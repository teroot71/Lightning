/*
 * This code is for Internal Salesforce use only, and subject to change without notice.
 * Customers shouldn't reference this file in any web pages.
 */
(function(d){if(!d.Sfdc||!d.Sfdc.canvas||!d.Sfdc.canvas.module){var s={};if(d.Sfdc&&d.Sfdc.canvas)for(var q in d.Sfdc.canvas)d.Sfdc.canvas.hasOwnProperty(q)&&(s[q]=d.Sfdc.canvas[q]);var t=Object.prototype,m=Array.prototype,n=d.document,f={hasOwn:function(a,b){return t.hasOwnProperty.call(a,b)},isUndefined:function(a){return void 0===a},isNil:function(a){return f.isUndefined(a)||null===a||""===a},isNumber:function(a){return!!(0===a||a&&a.toExponential&&a.toFixed)},isFunction:function(a){return!(!a||
!a.constructor||!a.call||!a.apply)},isArray:Array.isArray||function(a){return"[object Array]"===t.toString.call(a)},isArguments:function(a){return!(!a||!f.hasOwn(a,"callee"))},isObject:function(a){return null!==a&&"object"===typeof a},isString:function(a){return null!==a&&"string"==typeof a},isBoolean:function(a){return"[object Boolean]"===Object.prototype.toString.call(a)},appearsJson:function(a){return/^\{.*\}$/.test(a)},nop:function(){},invoker:function(a){f.isFunction(a)&&a()},identity:function(a){return a},
each:function(a,b,c){if(!f.isNil(a)){var g=m.forEach,e=0,h,d;h=a.length;c=c||a;if(g&&g===a.forEach)a.forEach(b,c);else if(f.isNumber(h))for(;e<h&&!1!==b.call(c,a[e],e,a);)e+=1;else for(d in a)if(f.hasOwn(a,d)&&!1===b.call(c,a[d],d,a))break}},startsWithHttp:function(a,b){return!f.isString(a)?a:"http"===a.substring(0,4)?a:b},map:function(a,b,c){var g=[],e=m.map;if(f.isNil(a))return g;if(e&&a.map===e)return a.map(b,c);c=c||a;f.each(a,function(a,e,f){g.push(b.call(c,a,e,f))});return g},values:function(a){return f.map(a,
f.identity)},slice:function(a,b,c){return m.slice.call(a,f.isUndefined(b)?0:b,f.isUndefined(c)?a.length:c)},toArray:function(a){return!a?[]:a.toArray?a.toArray:f.isArray(a)?a:f.isArguments(a)?f.slice(a):f.values(a)},size:function(a){return f.toArray(a).length},indexOf:function(a,b){var c=m.indexOf,g;if(!a)return-1;if(c&&a.indexOf===c)return a.indexOf(b);c=0;for(g=a.length;c<g;c+=1)if(a[c]===b)return c;return-1},isEmpty:function(a){if(null===a)return!0;if(f.isArray(a)||f.isString(a))return 0===a.length;
for(var b in a)if(f.hasOwn(a,b))return!1;return!0},remove:function(a,b){var c=f.indexOf(a,b);0<=c&&a.splice(c,1)},param:function(a,b){function c(a,e){f.isNil(e)||(e=f.isFunction(e)?e():e,f.isArray(e)?f.each(e,function(b,e){c(a,b)}):g[g.length]=b?encodeURIComponent(a)+"\x3d"+encodeURIComponent(e):a+"\x3d"+e)}var g=[];b=b||!1;if(f.isArray(a))f.each(a,function(a,b){c(b,a)});else for(var e in a)f.hasOwn(a,e)&&c(e,a[e]);return g.join("\x26").replace(/%20/g,"+")},objectify:function(a){var b={},c,g,e,h;
if(f.isNil(a))return b;"?"==a.substring(0,1)&&(a=a.substring(1));a=a.split("\x26");for(c=0;c<a.length;c+=1)g=a[c].split("\x3d"),e=g[0],g=g[1],h=b[e],f.isNil(h)?b[e]=g:f.isArray(h)?h[h.length]=g:(b[e]=[],b[e][0]=h,b[e][1]=g);return b},stripUrl:function(a){return f.isNil(a)?null:a.replace(/([^:]+:\/\/[^\/\?#]+).*/,"$1")},query:function(a,b){if(f.isNil(b))return a;a=a.replace(/#.*$/,"");return a+=/^\#/.test(b)?b:(/\?/.test(a)?"\x26":"?")+b},assert:function(a,b){if(void 0===a||null===a||!1===!!a)throw Error(b);
return a},apply:function(a,b,c){if(c)for(var g in b)b.hasOwnProperty(g)&&(a[g]=b[g]);else for(var e in b)a.hasOwnProperty(e)||(a[e]=b[e]);return a},userAgent:function(){var a=d.navigator&&d.navigator.userAgent||"",b=-1!=a.indexOf("Chromium"),c=-1!=a.indexOf("AppleWebKit"),g=c&&-1!=a.indexOf("Chrome/"),e=c&&!g,f=-1!=a.indexOf("Firefox/"),l=-1!=a.indexOf("MSIE ")||-1!=a.indexOf("Trident/"),k=parseInt(a.split("MSIE")[1],10)||-1;l&&(-1==k&&-1!=a.indexOf("Trident/7.0"))&&(k=11);return{isIE:l,isIE11:l&&
11==k,isIE10:l&&10==k,isIE9:l&&9==k,isIE8:l&&8==k,isIE7:l&&7==k,isIE6:l&&6==k,ieVersion:k,isWebkit:c,isChrome:g,isChromeFrame:g&&"undefined"!=typeof d.externalHost,isChromium:b,isSafari:e,isSafari3:e&&-1!=a.indexOf("Version/3"),isSafariIpad:c&&-1!=a.indexOf("iPad"),isSafariIOS:e&&(-1!=a.indexOf("iPad")||-1!=a.indexOf("iPhone")),isFirefox:f,isFirefox3:f&&-1!=a.indexOf("Firefox/3"),isOpera:-1!=a.indexOf("Opera"),isNetscape:-1!=a.indexOf("Netscape/")}}(),extend:function(a){f.each(f.slice(arguments,1),
function(b,c){f.each(b,function(b,c){a[c]=b})});return a},endsWith:function(a,b){return-1!==a.indexOf(b,a.length-b.length)},capitalize:function(a){return a.charAt(0).toUpperCase()+a.slice(1)},uncapitalize:function(a){return a.charAt(0).toLowerCase()+a.slice(1)},decode:function(a){var b=[],c,g,e="",h,d="",k=0;a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");do c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".indexOf(a.charAt(k++)),g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".indexOf(a.charAt(k++)),
h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".indexOf(a.charAt(k++)),d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".indexOf(a.charAt(k++)),c=c<<2|g>>4,g=(g&15)<<4|h>>2,e=(h&3)<<6|d,b.push(String.fromCharCode(c)),64!==h&&b.push(String.fromCharCode(g)),64!==d&&b.push(String.fromCharCode(e));while(k<a.length);return f.escapeToUTF8(b.join(""))},escapeToUTF8:function(a){for(var b="",c=0;c<a.length;){var g=a.charCodeAt(c++),e;if(128>g)b+=String.fromCharCode(g);
else if(191<g&&224>g)e=a.charCodeAt(c++),b+=String.fromCharCode((g&31)<<6|e&63);else{e=a.charCodeAt(c++);var f=a.charCodeAt(c++),b=b+String.fromCharCode((g&15)<<12|(e&63)<<6|f&63)}}return b},htmlEscapeChararacter:function(a){switch(a){case "'":return"\x26#39;";case "\x26":return"\x26amp;";case "\x3c":return"\x26lt;";case "\x3e":return"\x26gt;";case '"':return"\x26quot;";case "\u00a9":return"\x26copy;";case "\u2028":return"\x3cbr\x3e";case "\u2029":return"\x3cp\x3e";default:return a}},escapeToHtml:function(a,
b){if(null===a||""===a)return"";f.assert(a&&f.isString(a),"Expected escapeToHtml(String input, Boolean escapeNewline)");f.assert(f.isBoolean(b||!1),"Expected escapeToHtml(String input, Boolean escapeNewline)");if(f.isEmpty(a))return a;var c=a.replace(/[&<>"'\u00a9\u2028\u2029]/g,f.htmlEscapeChararacter);b&&(c=c.replace(/\n/g,"\x3cbr\x3e"));return c},generateQueryString:function(a,b,c){var g=[],e={},h=null;c=f.apply(c||{},{includeMark:!0,escape:encodeURIComponent,fullUrl:!1,allowMultipleOfParam:!1},
!1);var e=a.split("?"),d=e[0],e=1<e.length?e[1]:"";if(!b)return c.fullUrl?a:e;1<e.length?(a=e.split("#"),1<a.length&&(e=a[0])):(a=d.split("#"),1<a.length&&(d=a[0]));e=this.getUrlParameters(e,c);if(c.allowMultipleOfParam)for(var k in b)e.hasOwnProperty(k)?f.isArray(e[k])?e[k].push(b[k]):e[k]=[e[k],b[k]]:e[k]=b[k];else e=f.apply(e,b,!0);for(var m in e)if(e.hasOwnProperty(m)&&(h=e[m],void 0!==h&&null!==h))if(c.allowMultipleOfParam&&f.isArray(h)){b=0;for(k=h.length;b<k;b++)g.push(m+"\x3d"+c.escape(h[b]))}else g.push(m+
"\x3d"+c.escape(h));retval=c.fullUrl?d+"?":c.includeMark?"?":"";return 1<a.length?(a.shift(),retval+g.join("\x26")+"#"+a.join("#")):retval+g.join("\x26")},generateUrl:function(a,b,c){c=f.apply(c||{},{fullUrl:!0},!0);return this.generateQueryString(a,b,c)},_createXmlHttpObject:function(){if(window.XMLHttpRequest)return new window.XMLHttpRequest;try{return new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(a){}return null},_handleXDR:function(a,b){var c=new XDomainRequest;if(!f.isFunction(b.beforerequest)||
b.beforerequest.call(b.context))return c&&(c.onerror=function(){b.failure.call(b.context,c.responseText,c,b)},c.ontimeout=function(){b.failure.call(b.context,c.responseText,c,b)},c.onprogress=function(){},c.onload=function(){b.success.call(b.context,c.responseText,c,b)},c.open("get",a),c.send()),c},request:function(a,b){var c=b.isCrossDomain||!1,g="undefined"!=typeof XDomainRequest,e=c&&g;b=f.apply(b||{},{method:"GET",async:!0,beforerequest:function(){return!0},success:function(){},failure:function(){},
complete:function(){},contentType:null,headers:null,data:null,processData:!0,context:window,escape:function(a){return a}});b.method=b.method.toUpperCase();var d=f._createXmlHttpObject();if(c&&!g&&!("withCredentials"in d))b.onBrowserNotSupportXDR();else{if(e)return f._handleXDR(a,b);c=function(){if(4===d.readyState){var a=d.status;200<=a&&300>a||304===a||1223===a?b.success&&b.success.call(b.context,d.responseText,d,b):b.failure&&b.failure.call(b.context,d.responseText,d,b);b.complete&&b.complete.call(b.context,
d.responseText,d,b);b.complete=b.success=b.failure=b.beforerequest=null}};g=function(){b.failure&&b.failure.call(b.context,d.responseText,d,b);b.complete&&b.complete.call(b.context,d.responseText,d,b);b.complete=b.success=b.failure=b.beforerequest=null};b.data&&("GET"===b.method||"HEAD"===b.method?a=f.generateUrl(a,b.data,{escape:b.escape}):!f.isString(b.data)&&b.processData&&(b.data=f.generateQueryString("",b.data,{includeMark:!1,escape:b.escape,allowMultipleOfParam:!0})));b.async&&(d.onreadystatechange=
c,d.onerror=g);if(!f.isFunction(b.beforerequest)||b.beforerequest.call(b.context)){d.open(b.method,a,b.async);if(b.headers)for(var l in b.headers)b.headers.hasOwnProperty(l)&&d.setRequestHeader(l,b.headers[l]);b.contentType?d.setRequestHeader("Content-Type",b.contentType):b.data&&"POST"===b.method&&d.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset\x3dUTF-8");d.send(b.data);return!b.async?(c(),l=d.responseText,d.onreadystatechange=function(){},d=null,l):d}}},post:function(a,
b,c){c=c||{};c.method="POST";b&&(c.success=b);return f.request(a,c)},validEventName:function(a,b){var c,d=a.split(/\./),e=/^[$A-Z_][0-9A-Z_$]*$/i,h={sfdc:!0,canvas:!0,force:!0,salesforce:!0,chatter:!0,s1:!0};f.each(f.isArray(b)?b:[b],function(a){h[a]=!1});return 2<d.length?1:2===d.length&&(c=d[0].toLowerCase(),h[c])?2:!e.test(d[0])||!e.test(d[1])?3:0},prototypeOf:function(a){var b=Object.getPrototypeOf;return f.isFunction(b)?b.call(Object,a):"object"===typeof{}.__proto__?a.__proto__:a.constructor.prototype},
module:function(a,b){var c=a.split("."),g=d.Sfdc.canvas,e,h;"canvas"===c[1]&&(c=c.slice(2));h=c.length;for(e=0;e<h;e+=1)f.isUndefined(g[c[e]])&&(g[c[e]]={}),g=g[c[e]];f.isFunction(b)&&(b=b());return f.extend(g,b)},document:function(){return n},byId:function(a){return n.getElementById(a)},byName:function(a){return n.getElementsByName(a)[0]},byClass:function(a){return n.getElementsByClassName(a)},attr:function(a,b){var c=a.attributes,d;for(d=0;d<c.length;d+=1)if(b===c[d].name)return c[d].value},onReady:function(a){f.isFunction(a)&&
p.push(a)},console:function(){function a(){try{return"sessionStorage"in d&&null!==d.sessionStorage}catch(a){return!1}}function b(){}function c(){}function f(){b=Function.prototype.bind?Function.prototype.bind.call(console.log,console):function(){Function.prototype.apply.call(console.log,console,arguments)}}function e(){b=function(){}}var h=!1;d&&!d.console&&(d.console={});d&&!d.console.log&&(d.console.log=function(){});d&&!d.console.error&&(d.console.error=function(){});(h=a()&&"true"===sessionStorage.getItem("canvas_console"))?
f():e();c=Function.prototype.bind?Function.prototype.bind.call(console.error,console):function(){Function.prototype.apply.call(console.error,console,arguments)};return{enable:function(){h=!0;a()&&sessionStorage.setItem("canvas_console","true");f()},disable:function(){h=!1;a()&&sessionStorage.setItem("canvas_console","false");e()},log:b,error:c}}()},p=[],r=function(a){f.isFunction(a)&&p.push(a)};(function(){function a(){c||(c=!0,a=f.nop,f.each(p,f.invoker),p=[])}function b(){if(!c)try{d.document&&
(d.document.documentElement&&d.document.documentElement.doScroll)&&(d.document.documentElement.doScroll("left"),a())}catch(e){setTimeout(b,30)}}var c=!1,g,e;if(d.document&&d.document.addEventListener)d.document.addEventListener("DOMContentLoaded",a,!1);else if(d.document&&d.document.attachEvent){try{g=self!==top}catch(h){}document.documentElement.doScroll&&!g&&b();d.document.attachEvent("onreadystatechange",function(){d.document&&"complete"===d.document.readyState&&a()})}d.addEventListener?d.addEventListener("load",
a,!1):d.attachEvent?d.attachEvent("onload",a):(e=d.onload,d.onload=function(){e&&e();a()})})();f.each(f,function(a,b){r[b]=a});f.each(s,function(a,b){r[b]=a});(function(){for(var a,b=function(){},c="assert clear count debug dir dirxml error exception group groupCollapsed groupEnd info log markTimeline profile profileEnd table time timeEnd timeStamp trace warn".split(" "),f=c.length,e="undefined"!==typeof d&&d.console?d.console:{};f--;)a=c[f],e[a]||(e[a]=b)})();d.Sfdc||(d.Sfdc={});d.Sfdc.canvas=r}})(this);
(function(c,b){if("undefined"!==typeof c.xd)c.console.log("Skipping load of xd.js");else{var m=function(){var h=b.addEventListener,k=b.removeEventListener,g,l=Sfdc.JSON||JSON;return{post:function(e,d,a){if(c.isNil(d))throw"ERROR: target_url was not supplied on postMessage";d=c.stripUrl(d);a=a||parent;b.postMessage&&(c.isObject(e)&&(e.targetModule="Canvas"),e=l.stringify(e),a.postMessage(e,d))},receive:function(e,d){b.postMessage&&(e&&(g=function(a){var b,f;if(!c.isNil(a)){if("string"===typeof d&&
a.origin!==d)return c.console.log("source origin's don't match",a.origin,d),!1;if(c.isFunction(d)&&(f=d(a.origin,a.data,a.source),!1===f))return c.console.log("source origin's function returning false",a.origin,a.data),!1;if(f&&(f.parsedData||c.appearsJson(a.data))){if(f.parsedData)b=f.parsedData;else try{b=l.parse(a.data)}catch(g){}!c.isNil(b)&&(c.isNil(b.targetModule)||"Canvas"===b.targetModule)&&e(b,f,a.source)}}}),h?h("message",g,!1):b.attachEvent("onmessage",g))},remove:function(){b.postMessage&&
(k?k("message",g,!1):b.detachEvent("onmessage",g))}}}();c.module("Sfdc.canvas.xd",m)}})(Sfdc.canvas,this);
(function(k){var p=function(){function l(d,a,e,g,b){m(d,a,a,function(a,c,d){a.appendChild(document.createTextNode(e));c.appendChild(document.createTextNode(g));d.appendChild(document.createTextNode(b))})}function m(d,a,e,g){if(!k.isNil(d)){var b,f,c,h;b=k.byId("canvas-notify-styles");k.isNil(b)&&(b=document.createElement("style"),b.setAttribute("name","canvas-notify-styles"),b.setAttribute("id","canvas-notify-styles"),b.type="text/css",window.attachEvent&&!window.opera?b.styleSheet.cssText=n:(f=document.createTextNode(n),
b.appendChild(f)),document.getElementsByTagName("head")[0].appendChild(b));b=document.createElement("div");b.setAttribute("class","canvas-notify-block");f=document.createElement("div");f.setAttribute("class","top-line");c=document.createElement("img");c.setAttribute("src",a);c.setAttribute("width","16");c.setAttribute("height","16");c.setAttribute("class","title-image");a=document.createElement("div");a.setAttribute("class","title-text");f.appendChild(c);f.appendChild(a);b.appendChild(f);f=document.createElement("div");
f.setAttribute("class","content");c=document.createElement("div");c.setAttribute("class","contentIcon");h=document.createElement("img");h.setAttribute("src",e);h.setAttribute("width","32");h.setAttribute("height","32");c.appendChild(h);f.appendChild(c);e=document.createElement("div");e.setAttribute("class","notify-message");c=document.createElement("div");c.setAttribute("class","subject-text");h=document.createElement("div");h.setAttribute("class","body-text");k.isFunction(g)&&g(a,c,h);e.appendChild(c);
e.appendChild(h);f.appendChild(e);for(b.appendChild(f);d.firstChild;)d.removeChild(d.firstChild);d.appendChild(b)}}var n="#canvas-notify-block {background: none repeat scroll 0 0 #FFFFFF;border-radius: 5px 5px 5px 5px;margin-bottom: 20px;overflow: hidden;position: relative;top: 1px;color: #222222;font-family: Arial,Helvetica,sans-serif;padding-left: 10px;}.canvas-notify-block .top-line{background-color: #DEDEDE;border: 1px solid #CCCCCC;border-radius: 5px 5px 0 0;padding-bottom: 15px;color: #222222;font-size: 10px;font-weight: bold;margin-bottom: 0px;margin-top: 0px;padding-left: 5px;padding-top: 0px;height: 10px;}.canvas-notify-block .top-line .title-image{float:left;padding-top:5px;}.canvas-notify-block .top-line .title-text{padding-left:20px;margin-top:8px;display:block;}.canvas-notify-block .content{border-bottom: 1px solid #CCCCCC;border-bottom-left-radius: 5px;border-bottom-right-radius: 5px;border-left: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;font-size: 15px;padding-right: 4px;}.canvas-notify-block .content .contentIcon{float: left;height: 40px;margin-bottom: 3px;margin-left: 20px;margin-top: 6px;padding-top: 6px;width: 40px;}.canvas-notify-block .content .notify-message .subject-text{font-weight: bold;}.canvas-notify-block .content .notify-message .body-text{padding-top: 10px;}.canvas-notify-block .content .notify-message{padding-left:80px;padding-top:20px;padding-bottom:20px;font-size: 11px;}";
return{warning:function(d,a,e,g){l(d,"/img/msg_icons/warning32.png",a,e,g)},error:function(d,a,e,g){l(d,"/img/msg_icons/error32.png",a,e,g)},info:function(d,a,e,g){l(d,"/img/msg_icons/info32.png",a,e,g)},show:l,custom:m}}();k.module("Sfdc.canvas.notify",p)})(Sfdc.canvas);
(function(c){if("undefined"!==typeof c.parent)c.console.log("Skipping load of parent.js");else{var H=function(){var A,s;function I(b,e,a,d,g){g=LC.getLabel("CanvasParentJs","defaultNotifyTitle",a);a=LC.getLabel("CanvasParentJs","defaultRenderSummary",a);var f=t(1,h[b]);c.isArray(d)&&(d=LC.getLabel.apply(LC,d));c.isNil(f)?c.notify.show(e,v("/img/msg_icons/error32.png"),g,a,d):f({title:g,summary:a,detail:d});if(!c.isNil(h[b])){if(c.isFunction(h[b].options.onCanvasAppError))h[b].options.onCanvasAppError();
w(b)}}function H(b,e,a,d,g,f){var p=v("/img/msg_icons/info32.png"),l=LC.getLabel("CanvasParentJs","defaultNotifyTitle",a),k=LC.getLabel("CanvasParentJs","defaultRenderSummary",a);a=t(2,h[b]);c.isNil(a)?c.notify.custom(e,p,p,function(a,b,e){a.appendChild(document.createTextNode(l));b.appendChild(document.createTextNode(k));e.appendChild(document.createTextNode(d));c.isNil(f)||(a=document.createElement("a"),a.setAttribute("href",v(f)),a.setAttribute("title",g),a.appendChild(document.createTextNode(g)),
e.appendChild(document.createElement("p")),e.appendChild(a))}):a({title:l,summary:k,detail:d});if(!c.isNil(h[b])){if(c.isFunction(h[b].options.onCanvasAppError))h[b].options.onCanvasAppError();w(b)}}function t(b,e){var a=O[b];return!c.isNil(e)&&(e.options&&!c.isNil(e.options.customCanvasRenderer)&&!c.isNil(e.options.customCanvasRenderer[a]))&&c.isFunction(e.options.customCanvasRenderer[a])?e.options.customCanvasRenderer[a]:null}function J(b,e){var a=h[b],d;d=t(0,a);var g=c.isNil(a.app.name)?"":a.app.name,
g=LC.getLabel("CanvasParentJs","loadingStatus",g);a.options&&a.options.showLoadingStatus&&(c.isNil(d)?(w(b),d=c.byId("loading-"+b),c.isNil(d)?(d=document.createElement("div"),d.setAttribute("id","loading-"+b),d.setAttribute("style","position:relative;width:25%;height:30px;margin-top:20px;margin-bottom:30px;"),d.style.display="block",e.appendChild(d)):d.style.display="block",a.loadingScreen=new LoadingScreen(d,c.escapeToHtml(g)),a.loadingScreen.show()):d(!0,g))}function w(b){var e=h[b],a=t(0,e);c.isNil(a)?
(c.isNil(e.loadingScreen)||(e.loadingScreen.hide(),e.loadingScreen=null),b=c.byId("loading-"+b),c.isNil(b)||(b.style.display="none",K(b))):a(!1)}function K(b){if(!c.isNil(b))for(;b.firstChild;)b.removeChild(b.firstChild)}function x(c,e){var a,d,g,f=e?e+c:c;g=window.document.getElementsByTagName("iframe");d=g.length;for(a=0;a<d;a+=1)try{if(g[a].name===f)return g[a].contentWindow}catch(p){}return frames[f]}function v(b,e){var a=null,d=b;c.isNil(B)?c.isNil(C)||(d=C+d):(a=B+b,d=location.protocol+"//"+
location.hostname+":"+location.port+"/services/proxy",e.headers["SalesforceProxy-Endpoint"]=a);UserContext&&UserContext.getUrl&&(d=UserContext.getUrl(d),UserContext.isDefaultNetwork||(d=c.generateUrl(d)));return d}function P(b,e){var a=e.id;if(c.isNil(a))throw c.console.error(LC.getLabel("CanvasParentJs","missingIdInContext")),LC.getLabel("CanvasParentJs","missingIdInContext");if(b&&b.body){var d=b.body.type,g=b.seq,f=h[a];f&&(f.cversion=b.clientVersion,f.oauthToken=b.body.config.client.oauthToken,
f.url=f.url||b.body.config.client.url);c.console.log("xdCallback type [%s] seq [%d] id [%s]",d,g,a);"resize"===d?n.frame.childResize(b,f):"subscribe"===d?n.events.subscribe(b.body.subscriptions,f):"unsubscribe"===d?n.events.unsubscribe(b.body.subscriptions,f):"publish"===d?c.s1&&c.s1.canHandle(b.body.event)?D?D(function(){c.s1.handleEvent(b.body.event)}):c.s1.handleEvent(b.body.event):n.events.publishClient(b.body.event,f):"loading"===d?n.services(g,a).loading(b,f):"error"===d?n.services(g,a).error(b,
f):"info"===d&&n.services(g,a).info(b,f)}}function L(){E&&c.xd.remove();c.xd.receive(P,function(b,e){if(c.appearsJson(e)){e=y.parse(e);if(c.isNil(e.body)||c.isNil(e.body.config)||c.isNil(e.body.config.client))return c.console.log("JSON from postMessage invalid",e),!1;if(e.body.config.client.isVF)return c.console.log("can't find canvas, instanceId [%s] assuming from VF page",e.body.config.client.instanceId),{id:e.body.config.client.instanceId};var a=h[e.body.config.client.instanceId];if(!c.isNil(a))return c.console.log("post url: c.url "+
a.url),c.console.log("actual canvas url, c.app.canvasUrl"+a.app.canvasUrl),"refresh"===e.body.config.type&&c.stripUrl(a.app.canvasUrl)!==b?(c.console.error("Source origin and canvas url are from different domains",a.app.canvasUrl,b),!1):{id:e.body.config.client.instanceId}}return!1});E=!0}function q(c,e,a){var d=document.createElement("input");d.setAttribute("type","hidden");d.setAttribute("name",e);d.setAttribute("value",a);c.appendChild(d);return d}function M(b,e){var a,d,g;c.isNil(b)||(c.isNil(e.clientWidth)&&
(a=b.clientWidth,0===a&&(d=b.offsetParent,c.isNil(d)||(a=d.clientWidth)),e.clientWidth=a+"px"),c.isNil(e.clientHeight)&&(a=b.clientHeight,0===a&&(d=b.offsetParent,g=b.offsetTop,c.isNil(d)||(a=d.clientHeight-g),0>a&&(a=0)),e.clientHeight=a+"px"))}function F(b,e){return(!c.isNil(b.developerName)?(c.isNil(b.namespace)?"_":b.namespace)+":"+b.developerName:b.referenceId)+(c.isNil(e)?":":":"+e)}function N(b,e,a){var d={frameborder:"0",width:{value:"800px",max:"1000px"},height:{value:"900px",max:"2000px"},
scrolling:"no",displayLocation:"NONE",showLoadingStatus:!0};a&&(!c.isObject(a.width)&&!c.isNil(a.width)&&(a.width=c.extend(d.width,{value:a.width})),!c.isObject(a.height)&&!c.isNil(a.height)&&(a.height=c.extend(d.height,{value:a.height})),a.width=c.extend(d.width,a.width||{}),a.height=c.extend(d.height,a.height||{}));a=c.extend(d,a||{});a.height.value=n.frame.minPixels(a.height.value,a.height.max);a.width.value=n.frame.minPixels(a.width.value,a.width.max);d=c.isObject(e)?e:c.byId(e);if(c.isNil(d))console.error(LC.getLabel("CanvasParentJs",
"containerElementNotFound",e));else{e=F(b.app,a.canvasId);try{if(c.isNil(b)||c.isNil(b.app)||c.isNil(b.app.developerName)&&c.isNil(b.app.referenceId))throw LC.getLabel("CanvasParentJs","insufficientAppContainerInfo");if(c.isNil(b.version))throw LC.getLabel("CanvasParentJs","missingParentVersionInfo");if(!c.isNil(c.userAgent)&&(c.userAgent.isIE6||c.userAgent.isIE7||c.userAgent.isOpera||c.userAgent.isNetscape))throw LC.getLabel("CanvasParentJs","unsupportedBrowser");G(d,e);h[e]={instanceId:e,app:b.app,
sid:b.sid,cversion:null,options:a,startTime:(new Date).getTime(),onCanvasSubscribed:a.onCanvasSubscribed,parentElem:d};r=b.version;B=a.salesforceBaseUrl;C=a.customPathPrefix;J(e,d);var g=z+e,f=h[e],p=c.isNil(f.app.name)?LC.getLabel("CanvasParentJs","iframePlaceholderTitle"):LC.getLabel("CanvasParentJs","iframeTitle",f.app.name);M(d,a);var l=document.createElement("iframe");l.setAttribute("id",g);l.setAttribute("name",g);l.setAttribute("title",p);l.setAttribute("allow","geolocation *; microphone *; camera *");
l.style.display="none";l.frameBorder=a.frameborder;l.width=a.width.value;l.height=a.height.value;l.scrolling="no";d.appendChild(l);h[e].frameElement=l;var k=a.onCanvasSubscribed;try{k&&(a.onCanvasSubscribed=!0);document.location.origin||(document.location.origin=document.location.protocol+"//"+document.location.host);document.URL&&(a.referer=document.URL);var m=document.createElement("form"),p="canvas-outer-hidden-form-"+e;m.setAttribute("id",p);m.setAttribute("name",p);m.setAttribute("style","display:none");
m.setAttribute("action",v("/canvas/proxy.jsp"));m.setAttribute("target",g);m.setAttribute("method","get");q(m,"a",y.stringify(f.app));q(m,"ns",f.app.namespace);q(m,"dn",f.app.developerName);q(m,"ri",f.app.referenceId);q(m,"s",f.sid);q(m,"dm",document.location.origin);q(m,"o",y.stringify(a));q(m,"v",r);d.appendChild(m);m.submit()}finally{k&&(a.onCanvasSubscribed=k)}L()}catch(u){b=!c.isNil(b.app)?b.app.developerName||b.app.referenceId||"undefined":"undefined",I(e,d,b,u)}}}function G(b,e,a){n.events.unsubscribeAll(h[e]);
b=c.isObject(b)?b:c.byId(b);K(b);c.isNil(a)&&delete h[e]}var E=!1;A="canvas.scroll";s="sfdc.streamingapi";var O=["toggleLoadingScreen","renderError","renderInfo"],h={},r,B,C,z="canvas-outer-",y=JSON,D=null,n=function(){var b=function(){function a(a,b){var e,d=a.name;c.isNil(b)||(d===s?!c.isNil(b.handlers)&&!c.isNil(b.handlers[d])&&(e=b.handlers[d][a.params.topic]):!c.isNil(b.handlers)&&!c.isNil(b.handlers[d])&&(e=b.handlers[d]));return e}function d(b){var e=!1;c.each(h,function(d){c.isNil(a(b,d))||
(e=!0)});return e}function e(b,d){var f;if(c.isNil(b.target)&&c.isNil(d))c.console.log("Targeting all canvas apps"),c.each(h,function(d,e){f=a(b,d);c.isNil(f)||(c.isFunction(f)?f(b.payload):(c.console.log("Found canvas app with handler"),c.xd.post({parentVersion:r,clientVersion:d.cversion,body:{type:"event",config:{client:{instanceId:e}},event:b}},c.stripUrl(d.url),x(e,z))))});else if(!c.isNil(b.target)&&!c.isNil(b.target.canvas)&&"parent"===b.target.canvas)f=a(b,h.parent),c.isFunction(f)&&f(b.payload);
else if(c.isNil(d))if(c.isNil(b.target.iframe))c.isNil(b.target.canvas)?c.console.error("Nothing to target"):(c.console.log("Targeting single canvas ",b.target.canvas),c.each(h,function(d,e){var m=e.split(":");m[m.length-1]===b.target.canvas&&(c.console.log("Found targeted canvas app"),f=a(b,d),c.isNil(f)?c.console.log("Canvas app has no handler"):c.xd.post({parentVersion:r,clientVersion:d.cversion,body:{type:"event",config:{client:{instanceId:e}},event:b}},c.stripUrl(d.url),x(e,z)))}));else{c.console.log("Targeting single iframe");
var l=x(b.target.iframe);if(!c.isNil(l)){for(var g in h)if(l===h[g].frameElem){d=h[g];break}var p;void 0===d?(g={parentVersion:r,clientVersion:r,type:"event",payload:b},p="*"):(g={parentVersion:r,clientVersion:d.cversion,config:{client:{instanceId:d.instanceId}},body:{type:"event",event:b}},p=c.stripUrl(d.url));c.xd.post(g,p,l)}}else c.console.log("Targeting canvas object"),f=a(b,d),(!c.isNil(f)||b.name===s)&&c.xd.post({parentVersion:r,clientVersion:d.cversion,body:{type:"event",config:{client:{instanceId:d.instanceId}},
event:b}},c.stripUrl(d.url),x(d.instanceId,z))}function f(b,a){var d,e=c.validEventName(b,a);if(0!==e)throw d={1:LC.getLabel("CanvasParentJs","eventMultipleNamespaces"),2:LC.getLabel("CanvasParentJs","eventNamespaceReserved"),3:LC.getLabel("CanvasParentJs","eventInvalidCharacters")},d[e];}function p(b){var a,e=s,f,g,p;c.isNil(b)||(a=b.handlers,c.isNil(a)||(g=a[e],c.each(g,function(b,d){f=a[e][d];delete a[e][d];0>=c.size(a[e])&&delete a[e];unsubscribePushTopicOnServer(f)}),b.handlers={},c.each(a,function(b,
a){p=l[a];!c.isNil(p)&&!d(a)&&p.unsubscribe()})))}var l=[];l[A]=function(){function c(){e({name:A,method:"onData",payload:{heights:{contentHeight:document.documentElement.scrollHeight,pageHeight:document.documentElement.clientHeight,scrollTop:document.documentElement&&document.documentElement.scrollTop||document.body.scrollTop},widths:{contentWidth:document.documentElement.scrollWidth,pageWidth:document.documentElement.clientWidth,scrollLeft:document.documentElement&&document.documentElement.scrollLeft||
document.body.scrollLeft}}})}var b=!1;return{subscribe:function(a){!0!==b&&(b=!0,window.addEventListener?window.addEventListener("scroll",c,!1):window.attachEvent&&window.attachEvent("onscroll",c))},unsubscribe:function(){!1!==b&&(window.removeEventListener?window.removeEventListener("scroll",c,!1):window.detachEvent&&window.detachEvent("onscroll",c),b=!1)}}}();l["canvas.orientation"]=function(){var b=!1,a;return{subscribe:function(d){!0!==b&&(b=!0,a=function(){var b={},a;c.isNil(d.parentElem)||M(d.parentElem,
b);a={orientation:window.orientation};c.isNil(b.clientHeight)||(a.clientHeight=b.clientHeight);c.isNil(b.clientWidth)||(a.clientWidth=b.clientWidth);e({name:"canvas.orientation",method:"onData",payload:a})},window.addEventListener?window.addEventListener("orientationchange",a,!1):window.attachEvent&&window.attachEvent("orientationchange",a,!1))},unsubscribe:function(){!1!==b&&(window.removeEventListener?window.removeEventListener("orientationchange",a,!1):window.detachEvent&&window.detachEvent("orientationchange",
a),b=!1,a=null)}}}();return{subscribe:function(b,a){if(a){var d=a.handlers||{},e;c.console.log("Subscribing ",a);c.each(b,function(b,f){c.isNil(f)||(d[f]=b,e=l[f],c.isNil(e)||e.subscribe(a))});a.handlers=d;if(c.isFunction(a.onCanvasSubscribed))a.onCanvasSubscribed()}},unsubscribe:function(a,b){var e,f;if(!c.isNil(b))for(e in a)a.hasOwnProperty(e)&&!c.isNil(b.handlers[e])&&(delete b.handlers[e],f=l[e],!c.isNil(f)&&!d(e)&&f.unsubscribe())},unsubscribeAll:function(c){p(c)},parentSubscribe:function(a){var d,
e={};E||L();c.isNil(h.parent)&&(h.parent={});d=h.parent;c.each(c.isArray(a)?a:[a],function(a){c.isNil(a.name)||(f(a.name,"canvas"),e[a.name]=a.onData)});c.console.log("Parent subscribing");b.subscribe(e,d)},parentUnsubscribe:function(a){var d,e={};c.isNil(h.parent)&&(h.parent={});d=h.parent;c.each(c.isArray(a)?a:[a],function(a){c.isNil(a.name)||(f(a.name),e[a.name]=a.onData)});b.unsubscribe(e,d)},publish:function(c,a){e({name:c.name,method:"onData",payload:c.payload,target:c.target},a)},publishClient:function(a){!c.isNil(a.target)&&
!c.isNil(a.target.iframe)&&(a.target.iframe=null);b.publish(a)},parentPublish:function(a){f(a.name);b.publish(a)}}}(),e=function(){function a(a,b){return c.isNil(a)||c.isNil(b)||"final"===b?!1:!0}function b(a,e){if(c.endsWith(a,"%")||"infinite"===e||"final"===e)return c.endsWith(a,"%")||c.endsWith(a,"px")?a:a+"px";a=Number(a.split("px")[0]);e=Number(e.split("px")[0]);return(a<e?a:e)+"px"}function e(f,g){var k,h;!c.isNil(g)&&!c.isNil(g.frameElement)&&(a(f.height,g.options.height.max)&&(h=b(f.height,
g.options.height.max),g.frameElement.height=h,g.parentElem.height=h),a(f.width,g.options.width.max)&&(k=b(f.width,g.options.width.max),g.frameElement.width=k,g.parentElem.width=k));return{height:h,width:k}}function f(a){var c={},b;for(b in a)null!==b&&(c[b]=a[b]);return c}return{minPixels:b,childResize:function(f,h){var k,m=f.body.config.client.instanceId;c.console.log("Child asking to be resized, id: [%s]",m);if(c.isNil(h)){k=f.body.size;var u,q,r,s,t;c.console.log("Resizing VF [%s] to ",m,k);u=
c.byName(m);c.isNil(u)?k={height:"",width:""}:(q=u.getAttribute("data-max-canvas-width")||"final",r=u.getAttribute("data-max-canvas-height")||"infinite",c.console.log("Max Width [%s] Max Height [%s]",q,r),a(k.height,r)&&(t=b(k.height,r),u.style.height=t),a(k.width,q)&&(s=b(k.width,q),u.style.width=s),k={height:t,width:s});n.events.publish({name:"sfdc.resize",payload:k,target:{iframe:m}});n.events.publish({name:"sfdc.resize",payload:k,target:{canvas:"parent"}})}else k=e(f.body.size,h),n.events.publish({name:"canvas.resize",
payload:k},h),n.events.publish({name:"canvas.resize",payload:k,target:{canvas:"parent"}})},parentResize:function(a,b){c.isNil(b)?(c.each(h,function(b){c.isNil(b.instanceId)||(e(a,b),c.isNil(b.url)&&(b=f(b),b.url="*"),n.events.publish({name:"canvas.resize",payload:a},b))}),n.events.publish({name:"canvas.resize",payload:a,target:{canvas:"parent"}})):c.isNil(b.canvas)||c.each(h,function(d,h){var q=h.split(":");q[q.length-1]===b.canvas&&(e(a,d),c.isNil(d.url)&&(d=f(d),d.url="*"),n.events.publish({name:"canvas.resize",
payload:a,target:b},d),n.events.publish({name:"canvas.resize",payload:a,target:{canvas:"parent"}}))})}}}();return{events:b,services:function(a,b){return{error:function(a,b){I(b.instanceId,b.parentElem,a.body.name,a.body.msg)},info:function(a,b){H(b.instanceId,b.parentElem,a.body.name,a.body.msg,a.body.label,a.body.href)},loading:function(a,b){if(a.body.msg)J(b.instanceId,b.parentElem);else if(w(b.instanceId),a.body.success){if(c.isFunction(b.options.onCanvasAppLoad))b.options.onCanvasAppLoad();b.frameElement&&
(b.frameElement.style.display="inline",c.isNil(b.app.name)&&!c.isNil(a.body.config.client.name)&&(b.frameElement.title=LC.getLabel("CanvasParentJs","iframeTitle",a.body.config.client.name)))}else if(c.isFunction(b.options.onCanvasAppError))b.options.onCanvasAppError()}}},frame:e}}();return{loadLabels:function(b,c){var a=window.LC.labels||(window.LC.labels={});a.CanvasParentJs=b;a.SquidCacheManager=c},initUserContext:function(b){var c=window.UserContext||{};c&&(!c.initialized&&c.initialize)&&c.initialize(b)},
render:N,feed:function(b,e,a){var d=c.byId(e),g=c.byId("canvas-icon-"+a.canvasId),f;f=F(b.app,a.canvasId);d&&"block"===d.style.display?(d.style.display="none",g.style.display="block",G(e,f)):c.isNil(h[f])&&(a.onCanvasAppLoad=function(){d.style.display="block";g.style.display="none"},a.onCanvasAppError=a.onCanvasAppLoad,a.parameters=y.parse(a.parameters),N(b,d,a))},subscribe:n.events.parentSubscribe,unsubscribe:n.events.parentUnsubscribe,publish:n.events.parentPublish,resize:n.frame.parentResize,close:function(b,
c,a){b=F(b,a);G(c,b)},setContextCallback:function(b){Sfdc.isFunction(b)&&(D=b)}}}();c.module("Sfdc.canvas.parent",H)}})(Sfdc.canvas);
AccessiblePreviewContentDialog=function(a,b){this.id=a;this.title=b;this.content="";this.height=550;this.width=730};AccessiblePreviewContentDialog.prototype=new AccessibleDialog({});AccessiblePreviewContentDialog.prototype.getContent=function(){return this.content};
Sfdc.ns("Sfdc.BaseAccessibleFileDialog");Sfdc.BaseAccessibleFileDialog=function(a){AccessibleDialog.call(this,a)};Sfdc.BaseAccessibleFileDialog.prototype=new AccessibleDialog({});Sfdc.BaseAccessibleFileDialog.prototype.isInAccessibilityMode=function(){return!1};Sfdc.BaseAccessibleFileDialog.prototype.display=function(){this.isInAccessibilityMode()||this.createContent();this.show()};
Sfdc.BaseAccessibleFileDialog.prototype.show=function(){var a=this.isOpen;this.isInAccessibilityMode()?(this.height||(this.height=300),this.createAccessiblePopupWindow(),this.popupWindow&&(this.popupWindow.focus(),this.popupWindow.confirmOnCloseLabel=LC.getLabel("Global","dialogCloseConfirm"),curPopupWindow=this.popupWindow)):OverlayDialog.prototype.show.call(this);!0===a&&chatter.getEventBus().fireEvent("chatter:files","onAfterDialogOpen");document.body.style.overflow="hidden"};
Sfdc.BaseAccessibleFileDialog.prototype.createDialog=function(){this.isInAccessibilityMode()||OverlayDialog.prototype.createDialog.call(this)};Sfdc.BaseAccessibleFileDialog.prototype.hide=function(){if(this.isInAccessibilityMode()){if(this.popupWindow){try{this.popupWindow.confirmOnClose=!1,this.popupWindow.close()}catch(a){}this.popupWindow=null}}else OverlayDialog.prototype.hide.call(this);document.body.style.overflow="visible"};
Sfdc.BaseAccessibleFileDialog.prototype.cancel=function(){var a=Sfdc.BaseAccessibleFileDialog.getDialogById(this.id);a&&a.hide();this.hook_cancel()};Sfdc.BaseAccessibleFileDialog.prototype.hook_cancel=function(){};Sfdc.BaseAccessibleFileDialog.getDialogById=function(a){var c,b;b=Sfdc.BaseAccessibleFileDialog.prototype.isInAccessibilityMode()?window.opener?window.opener:window.parent:window;b.sfdcPage&&(c=b.sfdcPage.getDialogById(a));return c};
BaseAutoCompleteElement=function(a){if(a&&!AutoCompleteInputElement.getInstance(a.id)&&(this.id=a.elementId,a.inDialog&&BaseAutoCompleteElement.removeExistingInstance(this.id),this.element=document.getElementById(this.id),this.id&&this.element)){if(this.valElementId=a.valElementId)this.valElement=document.getElementById(this.valElementId);this.matchBlanks=!0;AutoCompleteInputElement.instanceRefs[this.id]=this;this.servletURI=a.servletURI?a.servletURI:"/chatter/handlers/file/shareAutoComplete";this.minSuggestLen=
a.minSuggestLen&&0<=a.minSuggestLen?a.minSuggestLen:0;this.cache={};this.triedQueries={};this.selected=-1;this.requestParams={};this.lastInput=null;this.enabled=!0;this.disableOnEsc=!1;this.displayHeader=this.shouldCaptureKeyStroke=!0;var b=this;addEvent(this.element,"keyup",function(a){b.handleInput(a)});addEvent(this.element,"keydown",function(a){b.handleNav(a)});this.allowHideAC=!0;this.handleBlur=a.handleBlur?a.handleBlur:function(){b.clearSuggestions()};a.handleFocusExtra&&(this.handleFocusExtra=
a.handleFocusExtra);addEvent(this.element,"blur",function(){b.focused=!1;b.allowHideAC&&b.handleBlur()});addEvent(this.element,"focus",function(){b.focused=!0;b.clearGhostText();b.displaySuggestions();b.handleFocusExtra&&b.handleFocusExtra()});a.inDialog&&(this.inDialog=a.inDialog);this.zIndex=a.zIndex?a.zIndex:8E4;a.disableGhostText||this.displayGhostText();this.handleSelect=a.handleSelect?a.handleSelect:BaseAutoCompleteElement.defaultClickInternal;a.getMinimumWidth&&(this.getMinimumWidth=a.getMinimumWidth);
a.getACXPosition&&(this.getACXPosition=a.getACXPosition);a.getACYPosition&&(this.getACYPosition=a.getACYPosition)}};Ext.extend(BaseAutoCompleteElement,AutoCompleteInputElement);BaseAutoCompleteElement.prototype.getBoxCssClass=function(){return AutoCompleteInputElement.BOX_CSS_CLASS+" ugAC_box"};BaseAutoCompleteElement.prototype.getListOlCssClass=function(){return"ugAC_list"};BaseAutoCompleteElement.prototype.getRowCssClass=function(){return AutoCompleteInputElement.ROW_CSS_CLASS+" ugAC_row"};
BaseAutoCompleteElement.prototype.getRowSelectedCssClass=function(){return AutoCompleteInputElement.ROW_CSS_CLASS_SELECTED+" ugAC_rowSelected"};BaseAutoCompleteElement.prototype.getRowMouseOverCssClass=function(){return this.getRowCssClass()+" ugAC_row_hover"};BaseAutoCompleteElement.prototype.getHintRowCssClass=function(){return this.getRowCssClass()+" ugAC_hintRow"};BaseAutoCompleteElement.prototype.getInputBoxGhostTextCssClass=function(){return"ghostText"};
BaseAutoCompleteElement.prototype.getMoveSelectionUp=function(){return"UP"};BaseAutoCompleteElement.prototype.getMoveSelectionDown=function(){return"DOWN"};BaseAutoCompleteElement.prototype.displayGhostText=function(){var a=Sfdc.get(this.id);a.blur();Sfdc.Dom.addClass(a,this.getInputBoxGhostTextCssClass());a.value=this.getGhostText()};BaseAutoCompleteElement.prototype.getGhostText=function(){return""};
BaseAutoCompleteElement.prototype.clearGhostText=function(){var a=Sfdc.get(this.id);this.inGhostMode()&&(Sfdc.Dom.removeClass(a,this.getInputBoxGhostTextCssClass()),a.value="")};BaseAutoCompleteElement.prototype.inGhostMode=function(){var a=Sfdc.get(this.id);return Sfdc.Dom.hasClass(a,this.getInputBoxGhostTextCssClass())?!0:!1};
BaseAutoCompleteElement.prototype.handleEnter=function(a){var b=this.getRow(this.selected);b&&b.onmousedown?(b.onmousedown(),BaseAutoCompleteElement.needDefer()||AutoCompleteInputElement.captureKeystroke(a)):AutoCompleteInputElement.captureKeystroke(a)};BaseAutoCompleteElement.prototype.getCacheKey=function(a){return a};BaseAutoCompleteElement.prototype.retrieveFromServlet=function(a){};
BaseAutoCompleteElement.prototype.positionACBox=function(a){if(this.element&&this.acBox&&(!a||this.isACBoxVisible())){a=this.getACXPosition(this.element)+1;var b=this.getACYPosition(this.element),c=this.getMinimumWidth();Sfdc.userAgent.isIE8&&(a-=1);this.acBox.setStyle("left",a+"px");this.acBox.setStyle("top",b+"px");this.acBox.setStyle("width",c+"px");this.acBox.setStyle("zIndex",this.zIndex);this.inDialog&&this.acBox.setStyle("position","absolute")}};
BaseAutoCompleteElement.prototype.getMinimumWidth=function(){return this.element.clientWidth+2};BaseAutoCompleteElement.prototype.displaySuggestions=function(a){if(this.element){var b=trim(this.element.value);if(a||b!=this.lastInput||!this.isACBoxVisible())this.setAppliedFlag(!1),this.lastInput=b,a=null,this.hasValidSelection()&&(a=this.curSuggestions[this.selected]),this.curSuggestions=this.getSuggestions(b),this.updateACBox(this.curSuggestions,a)}};
BaseAutoCompleteElement.prototype.getValidSuggestions=function(a,b){for(var c={AllItems:[]},d=c.AllItems,f=this.extractCurrentEntitySuggestions(b),e=0,h=f.length;e<h;e++){var g=f[e];this.isValidSuggestion(a,g)&&d.push(g)}c.length=d.length;return c};BaseAutoCompleteElement.prototype.isValidSuggestion=function(a,b){var c=this.getRegexForInput(a);return b.ItemName.match(c)};
BaseAutoCompleteElement.prototype.updateACBox=function(a,b){Sfdc.get(this.id);!a||0===a.length?(this.displayACBox(a,b),this.scrollDiv(),this.updateWidth()):BaseAutoCompleteElement.superclass.updateACBox.call(this,a,b)};
BaseAutoCompleteElement.prototype.initACBox=function(){if(this.element){this.acBox=document.createElement("div");this.acBox.id=this.id+AutoCompleteInputElement.BOX_ID;this.acBox.className=this.getBoxCssClass();this.addACBoxToPage(this.acBox);this.acBox=new iframeShim(this.acBox);this.acBox.setStyle("width",this.getMinimumWidth()+"px");var a=document.getElementById(this.id+AutoCompleteInputElement.BOX_ID);if(a){var b=this;Sfdc.userAgent.isIE?(addEvent(a,"mouseenter",function(a){b.allowHideAC=!1}),
addEvent(a,"mouseleave",function(a){b.allowHideAC=!0})):(addEvent(a,"mouseover",function(a){b.allowHideAC=!1}),addEvent(a,"mouseout",function(a){b.allowHideAC=!0}))}}};BaseAutoCompleteElement.prototype.constructACBox=function(a,b){var c=["\x3col class\x3d'"+this.getListOlCssClass()+"'\x3e"],d=this.extractCurrentEntitySuggestions(a);this.addSuggestions(c,d,b,0);this.addHintMessage(c,d);c.push("\x3c/ol\x3e");return c};
BaseAutoCompleteElement.prototype.addHintMessage=function(a,b){b&&b.length>BaseAutoCompleteElement.MATCH_DISPLAY_LIMIT&&a.push('\x3cli\x3e\x3cdiv class\x3d"'+this.getHintRowCssClass()+'"\x3e'+LC.getLabel("ChatterFileSharing","tooManyMatchMessage")+"\x3c/div\x3e\x3c/li\x3e")};BaseAutoCompleteElement.prototype.extractCurrentEntitySuggestions=function(a){return a.AllItems};
BaseAutoCompleteElement.prototype.setACBoxHeight=function(a){4<a?(this.acBox.setStyle("height","144px"),this.scrolling=!0):(this.acBox.setStyle("height","auto"),this.scrolling=!1)};BaseAutoCompleteElement.prototype.select=function(a){if(this.selected!=a){if(0<=this.selected){var b=this.getRow(this.selected);b&&(b.className=this.getRowCssClass())}this.selected=a;if(b=this.getRow(a))b.className=this.getRowSelectedCssClass()}};BaseAutoCompleteElement.prototype.addSuggestions=function(a,b,c,d){};
BaseAutoCompleteElement.prototype.getSuggestionHtml=function(a){var b=escapeHTML(this.lastInput);a=BaseAutoCompleteElement.htmlEncode(a.ItemName);var c=this.getRegexForInput(b);return["\x3cspan class\x3d'name'\x3e",""===b?a:a.replace(c,'$1\x3cstrong class\x3d"autocompleteMatch"\x3e$2\x3c/strong\x3e'),"\x3c/span\x3e"].join("")};BaseAutoCompleteElement.prototype.compareSuggestions=function(a,b){return a&&b&&a.ItemId&&b.ItemId&&b.ItemId==a.ItemId};
BaseAutoCompleteElement.prototype.scrollDiv=function(){if(this.hasValidSelection()&&this.scrolling)if(this.selectionMoveDirection===this.getMoveSelectionUp()){var a=this.acBox.div.scrollHeight*((this.selected+1)/this.curSuggestions.length)-34;this.acBox.div.scrollTop>a&&(this.acBox.div.scrollTop=a)}else this.acBox.div.scrollTop=this.acBox.div.scrollHeight*((this.selected+1)/this.curSuggestions.length)-this.acBox.div.clientHeight};
BaseAutoCompleteElement.prototype.handleNav=function(a){AutoCompleteInputElement.isNav(a)&&a.keyCode==KEY_TAB?(this.handleEnter(a),this.resizeTextArea()):(AutoCompleteInputElement.isNav(a)&&a.keyCode==KEY_ARROW_U?(this.selectionMoveDirection=this.getMoveSelectionUp(),(Sfdc.userAgent.isSafari||Sfdc.userAgent.isChrome)&&AutoCompleteInputElement.captureKeystroke(a)):AutoCompleteInputElement.isNav(a)&&a.keyCode==KEY_ARROW_D&&(this.selectionMoveDirection=this.getMoveSelectionDown()),BaseAutoCompleteElement.superclass.handleNav.call(this,
a))};BaseAutoCompleteElement.prototype.saveToCache=function(a,b){!a||""===a?this.emptyInputCache=b:this.cache[this.getCacheKey(a)]=b};BaseAutoCompleteElement.prototype.clearCache=function(){this.cache={};this.triedQueries={};this.emptyInputCache={}};BaseAutoCompleteElement.prototype.checkCacheOrRetrieve=function(a){var b=this.getCacheKey(a);(!a||""===a?this.emptyInputCache:this.cache[b])||this.retrieveFromServlet(a);return!a||""===a?this.emptyInputCache:this.cache[b]};
BaseAutoCompleteElement.mouseOver=function(a,b){var c=AutoCompleteInputElement.getInstance(a);c&&b!=c.selected&&(document.getElementById(AutoCompleteInputElement.getRowIdStatic(a,b)).className=c.getRowMouseOverCssClass())};BaseAutoCompleteElement.mouseOut=function(a,b){var c=AutoCompleteInputElement.getInstance(a);c&&b!=c.selected&&(document.getElementById(AutoCompleteInputElement.getRowIdStatic(a,b)).className=c.getRowCssClass())};
BaseAutoCompleteElement.click=function(a,b,c,d,f,e,h,g,l){var k=AutoCompleteInputElement.getInstance(b);k&&(AutoCompleteInputElement.captureKeystroke(a),k.handleSelect(b,c,d,f,e,h,g,l))};BaseAutoCompleteElement.defaultClickInternal=function(a,b,c,d,f,e){this.element.value=d;this.valElement&&(this.valElement.value=c);this.select(b);this.complete()};BaseAutoCompleteElement.makeACBoxID=function(a){return a+AutoCompleteInputElement.BOX_ID};
BaseAutoCompleteElement.removeExistingInstance=function(a){a=BaseAutoCompleteElement.makeACBoxID(a);(a=Sfdc.get(a))&&Sfdc.Dom.removeChild(a)};BaseAutoCompleteElement.needDefer=function(){return Sfdc.userAgent.isIE&&!Sfdc.userAgent.isIE6&&!Sfdc.userAgent.isIE9?!0:!1};BaseAutoCompleteElement.htmlEncode=function(a){return!a?a:String(a).replace(/&/g,"\x26amp;").replace(/>/g,"\x26gt;").replace(/</g,"\x26lt;").replace(/"/g,"\x26quot;").replace(/'/g,"\x26#39;")};
BaseAutoCompleteElement.htmlEncodeForJS=function(a){return!a?a:String(a).replace(/>/g,"\x26gt;").replace(/</g,"\x26lt;").replace(/"/g,"\x26quot;").replace(/'/g,"\x26#39;").replace(/&/g,"\x26amp;")};
Sfdc.ns("Sfdc.ChatterFiles");
Sfdc.ChatterFiles={ENTITY_NOT_VIEWABLE_COMMAND_URL:"/file/entitynotviewable/",parentId:"",pickerHover:null,documentId:"",parentContainer:"",documentStyle:"",rootFolderId:"",hideFileSyncBanner:function(){Sfdc.Dom.hideByDisplay(Sfdc.get("fileSyncOnBoardBanner"));UserContext.userPreferences.setBoolean("HideFileSyncBannerMsg",!0)},redirectToOwnerProfileUrl:function(a){a=this.ENTITY_NOT_VIEWABLE_COMMAND_URL+a+"?p\x3dtrue";chatter.getToolbox().get({url:a,success:function(a,c){navigateToUrl(c.ownerUrl)}})},
toggleSyncUnsyncFileLinks:function(a,b){var c=chatter.getToolbox(),e=Sfdc.Dom.getParent(a),d={};d.style=b.style?b.style:"Detail";var f=Ext.get(a);c.mask(f);c.post({url:"/file/filesyncsubscription/"+b.docId+";"+b.action,params:d,success:function(a,b){if(e)if("ListView"===d.style){var c=Chatter.Files.ContentListViewport.INSTANCE;c.isFileSyncFilter()?c.refresh():e.innerHTML=b.html}else e.innerHTML=b.html},failure:function(a,b){c.unmask(f)}})},initSyncUnsync:function(a,b){var c=b.action;this.parentContainer=
a;this.documentId=b.docId;this.documentStyle=b.style;"create"==c?this.showFolderPicker(a,b):"delete"==c&&this.toggleSyncUnsyncFile(a,b)},deleteFileQuietly:function(a,b,c){chatter.getToolbox().post({url:"/chatterfile/"+a+";delete",id:a,success:function(){b&&b.call(this)},failure:function(a,b){c&&c.call(this,a,b)}});return!0},getUpdatedParams:function(a){a.docId=this.documentId;a.style=this.documentStyle;return a},showFolderPicker:function(a,b){var c={},e=Sfdc.get(".contentFolderListView .zen-data"),
d=Sfdc.get("folderParentNavDiv");d&&Sfdc.Dom.hideByDisplay(d);e&&(Sfdc.userAgent.isIE?e.innerText="":Sfdc.Dom.updateHTML(e,""));this.pickerHover?(a.id=Sfdc.getUID(a),this.pickerHover.hoverItem=new SfdcApp.Chatter.BaseHoverItem({el:a,dir:SfdcApp.Chatter.Hover.direction.RIGHT,id:a.id}),this.pickerHover.loaded=!1,this.pickerHover.showNow()):(this.pickerHover=SfdcApp.Chatter.FolderPickerHover.createHover(a,b,c))&&this.pickerHover.show()},hideFolderPicker:function(){if(this.pickerHover){var a=Sfdc.get("closeFolderPicker");
this.pickerHover.lastMouseMoveElement=a;this.pickerHover.hideNow()}},toggleSyncUnsyncFile:function(a,b){var c=chatter.getToolbox(),e=Sfdc.Dom.getParent(Sfdc.ChatterFiles.parentContainer),d={},f=this.documentId,g=b.action;"create"==g&&(d.folderId=Sfdc.ChatterFiles.ContentFolderListViewPort.INSTANCE.getParentFolderId());d.style=this.documentStyle;d.isInFolderPickerParam=!0;var h=Ext.get(a);Sfdc.userAgent.isIE8?a.disabled=!0:c.mask(h);c.post({url:"/file/filesyncsubscription/"+f+";"+g,params:d,success:function(a,
b){"create"==g&&Sfdc.ChatterFiles.pickerHover.hideNow();if(e)if("ListView"===d.style){var c=Chatter.Files.ContentListViewport.INSTANCE;c.isFileSyncFilter()?c.refresh():e.innerHTML=b.html}else e.innerHTML=b.html},failure:function(b,d){var e="",e=b&&0==b.status?LC.getLabel("ContentFolderExceptions","NetworkErrorDuringSync"):d&&d.errors?d.errors.message:LC.getLabel("ContentFolderExceptions","GenericSyncError"),f=Sfdc.get("folderPickerError");Sfdc.Dom.setText(f,e);Sfdc.Dom.show(f,!0);Sfdc.userAgent.isIE8?
a.disabled=!1:c.unmask(h)}})}};
Sfdc.ChatterFileFeedActions={items:[],selected:-1,link:null,linkId:null,popupLink:null,popup:null,onHover:function(){function b(a){var c,b;a=Ext.get(a);a.setWidth(a.getWidth()).setHeight(a.getHeight());c=a.down(".previewHover");b=a.down("img");c||(c=a.createChild({tag:"div",cls:"previewHover",title:b.getAttribute("title")}),c.setStyle({width:b.getWidth()-b.getBorderWidth("lr")+"px",height:b.getHeight()-b.getBorderWidth("tb")+"px"}),c.setY(b.getY()),c.setVisibilityMode(Ext.Element.DISPLAY));c.show()}
return function(a){a=Ext.get(a);a.set({onmouseover:null,onfocus:null});b(a);a.hover(function(a,d){(d=a.getTarget()?a.getTarget(".contentThumbnail-a"):null)&&b(d)},function(a,b){(b=a.getTarget()?a.getTarget(".contentThumbnail-a"):null)&&Ext.fly(b).child(".previewHover").hide()})}}(),stopIfNav:function(b,a){var c=b.getKey();(37<=c&&40>=c||c===KEY_TAB)&&b.stopEvent()},onNav:function(b,a){function c(){var a;0<e.selected?(e.selected-=1,a=e.items.elements[e.selected],Ext.fly(a).isVisible()?Ext.fly(a).first().hasClass("chatterFollowUnfollow")?
(Ext.fly(a).first().first().isVisible()?Ext.fly(a).first().first().first().focus():Ext.fly(a).first().last().last().focus(),Sfdc.Event.fireEvent(Ext.fly(a).first().dom,"mouseover")):Ext.fly(a).first().focus():c()):0===e.selected&&(e.selected-=1,e.popupLink.focus())}function d(){var a;e.selected<e.items.getCount()-1&&(e.selected+=1,a=e.items.elements[e.selected],Ext.fly(a).isVisible()?Ext.fly(a).first().hasClass("chatterFollowUnfollow")?(Ext.fly(a).first().first().isVisible()?Ext.fly(a).first().first().first().focus():
Ext.fly(a).first().last().last().focus(),Sfdc.Event.fireEvent(Ext.fly(a).first().dom,"mouseover")):Ext.fly(a).first().focus():d())}var f=b.getKey(),e=Sfdc.ChatterFileFeedActions;switch(f){case KEY_ARROW_D:d();break;case KEY_ARROW_U:c();break;case KEY_ESC:e.closePopup();Ext.fly(e.linkId).focus();break;case KEY_TAB:b.shiftKey?c():d()}e.stopIfNav(b,a)},hoverHandler:function(b){var a=this;return function(c,d){var f;if(d=c.getTarget(".contentActionMenuItem"))d=Ext.get(d),b?(a.items.removeClass("hover"),
Ext.isIE7&&(f=d.parent(".contentActionMenu"),f.setWidth(f.getWidth())),d.addClass("hover")):d.removeClass("hover")}},bindEvents:function(b){var a=this,c=b?"on":"un";a.items[c]("mouseover",a.hoverHandler(!0));a.items[c]("mouseout",a.hoverHandler(!1));a.items.each(function(b,f){if(f=b.first())f[c]("focus",a.hoverHandler(!0)),f[c]("blur",a.hoverHandler(!1))});Ext.isGecko?(a.popup[c]("keypress",a.onNav),a.popup[c]("keydown",a.stopIfNav)):(a.popup[c]("keydown",a.onNav),Ext.EventManager[c](window,"keydown",
a.stopIfNav));a.popup[c]("keyup",a.stopIfNav);Ext.getBody()[c]("click",a.closePopup)},openPopup:function(b){var a=this,c=Ext.get("contentActionMenu"+b);if(c.child(".more-file-actions")||Ext.isIE7&&"1"===c.getAttribute("loaded"))a.openPopupCallback(b);else{var d=c.getAttribute("docId"),f={rendition:c.getAttribute("rendition"),subscribed:c.getAttribute("subscribed"),sharing:c.getAttribute("sharing")};chatter.getToolbox().get({url:"/chatterfileactionmenu/"+d,params:f,success:function(d,f){c.update(f.html,
!0);a.openPopupCallback(b)}})}},openPopupCallback:function(b){var a;this.popup=Ext.get("contentActionMenu"+b);this.link=Ext.get(b);this.items=this.popup.select(".contentActionMenuItem",!0);this.linkId=b;this.selected=-1;Ext.isIE7&&!this.popup.hasClass("feedcontainer")&&(this.popup.insertAfter(Ext.getBody().last()),this.popup.addClass("feedcontainer"));this.bindEvents(!0);this.popup.setVisible(!0);this.popupLink=this.popup.child(".more-file-actions");b=this.popup.getX()-this.popupLink.getX()+(Ext.isIE7?
2:0);a=this.popup.getY()-this.popupLink.getY()-(Ext.isIE7?1:0);this.popup.parent(".chatterFileListBlock")?a-=Ext.isIE8&&0<!Ext.query("body.ChatterPage").length?14:3:Ext.isIE7&&0<Ext.getBody().query("div.chatterFileListBlock").length&&(a=16,b=1,this.popup.dom.setAttribute("loaded","1"));this.popup.position("absolute",null,this.link.getX()+b,this.link.getY()+a);Ext.isIE7&&0<Ext.getBody().query("div.chatterFileListBlock").length&&(b=this.link.getY(),a=this.link.getX(),Ext.query("body.FileTabPage")&&
0===Ext.query("body.FileTabPage").length&&(b+=5,a+=4),this.popup.first().position("absolute",null,a,b));this.checkUploadPerms();this.popupLink.focus()},closePopup:function(b){for(var a=Sfdc.select("div.contentActionMenu"),c=null,d=0;d<a.length;d++)c=a[d],Sfdc.Dom.isVisible(c)&&Sfdc.Dom.hideByDisplay(c);Sfdc.ChatterFileFeedActions.bindEvents(!1);"string"===typeof b&&document.getElementById(this.linkId).focus()},checkUploadPerms:function(){var b,a,c,d;c=Ext.query("div.contentActionMenu .unchecked");
if(0!==c.length){a="";for(b=0;b<c.length;b++)d=c[b],d=Ext.get(d),a=a+d.child("span").dom.innerHTML+",",d.removeClass("unchecked"),d.addClass("inverification");b=chatter.getToolbox();b.get({url:"/file/permissionCheck",params:{docIds:a},success:function(a,b){var c,d,h,g,k=Ext.query("div.contentActionMenu .inverification"),l=Ext.toArray(b.Permissions);for(d=0;d<k.length;d++)g=Ext.get(k[d]),c=g.child("span").dom.innerHTML,-1!==l.indexOf(c)?(h=g.child("a"),h.set({href:Sfdc.ChatterFileFeedActions.uploadUrl(c)})):
g.addClass("disabled"),g.removeClass("inverification")}})}},resetDocUpload:function(b){var a,c,d=Ext.query("div.contentActionMenu div.upload span.docid");if(0<d.length)for(a=0;a<d.length;a++)docidSpan=d[a],c=docidSpan.innerHTML,-1!==c.indexOf(b)&&Ext.fly(docidSpan).up(".upload",5).addClass("unchecked");this.checkUploadPerms()},uploadUrl:function(b){return UserContext.getUrl("/"+b+"?fa\x3dnv")},adjustLinkElemWidthForThumbnail:function(b){b=Ext.get(b);var a=b.parent();a&&(a.hasClass("contentThumbnail-a")&&
a.parent(".cxfeedcomment"))&&a.setStyle({width:b.getWidth()+"px",height:b.getHeight()+"px"})}};
Sfdc.ns("Sfdc.ContentMenuActionOverlayDialog");Sfdc.ContentMenuActionOverlayDialog=function(){};Ext.extend(Sfdc.ContentMenuActionOverlayDialog,NonaccessibleDialog);Sfdc.ContentMenuActionOverlayDialog.DIALOG_ID="ContentMenuActionOverlayDialog";
Sfdc.ContentMenuActionOverlayDialog.open=function(a){var b=sfdcPage.getDialogById(Sfdc.ContentMenuActionOverlayDialog.DIALOG_ID);b?(b.url=a.url,b.title=a.title):b=new NonaccessibleDialog(Sfdc.ContentMenuActionOverlayDialog.DIALOG_ID,a.title,a.url,a.width,a.height);b.display()};Sfdc.ContentMenuActionOverlayDialog.prototype.hide=function(){NonaccessibleDialog.superclass.hide.call(this)};
Sfdc.ns("Sfdc.DropdownPanel");Sfdc.DropdownPanel=function(a,b){this.id=a;this.clazz=b||"dropdownPanel";this.domObj=null;Sfdc.DropdownPanel.registerPanel(this)};Sfdc.DropdownPanel.list={};Sfdc.DropdownPanel.getPanel=function(a){return Sfdc.DropdownPanel.list[a]};Sfdc.DropdownPanel.registerPanel=function(a){Sfdc.DropdownPanel.list[a.id]=a};Sfdc.DropdownPanel.prototype.resizeEventHandler=function(a){return function(){a.close()}};Sfdc.DropdownPanel.prototype.scrollEventHandler=function(a){return function(){a.close()}};
Sfdc.DropdownPanel.prototype.clickEventHandler=function(a,b){return function(){!a.hasFocus&&Sfdc.Dom.isVisible(b)&&a.close();a.hasFocus=!1}};Sfdc.DropdownPanel.prototype.keydownEventHandler=function(a){return function(b){getEvent(b).keyCode==KEY_ESC&&a.close()}};
Sfdc.DropdownPanel.prototype.init=function(){if(!this.domObj){var a=document.createElement("div");a.id=this.id;a.className=this.clazz;document.body.appendChild(a);var b=this;addEvent(a,"mouseover",function(){b.hasFocus=!0});addEvent(a,"mouseout",function(){b.hasFocus=!1});addEvent(window,"resize",b.resizeEventHandler(b));addEvent(window,"scroll",b.scrollEventHandler(b));addEvent(document.body,"click",b.clickEventHandler(b,a));addEvent(document.body,"keydown",b.keydownEventHandler(b),!1);this.initCustomEvents();
this.domObj=a}return this.domObj};Sfdc.DropdownPanel.prototype.initCustomEvents=function(){};Sfdc.DropdownPanel.prototype.getXY=function(a){var b=0,c=0;a&&a.x&&(b=a.x);a&&a.y&&(c=a.y);return{x:b,y:c}};Sfdc.DropdownPanel.prototype.getSize=function(){return null};Sfdc.DropdownPanel.prototype.getContent=function(a){return""};Sfdc.DropdownPanel.prototype.hasFocusInitially=function(){return!0};
Sfdc.DropdownPanel.prototype.show=function(a,b){var c=this.init();if(c){this.hasFocus=this.hasFocusInitially();this.anchorElem=a;Sfdc.Dom.show(c);var d=this.getXY(b);LC.isRtlPage()&&d.interpretXasRightOffset?c.style.right=d.x+"px":c.style.left=d.x+"px";c.style.top=d.y+"px";if(d=this.getSize())d.width&&(c.style.width=d.width+"px"),d.height&&(c.style.height=d.height+"px");if(d=this.getContent(b))c.innerHTML=d}};
Sfdc.DropdownPanel.prototype.close=function(){this.domObj&&(Sfdc.Dom.hideByDisplay(this.domObj),this.hasFocus=!1)};
Sfdc.ns("Sfdc.MultiUploadConfirmDialog");Sfdc.MultiUploadConfirmDialog=function(a){OverlayDialogElement.call(this,a.id);this.width=500;this.isModal=!1;this.setTitle(a.dialogTitle);this.warningMsg=a.warningMsg;this.yesButtonValue=a.yesButtonValue;this.noButtonValue=a.noButtonValue;this.extraClass="multiUploadConfirmDialog";this.initContent()};Ext.extend(Sfdc.MultiUploadConfirmDialog,OverlayDialogElement);Sfdc.MultiUploadConfirmDialog.DIALOG_ID="multiUploadConfirmationDialog";
Sfdc.MultiUploadConfirmDialog.multiUploadConfirmationDialog=null;Sfdc.MultiUploadConfirmDialog.open=function(a){a=sfdcPage.getDialogById(a.id);a||(a={id:Sfdc.MultiUploadConfirmDialog.DIALOG_ID},a=new Sfdc.MultiUploadCancelSingleFileConfirmDialog(a),a.created=!0,a.register());a.show()};Sfdc.MultiUploadConfirmDialog.prototype.show=function(){OverlayDialogElement.prototype.show.call(this);Sfdc.get("chatterFilesMultiUploadDialog").style.zIndex=50100};
Sfdc.MultiUploadConfirmDialog.prototype.initContent=function(){var a=[];a.push('\x3cdiv class\x3d"message chatterDeprecationMessage multiUploadWarningMessage"\x3e\x3ctable\x3e\x3ctr\x3e');a.push('\x3ctd\x3e\x3cimg src\x3d"/s.gif" alt\x3d"'+LC.getLabel("Icon","WARNING")+'" class\x3d"msgIcon" title\x3d"'+LC.getLabel("Icon","WARNING")+'"\x3e\x3c/td\x3e');a.push('\x3ctd class\x3d"messageCell"\x3e\x3cdiv class\x3d"messageText"\x3e'+this.warningMsg+"\x3c/div\x3e\x3c/td\x3e");a.push("\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e");
this.contents=a.join("");a=[];a.push('\x3cinput type\x3d"button" class\x3d"btn" onclick\x3d"sfdcPage.getDialogById(\''+this.id+'\').yesButtonClicked();" value\x3d"'+this.yesButtonValue+'"/\x3e');this.noButtonValue&&a.push('\x3cinput type\x3d"button" class\x3d"btn" onclick\x3d"sfdcPage.getDialogById(\''+this.id+'\').noButtonClicked();" value\x3d"'+this.noButtonValue+'"/\x3e');this.buttonContents=a.join("")};Sfdc.MultiUploadConfirmDialog.prototype.yesButtonClicked=function(){this.cancel()};
Sfdc.MultiUploadConfirmDialog.prototype.noButtonClicked=function(){this.cancel()};Sfdc.MultiUploadConfirmDialog.prototype.cancel=function(){Sfdc.get("chatterFilesMultiUploadDialog").style.zIndex=50101;OverlayDialogElement.prototype.cancel.call(this)};Sfdc.ns("Sfdc.MultiUploadCancelRemainingConfirmDialog");Sfdc.MultiUploadCancelRemainingConfirmDialog=function(a){Sfdc.MultiUploadConfirmDialog.call(this,a)};Ext.extend(Sfdc.MultiUploadCancelRemainingConfirmDialog,Sfdc.MultiUploadConfirmDialog);
Sfdc.MultiUploadCancelRemainingConfirmDialog.DIALOG_ID="MultiUploadCancelRemainingConfirmDialog";
Sfdc.MultiUploadCancelRemainingConfirmDialog.open=function(){var a=sfdcPage.getDialogById(Sfdc.MultiUploadCancelRemainingConfirmDialog.DIALOG_ID);a||(a={id:Sfdc.MultiUploadCancelRemainingConfirmDialog.DIALOG_ID,dialogTitle:LC.getLabel("ChatterFileMultiUpload","cancelRemainingUploadsTitle"),warningMsg:LC.getLabel("ChatterFileMultiUpload","cancelRemainingUploadsMsg"),yesButtonValue:LC.getLabel("ChatterFileMultiUpload","yesButtonCancelRemainingPanel"),noButtonValue:LC.getLabel("ChatterFileMultiUpload",
"noButtonCancelRemainingPanel")},a=new Sfdc.MultiUploadCancelRemainingConfirmDialog(a),a.created=!0,a.register());a.show()};Sfdc.MultiUploadCancelRemainingConfirmDialog.prototype.yesButtonClicked=function(){Sfdc.MultiUploadConfirmDialog.prototype.yesButtonClicked.call(this);Sfdc.AccessibleMultiUploadFilesDialog.uploader.cancelRemainingUploads()};Sfdc.ns("Sfdc.MultiUploadStoppedConfirmDialog");Sfdc.MultiUploadStoppedConfirmDialog=function(a){Sfdc.MultiUploadConfirmDialog.call(this,a)};
Ext.extend(Sfdc.MultiUploadStoppedConfirmDialog,Sfdc.MultiUploadConfirmDialog);Sfdc.MultiUploadStoppedConfirmDialog.DIALOG_ID="MultiUploadStoppedConfirmDialog";
Sfdc.MultiUploadStoppedConfirmDialog.open=function(){var a=sfdcPage.getDialogById(Sfdc.MultiUploadStoppedConfirmDialog.DIALOG_ID);a||(a={id:Sfdc.MultiUploadStoppedConfirmDialog.DIALOG_ID,dialogTitle:LC.getLabel("ChatterFileMultiUpload","uploadStoppedTitle"),warningMsg:LC.getLabel("ChatterFileMultiUpload","uploadStoppedMsg"),yesButtonValue:LC.getLabel("ChatterFileMultiUpload","yesButtonStopPanel"),noButtonValue:LC.getLabel("ChatterFileMultiUpload","noButtonStopPanel")},a=new Sfdc.MultiUploadStoppedConfirmDialog(a),
a.created=!0,a.register());a.show()};Sfdc.ns("Sfdc.MultiUploadResumeConfirmDialog");Sfdc.MultiUploadResumeConfirmDialog=function(a){Sfdc.MultiUploadConfirmDialog.call(this,a)};Ext.extend(Sfdc.MultiUploadResumeConfirmDialog,Sfdc.MultiUploadConfirmDialog);Sfdc.MultiUploadResumeConfirmDialog.DIALOG_ID="MultiUploadResumeConfirmDialog";
Sfdc.MultiUploadResumeConfirmDialog.open=function(){var a=sfdcPage.getDialogById(Sfdc.MultiUploadResumeConfirmDialog.DIALOG_ID);a||(a={id:Sfdc.MultiUploadResumeConfirmDialog.DIALOG_ID,dialogTitle:LC.getLabel("ChatterFileMultiUpload","resumeUploadTitle"),warningMsg:LC.getLabel("ChatterFileMultiUpload","resumeUploadMsg"),yesButtonValue:LC.getLabel("ChatterFileMultiUpload","yesButtonResumePanel"),noButtonValue:LC.getLabel("ChatterFileMultiUpload","noButtonResumePanel")},a=new Sfdc.MultiUploadResumeConfirmDialog(a),
a.created=!0,a.register());a.show()};Sfdc.ns("Sfdc.MultiUploadErrorHandlingDialog");Sfdc.MultiUploadErrorHandlingDialog=function(a){Sfdc.MultiUploadConfirmDialog.call(this,a)};Ext.extend(Sfdc.MultiUploadErrorHandlingDialog,Sfdc.MultiUploadConfirmDialog);Sfdc.MultiUploadErrorHandlingDialog.DIALOG_ID="MultiUploadErrorHandlingDialog";
Sfdc.MultiUploadErrorHandlingDialog.open=function(a){var b=sfdcPage.getDialogById(Sfdc.MultiUploadErrorHandlingDialog.DIALOG_ID);b?(b.warningMsg=a,b.initContent(),b.createContent()):(a={id:Sfdc.MultiUploadErrorHandlingDialog.DIALOG_ID,dialogTitle:LC.getLabel("Global","error"),warningMsg:a,yesButtonValue:LC.getLabel("Global","close")},b=new Sfdc.MultiUploadErrorHandlingDialog(a),b.created=!0,b.register());b.show();return b};Sfdc.MultiUploadErrorHandlingDialog.prototype.yesButtonClicked=function(){Sfdc.MultiUploadConfirmDialog.prototype.yesButtonClicked.call(this)};
UserAndGroupAutoCompleteInputElement=function(a){if(a&&!AutoCompleteInputElement.getInstance(a.id)&&(this.id=a.elementId,a.inDialog&&UserAndGroupAutoCompleteInputElement.removeExistingInstance(this.id),this.element=document.getElementById(this.id),this.id&&this.element)){this.entityType=a.entityType?a.entityType:UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_USER;if(this.valElementId=a.valElementId)this.valElement=document.getElementById(this.valElementId);this.matchBlanks=!0;AutoCompleteInputElement.instanceRefs[this.id]=
this;this.servletURI=a.servletURI?a.servletURI:"/chatter/handlers/file/shareAutoComplete";this.minSuggestLen=a.minSuggestLen&&0<=minSuggestLen?a.minSuggestLen:this.entityType===UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_GROUP?0:1;this.cache={};this.triedQueries={};this.selected=-1;this.requestParams={};this.lastInput=null;this.enabled=!0;this.disableOnEsc=!1;this.displayHeader=this.shouldCaptureKeyStroke=!0;var b=this;addEvent(this.element,"keyup",function(a){b.handleInput(a)});addEvent(this.element,
"keydown",function(a){b.handleNav(a)});this.allowHideAC=!0;this.handleBlur=a.handleBlur?a.handleBlur:function(){b.clearSuggestions()};a.handleFocusExtra&&(this.handleFocusExtra=a.handleFocusExtra);addEvent(this.element,"blur",function(){b.focused=!1;b.allowHideAC&&b.handleBlur()});addEvent(this.element,"focus",function(){b.focused=!0;b.clearGhostText();b.displaySuggestions();b.handleFocusExtra&&b.handleFocusExtra()});a.inDialog&&(this.inDialog=a.inDialog);this.zIndex=a.zIndex?a.zIndex:200;a.ghostText&&
(this.ghostText=a.ghostText);a.disableGhostText||this.displayGhostText();this.handleSelect=a.handleSelect?a.handleSelect:UserAndGroupAutoCompleteInputElement.defaultClickInternal;a.getMinimumWidth&&(this.getMinimumWidth=a.getMinimumWidth);a.getACXPosition&&(this.getACXPosition=a.getACXPosition);a.getACYPosition&&(this.getACYPosition=a.getACYPosition);this.suggestions=[]}};UserAndGroupAutoCompleteInputElement.prototype=new AutoCompleteInputElement;
UserAndGroupAutoCompleteInputElement.BOX_CSS_CLASS=AutoCompleteInputElement.BOX_CSS_CLASS+" ugAC_box";UserAndGroupAutoCompleteInputElement.ROW_CSS_CLASS=AutoCompleteInputElement.ROW_CSS_CLASS+" ugAC_row";UserAndGroupAutoCompleteInputElement.ROW_CSS_CLASS_SELECTED=AutoCompleteInputElement.ROW_CSS_CLASS_SELECTED+" ugAC_rowSelected";UserAndGroupAutoCompleteInputElement.ROW_CSS_CLASS_MOUSE_OVER=UserAndGroupAutoCompleteInputElement.ROW_CSS_CLASS+" ugAC_row_hover";
UserAndGroupAutoCompleteInputElement.HINT_ROW_CSS_CLASS=UserAndGroupAutoCompleteInputElement.ROW_CSS_CLASS+" ugAC_hintRow";UserAndGroupAutoCompleteInputElement.INPUTBOX_GHOSTTEXT_CSS_CLASS="ghostText";UserAndGroupAutoCompleteInputElement.MATCH_DISPLAY_LIMIT=25;UserAndGroupAutoCompleteInputElement.MOVE_SELECTION_UP="UP";UserAndGroupAutoCompleteInputElement.MOVE_SELECTION_DOWN="DOWN";UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_USER="u";UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_GROUP="g";
UserAndGroupAutoCompleteInputElement.prototype.displayGhostText=function(){var a=Sfdc.get(this.id);a.blur();Sfdc.Dom.addClass(a,UserAndGroupAutoCompleteInputElement.INPUTBOX_GHOSTTEXT_CSS_CLASS);a.value="";a.value=this.ghostText?this.ghostText:this.entityType&&this.entityType===UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_GROUP?LC.getLabel("ChatterFileSharing","sharedWithGroupGhostText"):LC.getLabel("ChatterFileSharing","sharedWithUserGhostText")};
UserAndGroupAutoCompleteInputElement.prototype.clearGhostText=function(){var a=Sfdc.get(this.id);this.inGhostMode()&&(Sfdc.Dom.removeClass(a,UserAndGroupAutoCompleteInputElement.INPUTBOX_GHOSTTEXT_CSS_CLASS),a.value="")};UserAndGroupAutoCompleteInputElement.prototype.inGhostMode=function(){var a=Sfdc.get(this.id);return Sfdc.Dom.hasClass(a,UserAndGroupAutoCompleteInputElement.INPUTBOX_GHOSTTEXT_CSS_CLASS)};
UserAndGroupAutoCompleteInputElement.prototype.handleEnter=function(a){var b=this.getRow(this.selected);b&&b.onmousedown&&(b.onmousedown(),UserAndGroupAutoCompleteInputElement.needDefer()||AutoCompleteInputElement.captureKeystroke(a))};UserAndGroupAutoCompleteInputElement.prototype.getCacheKey=function(a){return a};
UserAndGroupAutoCompleteInputElement.prototype.retrieveFromServlet=function(a){if(!this.inGhostMode()){if(!this.isInputOk(a))return!1;this.requestParams.str=a;this.entityType&&this.entityType===UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_GROUP&&(this.requestParams.etype=UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_GROUP);var b=this;this.ajaxState="initialized";var c=this.servletURI;"/chatter/handlers"==c.substr(0,17)&&(c=c.substring(17));chatter.getToolbox().get({url:c,params:this.requestParams,
success:function(c,d){b.ajaxState="finished";b.saveToCache(a,d);b.displaySuggestions(!0)}});return!0}};
UserAndGroupAutoCompleteInputElement.prototype.positionACBox=function(a){if(this.element&&this.acBox&&(!a||this.isACBoxVisible())){a=this.getACXPosition(this.element)+1;var b=this.getACYPosition(this.element),c=this.getMinimumWidth();Sfdc.userAgent.isIE8&&(a-=1);this.acBox.setStyle("left",a+"px");this.acBox.setStyle("top",b+"px");this.acBox.setStyle("width",c+"px");this.acBox.setStyle("zIndex",this.zIndex);this.inDialog&&this.acBox.setStyle("position","absolute")}};
UserAndGroupAutoCompleteInputElement.prototype.getMinimumWidth=function(){return this.element.clientWidth+2};
UserAndGroupAutoCompleteInputElement.prototype.displaySuggestions=function(a){if(this.element&&this.focused){var b=trim(this.element.value);if(a||b!=this.lastInput||!this.isACBoxVisible())this.setAppliedFlag(!1),this.lastInput=b,a=null,this.isInputOk(b)?(this.hasValidSelection()&&(a=this.curSuggestions[this.selected]),this.curSuggestions=this.getSuggestions(b),this.updateACBox(this.curSuggestions,a)):this.handleEmptyInput()}};
UserAndGroupAutoCompleteInputElement.prototype.isInputOk=function(a){return this.entityType===UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_USER&&(!a||""===a||2>a.length&&!/^[\u4E00-\u9FAF]+$/.test(a))?!1:!0};
UserAndGroupAutoCompleteInputElement.prototype.getValidSuggestions=function(a,b){var c={},e=UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_USER===this.entityType?"AllUsers":"AllGroups";c[e]=[];for(var e=c[e],d=this.extraCurrentEntitySuggestions(b),f=0,g=d.length;f<g;f++){var h=d[f];this.isValidSuggestion(a,h)&&e.push(h)}c.length=e.length;return c};UserAndGroupAutoCompleteInputElement.prototype.isValidSuggestion=function(a,b){return!0};
UserAndGroupAutoCompleteInputElement.prototype.updateACBox=function(a,b){var c=Sfdc.get(this.id).value;this.isInputOk(c)&&(!a||0===a.length?(this.displayACBox(a,b),this.scrollDiv(),this.updateWidth()):this.constructor.prototype.updateACBox.call(this,a,b))};
UserAndGroupAutoCompleteInputElement.prototype.initACBox=function(){if(this.element){this.acBox=document.createElement("div");this.acBox.id=this.id+AutoCompleteInputElement.BOX_ID;this.acBox.className=AutoCompleteInputElement.BOX_CSS_CLASS+" ugAC_box";this.addACBoxToPage(this.acBox);this.acBox=new iframeShim(this.acBox);this.acBox.setStyle("width",this.getMinimumWidth()+"px");var a=document.getElementById(this.id+AutoCompleteInputElement.BOX_ID);if(a){var b=this;Sfdc.userAgent.isIE?(addEvent(a,"mouseenter",
function(a){b.allowHideAC=!1}),addEvent(a,"mouseleave",function(a){b.allowHideAC=!0})):(addEvent(a,"mouseover",function(a){b.allowHideAC=!1}),addEvent(a,"mouseout",function(a){b.allowHideAC=!0}))}}};UserAndGroupAutoCompleteInputElement.prototype.constructACBox=function(a,b){var c=["\x3col class\x3d'ugAC_list'\x3e"],e=this.extraCurrentEntitySuggestions(a);this.addSuggestions(c,e,b,0);this.addHintMessage(c,e);c.push("\x3c/ol\x3e");return c};
UserAndGroupAutoCompleteInputElement.prototype.addHintMessage=function(a,b){b&&b.length>UserAndGroupAutoCompleteInputElement.MATCH_DISPLAY_LIMIT&&a.push('\x3cli\x3e\x3cdiv class\x3d"'+UserAndGroupAutoCompleteInputElement.HINT_ROW_CSS_CLASS+'" onmousedown\x3d\'UserAndGroupAutoCompleteInputElement.hideACBox("'+this.id+"\")'\x3e"+LC.getLabel("ChatterFileSharing","tooManyMatchMessage")+"\x3c/div\x3e\x3c/li\x3e")};
UserAndGroupAutoCompleteInputElement.prototype.extraCurrentEntitySuggestions=function(a){return a[UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_USER===this.entityType?"AllUsers":"AllGroups"]};UserAndGroupAutoCompleteInputElement.prototype.setACBoxHeight=function(a){4<a?(this.acBox.setStyle("height","144px"),this.scrolling=!0):(this.acBox.setStyle("height","auto"),this.scrolling=!1)};
UserAndGroupAutoCompleteInputElement.prototype.select=function(a){if(this.selected!=a){if(0<=this.selected){var b=this.getRow(this.selected);b&&(b.className=UserAndGroupAutoCompleteInputElement.ROW_CSS_CLASS)}this.selected=a;if(b=this.getRow(a))b.className=UserAndGroupAutoCompleteInputElement.ROW_CSS_CLASS_SELECTED}};
UserAndGroupAutoCompleteInputElement.prototype.addSuggestions=function(a,b,c,e){if(b)if(0===b.length)b="\x3cb\x3e\x26quot;"+Sfdc.String.escapeToHtml(Sfdc.get(this.id).value)+"\x26quot;\x3c/b\x3e",a.push('\x3cli\x3e\x3cdiv class\x3d"ugAC_noMatch"\x3e'),this.entityType&&this.entityType===UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_GROUP?""===Sfdc.get(this.id).value?(c=UserContext.getUrl("/_ui/core/chatter/groups/GroupListPage"),b=UserContext.getUrl("/_ui/core/chatter/groups/GroupCreatePage"),c=
'\x3ca href\x3d"'+c+'"\x3e'+LC.getLabel("FeedFilter","GroupEmptyFeedJoinLink")+"\x3c/a\x3e",b='\x3ca href\x3d"'+b+'"\x3e'+LC.getLabel("FeedFilter","GroupEmptyFeedCreateLink")+"\x3c/a\x3e",a.push(LC.getLabel("ChatterFileSharing","doesNotBelongToAnyGroup",c,b))):a.push(LC.getLabel("ChatterFileSharing","noMatchGroupText",b)):a.push(LC.getLabel("ChatterFileSharing","noMatchText",b)),a.push("\x3c/div\x3e\x3c/li\x3e");else{e=b.length<UserAndGroupAutoCompleteInputElement.MATCH_DISPLAY_LIMIT?b.length:UserAndGroupAutoCompleteInputElement.MATCH_DISPLAY_LIMIT;
for(var d=0;d<e;d++){var f=b[d];if(f&&(f.ItemName||f.value)){var g=this.id;this.suggestions[d]={id:g,rowIndex:d,itemId:b[d].ItemId,itemName:Sfdc.String.escapeToHtml(b[d].ItemName),itemTitle:Sfdc.String.escapeToHtml(b[d].Title),imageLink:b[d].ImageLink,badgeHtml:b[d].BadgeHtml,outOfOfficeMessageHtml:b[d].OutOfOfficeMessageHtml||null,imageHtml:b[d].ImageHtml||null,itemPrivacy:b[d].ItemPrivacy||null,isExternalUserOrGroup:!b[d].InternalUserOrGroup};a.push("\x3cli\x3e");a.push("\x3cdiv ");a.push("onmouseover\x3d'UserAndGroupAutoCompleteInputElement.mouseOver("+
d+', "'+g+"\")' ");a.push("onmouseout\x3d'UserAndGroupAutoCompleteInputElement.mouseOut("+d+', "'+g+"\")' ");a.push("onmousedown\x3d'UserAndGroupAutoCompleteInputElement.click(event, "+d+', "'+g+"\")' ");c&&this.compareSuggestions(c,f)||!c&&0===d?(a.push("class\x3d'"+UserAndGroupAutoCompleteInputElement.ROW_CSS_CLASS_SELECTED+"' "),this.selected=d,this.select(d)):a.push("class\x3d'"+UserAndGroupAutoCompleteInputElement.ROW_CSS_CLASS+"' ");a.push("title\x3d'"+Sfdc.String.escapeToHtml(b[d].ItemName)+
"' ");a.push("id\x3d'"+AutoCompleteInputElement.getRowIdStatic(g,d)+"'\x3e");a.push(this.getSuggestionHtml(f));a.push("\x3c/div\x3e");a.push("\x3c/li\x3e")}}}};
UserAndGroupAutoCompleteInputElement.prototype.getSuggestionHtml=function(a){var b=escapeHTML(this.lastInput),c=Sfdc.String.escapeToHtml(a.ItemName),e=Sfdc.String.escapeToHtml(a.Title),d=this.getRegexForInput(b),b=""===b?c:c.replace(d,'$1\x3cstrong class\x3d"autocompleteMatch"\x3e$2\x3c/strong\x3e');return["\x3cdiv class\x3d'ugAC_entityImgDiv'\x3e",a.ImageHtml,"\x3c/div\x3e\x3cspan class\x3d'name'\x3e",b,a.BadgeHtml,a.OutOfOfficeMessageHtml,"\x3c/span\x3e \x3cdiv class\x3d'ugAC_userRole'\x3e",e,"\x3c/div\x3e"].join("")};
UserAndGroupAutoCompleteInputElement.prototype.compareSuggestions=function(a,b){return a&&b&&a.ItemId&&b.ItemId&&b.ItemId==a.ItemId};
UserAndGroupAutoCompleteInputElement.prototype.scrollDiv=function(){if(this.hasValidSelection()&&this.scrolling)if(this.selectionMoveDirection===UserAndGroupAutoCompleteInputElement.MOVE_SELECTION_UP){var a=this.acBox.div.scrollHeight*((this.selected+1)/this.curSuggestions.length)-34;this.acBox.div.scrollTop>a&&(this.acBox.div.scrollTop=a)}else this.acBox.div.scrollTop=this.acBox.div.scrollHeight*((this.selected+1)/this.curSuggestions.length)-this.acBox.div.clientHeight};
UserAndGroupAutoCompleteInputElement.prototype.handleNav=function(a){AutoCompleteInputElement.isNav(a)&&a.keyCode==KEY_TAB?(this.handleEnter(a),this.resizeTextArea()):(AutoCompleteInputElement.isNav(a)&&a.keyCode==KEY_ARROW_U?(this.selectionMoveDirection=UserAndGroupAutoCompleteInputElement.MOVE_SELECTION_UP,(Sfdc.userAgent.isSafari||Sfdc.userAgent.isChrome)&&AutoCompleteInputElement.captureKeystroke(a)):AutoCompleteInputElement.isNav(a)&&a.keyCode==KEY_ARROW_D&&(this.selectionMoveDirection=UserAndGroupAutoCompleteInputElement.MOVE_SELECTION_DOWN),
this.constructor.prototype.handleNav.call(this,a))};UserAndGroupAutoCompleteInputElement.prototype.saveToCache=function(a,b){!a||""===a?this.emptyInputCache=b:this.cache[this.getCacheKey(a)]=b};UserAndGroupAutoCompleteInputElement.prototype.clearCache=function(){this.cache={};this.triedQueries={};this.emptyInputCache={}};
UserAndGroupAutoCompleteInputElement.prototype.checkCacheOrRetrieve=function(a){var b=this.getCacheKey(a);(!a||""===a?this.emptyInputCache:this.cache[b])||this.retrieveFromServlet(a);return!a||""===a?this.emptyInputCache:this.cache[b]};UserAndGroupAutoCompleteInputElement.mouseOver=function(a,b){var c=AutoCompleteInputElement.getInstance(b);c&&a!=c.selected&&(document.getElementById(AutoCompleteInputElement.getRowIdStatic(b,a)).className=UserAndGroupAutoCompleteInputElement.ROW_CSS_CLASS_MOUSE_OVER)};
UserAndGroupAutoCompleteInputElement.mouseOut=function(a,b){var c=AutoCompleteInputElement.getInstance(b);c&&a!=c.selected&&(document.getElementById(AutoCompleteInputElement.getRowIdStatic(b,a)).className=UserAndGroupAutoCompleteInputElement.ROW_CSS_CLASS)};UserAndGroupAutoCompleteInputElement.click=function(a,b,c){if(c=AutoCompleteInputElement.getInstance(c))AutoCompleteInputElement.captureKeystroke(a),c.handleSelect(c.suggestions[b])};
UserAndGroupAutoCompleteInputElement.hideACBox=function(a){(a=AutoCompleteInputElement.getInstance(a))&&a.handleBlur()};UserAndGroupAutoCompleteInputElement.defaultClickInternal=function(a){this.element.value=Sfdc.String.unescapeHtml(a.itemName);this.valElement&&(this.valElement.value=a.itemId);this.select(a.rowIndex);this.complete()};UserAndGroupAutoCompleteInputElement.makeACBoxID=function(a){return a+AutoCompleteInputElement.BOX_ID};
UserAndGroupAutoCompleteInputElement.removeExistingInstance=function(a){a=UserAndGroupAutoCompleteInputElement.makeACBoxID(a);(a=Sfdc.get(a))&&Sfdc.Dom.removeChild(a)};UserAndGroupAutoCompleteInputElement.needDefer=function(){return Sfdc.userAgent.isIE7||Sfdc.userAgent.isIE8?!0:!1};
Sfdc.ns("Sfdc.MultiFileUploaderFile");Sfdc.MultiFileUploaderFile=function(a){this.name="undefined"!=typeof a.fileName?a.fileName:a.name;this.size="undefined"!=typeof a.fileSize?a.fileSize:a.size;this.type=a.type;a=this.name;var b=a.lastIndexOf(".");-1!=b&&(a=a.substr(0,b));this.shortName=a;this.docId=null};
Sfdc.ns("Sfdc.MultiFileUploaderUi");
Sfdc.MultiFileUploaderUi={showSingleFileModeUploadList:function(){var a=Sfdc.get("multifile-upload-list").childNodes.item(0);Sfdc.Dom.removeClass(a,"multi-item");Sfdc.Dom.addClass(a,"single-item")},showOverallProgressBar:function(){var a=Sfdc.get("overallProgress");Sfdc.Dom.setStyle(a,"display","inline-block");a=Sfdc.get("uploadingStatusInfo");Sfdc.Dom.hasClass(a,"canceledAllStatusInfo")&&(Sfdc.Dom.removeClass(a,"canceledAllStatusInfo"),Sfdc.Dom.addClass(a,"uploadingStatusInfo"))},hideOverallProgressBar:function(){var a=
Sfdc.get("overallProgress");Sfdc.Dom.hideByDisplay(a)},showListTableHeader:function(){var a=Sfdc.get("multiUploadListTableHeader");Sfdc.Dom.hasClass(a,"canceledAllBackGround")&&(Sfdc.Dom.removeClass(a,"canceledAllBackGround"),Sfdc.Dom.addClass(a,"ongoingBackGround"));Sfdc.Dom.show(a)},hideListTableHeader:function(){Sfdc.Dom.hideByDisplay("multiUploadListTableHeader")},showCancelRemainingUploadsButton:function(){Sfdc.Dom.show(Sfdc.get("multiUploadCancelRemainingBtn"))},hideCancelRemainingUploadsButton:function(){Sfdc.Dom.hideByDisplay(Sfdc.get("multiUploadCancelRemainingBtn"))},
showCloseButton:function(){Sfdc.Dom.show(Sfdc.get("multiUploadCloseBtn"))},hideCloseButton:function(){Sfdc.Dom.hideByDisplay(Sfdc.get("multiUploadCloseBtn"))},showSharingSettingsBtn:function(a,b){Sfdc.Dom.setStyle(Sfdc.get("multiUploadSharingSettingsBtn"),"display","inline-block");Sfdc.Dom.hideByDisplay(Sfdc.get("multiUploadCancelRemainingBtn"));Sfdc.Dom.show(Sfdc.get("multiUploadCloseBtn"));addEvent(Sfdc.get("multiUploadSharingSettingsBtn"),"click",function(){navigateToUrl(a+"/"+b+"?so\x3dlst")})},
hideSharingSettingBtn:function(){Sfdc.Dom.hideByDisplay(Sfdc.get("multiUploadSharingSettingsBtn"))},updateUploadingStatusInfoWithSuccessMessage:function(a){1<a?Sfdc.get("uploadingStatusInfo").innerHTML=LC.getLabel("ChatterFileMultiUpload","uploadSucessfulStatusHeaderMsg",a.toString()):Sfdc.get("uploadingStatusInfo").innerHTML=LC.getLabel("ChatterFileMultiUpload","singleUploadSucessfulStatusHeaderMsg")},updateUploadingStatusInfoWithInProgressMessage:function(a,b){var c=Sfdc.get("overallProgress");
1<b?(Sfdc.get("uploadingStatusInfo").innerHTML=LC.getLabel("ChatterFileMultiUpload","uploadingInProgressHeaderMsg",(a+1).toString(),b.toString()),Sfdc.Dom.setStyle(c,"display","inline-block")):(Sfdc.get("uploadingStatusInfo").innerHTML=LC.getLabel("ChatterFileMultiUpload","singleUploadingInProgressHeaderMsg"),Sfdc.Dom.hideByDisplay(c))},updateUploadingStatusInfoWithAllCanceledMessage:function(a){1<a?Sfdc.get("uploadingStatusInfo").innerHTML=LC.getLabel("ChatterFileMultiUpload","uploadCanceledAllStatusHeaderMsg",
a):Sfdc.get("uploadingStatusInfo").innerHTML=LC.getLabel("ChatterFileMultiUpload","singleUploadCanceledAllStatusHeaderMsg");a=Sfdc.get("multiUploadListTableHeader");Sfdc.Dom.removeClass(a,"ongoingBackGround");Sfdc.Dom.addClass(a,"canceledAllBackGround");a=Sfdc.get("uploadingStatusInfo");Sfdc.Dom.removeClass(a,"uploadingStatusInfo");Sfdc.Dom.addClass(a,"canceledAllStatusInfo")}};
Sfdc.ns("Sfdc.MultiFileUploaderUtil");Sfdc.MultiFileUploaderUtil.extend=function(a,b){for(var c in b)c&&(a[c]=b[c])};Sfdc.MultiFileUploaderUtil.isFileAPISupported=function(){return"undefined"!=typeof File&&"undefined"!=typeof FormData&&"undefined"!=typeof(new XMLHttpRequest).upload};Sfdc.MultiFileUploaderUtil.isMultiFileUploadSupported=function(){var a=document.createElement("input");a.type="file";return"multiple"in a&&Sfdc.MultiFileUploaderUtil.isFileAPISupported()};
Sfdc.MultiFileUploaderUtil.isIE9AndBelow=function(){return Sfdc.userAgent.isIE&&!Sfdc.userAgent.isIE10&&!Sfdc.userAgent.isIE11};Sfdc.MultiFileUploaderUtil.getBrowserName=function(){var a="unknown";Sfdc.userAgent.isIE?a="IE"+Sfdc.userAgent.ieVersion:Sfdc.userAgent.isChrome?a="Chrome":Sfdc.userAgent.isSafari?a="Safari":Sfdc.userAgent.isFirefox?a="Firefox":Sfdc.userAgent.isOpera?a="Opera":Sfdc.userAgent.isNetscape&&(a="Netscape");return a};
Sfdc.MultiFileUploaderUtil.parseResponseResult=function(a){a=a.replace(/\r/g,"\n");0===a.indexOf("\x3cpre")&&(a=a.replace(/^<pre[^>]*>/,"").replace(/<\/pre>$/,""));var b=a.indexOf(AjaxServlet.CSRF_PROTECT);if(-1===b)return null;0<b&&(a=AjaxServlet.CSRF_PROTECT+a.replace(AjaxServlet.CSRF_PROTECT,""));0<a.indexOf("\x3ctextarea")&&(a=a.replace(/<textarea[^>]*>/,"").replace(/<\/textarea>$/,""));return chatter.getToolbox().evalJson(a)};
Sfdc.MultiFileUploaderUtil.getActionUrl=function(){var a=chatter.getToolbox();return a.sitePrefix()+a.apiurl()};Sfdc.MultiFileUploaderUtil.formatFileSize=function(a){var b=["KB","MB","GB"];if(0<a){var c=-1;do a/=1024,c++;while(1023<a);return Math.max(a,0.1).toFixed(1)+" "+b[c]}return"0 "+b[0]};
Sfdc.MultiFileUploaderUtil.formatFileTypeCSS=function(a,b){b=b||"16";return/^image\/|^.png$|^.jpg$|^.bmp$|^.gif$/.test(a)?"sprite-doctype-image-"+b:/^video\/|^.mov$|^.avi$|^.mp4$|^.mpeg$|^.wmv$|^.rmvb$/.test(a)?"sprite-doctype-video-"+b:/^audio\/|^.mp3$|^.wma$|^.wav$|^.midi$/.test(a)?"sprite-doctype-audio-"+b:/^text\/csv|^.csv$/.test(a)?"sprite-doctype-csv-"+b:/^text\/plain|^.txt$/.test(a)?"sprite-doctype-txt-"+b:/^text\/xml|^.xml$/.test(a)?"sprite-doctype-xml-"+b:/^text\/html|^.html$|^.xhtml$|^.htm$/.test(a)?
"sprite-doctype-html-"+b:/^text\/richtext|^.rtf$|application\/rtf/.test(a)?"sprite-doctype-rtf-"+b:/^application\/.*word|^.doc$|^.docx$/.test(a)?"sprite-doctype-word-"+b:/^application\/.*(excel|sheet)|^.xls$|^.xlsx$/.test(a)?"sprite-doctype-excel-"+b:/^application\/.*powerpoint|^application\/.*presentation|^.ppt$|^.pptx$/.test(a)?"sprite-doctype-ppt-"+b:/^application\/.*visio|^.vsd$/.test(a)?"sprite-doctype-visio-"+b:/^application\/.*pdf|^.pdf$/.test(a)?"sprite-doctype-pdf-"+b:/^application\/.*flash|^.swf$/.test(a)?
"sprite-doctype-flash-"+b:/^application\/.*zip|^.zip$/.test(a)?"sprite-doctype-zip-"+b:/^application\/.*postscript|^.eps$/.test(a)?"sprite-doctype-eps-"+b:/^application\/.*msdownload|^.exe$/.test(a)?"sprite-doctype-exe-"+b:"sprite-doctype-unknown-"+b};Sfdc.MultiFileUploaderUtil.checkFileSyncOption=function(){if(!Sfdc.ChatterFileUploader.isFileSync){var a=Sfdc.get("chatterboxFilesBrowseItem");a&&Sfdc.Dom.hasClass(a,"selectedLinkItem")&&(Sfdc.ChatterFileUploader.isFileSync=!0)}};
Sfdc.MultiFileUploaderUtil.createElementFromHTML=function(){var a=document.createElement("div");return function(b){a.innerHTML=b;b=a.firstChild;a.removeChild(b);return b}}();
Sfdc.MultiFileUploaderUtil.processDirectoriesInFileList=function(a){var b,c,d=[];if(a.items)for(b=0;b<a.items.length;b++){if(c=a.items[b]){var e=null;c.webkitGetAsEntry&&(e=c.webkitGetAsEntry());e&&(e.isDirectory?d.push({name:e.name,size:0,type:""}):e.isFile&&d.push(a.files[b]))}}else{d=a.files;a=[];for(b=0;b<d.length;b++)c=d[b],0===c.size?a.push({name:c.name,size:0,type:""}):a.push(c);d=a}return d};
Sfdc.ns("Sfdc.MultiFileUploaderUiComponents.ProgressBar");Sfdc.MultiFileUploaderUiComponents.ProgressBar=function(a,b){this.element=a;this.totalPixelSize=b;this.element.childNodes.item(0).style.width="0px"};Sfdc.MultiFileUploaderUiComponents.ProgressBar.prototype.update=function(a){this.element.childNodes.item(0).style.width=a*this.totalPixelSize+"px"};
var isIE=-1!=navigator.appVersion.indexOf("MSIE")?!0:!1,isWin=-1!=navigator.appVersion.toLowerCase().indexOf("win")?!0:!1,isOpera=-1!=navigator.userAgent.indexOf("Opera")?!0:!1,isIPad=-1!=navigator.userAgent.indexOf("iPad")?!0:!1,isIPhone=-1!=navigator.userAgent.indexOf("iPhone")?!0:!1;
function controlVersion(){var a,d;try{d=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7"),a=d.GetVariable("$version")}catch(g){}if(!a)try{d=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6"),a="WIN 6,0,21,0",d.AllowScriptAccess="always",a=d.GetVariable("$version")}catch(c){}if(!a)try{d=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3"),a=d.GetVariable("$version")}catch(b){}if(!a)try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3"),a="WIN 3,0,18,0"}catch(e){}if(!a)try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),
a="WIN 2,0,0,11"}catch(f){a=-1}return a}
function getSwfVer(){var a=-1;if(null!==navigator.plugins&&0<navigator.plugins.length){if(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]){var a=navigator.plugins["Shockwave Flash"+(navigator.plugins["Shockwave Flash 2.0"]?" 2.0":"")].description.split(" "),d=a[2].split("."),g=d[0],d=d[1],c=a[3];""===c&&(c=a[4]);"d"==c[0]?c=c.substring(1):"r"==c[0]&&(c=c.substring(1),0<c.indexOf("d")&&(c=c.substring(0,c.indexOf("d"))));a=g+"."+d+"."+c}}else-1!=navigator.userAgent.toLowerCase().indexOf("webtv/2.6")?
a=4:-1!=navigator.userAgent.toLowerCase().indexOf("webtv/2.5")?a=3:-1!=navigator.userAgent.toLowerCase().indexOf("webtv")?a=2:isIE&&(isWin&&!isOpera)&&(a=controlVersion());return a}
function detectFlashVer(a,d,g){versionStr=getSwfVer();if(-1==versionStr)return!1;if(0!==versionStr){isIE&&isWin&&!isOpera?(tempArray=versionStr.split(" "),tempString=tempArray[1],versionArray=tempString.split(",")):versionArray=versionStr.split(".");var c=versionArray[0],b=versionArray[1],e=versionArray[2];return c>parseFloat(a)||c==parseFloat(a)&&(b>parseFloat(d)||b==parseFloat(d)&&e>=parseFloat(g))?!0:!1}}function ac_AddExtension(a,d){return-1!=a.indexOf("?")?a.replace(/\?/,d+"?"):a+d}
function ac_Generateobj(a,d,g,c){var b="",e;if(isIE&&isWin&&!isOpera){b+="\x3cobject ";for(e in d)"parent"!=e&&(b+=e+'\x3d"'+d[e]+'" ');b+="\x3e";for(e in g)g.hasOwnProperty(e)&&(b+='\x3cparam name\x3d"'+e+'" value\x3d"'+g[e]+'" /\x3e ');b+="\x3cp\x3e"+LC.getLabel("ContentFlashPlayer","flashFilePreview")+"\x3c/p\x3e\x3c/object\x3e"}else{b+="\x3cembed ";for(e in c)c.hasOwnProperty(e)&&"function"!=typeof c[e]&&(b+=e+'\x3d"'+c[e]+'" ');b+="\x3e\x3cnoembed\x3e\x3cp\x3e"+LC.getLabel("ContentFlashPlayer",
"flashFilePreview")+"\x3c/p\x3e\x3c/noembed\x3e\x3c/embed\x3e"}a.innerHTML=b}
function ac_GetArgs(a,d,g,c,b){for(var e={embedAttrs:{},params:{},objAttrs:{}},f=0;f<a.length;f+=2)switch(a[f].toLowerCase()){case "parent":e.parent=a[f+1];break;case "classid":break;case "pluginspage":e.embedAttrs[a[f]]=a[f+1];break;case "src":case "movie":a[f+1]=ac_AddExtension(a[f+1],d);e.embedAttrs.src=a[f+1];e.params[g]=a[f+1];break;case "onafterupdate":case "onbeforeupdate":case "onblur":case "oncellchange":case "onclick":case "ondblClick":case "ondrag":case "ondragend":case "ondragenter":case "ondragleave":case "ondragover":case "ondrop":case "onfinish":case "onfocus":case "onhelp":case "onmousedown":case "onmouseup":case "onmouseover":case "onmousemove":case "onmouseout":case "onkeypress":case "onkeydown":case "onkeyup":case "onload":case "onlosecapture":case "onpropertychange":case "onreadystatechange":case "onrowsdelete":case "onrowenter":case "onrowexit":case "onrowsinserted":case "onstart":case "onscroll":case "onbeforeeditfocus":case "onactivate":case "onbeforedeactivate":case "ondeactivate":case "type":case "codebase":e.objAttrs[a[f]]=a[f+
1];break;case "id":case "width":case "height":case "align":case "vspace":case "hspace":case "class":case "title":case "accesskey":case "name":case "tabindex":e.embedAttrs[a[f]]=e.objAttrs[a[f]]=a[f+1];break;default:e.embedAttrs[a[f]]=e.params[a[f]]=a[f+1]}e.objAttrs.classid=c;b&&(e.embedAttrs.type=b);return e}
function ac_FL_RunContent(){var a=ac_GetArgs(arguments,".swf","movie","clsid:d27cdb6e-ae6d-11cf-96b8-444553540000","application/x-shockwave-flash");ac_Generateobj(a.parent,a.objAttrs,a.params,a.embedAttrs)}function getFlexRoot(a){return-1!=navigator.appName.indexOf("Microsoft")?window[a]:document[a]}
function sizeImagePreview(a,d,g,c){var b=document.getElementById(a),e=b.height/b.width,f="0px";b.width>=d&&e<=g/d?(b.width=d,b.height=b.width*e):b.height>=g&&(b.height=g,b.width=b.height/e);b.height<g&&(f=0.45*(g-b.height)+"px");b.style.marginTop=f;c?Ext.fly(a).removeClass(c):Ext.fly(a).dom.style.display="block"}function onPreviewSuccess(a,d,g,c){sizeImagePreview(a,d,g,c);if(a=Ext.fly("fullPreviewNotSupported"))a.dom.style.display="block"}
function showPreviewError(a){a=Ext.fly(a).parent("div");if("chatterFileViewerPanel"==a.dom.id)a.dom.innerHTML=previewErrorHtml,a.child("div").dom.style.display="block";else{var d=LC.getLabel("ChatterFileListPage","noPreviewOnDevice");a.dom.innerHTML='\x3ctable style\x3d"font-size:1.2em;font-weight:bold;width:100%;height:100%"\x3e\x3ctr\x3e\x3ctd style\x3d"text-align:center;vertical-align:middle;"\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e';a.child("td").dom.innerHTML=d}if(a=Ext.fly("fullPreviewNotSupported"))a.dom.style.display=
"none"}
function doIPadIPhonePreview(a,d,g,c,b,e,f,l,m,n,h){var k;c=g.split("\x26");for(b=0;b<c.length;b++)0===c[b].indexOf("v\x3d")&&(k=c[b].substring(2));d=UserContext.getUrl("/sfc/servlet.shepherd/version/download/"+k+"?asPdf\x3dtrue");k=UserContext.getUrl("/sfc/servlet.shepherd/version/renditionDownload?rendition\x3dTHUMB720BY480\x26versionId\x3d"+k);c=a.clientWidth;b=a.clientHeight-30;previewErrorHtml=a.innerHTML;k='\x3cdiv style\x3d"'+("width:"+c+"px; height:"+b+"px;")+'"\x3e\x3ca href\x3d"'+d+'"\x3e\x3cimg onerror\x3d"showPreviewError(this)" onload\x3d"onPreviewSuccess(\'imageRendition\', \''+
c+"', '"+b+'\')" id\x3d"imageRendition" style\x3d"display:none;margin:auto;" src\x3d"'+k+'"/\x3e\x3c/a\x3e\x3c/div\x3e';c=null;b=!1;h&&h.fileType&&(c=h.fileType,b=h.isImage);h="";b||(b=null,null!==c&&(b=escapeHTML(LC.getLabel("ContentDownloadLinkElement","downloadFeedPost"," "+c))),h='\x3cdiv id\x3d"fullPreviewNotSupported" style\x3d"display:none"\x3e\x3ctable cellpadding\x3d"0" cellspacing\x3d"0" class\x3d"fullPreviewNotSupported"\x3e\x3ctr\x3e\x3ctd class\x3d"iconCell"\x3e\x3cimg class\x3d"warningIcon" width\x3d"1" height\x3d"1" alt\x3d"" src\x3d"/img/s.gif"/\x3e\x3c/td\x3e\x3ctd class\x3d"textCell"\x3e'+
escapeHTML(LC.getLabel("ChatterFileListPage","fullPreviewNotSupported"))+"\x3c/td\x3e",null!==b&&(h+=' \x3ctd\x3e\x3cdiv class\x3d"download"\x3e\x3ca class\x3d"actionLink" href\x3d"'+d+'"\x3e\x3cimg width\x3d"1" height\x3d"1" title\x3d"'+b+'" class\x3d"downloadIcon" alt\x3d"" src\x3d"/img/s.gif"/\x3e\x3cspan class\x3d"actionLabel"\x3e'+b+"\x3c/span\x3e\x3c/a\x3e\x3c/div\x3e\x3c/td\x3e"),h+="\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e");a.innerHTML=k+h}
function showDownloadLink(a,d){if("undefined"!=typeof Ext&&"undefined"!=typeof Shepherd){var g=new Ext.Element(Ext.getDom("container_bubble"));g.setSize(500,100);g.center();Shepherd.getHelper("bubble").getBubble().wrapper.style.top=Position.realOffset($("body_content"))[1]+50;new Ext.Panel({id:"noFlashPanel",border:!1,buttonAlign:"center",renderTo:a,frame:!1,bodyStyle:"text-align:center;margin-bottom:20px;",html:d.adobeFlashVersionLbl,buttons:[new Ext.Button({text:d.closeDialogLbl,hidden:!Ext.fly(a).up("div#container_bubble"),
handler:function(){Shepherd.run("bubble","hide")}})]})}else a.innerHTML="\x3cfont style\x3d'text-align:center' color\x3d'#000'\x3e"+d.adobeFlashVersionLbl+"\x3c/font\x3e"}
function insertFlexComponent(a,d,g,c,b,e,f,l,m,n){var h="string"==typeof e?document.getElementById(e):e;isIPad||isIPhone?doIPadIPhonePreview(h,a,d,g,c,b,e,f,l,m,n):(e=detectFlashVer(6,0,65),l=detectFlashVer(9,0,115),e&&!l?showDownloadLink(h,m):l?ac_FL_RunContent("src",a,"FlashVars",d,"width",g,"height",c,"align","middle","id",f,"quality","high","bgcolor",b,"name",f,"allowScriptAccess","sameDomain","allowFullScreen","true","type","application/x-shockwave-flash","wmode","opaque","parent",h):showDownloadLink(h,
m))}function closeContentPreviewDialog(){if(window.dialog&&"docViewerOverlay"===window.dialog.id)window.dialog.hide();else if(sfdcPage){var a=sfdcPage.getDialogById("docViewerOverlay");a&&a.hide()}};
Ext.ns("Ninja.Flex");
Ninja.Flex.FlexCoverflow={getApp:function(){return getFlexRoot("Coverflow")},showPreview:function(c){if(Sfdc.ChatterFiles||"undefined"==typeof Shepherd){var b=ChatterFilesConstants.OVERLAY_ID,g=ChatterFilesConstants.DOC_VIEWER_OVERLAY_CLASS,h=ChatterFilesConstants.DOC_VIEWER_CONTAINER_PARENT_CLASS,e=ChatterFilesConstants.DOC_VIEWER_CONTAINER_PARENT_CLASS,f=ChatterFilesConstants.CONTAINER_ID,k=ChatterFilesConstants.CONTAINER_ID,d=Sfdc.Window.getWindowWidth(),a=Sfdc.Window.getWindowHeight(),d=d-40,
a=a-20-48;width=730<d?d:730;height=480<a?a:480;null===Ext.get(b)?(a=new AccessiblePreviewContentDialog(b),a.extraClass=g,a.content="\x3cdiv id\x3d'"+e+"' class\x3d'"+h+"'\x3e\x3cdiv id\x3d'"+f+"' class\x3d'"+k+"'\x3e\x3c/div\x3e\x3c/div\x3e",a.created=!0,a.register(),Ext.get(e).setHeight(height),Ext.get(b).setWidth(width),a.show(),Ext.get(b).setStyle("left","10px")):(a=OverlayDialogElement.getDialog(b),a.setTitle(""),Ext.get(e).setHeight(height),Ext.get(b).setWidth(width),Ext.getBody().setStyle("overflow",
"auto"),a.show());b=chatter&&chatter.getToolbox()?chatter.getToolbox().sitePrefix():"";insertFlexComponent(Ninja.Flex.ContentStaticResourcesBase+"/flex/DocViewer","shepherd_prefix\x3d"+b+Ninja.Flex.ShepherdController+"\x26v\x3d"+c+"\x26mode\x3dbubble\x26in_tests\x3dfalse","100%","100%","#f3f3f3",f,"renditionLarge",!1,{adobeFlashVersionLbl:LC.getLabel("ContentFlashPlayer","adobeFlashVersion"),downloadAdobeLbl:LC.getLabel("ContentFlashPlayer","downloadAdobe"),downloadAdobeLinkLbl:LC.getLabel("ContentFlashPlayer",
"downloadAdobeLink"),closeDialogLbl:LC.getLabel("ContentFlashPlayer","closeDialog")})}else Shepherd.run("document","viewRenditionLarge",{selectedVersionId:c})},showDetails:function(c){Sfdc.ChatterFiles||"undefined"==typeof Shepherd?navigateToUrl(UserContext.getUrl("/"+c)):Shepherd.run("document","view",{selectedDocumentId:c})}};Ninja.Flex.ContentStaticResourcesBase="/sfc";Ninja.Flex.ShepherdController="/sfc/servlet.shepherd";
function ActionProgressDialog(b,a,d,c){this.id=b;this.url=a;this.escapeParams=d;this.parentId=c;this.isModal=!0;this.width=480;this.progressMsgText=this.progressMsgTitleTooltip=this.progressMsgTitle="";this.displayX=!1;this.addEvents();this.helpUrl=null}ActionProgressDialog.prototype=new OverlayDialog;ActionProgressDialog.prototype.hide=function(){OverlayDialog.prototype.hide.apply(this,[]);this.createContent()};
ActionProgressDialog.prototype.createContent=function(){var b=document.getElementById(this.getContentId());b||(sfdcPage.executeOnloadQueue(),b=document.getElementById(this.getContentId()));var a=[];a.push("\x3cdiv id\x3d'actionProgressPanel' class\x3d'actionProgressPanel'\x3e");if(this.helpUrl){var d=LC.getLabel("ChatterFileMultiUpload","helpWithUploading"),c=LC.getLabel("ChatterFileMultiUpload","helpWithUploading")+"\x26nbsp;"+LC.getLabel("Global","new_window");a.push('\x3cdiv class\x3d"pageHelpIconPanel"\x3e');
a.push('\x3ca class\x3d"helpLinkElement" id\x3d"uploadHelpLinkElement" href\x3d"'+this.helpUrl+'"\x3e');a.push('\x3cspan class\x3d"helpLink"\x3e'+d+"\x3c/span\x3e");a.push('\x3cimg src\x3d"/s.gif" class\x3d"helpIcon" alt\x3d"'+c+'" title\x3d"'+c+'"\x3e');a.push("\x3c/a\x3e");a.push("\x3c/div\x3e")}a.push("\x3cdiv id\x3d'contentContainer'\x3e");a.push("\x3cdiv id\x3d'progressIcon'\x3e\x3c/div\x3e");a.push("\x3cdiv id\x3d'progressMsgContainer'\x3e");a.push("\x3cp id\x3d'progressMsgTitle' title\x3d\""+
this.progressMsgTitleTooltip+'"\x3e'+this.progressMsgTitle+" ");a.push("\x3c/p\x3e");a.push("\x3cp id\x3d'progressMsgText'\x3e"+this.progressMsgText+"\x3c/p\x3e");a.push("\x3c/div\x3e\x3cdiv class\x3d'clear'\x3e\x3c/div\x3e");a.push("\x3c/div\x3e\x3c/div\x3e");this.createButtons(a);b.innerHTML=a.join("");this.clearButtons();this.addButtonBar()};ActionProgressDialog.prototype.addButtonBar=function(){};
ActionProgressDialog.prototype.setProgressMsgTitle=function(b,a){this.progressMsgTitle=b;this.progressMsgTitleTooltip=a};ActionProgressDialog.prototype.setProgressMsgText=function(b){this.progressMsgText=b};ActionProgressDialog.prototype.setHelpUrl=function(b){this.helpUrl=b};
PublisherAutoComplete=function(){};PublisherAutoComplete.prototype.getInputWithEncodedAtMentions=function(){return""};PublisherCKEditorAutoComplete=function(){};PublisherCKEditorAutoComplete.prototype.getValue=function(){return""};PublisherCKEditorAutoComplete.prototype.getInputValueLength=function(){return""};PublisherCKEditorAutoComplete.prototype.isNoticeDisplayed=function(){return""};
Sfdc.provide("Sfdc.RechatComposer",{RechatToFollowersHelper:function(){},RechatToGroupHelper:function(){},RechatTargetSelector:function(){}});
(function(){Sfdc.provide("SfdcApp.Chatter.FormHandler",{errorCount:0,hideErrors:function(b){Sfdc.each(Sfdc.select(".errorMsg",b),function(a){Sfdc.Dom.hideByDisplay(a)})},addErrors:function(b,a){chatter.getToolbox();a&&Sfdc.each(Object.keys(a),function(c){var d=Sfdc.get("."+c,b);Sfdc.Dom.updateHTML(d,a[c]);Sfdc.Dom.show(d)})},disableButtons:function(b){Sfdc.each(Sfdc.select("input.btn",b),function(a){chatter.getToolbox().disableButton(a)})},disableSubmit:function(b){this.errorCount++;0<this.errorCount&&
Sfdc.each(Sfdc.select("input.saveBtn",b),function(a){chatter.getToolbox().disableButton(a)})},enableButtons:function(b){Sfdc.each(Sfdc.select("input.btn",b),function(a){Sfdc.Dom.hasClass(a,"btnNoEnable")||chatter.getToolbox().enableButton(a)})},enableSubmit:function(b){this.errorCount--;0>=this.errorCount&&(this.errorCount=0,Sfdc.each(Sfdc.select("input.saveBtn",b),function(a){chatter.getToolbox().enableButton(a)}))},submit:function(b,a,c){this.disableButtons(b);this.hideErrors(b);var d=sfdcPage.dirtyState!==
GenericSfdcPage.STATE_CLEAN,e=this;chatter.getToolbox().post({url:a,params:c,failure:function(a,f){e.enableButtons(b);e.addErrors(b,f.errors);c.failure&&c.failure(a,f);d&&sfdcPage.updateDirtyState(GenericSfdcPage.STATE_ERROR)},success:function(a,b){chatter.getToolbox().navigateTo(b.url)}})},getCheckedValue:function(b){for(var a=0;a<b.length;a++)if(b[a].checked)return b[a].value}})})();
Sfdc.provide("SfdcApp.Chatter.SubscribeButton",{onHover:function(){},onKeyUp:function(){},onClick:function(){return!1}});
function getOpenDialog(){for(var a in sfdcPage.dialogs)if(sfdcPage.dialogs.hasOwnProperty(a)){var b=sfdcPage.dialogs[a];if(b.isOpen)return b}}function closeDialog(a){var b=getOpenDialog();b&&b.close();a&&(Sfdc.userAgent.isSafari3?window.location.href=window.location.href:window.location.reload())}function resizeDialog(a,b){var d=getOpenDialog();d&&d.resize(a,b)}function CollaborationAccessibleDialogHelper(){}CollaborationAccessibleDialogHelper.addUrlObserver=function(a){CollaborationAccessibleDialogHelper.urlObservers.push(a)};
CollaborationAccessibleDialogHelper.urlObservers=[];CollaborationAccessibleDialogHelper.transformUrl=function(a){for(var b=0;b<CollaborationAccessibleDialogHelper.urlObservers.length;b++)a=CollaborationAccessibleDialogHelper.urlObservers[b](a);return a};function CollaborationAccessibleDialog(a,b,d,e,c){this.id=a;this.contentId=a+"ContentId";this.height=e;this.url=d;""!==c&&void 0!==c&&(this.width=parseInt(c,10));this.register();Ext.fly(window).on("focus",function(){closeDialog()})}
CollaborationAccessibleDialog.prototype=new SimpleDialog;CollaborationAccessibleDialog.prototype.display=function(){for(var a in sfdcPage.dialogs)if(sfdcPage.dialogs.hasOwnProperty(a)){var b=sfdcPage.dialogs[a];b.isOpen&&b.popupWindow.close()}this.popupWindow=window.open(CollaborationAccessibleDialogHelper.transformUrl(this.url),this.id,"height\x3d"+this.height+",width\x3d"+this.width+",location\x3d0,status\x3d0");this.popupWindow.focus();this.isOpen=!0};
CollaborationAccessibleDialog.prototype.resize=function(a,b){this.popupWindow.resizeTo(b,a+100)};CollaborationAccessibleDialog.prototype.close=function(){this.popupWindow.close()};function NonaccessibleDialog(a,b,d,e,c){this.id=a;this.contentId=a+"ContentId";this.displayX=this.isMovable=!0;this.height=e;this.url=d;""!==c&&void 0!==c&&(this.width=parseInt(c,10));this.setTitle(b);this.register()}NonaccessibleDialog.prototype=new SimpleDialog;
NonaccessibleDialog.prototype.display=function(){var a=[];a.push('\x3ciframe frameborder\x3d"no" id\x3d"'+this.contentId+'" style\x3d"border:0;height:'+this.height+"px;width:"+(Sfdc.userAgent.isIE6?"93%":"100%")+';" src\x3d"'+CollaborationAccessibleDialogHelper.transformUrl(this.url)+'"\x3e\x3c/iframe\x3e');this.setContentInnerHTML(a.join(""));this.show();this.setWidth(this.width)};NonaccessibleDialog.prototype.resize=function(a,b){document.getElementById(this.contentId).style.height=a+"px";this.setWidth(b)};
NonaccessibleDialog.superclass=SimpleDialog.prototype;NonaccessibleDialog.prototype.hide=function(){var a=this.getContentElement().firstChild.contentWindow;try{a.closePopup&&a.closePopup()}catch(b){}finally{NonaccessibleDialog.superclass.hide.call(this)}};NonaccessibleDialog.prototype.close=function(){this.hide()};
var chatter=new function(){function k(){function b(){function b(){document.title=d?l:e;d&&g++;d=!d;g<=s?a=setTimeout(b,f):document.title=e}var d=!0;b()}function d(){clearTimeout(a);document.title=l;g=0}var a,f,s,g=0,h=chatter.getEventBus(),l=document.title,e=LC.getLabel("Feeds","pageTitleFlipMessage");this.init=function(a,g){h.addEventListener("chatter:feed","onAfterLiveFeedMessageShown",b);h.addEventListener("chatter:feed","onAfterFeedRefresh",d);f=a;s=g}}function e(){function b(a){Ext.get("notFavorited").addClass("hidden");
var b=Ext.get("alreadyFavorited");b.removeClass("hidden");b.set({feedFavoriteId:a});a=!!Sfdc.select("#Chatter_Tab:first-child").length;HelpBubble.display({parentDiv:"Chatter_Tab",pointerDirection:a?HelpBubble.BOTTOMLEFT:HelpBubble.BOTTOM,contentText:LC.getLabel("FeedFavorites","SavedFeedFavoriteBubble"),hideCloseX:!0,additionalClass:"feedFavoriteHelpBubble",fadeInCallBackFn:function(){setTimeout("HelpBubble.hideBubble('feedFavoriteHelpBubble');",3E3)}})}this.remove=function(a){omnitureWrapper.trackEvent(chatter.getOmnitureEventMap().removeFavorite);
Perf.mark("DeleteFeedFavoriteStart");var b=a.name,d=function(){chatter.getToolbox().post({url:"/feed/favorites/"+a.feedFavoriteId+";delete",params:a,success:function(){var b=Ext.get("feedFavoriteDelete{0}".replace("{0}",a.feedFavoriteId));b&&(b=Sfdc.Dom.getParent(b.dom,"li"),Sfdc.Dom.hasClass(b,"selected")&&chatter.getNavigationGroups().getAssociatedGroup("chatterTabNavigation").mainNavigation.selectDefaultItem(!0),Sfdc.Dom.removeChild(b));a.calledByWidget&&(Ext.get("alreadyFavorited").addClass("hidden"),
Ext.get("notFavorited").removeClass("hidden"));Perf.endMark("DeleteFeedFavoriteStart")}})};a.noalert?d():Dialogs.showSimpleConfirmation("",LC.getLabel("Feeds","FeedFavoriteDeleteAlert",b),d)};var d=this.add=function(a){omnitureWrapper.trackEvent(chatter.getOmnitureEventMap().addFavorite);chatter.getToolbox().post({url:"/feed/favorite/term;create",params:a,success:function(d,e){a.calledByWidget&&b(e.feedFavoriteId)}})};this.addFavoriteFromSearchResult=function(a){d({searchText:a,calledByWidget:!0,
type:"S"})};this.addFavoriteFromListView=function(a,b){d({entityId:a,calledByWidget:!0,name:b,type:"L"})};this.addFavoriteFromTopic=function(a,b){d({entityId:a,calledByWidget:!0,name:b,type:"T"})};this.widgetRemove=function(){var a=Ext.get("alreadyFavorited").dom.getAttribute("feedFavoriteId");chatter.getFeedFavoriteHelper().remove({feedFavoriteId:a,noalert:!0,calledByWidget:!0})};this.favoriteDeleteRemoveZenAssist=function(a){a=Sfdc.get(".delete",a);chatter.getToolbox().removeZenAssist(a)};this.favoriteDeleteAddZenAssist=
function(a){a=Sfdc.get(".delete",a);chatter.getToolbox().addZenAssist(a)}}function r(){var b=0,d,a,f=!1,e="idle",g=chatter.getEventBus();g.addEventListener("chatter:feed","onAfterShowMoreFeedItems",function(){e="idle"});g.addEventListener("chatter:feed","onAfterFeedRefresh",function(){b=0;e="idle";f=!1});this.init=function(h){d=h.max||3;a=h.factor||0.75;Ext.EventManager.on(window,"scroll",function(){if(chatter.isFeedVisible()){var h=(Ext.get("contentWrapper")||Ext.get("bodyInner")||Ext.getBody()).getHeight();
if(Ext.get(document).getScroll().top+(Ext.isIE?document.documentElement.clientHeight:window.innerHeight)>h*a&&(!(b>=d)&&!f)&&"processing"!=e)e="processing",h=Ext.select("div.showmorefeeditemscontainer a").elements,1==h.length?(h[0].onclick(),b+=1):(f=!0,e="idle")}})};this.getMax=function(){return d};this.resetShownCount=function(){b=0};this.isReachedMaxExecutions=function(){return b>=d}}function t(){this.onMouseOver=function(b){b=Ext.get(b);b.hasClass("newFeedItemsMessageHover")||b.addClass("newFeedItemsMessageHover")};
this.onMouseOut=function(b){b=Ext.get(b);b.hasClass("newFeedItemsMessageHover")&&b.removeClass("newFeedItemsMessageHover")}}function q(){StringBuffer=function(){this.buffer=[];this.append=function(b){this.buffer.push(b);return this};this.toString=function(){return this.buffer.join("")}};return new StringBuffer}function n(){function b(c){chatter.isInvalidSession(c.responseText)&&(h.log("Handling redirect"),chatter.getToolbox().refresh())}function d(c){var a=c.params||{};a.token=h.token();var d=c.dieSilently||
!1,f=u.sitePrefix()+h.apiurl()+(c.url||"");h.log("XHR request "+c.method+" "+f+(a.q?a.q:""));Ext.each(chatter.getConfig().getUrlObservers(),function(c){f=c(f);return!0});h.log("Rewritten URL: "+f);var e=h.now(),l;x&&(l=["XHR ",c.method,": ",a.q?f+"?q\x3d"+a.q:f].join(""),Perf.mark(l));A&&(a.trace="sqltrace");a={url:f,params:a,method:c.method,headers:c.headers,timeout:c.timeout||6E4,callback:null,failure:function(a){var p=h.now();h.log("Request completed in "+(p-e)+"ms");if(d)h.log("Request to "+f+
" failed.");else{var g;try{g=h.evalJson(a.responseText)}catch(l){h.log("Oops, an error occurred parsing JSON: "+l+" from text"+a.responseText),g={},b(a)}h.xhrFailure(a,g);if(c.failure)try{c.failure(a,g)}catch(s){h.log("Failure handler caught an exception: "+s)}g.redirecturl&&h.navigateTo(g.redirecturl)}},success:function(a){var p=h.now();h.log("Request completed in "+(p-e)+"ms");var d;try{d=h.evalJson(a.responseText)}catch(g){h.log("Oops, an error occurred parsing JSON: "+g+" from text"+a.responseText),
d={},b(a)}if(c.success)try{c.success(a,d),h.log("Success handler completed in "+(h.now()-p)+"ms")}catch(f){h.log("Success handler caught an exception: "+f),c.failure&&c.failure(a,{}),h.log("Success handler completed with failure in "+(h.now()-p)+"ms")}x&&Perf.endMark(l)}};c.form&&(a.form=c.form);Ext.Ajax.defaultHeaders={Authorization:h.token()};var s=c.abortTargets;if(s&&Sfdc.isArray(s))for(var k=0;k<s.length;k++)Ext.Ajax.abort(g[s[k]]);try{c.ajaxInstanceKey?g[c.ajaxInstanceKey]=Ext.Ajax.request(a):
Ext.Ajax.request(a)}catch(O){h.log("Ext.Ajax.request caught an exception: "+O)}}function a(c,a){for(var b=/(?:<script([^>]*)?>)((\n|\r|.)*?)(?:<\/script>)/ig,d=/\ssrc=([\'\"])(.*?)\1/i,h,g,f=[],e=[],l=function(){for(;f.length;)window.execScript?window.execScript(f.shift()):window.eval(f.shift());Sfdc.isFunction(a)&&a()};h=b.exec(c);)(g=(g=h[1])?g.match(d):!1)&&g[2]?e.push(g[2]):h[2]&&0<h[2].length&&f.push(h[2]);e.length?Sfdc.Resource.addJavaScripts(e,l):l()}function f(c,b,d){Ext.lib.Event.onAvailable(d,
function(){a(c,b)})}function e(c){return Array(c.length-1).join("\x26nbsp;")+" "}var g={},h=this,l=null,k="",x=window.Perf&&Perf.enabled,A=!1,m;this.enableSqlTrace=function(){A=!0};this.disableSqlTrace=function(){A=!1};this.handleRedirect=function(c){b(c)};this.log=function(c){"undefined"!=typeof console&&"undefined"!=typeof console.info&&console.info(c)};this.now=function(){return(new Date).getTime()};this.disableButton=function(c){c=h.returnHtmlElementIfExtElement(c,"disableButton");Sfdc.Dom.addClass(c,
["btnDisabled",ZenCss.disabledBtn]);h.disable(c)};this.enableButton=function(c){c=h.returnHtmlElementIfExtElement(c,"enableButton");Sfdc.Dom.removeClass(c,["btnDisabled",ZenCss.disabledBtn]);h.enable(c)};this.addZenAssist=function(c){c&&Sfdc.Dom.addClass(c,"zen-assistiveText")};this.removeZenAssist=function(c){c&&Sfdc.Dom.removeClass(c,"zen-assistiveText")};this.removeClassOnMouseOut=function(c,a,b){Sfdc.Event.mouseExited(c,a)&&Sfdc.Dom.removeClass(a,b)};this.expandableTextArea=function(c,a,b){Sfdc.on(c,
Sfdc.userAgent.isIE8||Sfdc.userAgent.isIE7?"keyup":"input",this.updateHeight.bind(this,c,a,a*b))};this.updateHeight=function(c,a,b){Sfdc.isDefAndNotNull(m)||(m=Sfdc.Dom.create(document.body),Sfdc.Dom.addClass(m,"shadowDiv"));a=m;var d=Sfdc.Dom.getStyles(c,"paddingTop paddingBottom paddingLeft paddingRight lineHeight fontSize fontStyle fontWeight fontFamily wordWrap".split(" ")),h=parseInt(d.paddingLeft)||0,g=parseInt(d.paddingRight)||0;d.width=Sfdc.Dom.getWidth(c)-(h+g)+"px";Sfdc.Dom.setStyles(a,
d);d=c.value;Sfdc.Dom.updateHTML(a,d.replace(/<|>|&/g,"\x26lt;").replace(/\n$/,"\x3cbr/\x3e\x26nbsp;").replace(/\n/g,"\x3cbr/\x3e\x26nbsp;").replace(/ {2,}/g,e));a.value=d;a=Sfdc.Dom.getActualHeight(a);a<b&&(a=b);if(a!==parseInt(c.style.height||0))c.style.height=a+"px"};this.initializeIE8JPNTypingFix=function(c){if(Sfdc.userAgent.isIE8&&"ENTITY"===chatter.getFeed().getConfig().feedType){var a=Sfdc.get("bodyTable");a&&(Sfdc.Event.add(c,"focus",function(){a.width=a.offsetWidth+"px";Sfdc.Dom.addClass(a,
"recordTableBodyIE8Fix")}),Sfdc.Event.add(c,"blur",function(){a.width="100%";Sfdc.Dom.removeClass(a,"recordTableBodyIE8Fix")}))}};this.disable=function(){Sfdc.Array.forEach(Sfdc.Array.toArray(arguments),function(c){h.returnHtmlElementIfExtElement(c,"disable").disabled=!0})};this.enable=function(){Sfdc.Array.forEach(Sfdc.Array.toArray(arguments),function(c){h.returnHtmlElementIfExtElement(c,"enable").disabled=!1})};this.poll=function(c){c=new z(c);c.start();return c};this.xhrFailure=function(c,a){var b;
b="XHR Failure."+(a&&a.errorid?" Error ID: "+a.errorid+". ":"");b+="\nResponse text:\n"+c.responseText;h.log(b);a&&a.errormessage&&Dialogs.showSimpleError("",a.errormessage,null)};this.stopPropagation=function(c){c=c||event;c.stopPropagation?c.stopPropagation():c.cancelBubble=!0};this.stringIsEmpty=function(c){return 0==c.replace(/\s+$/g,"").length};this.stringTrim=function(c){return c.replace(/^\s+|\s+$/g,"")};this.setToken=function(c){l=c};this.token=function(){return l};this.apiurl=function(){return"/chatter/handlers"};
this.setImageSrc=function(c,a){var b=Sfdc.Dom.get(c,"src");return!b||a!==Sfdc.Url.stripDomainFromUrl(b)?(Sfdc.Dom.set(c,{src:a}),!0):!1};this.setSitePrefix=function(c){k=c};this.sitePrefix=function(){return""!==k?k:UserContext.siteUrlPrefix?UserContext.siteUrlPrefix:""};this.evalJson=function(c){return Util.evalAjaxServletOutput(c)||{}};this.get=function(c){c.method="GET";d(c)};this.post=function(c){c.method="POST";d(c)};this.navigateTo=function(c,a){navigateToUrl(c,"CHATTER",a)};this.refresh=function(){h.navigateTo(window.location)};
this.showMoreDescription=function(c){c=Ext.get(c).parent(".chatterDescription");c.child(".truncatedDescription").remove();c.child(".fullDescription").enableDisplayMode().show()};this.htmlEncode=function(c){return!c?c:String(c).replace(/&/g,"\x26amp;").replace(/>/g,"\x26gt;").replace(/</g,"\x26lt;").replace(/"/g,"\x26quot;").replace(/'/g,"\x26#39;")};this.htmlDecode=function(c){return!c?c:String(c).replace(/&gt;/g,"\x3e").replace(/&lt;/g,"\x3c").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&amp;/g,
"\x26")};this.getEmptyPublisherHTML=function(){return emptyPublisherHTML};this.hide=function(c){if(!Ext.isEmpty(c))return c.setVisibilityMode(Ext.Element.DISPLAY).hide()};this.show=function(c){if(!Ext.isEmpty(c))return c.setVisibilityMode(Ext.Element.DISPLAY).show()};this.runScriptReturnHtml=function(c,a,b){c=c||"";var d=Ext.id();c+='\x3cspan id\x3d"'+d+'"\x3e\x3c/span\x3e';f(c,function(){var c=Sfdc.get(d);c&&Sfdc.Dom.removeChild(c);Sfdc.isFunction(a)&&a()},d);!0!==b&&(c=c.replace(/(?:<script.*?>)((\n|\r|.)*?)(?:<\/script>)/ig,
""));return c};this.updateHTMLFromConfig=function(c){var a=c.el,b=c.callback;if(!a)return a;a.dom&&(a=a.dom);var d=c.html||"";if(!0!==c.loadScripts)return a.innerHTML=d,Ext.isFunction(b)&&b(),a;a.innerHTML=this.runScriptReturnHtml(d,b,c.leaveScripts);return a};this.updateHTML=function(c,a,b,d){this.updateHTMLFromConfig({el:c,html:a,loadScripts:b,callback:d})};this.fixIE7Haslayout=function(c){Sfdc.userAgent.isIE7&&setTimeout(function(){c.style.display="block"},0)};this.mask=function(c,a,b){var d=Ext.Element.data,
h=c.dom,g=Ext.DomHelper,f;!/^body/i.test(h.tagName)&&"static"==c.getStyle("position")&&c.addClass("toolkit-masked-relative");(f=d(h,"maskMsg"))&&f.remove();(f=d(h,"mask"))&&f.remove();f=g.append(h,{cls:"toolkit-el-mask",onclick:"chatter.getToolbox().stopPropagation(event); return false;"},!0);d(h,"mask",f);c.addClass("toolkit-masked");f.setDisplayed(!0);"string"==typeof a&&(g=g.append(h,{cls:"toolkit-el-mask-msg",cn:{tag:"div"}},!0),d(h,"maskMsg",g),g.dom.className=b?"toolkit-el-mask-msg "+b:"toolkit-el-mask-msg",
g.dom.firstChild.innerHTML=a,g.setDisplayed(!0),g.center(c));Ext.isIE&&((!Ext.isIE7||!Ext.isStrict)&&"auto"==c.getStyle("height"))&&this.setSize(f,void 0,c.getHeight());return f};this.unmask=function(c){var a=Ext.Element.data,b=c.dom,d=a(b,"mask"),g=a(b,"maskMsg");d&&(g&&(g.remove(),a(b,"maskMsg",void 0)),d.remove(),a(b,"mask",void 0),c.removeClass(["toolkit-masked","toolkit-masked-relative"]))};this.setSize=function(c,a,b,d){"object"==typeof a&&(b=a.height,a=a.width);a=c.adjustWidth(a);b=c.adjustHeight(b);
!d||!c.anim?(c.dom.style.width=c.addUnits(a),c.dom.style.height=c.addUnits(b)):c.anim({width:{to:a},height:{to:b}},c.preanim(arguments,2));return c};this.isVisible=function(c,a){var b=!c.isStyle("visibility","hidden")&&!c.isStyle("display","none"),d=c.dom.parentNode,g=chatter.getToolbox();if(!0!==a||!b)return b;for(;d&&!/body/i.test(d.tagName);){if(!g.isVisible(Ext.fly(d,"_isVisible")))return!1;d=d.parentNode}return!0};this.getStyles=function(c,a){var b={};Ext.each(a,function(a){b[a]=c.getStyle(a)},
c);return b};this.validateTextFieldLength=function(c,a){var b=Ext.get(c),d=b.getValue().length>a.maxlength,g=b.hasClass("maxlengthfielderror"),h=chatter.getToolbox();d!=g&&(g=b.parent().child(".errorMsg"),null==g&&(g=b.parent().child(".zen-errorMessage")),d?(h.updateHTML(g,a.msg),h.show(g),b.addClass("maxlengthfielderror"),b=c.form,SfdcApp.Chatter.FormHandler.disableSubmit(b)):(h.hide(g),b.removeClass("maxlengthfielderror"),b=c.form,SfdcApp.Chatter.FormHandler.enableSubmit(b)))};this.getPerfEnabled=
function(){return x};this.perfMark=function(c,a){x&&(null==a?Perf.mark(c):Perf.mark(c,a))};this.perfEndMark=function(c,a){x&&(null==a?Perf.endMark(c):Perf.endMark(c,a))};this.perfRemoveStats=function(){x&&Perf.removeStats()};this.submitPerfData=function(c){if(x){var a=Perf.getMeasures();if(a&&0!==a.length){for(var b='u:"'+window.document.URL+'",',d=0,g=0;g<a.length;g++)if(0===d||d>a[g].rt)d=a[g].rt;d="rt.ss:"+d+",";a=Perf.toJson().match(/((measures:\[[^\]]+\]))/i)[0].replace(/"measure":"[^"]+",/g,
"");g="";c&&(g=",extra:"+JSON.stringify(c));a="{"+b+d+a+g+"}";c=function(c){if(c=document.getElementsByName(c))for(var a=0;a<c.length;a++)document.body.removeChild(c[a])};c("ui_perf_form");c("ui_perf_iframe");c=document.createElement("iframe");b=document.createElement("form");d=document.createElement("input");c.name="ui_perf_iframe";c.style.display=b.style.display="none";b.name="ui_perf_form";b.method="POST";b.action="/_ui/common/request/servlet/UIPerfServlet";b.enctype="text/plain";b.target=c.name;
d.name="data";d.value=a;document.body.appendChild(c);b.appendChild(d);document.body.appendChild(b);b.submit()}}};this.submitAndResetPerfData=function(c){this.submitPerfData(c);this.perfRemoveStats()};this.getElementErrorContainer=function(c){return c.parent("div").child(".errorMsg")};this.validateElement=function(c,a,b){if(a())return c.addClass("hidden"),!0;this.updateHTML(c,b);c.removeClass("hidden");return!1};this.wireFieldChange=function(c,a,b){c.on("keyup",a);if(!b)c.on("blur",a);c.on("paste",
function(){a.defer(10)});c.on("cut",function(){a.defer(10)})};this.dismissMessage=function(c,a,b){Ext.get(c).remove();UserContext.userPreferences.setBoolean(a,b)};this.returnHtmlElementIfExtElement=function(a,b){return a.dom?(Sfdc.warn("By 182 the method "+b+" will only accept html dom elements. Please stop passing in Ext Elements."),a.dom):a};this.addCKEditorAsync=function(a,b,d,g,h){if(this.checkIfCKEditorExists()&&!Sfdc.userAgent.isIE8&&!Sfdc.userAgent.isIE7&&!Sfdc.userAgent.isIE6){var f=this.getCKEditorInstance(a.id);
if(f&&"unloaded"==f.status)return f;CKEDITOR.plugins.get("chatterMention")||CKEDITOR.plugins.add("chatterMention",{requires:"widget",init:function(a){a.widgets.add("chatterMention",{draggable:!1,upcast:function(a){return"span"==a.name&&!Sfdc.isEmpty(a.attributes["data-mention"])}})}});var e=this,f="confighelper,chatterMention";Sfdc.userAgent.isIE11||(f+=",autogrow");f={language:UserContext.language.toLowerCase().replace(/_/g,"-"),height:85,readOnly:!1,resize_enabled:!1,extraPlugins:f,autoGrow_minHeight:85,
autoGrow_bottomSpace:25,forceSimpleAmpersand:!0,entities:!1,bodyClass:"chatterPublisherRTE",shiftEnterMode:CKEDITOR.ENTER_P,format_p:{element:"p",attributes:{"class":"normalPara"}},toolbar:[{name:"basicstyles",groups:["basicstyles","cleanup"],items:["Bold","Italic","Underline","Strike","RemoveFormat"]},{name:"paragraph",groups:["list"],items:["NumberedList","BulletedList"]}],toolbarLocation:"bottom",disableNativeSpellChecker:!1,allowedContent:"p b i u ul ol li s",extraAllowedContent:"span[!data-mention]",
coreStyles_bold:{element:"b",overrides:"strong"},coreStyles_italic:{element:"i",overrides:"em"},on:{mode:function(a){if(Sfdc.userAgent.isIE9||Sfdc.userAgent.isIE10)a=a.editor,a=a.editable?a.editable():"wysiwyg"==a.mode?a.document&&a.document.getBody():a.textarea,"\x3cp\x3e\x3c/p\x3e"===a.getHtml()&&a.setHtml("\x3cp\x3e\x26nbsp;\x3c/p\x3e")},instanceReady:function(a){a=a.editor;var c=a.document.$;Sfdc.userAgent.isIE&&c.execCommand("AutoUrlDetect",!1,!1);for(var b=["p","ol","ul"],f=0;f<b.length;f++)a.dataProcessor.writer.setRules(b[f],
{breakBeforeOpen:!1,breakAfterOpen:!1,breakBeforeClose:!1,breakAfterClose:!1});h&&e.focusAtEndOfTextOnCKEditor(a,g);Sfdc.isFunction(d)&&d(a);c.ondrop=function(a){a.preventDefault()}},paste:function(a){var c=a.data.dataValue,b={$1:{elements:CKEDITOR.dtd,attributes:!0,styles:!0,classes:!0}},d=new CKEDITOR.filter;d.allow(b);d.addTransformations([[{element:"br",right:function(a,c){CKEDITOR.filter.transformationsTools.transform(a,"p")}}]]);b=new CKEDITOR.htmlParser.basicWriter;c=CKEDITOR.htmlParser.fragment.fromHtml(c);
d.applyTo(c);c.writeHtml(b);a.data.dataValue=b.getHtml();d.destroy()}}};if(b)for(var l in b)f[l]=b[l];a=CKEDITOR.replace(a,f);a.config.removePlugins="elementspath,magicline,resize,liststyle,tableselection,tabletools,contextmenu";b="body.chatterPublisherRTE {padding: 8px; margin: 0; font-size: "+this.getChatterFontSizeForCKEditor()+";}";l="body.chatterPublisherRTE ul, body.chatterPublisherRTE ol {margin-top: 0em; } body.chatterPublisherRTE li { list-style: inherit; display: list-item; } body.chatterPublisherRTE ol \x3e li { list-style-type: decimal; }";
l+=" body.chatterPublisherRTE ul \x3e li { list-style-type: disc; }";CKEDITOR.addCss(b+" body.chatterPublisherRTE p, body.chatterPublisherRTE ul, body.chatterPublisherRTE ol {margin:0; line-height: 16px; } "+l);CKEDITOR.addCss("body p {margin:0 !important;}");return a}};this.destroyCKEditor=function(a){if(a=this.getCKEditorInstance(a))try{a.destroy()}catch(b){this.destroyUnstableCKEditor(a)}};this.destroyUnstableCKEditor=function(a){Sfdc.Dom.removeChild(Sfdc.get(a.container.getId()));delete CKEDITOR.instances[a.name]};
this.showOrRemoveCKEditorErrorBackground=function(a,b){a&&a.editable()&&(b?a.editable().setStyle("background-color","#fce8e8"):a.editable().removeStyle("background-color","#fce8e8"))};this.checkIfCKEditorExists=function(){return"undefined"!==typeof CKEDITOR};this.getCKEditorInstance=function(a){return!this.checkIfCKEditorExists()?null:CKEDITOR.instances[a]};this.onCkEditorInstanceReady=function(a,b,d){if("ready"===a.status)b.call(d);else a.on("instanceReady",function(a){b.call(d||this)})};this.focusAtEndOfTextOnCKEditor=
function(a,b){if(!b){a.focus();var d=a.createRange();d&&(d.moveToElementEditEnd(d.root),a.getSelection().selectRanges([d]))}};this.getDataFromCKEditor=function(a){var b="",d=new CKEDITOR.filter(a.config.allowedContent+"; "+a.config.extraAllowedContent),g=new CKEDITOR.htmlParser.basicWriter;try{var f=CKEDITOR.htmlParser.fragment.fromHtml(a.getData());d.applyTo(f);f.writeHtml(g);b=g.getHtml()}catch(h){Sfdc.log(h)}return b.replace(/(<p>&nbsp;<\/p>$)/,"").replace(/[\u200B-\u200D\uFEFF]/g,"")};this.getChatterFontSizeForCKEditor=
function(){var a="12px",b=Sfdc.get("publishereditablearea")||Sfdc.get("quickActionFeedBodyInput");b&&(a=getComputedStyle(b).fontSize);return a};this.getPlainTextData=function(a){var b=document.createElement("div");b.innerHTML=a;return Sfdc.Dom.getText(b)};this.getCKEIframeDomEl=function(a){return Sfdc.get(".cke_wysiwyg_frame",a.container.$)};this.getCKEditorDomEl=function(a){a=this.getCKEIframeDomEl(a);return Sfdc.get(".cke_editable",a.contentWindow?a.contentWindow.document:a.contentDocument)};this.linkDetectionAndPublisherSwitch=
function(a){if(a=this.checkIfStringIsALink(a)){var b=chatter.getPublisher().getHandler("TextPost");a!=b.config.lastPastedLink&&(b.config.lastPastedLink=a,chatter.getPublisher().openTypeSpecificPanel(Sfdc.get("publisherAttachLinkPost"),"LinkPost"))}};this.checkIfStringIsALink=function(a){if(a&&(a=a.trim(),-1===a.indexOf(" ")&&(0===a.indexOf("http://")||0===a.indexOf("https://")||0===a.indexOf("ftp://"))))return a}}function z(b){function d(){var b=chatter.getToolbox();if(0==a.intervalCount){if(a.index>=
a.intervals.length){a.run=!1;b.log("Ending polling sequence: "+a.configName);return}var e=a.intervals[a.index++];a.currentInterval=e[0];a.intervalCount=e[1]}a.intervalCount--;b.log("Polling timeout: "+a.configName+" \x3c"+a.currentInterval+"\x3e");a.pollerId=setTimeout(function(){b.log("Polling: "+a.configName);a.config.callback()&&a.run?d():b.log("Ending polling sequence: "+a.configName)},1E3*a.currentInterval)}var a=this;this.config=b;this.configName=b.name||(new Date).getTime();this.index=0;this.run=
!0;this.intervals=b.intervals||[[90,-1]];this.currentInterval=90;this.intervalCount=-1;this.pollerId=null;this.start=function(){if(!a.pollerId){chatter.getToolbox().log("Starting to poll: "+a.configName);a.index=0;a.run=!0;var b=a.intervals[a.index++];a.currentInterval=b[0];a.intervalCount=b[1];d()}};this.stop=function(){a.pollerId&&(chatter.getToolbox().log("Stopping polling of: "+a.configName),clearTimeout(a.pollerId),a.pollerId=null)}}function B(){var b=function(b){b=Ext.get(b).parent(".cxchattertextareacontainer");
return{parent:b,messageContainer:b.child(".cxchattermessagecontainer")}};this.enableSubmitButtonIfNoErrorsInternal=function(b,a){var f=Sfdc.Dom.getParent(b,".feeditemcommentnew");0===Sfdc.select(".cxchattertextareaerror",f).length&&u.enableButton(a)};this.isMessageDisplayed=function(b,a){return!!Ext.get(b+"_"+a)};this.showMessage=function(d){var a=d.el,f=chatter.getToolbox(),e=b(a),a=a+"_"+d.msg_id,g=document.getElementById(a);g||(g=document.createElement("div"),g.id=a,1==d.type?(g.className="cxchattertextareaerror chattertextareaerror",
e.parent.addClass("chattertextareahaserror")):g.className="chattertextareanotice",d.append||(e.messageContainer.dom.innerHTML=""),g.innerHTML=d.msg_html,e.messageContainer.appendChild(g));f.show(e.messageContainer);return g.id};this.hideMessage=function(d){var a=d.el,f=b(a),e=!0,g=d.hideAll||!1;if((d=document.getElementById(a+"_"+d.msg_id))||g)return a=chatter.getToolbox(),g?(Sfdc.Dom.setText(f.messageContainer.dom,""),a.hide(f.messageContainer),e=!1):(Ext.fly(d).remove(),0===f.messageContainer.query(".cxchattertextareaerror").length&&
(e=!1,0===f.messageContainer.query("div").length&&a.hide(f.messageContainer))),e||f.parent.removeClass("chattertextareahaserror"),e}}function P(){this.NODE_TYPES={ELEMENT:1,ATTRIBUTE:2,TEXT:3,CDATA_SECTION:4,ENTITY_REFERENCE:5,ENTITY:6,PROCESSING_INSTRUCTION:7,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,NOTATION_NODE:12};this.insertBreak=function(){if(document.selection){var b=document.selection.createRange();b.pasteHTML("\x3cbr/\x3e");b.moveEnd("character",1);b.collapse();b.select()}};
this.isText=function(b){return b.nodeType===this.NODE_TYPES.TEXT};this.isBreak=function(b){var d,a;try{if(d=(new String(b.nodeName)).toUpperCase(),a=b.nodeType,"BR"==d||"BR"==a)return!0}catch(f){}return!1};this.getContentValue=function(b){for(var d="",a=this.NODE_TYPES,f=a.TEXT,e=a.CDATA_SECTION,a=a.COMMENT,g=0,h=b.length;g<h;g++){var l=b[g];l.nodeType===f||l.nodeType===e?d+=l.nodeValue:this.isBreak(l)?d+="\n":this.isMention(l)?d+="{@"+l.name+"}":l.nodeType!==a&&(d+=this.getContentValue(l.childNodes))}return d};
this.toArray=function(b){for(var d=[],a=0,f=b.length;a<f;a++)d[a]=b[a];return d};this.getText=function(b){for(var d="",a=this.NODE_TYPES,f=a.TEXT,e=a.CDATA_SECTION,a=a.COMMENT,g=0,h=b.length;g<h;g++){var l=b[g];l.nodeType===f||l.nodeType===e?d+=l.nodeValue:l.nodeType!==a&&(d+=this.getText(l.childNodes))}return d};this.getCaretLocation=function(b){if("number"===typeof b.selectionStart)return b.selectionStart;if(document.selection){b.focus();var d=document.selection.createRange();if(null==d)return 0;
var a=b.value.replace(/(\r\n)+$/,""),f=d.duplicate();f.moveToElementText(b);f.setEndPoint("StartToStart",d);return a.length-f.text.length}return 0};this.setCaretLocation=function(b,d){if(document.selection){var a=b.createTextRange();a.collapse(!0);a.moveEnd("character",d);a.moveStart("character",d);a.select()}else if(b.selectionStart||"0"==b.selectionStart)b.selectionStart=d,b.selectionEnd=d,b.focus()};this.getValue=function(b){return b.value}}function Q(){var b=new Sfdc.Event.EventManager;b.onError=
function(b){Sfdc.sendGack("CHATTEREVENTBUS",b)};this.addEventListener=function(d,a,f,e){b.add(this,d+":"+a,f,e||this)};this.fireEvent=function(d,a,f){var e=chatter.getToolbox().now();b.fireEvent(this,d+":"+a,{data:f});var g=chatter.getToolbox().now(),h=q();h.append("CEB EVENT! ns\x3c");h.append(d);h.append("\x3e en\x3c");h.append(a);h.append("\x3e pld\x3c");h.append(f);h.append("\x3e exec-time\x3c");h.append(g-e);h.append("\x3e");chatter.getToolbox().log(h.toString())};this.removeEventListener=function(d,
a,f){b.remove(this,d+":"+a,f)}}function w(b){var d=this;this.config=b;this.id=b.id;this.title=b.title||"";this.url=b.url;this.content="";this.height=b.height||400;this.width=b.width||500;this.extraClass=b.extraClass;this.isAbsolutePositioned=this.isDialogPositionAbsolute=b.isDialogPositionAbsolute;Sfdc.userAgent.isIE6||(this.useCSS=!0);this.closeDialog=function(){var a=(UserContext.isAccessibleMode?window.opener?window.opener:window.parent:window).sfdcPage.getDialogById(d.id);return a?a.cancel():
void 0};this.open=function(){var a={i:d.subjectId};if(this.config.params)for(var b in this.config.params)a[b]=this.config.params[b];chatter.getToolbox();chatter.getToolbox().get({url:d.url,params:a,success:function(a,b){chatter.getEventBus().fireEvent("chatter:modalOverlay","onBeforeOverlayShown",{});d.content=b.html;d.display();if(Sfdc.isFunction(d.config.onShow))d.config.onShow()},failure:function(a,b){b&&!b.errormessage&&Dialogs.showSimpleError("",LC.getLabel("Feeds","GenericFailureNoGack"),null)}});
if(this.config.onOpen)this.config.onOpen(d.id)};this.positionTop=function(){if(this.isDialogPositionAbsolute&&!UserContext.isAccessibleMode){(Sfdc.userAgent.isFirefox?document.body.style:document.documentElement.style).overflow=Sfdc.userAgent.isIE7?"":"visible";var a=Sfdc.Window.getScrollY(),b=Sfdc.Dom.getHeight(this.dialog),d=Sfdc.Window.getWindowHeight(),a=Math.max(d-b,10)/2+a;Sfdc.Dom.setStyles(this.dialog,{top:a+"px",marginTop:"0px"})}}}function R(){this.toggle=function(b,d){var a=Ext.get(b),
f=chatter.getToolbox();if(a){var e=a.dom.getAttribute("entityid");if(e){f.mask(a);var g=!0;a.hasClass("unfollow")&&(g=!1);var h=this;f.post({url:"/subscriptions/"+e+(g?";new":";delete"),params:{entityid:e},failure:function(){f.unmask(a)},success:function(b,e){a&&(f.unmask(a),h.updateFollowActionLink(g,a.dom),d&&Ext.isFunction(d)&&d(b,e));return!1}})}}};this.updateFollowActionLink=function(b,d){var a=Ext.get(d);a.setVisible(!1);b?a.addClass("unfollow"):a.removeClass("unfollow");var f=a.dom.getAttribute("title"),
e=a.dom.getAttribute("revtitle");f&&e&&a.set({title:e,revtitle:f});a.setVisible(!0)}}function S(){this.wire=function(b){var d=function(a,d){if(d.followersHtml&&d.entityId==b){var e=Ext.select("."+b).filter(".followers");e&&e.hasClass("followers")&&e.replaceWith({html:d.followersHtml})}};chatter.getEventBus().addEventListener("chatter:FollowUnfollow","onAfterFollow",d);chatter.getEventBus().addEventListener("chatter:FollowUnfollow","onAfterUnfollow",d)}}function T(){this.deleteProfilePhoto=function(b){Dialogs.showSimpleConfirmation("",
LC.getLabel("UserProfilePage","ConfirmPhotoDelete"),function(){var d=chatter.getToolbox();d.log("delete photo for subject id: "+b);d.post({url:"/profilephoto/"+b+";delete",success:function(){window.location.reload()},failure:function(a,b){b.reloadOnFail&&window.loation.reload()}})})}}function U(b,d,a){var f=this;this.pollForPhotoTimeout=function(){clearTimeout(f.timeoutId);chatter.getToolbox().navigateTo(a)};this.pollForPhoto=function(){var g=chatter.getToolbox(),h=g.now()-e;Ext.Ajax.request({url:g.sitePrefix()+
g.apiurl()+"/pollphotoresize/"+b,method:"GET",params:{timeElapsed:h,token:g.token()},success:function(b){200==b.status?(clearTimeout(f.timeoutId),window.opener?(window.opener.closeDialog(!1),window.opener.location=d):(window.parent.closeDialog(!1),window.parent.location=d)):202==b.status?setTimeout("chatter.getPhotoPoller().pollForPhoto()",1E3):(clearTimeout(f.timeoutId),window.location=a)},failure:function(){clearTimeout(f.timeoutId);window.location=a}})};var e=u.now();setTimeout("chatter.getPhotoPoller().pollForPhoto()",
1E3);f.timeoutId=setTimeout("chatter.getPhotoPoller().pollForPhotoTimeout()",6E4)}function V(){function b(){if(Ext.fly("chatterFile"+f)){var a=Ext.fly("chatterFile"+f).dom.value;return a&&""!=a}return!0}var d=chatter.getToolbox(),a=!1,f="",e=new function(){this.decode=function(a){var b=[],d,f,e="",k,m="",c=0;a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");do d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".indexOf(a.charAt(c++)),f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".indexOf(a.charAt(c++)),
k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".indexOf(a.charAt(c++)),m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".indexOf(a.charAt(c++)),d=d<<2|f>>4,f=(f&15)<<4|k>>2,e=(k&3)<<6|m,b.push(String.fromCharCode(d)),64!=k&&b.push(String.fromCharCode(f)),64!=m&&b.push(String.fromCharCode(e));while(c<a.length);a=b.join("");b="";for(m=k=0;k<a.length;)m=a.charCodeAt(k++),128>m?b+=String.fromCharCode(m):191<m&&224>m?(c=a.charCodeAt(k++),b+=String.fromCharCode((m&
31)<<6|c&63)):(c=a.charCodeAt(k++),d=a.charCodeAt(k++),b+=String.fromCharCode((m&15)<<12|(c&63)<<6|d&63));return b}};this.setDialogAppendix=function(a){f=a};this.resetDialogAppendix=function(){f=""};this.createFromContentHubDocument=function(a,b,d){var f=a.indexOf(":"),e=a.substring(0,f),k=a.substring(f+1);a=chatter.getToolbox().sitePrefix()+chatter.getToolbox().apiurl()+"/chatterfile/";f=b.lastIndexOf(".");b={fileName:0<f?b.substring(0,f):b,desc:"",fileFullName:b,chubRepositoryId:e,chubDocumentId:k,
chubCreateAsExternalFile:d,shareOption_upload:"lst"};this.createUploadFormIfMissing();d={failureHandler:Sfdc.AccessibleUploadFileDialog.getFailureAndErrorHandler(),errorHandler:Sfdc.AccessibleUploadFileDialog.getFailureAndErrorHandler(),successHandler:Sfdc.AccessibleUploadFileDialog.getSuccessHandler()};this.upload(a,b,d)};this.createUploadFormIfMissing=function(){var a="chatterFileForm"+f;Ext.getDom(a)||Ext.DomHelper.append(Ext.getBody(),"\x3cform style\x3d'display:none' id\x3d'"+a+"'\x3e\x3cinput type\x3d'file' name\x3d'file'/\x3e\x3c/form\x3e",
!1)};this.upload=function(a,b,e,k){b=b||{};window.checkSessionTimeout&&checkSessionTimeout();var q=this,s=b.fileName||Ext.get("fileName"+f).getValue(),m=b.desc||""==b.desc||Ext.get("desc"+f).getValue(),c=b.fileFullName||Ext.get("chatterFile"+f).getValue(),p=c.lastIndexOf("."),r="";-1<p&&(r=c.substring(p));var n;n=b.chubRepositoryId?ExternalFileProgressDialog.showOnPostFile("extFileProgress",b.chubCreateAsExternalFile):FeedPostContentUploadDialog.getDialog("uploadProgressDialog",chatter.getToolbox().htmlEncode(s),
chatter.getToolbox().htmlEncode(r),k);n.show();b.token=d.token();b.fileName=s;b.desc=m;var v=!0,t=(k=Ext.getDom("shareOptionPRIVATE"))?k.checked:!1;k=document.getElementById("chatterFileForm"+f)?"chatterFileForm"+f:Ext.get("chatterFile"+f).dom.form;Ext.Ajax.request({url:a,params:b,isUpload:!0,form:k,method:"POST",failure:function(){v=!1;n.hide()},success:function(a){if(a.responseText){v=!1;n.hide();var b=a.responseText.replace(/\r/g,"\n");0==b.indexOf("\x3cpre")&&(b=b.replace(/^<pre[^>]*>/,"").replace(/<\/pre>$/,
""));b.substring(0,AjaxServlet.CSRF_PROTECT.length)!==AjaxServlet.CSRF_PROTECT&&0<=b.indexOf("/img/s.gif")||(!a.responseXML||chatter.isInvalidSession(a.responseXML.location+"")?chatter.getToolbox().refresh():(b=d.evalJson(b),b.html=b.html&&q.getBase64Decoder().decode(b.html),"Failure"===b.message?e&&e.failureHandler&&e.failureHandler.call(this,a,b):"Error"===b.message?(b.errormessage=b.errormessage&&q.getBase64Decoder().decode(b.errormessage),e&&e.errorHandler?e.errorHandler.call(this,a,b):d.xhrFailure(a,
b)):b.errormessage?e&&e.errorHandler?e.errorHandler.call(this,a,b):d.xhrFailure(a,b):e&&e.successHandler&&e.successHandler.call(this,a,b,t,c)))}}});(function(){v&&Ext.Ajax.request({url:a,method:"POST",failure:function(a,b){v=!1},success:function(a,b){d.handleRedirect(a)}})}).defer(1E4)};this.initValidation=function(d,e,k,q){var s=!e,n=e||Ext.get("fileName"+f),m=k||Ext.get("desc"+f),c=q||Ext.get("reason"+f),p=chatter.getToolbox(),r=p.getElementErrorContainer(m),t=p.getElementErrorContainer(n);p.updateHTML(r,
"");p.updateHTML(t,"");var v;c&&(v=p.getElementErrorContainer(c),p.updateHTML(v,""));var u=LC.getLabel("Publisher","postValueMaxLen",255),w=LC.getLabel("Publisher","postFileNameRequired"),B=LC.getLabel("Publisher","postContentDescriptionMaxLen",1E3),y=LC.getLabel("ChatterFileSharing","postWhatChangedMaxLen",1E3),z=function(){var a=p.stringTrim(n.getValue()).length,e=p.stringTrim(m.getValue()).length,f=p.validateElement(t,function(){return 0<a},w)&&p.validateElement(t,function(){return 255>=a},u)&&
p.validateElement(r,function(){return 1E3>=e},B);if(c)var h=p.stringTrim(c.getValue()).length,f=f&&p.validateElement(v,function(){return 1E3>=h},y);f=f&&b();d&&d.call(this,f)};e=function(){a=!0;return z()};chatter.getToolbox().wireFieldChange(n,e,!0);chatter.getToolbox().wireFieldChange(m,z,!0);k=function(){(!s||b())&&z()};n.on("blur",k);m.on("blur",k);c&&chatter.getToolbox().wireFieldChange(c,e);n.focus()};this.reset=function(b,d,e){this.initFields(d,e);a=d?!0:!1;this.resetFileSelectPanel(b);b=Ext.get("slideDownError_chatterFileStageTwo");
null!==b&&b.setDisplayed(!1);b=Ext.get("slideDownError_chatterLinkPost");null!==b&&b.setDisplayed(!1)};this.initFields=function(a,b){Ext.fly("chatterFile"+f).dom.value="";Ext.fly("fileName"+f).dom.value=a||"";Ext.fly("desc"+f).dom.value=b||"";Ext.fly("reason"+f)&&(Ext.fly("reason"+f).dom.value="");Ext.getDom("shareOptionPUBLIC")&&(Ext.getDom("shareOptionPUBLIC").checked=!0)};this.fileInfoUpdate=function(){var b=Ext.get("fileName"+f),e=""==b.dom.value;Ext.fly("hiddenFileName"+f).dom.value=Ext.fly("chatterFile"+
f).dom.value;if(!a||e){var k=Util.getFileNameFromFileInputUsingJS(Ext.fly("chatterFile"+f).dom),k=Util.convertPathToTitle(k);b.dom.value=k.name;b=d.getElementErrorContainer(b);d.updateHTML(b,"");e&&(a=!1)}};this.resetFileSelectPanel=function(a){var b=this,d={id:"chatterFile"+f,name:"chatterFile"+f,tag:"input",cls:"file",type:"file",size:20};Ext.fly("chatterFile"+f).replaceWith(d);d=Ext.fly("chatterFile"+f);d.dom.onchange=function(){b.fileInfoUpdate();a&&a.call(this,!0)}};this.getBase64Decoder=function(){return e}}
var W=new function(){function b(){return Ext.get("recentFilesPanel")}this.refresh=function(d){b().replaceWith({html:d})};this.isWidgetPresent=function(){return null!==b()};this.getEntityId=function(){return b().child(".entityId").dom.innerHTML}},u,C,D,E,F,G,H,I,J,K,L,M,N,y=this,X={addFavorite:"add-favorite",follow:"follow",filterByTopic:"filter-by-topic",inviteCoWorkers:"invite-coworkers",invite:"invite",inviteSuccess:"invite-success",joinGroupsSplash:"join-groups-splash",joinGroup:"join-group",post:"post",
postFile:"post-file",postLink:"post-link",postComment:"post-comment",postThanks:"post-thanks",removeFavorite:"remove-favorite",showListView:"show-list-view",showDropdownFilter:"show-dropdown-filter",showMainFilter:"show-main-filter",unfollow:"unfollow",unjoinGroup:"unjoin-group"};this.extend=function(b,d,a){function e(){var a=b.charAt(0);return a!==a.toUpperCase()?(g+="\n name has to start with a capital letter.",!1):!0}var k="ext_"+b,g="Error extending "+b,h;y.hasOwnProperty("get"+b)?(g+="\n'"+k+
"' already exists in the chatter object",h=!0):h=!1;!h&&e()?y["get"+b]=function(){y[k]||(y[k]=new d(a));return y[k]}:Dialogs.showSimpleError("",g,null)};this.getPageTitleController=function(){M||(M=new k);return M};this.getAutoShowOlder=function(){L||(L=new r);return L};this.createModalOverlay=function(b){return new w(b)};this.getFeedFavoriteHelper=function(){N||(N=new e);return N};this.getRecentFiles=function(){return W};this.isInvalidSession=function(b){return b.match("ec\x3d302")};this.getToolbox=
function(){u||(u=new n);return u};this.getTextareaMessageUtil=function(){D||(D=new B);return D};this.getTextUtil=function(){C||(C=new P);return C};this.getEventBus=function(){E||(E=new Q);return E};this.getModalOverlay=function(b){var d=window[b];if((!d||!d.closeDialog)&&window.opener)d=window.opener[b];return d};this.getFeedUpdatesMessage=function(){K||(K=new t);return K};this.getFollowUnfollowListAction=function(){F||(F=new R);return F};this.getFollowersPanel=function(){H||(H=new S);return H};this.getProfilePhoto=
function(){G||(G=new T);return G};this.getPhotoPoller=function(b,d,a){I||(I=new U(b,d,a));return I};this.getFileUploader=function(){J||(J=new V);return J};this.isFeedVisible=function(){var b=Sfdc.get(".feedcontainer");return b?Sfdc.Dom.isVisible(b,!0):!1};this.notifyFrameActive=function(){if(Ext.isGecko){var b=Ext.get("chatterexpando").dom;if("none"!=b.style.display){var d=document.createElement("div");b.parentNode.insertBefore(d,b);d.appendChild(b);d.parentNode.insertBefore(b,d);Ext.removeNode(d)}}};
this.getOmnitureEventMap=function(){return X};this.onDeferLoad=function(b){Sfdc.on(this,"chatter:onDeferLoad",b)};w.prototype=new AccessibleDialog({});w.prototype.display=function(){if(!UserContext.isAccessibleMode)var b=this.createContent();this.show();Sfdc.Dom.isElement(b)&&Sfdc.Resource.execScripts(Sfdc.Resource.getScriptsFromHtml(b));this.positionTop()};w.prototype.hide=function(){AccessibleDialog.prototype.hide.call(this);if(this.config.onClose)this.config.onClose(this.id)};w.prototype.getContent=
function(){return this.content};w.prototype.writeAccessiblePopupHeaderIncludes=function(b){if(this.config.jsLibs)for(var d=0;d<this.config.jsLibs.length;d++)b.write('\x3cscript src\x3d"'),b.write(this.config.jsLibs[d]),b.writeln('" type\x3d"text/javascript"\x3e\x3c/script\x3e')};var Y=new function(){var b=[];this.addUrlObserver=function(d){if(!Ext.isFunction(d))throw Error("A URL observer must be a function and instead is a "+typeof d+". Wit documentation.");b.push(d)};this.getUrlObservers=function(){return b}};
this.getConfig=function(){return Y}};UserPanelAccessibleUrlDialog=function(k,e,r,t,q){var n=this;this.id=k;this.title=e;this.url=r;this.subjectId=t;this.content="";this.height=q;this.width=0;this.open=function(){chatter.getToolbox().get({url:n.url,params:{i:n.subjectId,dialogId:n.id},success:function(e,k){n.content=k.html;n.display()}})}};UserPanelAccessibleUrlDialog.prototype=new AccessibleDialog({});UserPanelAccessibleUrlDialog.prototype.getContent=function(){return this.content};
UserPanelAccessibleUrlDialog.prototype.display=function(){UserContext.isAccessibleMode||this.createContent();this.show()};GroupListAccessibleUrlDialog=function(k,e,r,t,q){var n=this;this.id=k;this.title=e;this.url=r;this.subjectId=t;this.content="";this.height=q;this.width=0;this.open=function(){chatter.getToolbox().get({url:n.url,success:function(e,k){n.content=k.html;n.display()}})}};GroupListAccessibleUrlDialog.prototype=new AccessibleDialog({});
GroupListAccessibleUrlDialog.prototype.getContent=function(){return this.content};GroupListAccessibleUrlDialog.prototype.display=function(){UserContext.isAccessibleMode||this.createContent();SfdcApp.ChatterGroupMembership.setCurrentUserProfileId(this.subjectId);this.show()};
GroupListAccessibleUrlDialog.prototype.hide=function(){AccessibleDialog.prototype.hide.call(this);var k=Ext.get("groupListPanel");k&&chatter.getToolbox().get({url:"/user/"+this.subjectId+"/grouplistpanel",success:function(e,r){Ext.DomHelper.insertBefore(k,r.html);k.remove()}});SfdcApp.ChatterGroupMembership.setCurrentUserProfileId("")};Ext.ns("Sfdc.Chatter");
Sfdc.Chatter.TutorialWindow=function(k,e){var r=LC.getLabel("CSNWelcomeMessage","videoTitle"),t=e?e:635,q;Sfdc.Chatter.TutorialWindow.dialogInstance?q=Sfdc.Chatter.TutorialWindow.dialogInstance:(q=Sfdc.Chatter.TutorialWindow.dialogInstance=new VideoDialog("Sfdc.Chatter.TutorialWindow",!1),q.displayX=!0,q.setTitle(r),q.setWidth(840),q.register());this.show=function(){q.setContentInnerHTML(String.format('\x3ciframe width\x3d"{0}" height\x3d"{1}" src\x3d"{2}" frameborder\x3d"no" scrolling\x3d"no"\x3e',
810,t,k));q.show()};this.hide=function(){q.hide()}};
Sfdc.Chatter.ChatterDesktopWindow=function(k){var e;Sfdc.Chatter.ChatterDesktopWindow.dialogInstance?e=Sfdc.Chatter.ChatterDesktopWindow.dialogInstance:(e=Sfdc.Chatter.ChatterDesktopWindow.dialogInstance=new SimpleDialog("Sfdc.Chatter.ChatterDesktopWindow",!1),e.displayX=!0,e.setTitle("Chatter Desktop"),e.setWidth(728),e.register());this.show=function(){e.setContentInnerHTML(String.format('\x3ciframe width\x3d"{0}" height\x3d"{1}" src\x3d"{2}" frameborder\x3d"no"\x3e',705,500,k));e.show()};this.hide=
function(){e.hide()}};
Sfdc.Chatter.ChatterMobileWindow=function(k){var e;Sfdc.Chatter.ChatterMobileWindow.dialogInstance?e=Sfdc.Chatter.ChatterMobileWindow.dialogInstance:(e=Sfdc.Chatter.ChatterMobileWindow.dialogInstance=new SimpleDialog("Sfdc.Chatter.ChatterMobileWindow",!1),e.displayX=!0,e.setWidth(632),e.register());this.show=function(){e.setContentInnerHTML(String.format('\x3ciframe id\x3d"getChatterMobileIFrame" width\x3d"{0}" height\x3d"{1}" src\x3d"{2}" frameborder\x3d"0" scrolling\x3d"no"\x3e',600,520,k));e.show()};
this.hide=function(){e.hide()}};
var topicForm=new function(){var k=chatter.getToolbox();this.onKeyUpNameField=function(e){k.validateTextFieldLength(e,{maxlength:255,msg:LC.getLabel("TopicPage","nameExceedsMaxLength",255)})};this.onKeyUpDescriptionField=function(e){k.validateTextFieldLength(e,{maxlength:1E3,msg:LC.getLabel("TopicPage","descriptionExceedsMaxLength",1E3)})}},requestdeclineform=new function(){var k=chatter.getToolbox();this.onKeyUpResponseMessageField=function(e){k.validateTextFieldLength(e,{maxlength:255,msg:LC.getLabel("ChatterGroups",
"declinedMessageExceedsMaxLengthJs",255)})}};Ext.ns("Sfdc.Feed.ViewFileConfirmDialog");Sfdc.Feed.ViewFileConfirmDialog=function(k){this.id=k.id;this.docId=k.docId;this.fileName=k.fileName;this.subjectName=k.subjectName;this.windowName=id;this.setupDefaultButtons();this.addEvents();this.buttonContents=this.contents="";this.hasButtonsBar=!0};Ext.extend(Sfdc.Feed.ViewFileConfirmDialog,OverlayDialogElement);Sfdc.Feed.ViewFileConfirmDialog.ID="viewFileConfirmDialog";
Sfdc.Feed.ViewFileConfirmDialog.showIt=function(k){var e=null;document.getElementById(Sfdc.Feed.ViewFileConfirmDialog.ID)?(e=OverlayDialogElement.getDialog(Sfdc.Feed.ViewFileConfirmDialog.ID),e.fileName=k.fileName,e.subjectName=k.subjectName):(k.id=Sfdc.Feed.ViewFileConfirmDialog.ID,e=new Sfdc.Feed.ViewFileConfirmDialog(k),e.register());e.showDialog(k)};Sfdc.Feed.ViewFileConfirmDialog.closeIt=function(){OverlayDialogElement.getDialog(Sfdc.Feed.ViewFileConfirmDialog.ID).cancel()};
Sfdc.Feed.ViewFileConfirmDialog.prototype.showDialog=function(k){this.makeContent(k);this.createContent();this.setWidth(440);this.show()};
Sfdc.Feed.ViewFileConfirmDialog.prototype.makeContent=function(k){this.setTitle(LC.getLabel("Publisher","privatelyShareConfirmTitle"));var e=[];e.push('\x3cdiv class\x3d"confirmationMsgPanel"\x3e');var r=LC.getLabel("Publisher","privatelyShareConfirmMsg",this.fileName,this.subjectName);e.push('\x3cimg src\x3d"/s.gif" class\x3d"icon"\x3e\x3cdiv class\x3d"confirmationMsg"\x3e'+r+"\x3c/div\x3e");e.push("\x3c/div\x3e");this.contents=e.join("");e=[];e.push('\x3cinput type\x3d"button" value\x3d"');e.push(LC.getLabel("Publisher",
"viewFile"));e.push('" class\x3d"btn"');e.push(' onclick\x3d"Sfdc.Feed.ViewFileConfirmDialog.execute(');e.push("{docId: '");e.push(k.docId);e.push("'}");e.push(');"/\x3e');e.push('\x3cinput type\x3d"button" value\x3d"');e.push(LC.getLabel("Buttons","close"));e.push('" class\x3d"btn" onclick\x3d"Sfdc.Feed.ViewFileConfirmDialog.closeIt();"/\x3e');this.buttonContents=e.join("")};Sfdc.Feed.ViewFileConfirmDialog.execute=function(k){navigateToUrl("/"+k.docId)};
function ContentListViewport(v,k,l,w,K,x,m,y,z,A,B,C,D,E,q){function t(b,a,e,d,c,g,h){b={"ContentListViewport.entityId":b,ptype:"ftab",_CONFIRMATIONTOKEN:Sfdc.Cookie.getCookie("confFlag")};(h=F[a.replace("_notes","")])&&(b[h]=!0);if("ct"===h||a&&-1<a.indexOf("_notes"))b.contentTypes=z,b.contentTypes||(b.contentTypes=JSON.stringify({type:"SNOTE"})),b.ct=!0;if(n()){b.ptype="sfs";a:{if((a=(a=window.opener&&window.opener.chatter||parent.chatter||parent.opener&&parent.opener.chatter||window.chatter)&&
a.getPublisher&&a.getPublisher()||null)&&a.getHandler)if((a=a.getHandler("ContentPost"))&&a.getCurrentFeedParentId){a=a.getCurrentFeedParentId();break a}a=""}b.feedParentId=a}!0==e&&(b.isCustom=!0);d&&(b.customFilterParams=Sfdc.JSON.stringify(d));c&&(b.fldr=c);Sfdc.get("chatterListViewContainer")&&(b.ptype="ctab");"ContentVersionFlaggedFileSearch"==k&&(b.ptype="ncon");!0===g&&(b.cc="true");return b}function u(b,a,e,d,c){if(b)return b;b=null;switch(a){case "ContentVersionRecentlyViewedFileSearch":c&&
(b=LC.getLabel("ChatterFileListPage","findAllFilesWithFileSync"));break;case "ContentVersionSharedWithMeFileSearch":b=c?LC.getLabel("ChatterFileListPage","findFilesSharedWithMeWithFileSync"):LC.getLabel("ChatterFileListPage","findFilesSharedWithMe");break;case "ContentVersionAllUserFileSearch":b=LC.getLabel("ChatterFileListPage","searchMyFiles");break;case "ContentVersionFollowedFileSearch":b=c?LC.getLabel("ChatterFileListPage","findFilesIFollowWithFileSync"):LC.getLabel("ChatterFileListPage","findFilesIFollow");
break;case "ContentVersionMyGroupsFileSearch":b=LC.getLabel("ChatterFileListPage","findFilesInMyGroups");break;case "ContentVersionMyWorkspacesFileSearch":b=LC.getLabel("ChatterFileListPage","findAllFilesInMyLibraries");break;case "ContentVersionPersonalWorkspaceFileSearch":b=LC.getLabel("ChatterFileListPage","searchPersonalWorkspace");break;case "ContentVersionMyFoldersFileSearch":b=LC.getLabel("ChatterFileListPage","searchChatterbox");break;case "ContentVersionFileTypeSearch":b=LC.getLabel("ChatterNotesList",
"searchAllNotes");break;case "ContentVersionUserFileSearch":b=UserContext.userId==e?c?LC.getLabel("ChatterFileListPage","findFilesIOwnWithFileSync"):LC.getLabel("ChatterFileListPage","findFilesIOwn"):LC.getLabel("ChatterFileListPage","searchOwnedFiles");break;case "ContentVersionGroupFileSearch":case "ContentVersionWorkspaceFileSearch":b=LC.getLabel("ChatterFileListPage","searchInGroupOrWorkspace",d);break;case "ContentVersionFlaggedFileSearch":b=LC.getLabel("ChatterFileListPage","searchFlaggedFiles")}return b||
LC.getLabel("ChatterFileListPage","findAllFiles")}function r(b){switch(b||""){case "ChatterOrganizationContentSearchFilter":case "ChatterWorkspaceFilesSearchFilter":case "ChatterGroupFilesSearchFilter":case "ChatterUserFilesSearchFilter":case "ContentVersionOrganizationFileSearch":case "ContentVersionGroupFileSearch":case "ContentVersionUserFileSearch":case "ContentVersionWorkspaceFileSearch":case "ContentVersionPersonalWorkspaceFileSearch":case "ContentVersionFileSearch":case "ContentVersionSharedWithMeFileSearch":case "ContentVersionRecentlyViewedFileSearch":case "ContentVersionMyGroupsFileSearch":case "ContentVersionMyWorkspacesFileSearch":case "ContentVersionAllUserFileSearch":case "ContentVersionFollowedFileSearch":case "ContentVersionMyFoldersFileSearch":case "ContentVersionFlaggedFileSearch":case "ContentHubFileFilter":return!0}return!1}
function n(){return!!Sfdc.get("sfsContentWrapper")}function G(b,a){if(a.columns)for(var e=0;e<a.columns.length;e++)switch(a.columns[e].sortable=!1,a.columns[e].fieldName){case "actions":a.columns[e].className+=m?" simplified":"";break;case "type":a.columns[e].className+=r()?" narrow":"";break;case "following":switch(UserContext.initialized&&UserContext.language||""){case "de":case "fr":case "it":case "ru":className+=" medium";break;case "nl_NL":className+=" wide"}}var e=b.target.labels.listView,d=
c.viewType,f='\x3ca class\x3d"uploadFileLink" href\x3d"javascript: void(0);" onclick\x3d"{onclick}"\x3e{label}\x3c/a\x3e',g=Sfdc.String.format(f,{onclick:"Sfdc.AccessibleUploadFileDialog.open();",label:LC.getLabel("ChatterFilesTabPage","uploadingFileLinkText")}),f=Sfdc.ChatterFileUploader.isMultiFileUpload?Sfdc.ChatterFileUploader.isIEMultiFileUpload?LC.getLabel("ChatterFilesTabPage","uploadMultiFilesTextForIE"):Sfdc.String.format(f,{onclick:"document.getElementById(Sfdc.UploadButton.HIDDEN_MULTI_INPUT_ID).click();",
label:LC.getLabel("ChatterFilesTabPage","uploadMultiFilesLinkText")}):Sfdc.String.format(f,{onclick:"Sfdc.AccessibleUploadFileDialog.open();",label:LC.getLabel("ChatterFilesTabPage","uploadFileLinkText")});c.additionalParams&&(c.additionalParams.ct&&c.additionalParams.contentTypes&&-1<c.additionalParams.contentTypes.indexOf("SNOTE"))&&(d+="_notes");if(c.searchTerm)d="ContentVersionFileTypeSearch"===d?LC.getLabel("ChatterNotesList","noNotesFoundSearch"):LC.getLabel("ChatterFilesTabPage","noFilesFoundSearch");
else switch(d){case "ContentVersionRecentlyViewedFileSearch":d=LC.getLabel("ChatterFilesTabPage","noFilesFoundRecentlyViewed");break;case "ContentVersionRecentlyViewedFileSearch_notes":d=LC.getLabel("ChatterNotesTabPage","noNotesFoundRecentlyViewed");break;case "ContentVersionSharedWithMeFileSearch":d=m?LC.getLabel("ChatterFilesTabPage","noFilesFoundSharedWithMeSimple"):LC.getLabel("ChatterFilesTabPage","noFilesFoundSharedWithMe");break;case "ContentVersionSharedWithMeFileSearch_notes":d=m?LC.getLabel("ChatterNotesTabPage",
"noNotesFoundSharedWithMeSimple"):LC.getLabel("ChatterNotesTabPage","noNotesFoundSharedWithMe");break;case "ContentVersionGroupFileSearch":d=LC.getLabel("ChatterFilesTabPage","noFilesFoundGroup");break;case "ContentVersionOrganizationFileSearch":d=LC.getLabel("ChatterFilesTabPage","noFilesFoundAllFiles");n()||(d=m?d+(" "+LC.getLabel("ChatterFilesTabPage","noFilesFoundUploadSimple",f)):d+(" "+LC.getLabel("ChatterFilesTabPage","noFilesFoundUpload",f)));break;case "ContentVersionUserFileSearch":d=LC.getLabel("ChatterFilesTabPage",
"noFilesFoundFilesIOwn");n()||(d=m?d+(" "+LC.getLabel("ChatterFilesTabPage","noFilesFoundUploadSimple",f)):d+(" "+LC.getLabel("ChatterFilesTabPage","noFilesFoundUpload",f)));break;case "ContentVersionUserFileSearch_notes":d=LC.getLabel("ChatterNotesTabPage","noNotesFoundFilesIOwn");break;case "ContentVersionWorkspaceFileSearch":case "ContentVersionPersonalWorkspaceFileSearch":d=escapeHTML(LC.getLabel("ChatterFilesTabPage","noFilesFoundWorkspace"));break;case "ContentVersionFollowedFileSearch":d=LC.getLabel("ChatterFilesTabPage",
"noFilesFoundFilesIFollow");break;case "ContentVersionMyGroupsFileSearch":d=LC.getLabel("ChatterFilesTabPage","noFilesFoundMyGroups");break;case "ContentVersionMyWorkspacesFileSearch":d=escapeHTML(LC.getLabel("ChatterFilesTabPage","noFilesFoundMyWorkspaces"));break;case "ContentVersionAllUserFileSearch":d=m?LC.getLabel("ChatterFilesTabPage","noFilesFoundMyFilesSimple"):LC.getLabel("ChatterFilesTabPage","noFilesFoundMyFiles");n()||(d+=" "+LC.getLabel("ChatterFilesTabPage","noFilesFoundGetStarted",
g));break;case "ContentVersionMyFoldersFileSearch":d=LC.getLabel("ChatterFilesTabPage","noFilesFoundInFolder");break;case "ContentVersionFileTypeSearch":d=LC.getLabel("ChatterNotesList","noNotesFound");break;default:d=LC.getLabel("ChatterFilesTabPage","noFilesFound")}e.emptyMessage=d}function H(b,a){c&&a&&(null==c.additionalParams._CONFIRMATIONTOKEN&&(c.additionalParams._CONFIRMATIONTOKEN=Sfdc.Cookie.getCookie("confFlag")),1==a.searchTerm.replace(RegExp(UnifiedSearchUI.RESERVED_CHAR_REGEX,"g"),"").length&&
(Dialogs.showSimpleInfo("",LC.getLabel("ChatterFilesTabPage","searchTermHasTwoOrMore"),null),a.cancel=!0))}function I(b,a){var c=Sfdc.get(".listBody");if(c){var d=Sfdc.get(".sync",c);if(d)if(!0===s){if(c=Sfdc.get(".zen-data",c))c.className+=" hideSync",0===a.items.length&&(c=Sfdc.get(".emptyText",c))&&c.setAttribute("colspan",a.columns.length-1)}else d.title=LC.getLabel("FileSyncRemoveLink","syncColumnHeaderTooltip")}}function J(b,a,c){var d=Sfdc.get("000000000000000_topNav");d&&(a&&a.target&&a.target.viewType&&
a.target.additionalParams&&a.target.additionalParams.ct&&a.target.additionalParams.contentTypes&&-1<a.target.additionalParams.contentTypes.indexOf("SNOTE")?Sfdc.Dom.addClass(d,"hidden"):Sfdc.Dom.removeClass(d,"hidden"));b.labels.listView.errorMessage=c&&c.data&&c.data.displayErrorMessage?c.data.exDesc:LC.getLabel("List","error")||"No records to display."}Perf.mark("Sfdc.Content:Start");var g,c,p,s,F={ContentVersionRecentlyViewedFileSearch:"rv",ContentVersionPersonalWorkspaceFileSearch:"pw",ContentVersionSharedWithMeFileSearch:"sm",
ContentVersionMyGroupsFileSearch:"ag",ContentVersionMyWorkspacesFileSearch:"al",ContentVersionAllUserFileSearch:"auf",ContentVersionFollowedFileSearch:"ff",ContentVersionMyFoldersFileSearch:"fs",ContentVersionFileTypeSearch:"ct",ContentVersionFlaggedFileSearch:"flg",ContentVersionAllUserFileSearch_notes:"auf_notes",ContentVersionRecentlyViewedFileSearch_notes:"rv_notes",ContentVersionSharedWithMeFileSearch_notes:"sm_notes"};this.load=function(b,a,e,d,f,k,h,l,m,n,q){c&&(c.additionalParams=t(b,a,h,
l,void 0,n,q),c.viewType=a.replace("_notes",""),c.sortBy="",c.searchTerm="",c.currentPage=1,c.provide());if(!1===f||-1<a.indexOf("notes"))g.setNavigationVisible(!1);else{if(p&&p.length)for(f=0;f<p.length;f++)h=p[f],h.searchTerm="",h.setPlaceholder(k?k:u("",a,b,e,d)),h.setSearchButtonLabel(r(a)?LC.getLabel("Buttons","search"):LC.getLabel("Buttons","go")),h.update();g.setNavigationVisible(!0)}s=m};this.isFileSyncFilter=function(){return c&&!!c.additionalParams.fs};this.refresh=function(){if(c){var b=
c.items.length,a=c.currentPage;1<a&&1==b&&(a-=1);c.currentPage=a;c.provide()}};Sfdc.ns("Chatter.Files.ContentListViewport");Chatter.Files.ContentListViewport.INSTANCE=this;Sfdc.onload(function(){var b=u(x,k),a=y||"",b=Sfdc.String.format('\x3csfdc:listView class\x3d"FileListView {className}zen-listViewFixed"\x3e\x3cdata:provider type\x3d"ListServlet" pageSize\x3d"{pageSize}" resourceUri\x3d"{resourceUri}" viewType\x3d"{viewType}" additionalParams\x3d"{additionalParams}" autoProvide\x3d"false"\x3e\x3c/data:provider\x3e\x3cfacet:header\x3e\x3c/facet:header\x3e\x3cfacet:navigation\x3e\x3cui:searchbox className\x3d"zen-searchBox" labelText\x3d"" labelClass\x3d"zen-assistiveText" placeholder\x3d"{searchBoxPlaceholder}" title\x3d"{searchBoxTitle}" delay\x3d"1000" searchButtonLabel\x3d"{searchButtonLabel}" searchTerm\x3d"{searchTerm}" searchMode\x3d"explicit" maxLength\x3d"100"\x3e\x3c/ui:searchbox\x3e\x3c/facet:navigation\x3e\x3cfacet:footer\x3e\x3cui:pagerPageInfo\x3e\x3c/ui:pagerPageInfo\x3e\x3cui:pagerNextPrevious\x3e\x3c/ui:pagerNextPrevious\x3e\x3cui:pagerJumpToPage readOnly\x3d"true"\x3e\x3c/ui:pagerJumpToPage\x3e\x3c/facet:footer\x3e\x3c/sfdc:listView\x3e',
{additionalParams:Sfdc.String.escapeToHtml(Sfdc.JSON.stringify(t(w,k,B,C,D,!1,q))),className:n()?"SfsListView zen-listViewFixedHeader ":"",pageSize:l&&l.rowsPerPage||25,resourceUri:UserContext.getUrl("/_ui/core/chatter/content/FileListServlet"),viewType:k,searchBoxPlaceholder:Sfdc.String.escapeToHtml(b),searchBoxTitle:Sfdc.String.escapeToHtml(b),searchTerm:a,searchButtonLabel:r(k)?LC.getLabel("Buttons","search"):LC.getLabel("Buttons","go")}),e=Sfdc.get(v+"_listBody");Sfdc.Dom.updateHTML(e,b);SfdcCmp.init(e);
Sfdc.Cookie.setCookie("confFlag",q);g=SfdcCmp.findInstance(e,SfdcCmp.Sfdc.ListView);g.attach("onbeforesearch",H);g.attach("onbeforeupdate",G);g.attach("onupdate",I);l&&l.displayErrorMessage&&(g.labels.listView.errorMessage=l.exDesc);c=g.getProvider();c.attach("onreceive",J.bind(this,g));c.viewType=k;c.searchTerm=a;c.setPayload(l);s=E;p=SfdcCmp.findInstances(e,SfdcCmp.Ui.ISearchable,!0);!1===A&&g.setNavigationVisible(!1);Perf.endMark("Sfdc.Content:Start")})};
DirectMessageDialog={dialogs:{},showDialog:function(a,b){window.checkSessionTimeout&&checkSessionTimeout();DirectMessageDialog.getDialog(a,b).display()},getDialog:function(a,b){if(DirectMessageDialog.dialogs[a])return DirectMessageDialog.dialogs[a];var c="conversationComposeDialog"+a,d=null;Perf.mark(OverlayDialog.LOAD_MARK);d=UserContext.isAccessibleMode?new CollaborationAccessibleDialog(c,LC.getLabel("DirectMessage","sendMessageDialogTitle"),b,249,530):new NonaccessibleDialog(c,LC.getLabel("DirectMessage",
"sendMessageDialogTitle"),b,249,530);return DirectMessageDialog.dialogs[a]=d}};
var JoinGroupsSplash=new function(){this.joinGroup=function(b){this.takeAction(b,"joinGroup",!1)};this.leaveGroup=function(b){this.takeAction(b,"leaveGroup",!1)};this.createGroup=function(b){this.takeAction(b,"createGroup",!0)};this.goToGroupCreatePage=function(){chatter.getToolbox().post({url:"/chatterEditionSplash",params:{nextAction:"GoToGroupCreatePage"},success:function(b,d){navigateToUrl(d.url)}})};this.takeAction=function(b,d,g){var c=Ext.get("joinGroupsOverlay-"+b);c.dom.innerHTML='\x3cdiv class\x3d"inprogress"\x3e\x3cimg class\x3d"check" src\x3d"/s.gif"\x3e'+
LC.getLabel("Images","search_loading")+"\x3c/div\x3e";params={nextAction:d};params[g?"groupNumber":"groupId"]=b;chatter.getToolbox().post({url:"/chatterEditionSplash",params:params,success:function(d,a){c.dom.id="joinGroupsOverlay-"+a.groupId;if("true"==a.groupOwner)c.update('\x3cdiv class\x3d"owner"\x3e\x3cimg class\x3d"check" src\x3d"/s.gif"\x3e'+a.label+"\x3c/div\x3e");else if("true"==a.joinGroup){var e="onclick\x3d\"JoinGroupsSplash.joinGroup('"+b+"');\"";c.update('\x3cdiv class\x3d"asktojoin"\x3e\x3ca '+
e+' href\x3d"javascript:void(0);" title\x3d\''+a.tooltip+'\'\x3e\x3cimg class\x3d"check" src\x3d"/s.gif"\x3e'+a.label+"\x3c/a\x3e\x3c/div\x3e")}else if("true"==a.groupMember){var f="csnLeaveGroupIcon-"+a.groupId,e="onclick\x3d\"JoinGroupsSplash.leaveGroup('"+a.groupId+"');\"";c.update('\x3cdiv class\x3d"member"\x3e\x3cimg class\x3d"check" src\x3d"/s.gif"\x3e'+a.label+"\x3cspan onmouseout\x3d\"Ext.get('"+f+"').removeClass('active');\" onmouseover\x3d\"Ext.get('"+f+"').addClass('active');\"\x3e\x3ca "+
e+'"  title\x3d"'+a.tooltip+'" href\x3d"javascript:void(0);"\x3e\x3cimg src\x3d"/s.gif" class\x3d"leave" id\x3d"'+f+'"\x3e\x3c/a\x3e\x3c/span\x3e\x3c/div\x3e')}},failure:function(b,a){c.update('\x3cdiv class\x3d"errorResponse"\x3e\x3cimg class\x3d"check" src\x3d"/s.gif"\x3e'+a.errMsg+"\x3c/div\x3e")}});"joinGroup"==d&&omnitureWrapper.trackEvent(chatter.getOmnitureEventMap().joinGroup)}};
var moderateChatter=function(){return{executeCommand:function(a,b){chatter.getToolbox().post({url:"/moderateChatter/"+b+"/"+a,params:{},success:function(a,b){window.location.reload()}})},confirmTask:function(a,b,c){confirmDelete(a)&&this.executeCommand(b,c)}}}();
var swfobject=function(){function v(){if(!t){try{var a=f.getElementsByTagName("body")[0].appendChild(f.createElement("span"));a.parentNode.removeChild(a)}catch(b){return}t=!0;for(var a=z.length,c=0;c<a;c++)z[c]()}}function I(a){t?a():z[z.length]=a}function J(a){if(typeof p.addEventListener!=k)p.addEventListener("load",a,!1);else if(typeof f.addEventListener!=k)f.addEventListener("load",a,!1);else if(typeof p.attachEvent!=k)S(p,"onload",a);else if("function"==typeof p.onload){var b=p.onload;p.onload=
function(){b();a()}}else p.onload=a}function K(){return!A&&D("6.0.65")&&(d.win||d.mac)&&!(d.wk&&312>d.wk)}function L(a,b,c,e){A=!0;E=e||null;M={success:!1,id:c};var h=r(c);if(h){"OBJECT"==h.nodeName?(x=T(h),B=null):(x=h,B=c);a.id=N;if(typeof a.width==k||!/%$/.test(a.width)&&310>parseInt(a.width,10))a.width="310";if(typeof a.height==k||!/%$/.test(a.height)&&137>parseInt(a.height,10))a.height="137";f.title=f.title.slice(0,47)+" - Flash Player Installation";e=d.ie&&d.win?"ActiveX":"PlugIn";e="MMredirectURL\x3d"+
encodeURI(window.location).toString().replace(/&/g,"%26")+"\x26MMplayerType\x3d"+e+"\x26MMdoctitle\x3d"+f.title;b.flashvars=typeof b.flashvars!=k?b.flashvars+("\x26"+e):e;d.ie&&(d.win&&4!=h.readyState)&&(e=f.createElement("div"),c+="SWFObjectNew",e.setAttribute("id",c),h.parentNode.insertBefore(e,h),h.style.display="none",function(){4==h.readyState?h.parentNode.removeChild(h):setTimeout(arguments.callee,10)}());F(a,b,c)}}function T(a){var b=f.createElement("div");if(d.win&&d.ie)b.innerHTML=a.innerHTML;
else if(a=a.getElementsByTagName(u)[0])if(a=a.childNodes)for(var c=a.length,e=0;e<c;e++)!(1==a[e].nodeType&&"PARAM"==a[e].nodeName)&&8!=a[e].nodeType&&b.appendChild(a[e].cloneNode(!0));return b}function F(a,b,c){var e,h=r(c);if(d.wk&&312>d.wk)return e;if(h)if(typeof a.id==k&&(a.id=c),d.ie&&d.win){var l="",g;for(g in a)a[g]!=Object.prototype[g]&&("data"==g.toLowerCase()?b.movie=a[g]:"styleclass"==g.toLowerCase()?l+=' class\x3d"'+a[g]+'"':"classid"!=g.toLowerCase()&&(l+=" "+g+'\x3d"'+a[g]+'"'));g="";
for(var m in b)b[m]!=Object.prototype[m]&&(g+='\x3cparam name\x3d"'+m+'" value\x3d"'+b[m]+'" /\x3e');h.outerHTML='\x3cobject classid\x3d"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+l+"\x3e"+g+"\x3c/object\x3e";C[C.length]=a.id;e=r(a.id)}else{m=f.createElement(u);m.setAttribute("type",G);for(var q in a)a[q]!=Object.prototype[q]&&("styleclass"==q.toLowerCase()?m.setAttribute("class",a[q]):"classid"!=q.toLowerCase()&&m.setAttribute(q,a[q]));for(l in b)b[l]!=Object.prototype[l]&&"movie"!=l.toLowerCase()&&
(a=m,g=l,q=b[l],c=f.createElement("param"),c.setAttribute("name",g),c.setAttribute("value",q),a.appendChild(c));h.parentNode.replaceChild(m,h);e=m}return e}function O(a){var b=r(a);b&&"OBJECT"==b.nodeName&&(d.ie&&d.win?(b.style.display="none",function(){if(4==b.readyState){var c=r(a);if(c){for(var d in c)"function"==typeof c[d]&&(c[d]=null);c.parentNode.removeChild(c)}}else setTimeout(arguments.callee,10)}()):b.parentNode.removeChild(b))}function r(a){var b=null;try{b=f.getElementById(a)}catch(c){}return b}
function S(a,b,c){a.attachEvent(b,c);w[w.length]=[a,b,c]}function D(a){var b=d.pv;a=a.split(".");a[0]=parseInt(a[0],10);a[1]=parseInt(a[1],10)||0;a[2]=parseInt(a[2],10)||0;return b[0]>a[0]||b[0]==a[0]&&b[1]>a[1]||b[0]==a[0]&&b[1]==a[1]&&b[2]>=a[2]?!0:!1}function P(a,b,c,e){if(!d.ie||!d.mac){var h=f.getElementsByTagName("head")[0];if(h){c=c&&"string"==typeof c?c:"screen";e&&(H=n=null);if(!n||H!=c)e=f.createElement("style"),e.setAttribute("type","text/css"),e.setAttribute("media",c),n=h.appendChild(e),
d.ie&&(d.win&&typeof f.styleSheets!=k&&0<f.styleSheets.length)&&(n=f.styleSheets[f.styleSheets.length-1]),H=c;d.ie&&d.win?n&&typeof n.addRule==u&&n.addRule(a,b):n&&typeof f.createTextNode!=k&&n.appendChild(f.createTextNode(a+" {"+b+"}"))}}}function y(a,b){if(Q){var c=b?"visible":"hidden";t&&r(a)?r(a).style.visibility=c:P("#"+a,"visibility:"+c)}}function R(a){return null!=/[\\\"<>\.;]/.exec(a)&&typeof encodeURIComponent!=k?encodeURIComponent(a):a}var k="undefined",u="object",G="application/x-shockwave-flash",
N="SWFObjectExprInst",p=window,f=document,s=navigator,z=[],C=[],w=[],x,B,E,M,t=!1,A=!1,n,H,Q=!0,d=function(){var a=typeof f.getElementById!=k&&typeof f.getElementsByTagName!=k&&typeof f.createElement!=k,b=s.userAgent.toLowerCase(),c=s.platform.toLowerCase(),d=c?/win/.test(c):/win/.test(b),c=c?/mac/.test(c):/mac/.test(b),b=/webkit/.test(b)?parseFloat(b.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,h=!+"\v1",l=[0,0,0],g=null;if(typeof s.plugins!=k&&typeof s.plugins["Shockwave Flash"]==u){if((g=s.plugins["Shockwave Flash"].description)&&
!(typeof s.mimeTypes!=k&&s.mimeTypes[G]&&!s.mimeTypes[G].enabledPlugin))h=!1,g=g.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),l[0]=parseInt(g.replace(/^(.*)\..*$/,"$1"),10),l[1]=parseInt(g.replace(/^.*\.(.*)\s.*$/,"$1"),10),l[2]=/[a-zA-Z]/.test(g)?parseInt(g.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}else if(typeof p.ActiveXObject!=k)try{var m=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(m&&(g=m.GetVariable("$version")))h=!0,g=g.split(" ")[1].split(","),l=[parseInt(g[0],10),parseInt(g[1],10),parseInt(g[2],
10)]}catch(q){}return{w3:a,pv:l,wk:b,ie:h,win:d,mac:c}}();(function(){d.w3&&((typeof f.readyState!=k&&"complete"==f.readyState||typeof f.readyState==k&&(f.getElementsByTagName("body")[0]||f.body))&&v(),t||(typeof f.addEventListener!=k&&f.addEventListener("DOMContentLoaded",v,!1),d.ie&&d.win&&(f.attachEvent("onreadystatechange",function(){"complete"==f.readyState&&(f.detachEvent("onreadystatechange",arguments.callee),v())}),p==top&&function(){if(!t){try{f.documentElement.doScroll("left")}catch(a){setTimeout(arguments.callee,
0);return}v()}}()),d.wk&&function(){t||document.addEventListener("DOMContentLoaded",function(a){v()})}(),J(v)))})();(function(){d.ie&&d.win&&window.attachEvent("onunload",function(){for(var a=w.length,b=0;b<a;b++)w[b][0].detachEvent(w[b][1],w[b][2]);a=C.length;for(b=0;b<a;b++)O(C[b]);for(var c in d)d[c]=null;d=null;for(var e in swfobject)swfobject[e]=null;swfobject=null})})();return{registerObject:function(a,b,c,e){d.w3&&a&&b?y(a,!1):e&&e({success:!1,id:a})},getObjectById:function(a){if(d.w3){var b=
null;if((a=r(a))&&"OBJECT"==a.nodeName)typeof a.SetVariable!=k?b=a:(a=a.getElementsByTagName(u)[0])&&(b=a);return b}},embedSWF:function(a,b,c,e,f,l,g,m,q,p){var r={success:!1,id:b};d.w3&&!(d.wk&&312>d.wk)&&a&&b&&c&&e&&f?(y(b,!1),I(function(){c+="";e+="";var d={};if(q&&typeof q===u)for(var n in q)d[n]=q[n];d.data=a;d.width=c;d.height=e;n={};if(m&&typeof m===u)for(var s in m)n[s]=m[s];if(g&&typeof g===u)for(var t in g)n.flashvars=typeof n.flashvars!=k?n.flashvars+("\x26"+t+"\x3d"+g[t]):t+"\x3d"+g[t];
if(D(f))s=F(d,n,b),d.id==b&&y(b,!0),r.success=!0,r.ref=s;else{if(l&&K()){d.data=l;L(d,n,b,p);return}y(b,!0)}p&&p(r)})):p&&p(r)},switchOffAutoHideShow:function(){Q=!1},ua:d,getFlashPlayerVersion:function(){return{major:d.pv[0],minor:d.pv[1],release:d.pv[2]}},hasFlashPlayerVersion:D,createSWF:function(a,b,c){if(d.w3)return F(a,b,c)},showExpressInstall:function(a,b,c,e){d.w3&&K()&&L(a,b,c,e)},removeSWF:function(a){d.w3&&O(a)},createCSS:function(a,b,c,e){d.w3&&P(a,b,c,e)},addDomLoadEvent:I,addLoadEvent:J,
getQueryParamValue:function(a){var b=f.location.search||f.location.hash;if(b){/\?/.test(b)&&(b=b.split("?")[1]);if(null==a)return R(b);for(var b=b.split("\x26"),c=0;c<b.length;c++)if(b[c].substring(0,b[c].indexOf("\x3d"))==a)return R(b[c].substring(b[c].indexOf("\x3d")+1))}return""},expressInstallCallback:function(){if(A){var a=r(N);a&&x&&(a.parentNode.replaceChild(x,a),B&&(y(B,!0),d.ie&&d.win&&(x.style.display="block")),E&&E(M));A=!1}}}}();
var whatToDoNext=new function(){function f(a,b,c){chatter.getEventBus().addEventListener(a,b,function(a,b){try{c(a,b)}catch(g){Sfdc.Debug.error("whatToDoNext: Event listener could not be executed.",{error:g,eventname:a,payload:b})}})}this.logClicks=this.accessibilityMode=!0;this.contextId=this.tabNameType=null;this.inAjaxCall=!1;this.dismissThisItem=function(a,b){Sfdc.get("ReadOnlyBanner")?Dialogs.showSimpleError("",LC.getLabel("Exception","InvalidReadOnlyUserDmlException_desc"),null):("getSalesforce1"==
a&&Sfdc.logServer("WTDN",{userAction:a+"TaskDismissed",location:window.location.pathname}),this.doAjaxCall(a,b,"dismiss",!1))};this.completeThisItem=function(a,b,c,e){Ext.fly("todoItem")&&Ext.fly("todoItem").addClass("success");this.doAjaxCall(a,b,e?"completeAndLog":"complete",!0)};this.hideWTDN=function(){Ext.fly("todoItem")&&Ext.fly("todoItem").remove()};this.logThisItem=function(a){!0===whatToDoNext.logClicks&&chatter.getToolbox().post({url:"/whatToDoNext",params:{taskName:a,taskAction:"log"}})};
this.doAjaxCall=function(a,b,c,e){if(!this.inAjaxCall){this.inAjaxCall=!0;var d=this;chatter.getToolbox().post({url:"/whatToDoNext",params:{taskName:a,taskAction:c,tabNameType:whatToDoNext.tabNameType||"CHATTER",contextId:whatToDoNext.contextId},success:function(a,c){Ext.fly(b)&&d.replaceItem(b,c.html,c.selfFade,e)},failure:function(a,b){d.inAjaxCall=!1}})}};this.replaceItem=function(a,b,c,e){var d,g,f=this;b&&(d=Ext.get(a),g=d.parent(),setTimeout(function(){d.fadeOut({endOpacity:0,duration:0.5,remove:!0,
callback:function(a){c?Ext.fly("todoItem").addClass("success"):Ext.fly("todoItem").removeClass("success");a=g.createChild(b);a.is("script")&&(a=a.prev());a.fadeIn({endOpacity:1,duration:1,callback:function(){f.inAjaxCall=!1;c&&setTimeout(function(){Ext.get("todoItem").parent().fadeOut({endOpacity:0,duration:1,remove:!0})},5E3)}})}})},e?5E3:0))};this.markListItemComplete=function(a){var b="listItem-"+a;null!==Ext.get(b)&&this.completeThisItem(a,b)};this.setProfileProperties=function(){};this.uploadPhoto=
function(){this.logThisItem("addPhoto");SfdcApp.ChatterProfileSection.showDialog("uploadPhoto");return!1};this.editContactInfo=function(){this.logThisItem("contactInfo");SfdcApp.ChatterProfileSection.showDialog("contactInfo");return!1};this.shortBio=function(){this.logThisItem("shortBio");SfdcApp.ChatterProfileSection.showDialog("aboutMe");return!1};this.showProfilePage=function(){whatToDoNext.logThisItem("profileTask");navigateToUrl("/_ui/core/userprofile/UserProfilePage")};this.getPeopleListNavigationElement=
function(){return Sfdc.select("div#mainNavigation li.peopleListView a")[0]};this.isProfileTab=function(){return 0<document.URL.indexOf("_ui/core/userprofile/UserProfilePage")};this.isPeopleListTab=function(){return 0<document.URL.indexOf("_ui/core/chatter/people/PeopleListPage")};this.isGroupDetailTab=function(){return 0<document.URL.indexOf("_ui/core/chatter/groups/GroupProfilePage")};this.isGroupListTab=function(){return 0<document.URL.indexOf("_ui/core/chatter/groups/GroupListPage")};this.isHomeTab=
function(){return 0<document.URL.indexOf("home/home.jsp")};this.isGroupListFilter=function(){return Sfdc.select("div[title\x3d'"+LC.getLabel("ChatterGroups","listheader_membership")+"']")[0]||null};this.isPeopleListFilter=function(){return Sfdc.get('div[title\x3d"'+LC.getLabel("Feeds","Following")+'"]')?!0:!1};this.getGroupListNavigationElement=function(){return Sfdc.select("div#mainNavigation li.groupListView")[0]};this.getInviteLink=function(){var a=Sfdc.get("viralInviteMembersButtonId");return a?
a:Sfdc.get("externalInviteLinkId")};this.showInvite=function(){whatToDoNext.getInviteLink().click()};this.joinGroup=function(){whatToDoNext.logThisItem("findGroups");navigateToUrl("/_ui/core/chatter/ui/ChatterPage?listViewType\x3dgroups")};this.showCreateGroupsPage=function(){whatToDoNext.createGroup()};this.createGroup=function(){whatToDoNext.logThisItem("createGroup");navigateToUrl("/_ui/core/chatter/groups/GroupCreatePage")};this.uploadGroupPhoto=function(){whatToDoNext.logThisItem("addGroupPhoto");
SfdcApp.ChatterProfileSection.showDialog("uploadPhoto");return!1};this.updateGroupDescription=function(){whatToDoNext.logThisItem("addGroupDesc");SfdcApp.ChatterProfileSection.showDialog("groupDescription");return!1};this.addGroupMembers=function(){whatToDoNext.logThisItem("addGroupMembers");Sfdc.get("manageUsersLink").click();return!1};this.showHomePage=function(){whatToDoNext.logThisItem("showProfile");navigateToUrl("/home/home.jsp")};this.showFilesPage=function(){whatToDoNext.logThisItem("shareFile");
navigateToUrl("/_ui/core/chatter/files/FileTabPage")};this.getChatterMobile=function(){this.completeThisItem("getChatterMobile","listItem-getChatterMobile","completedItemClass",!0);(new Sfdc.Chatter.ChatterMobileWindow("/mobile/chattersplash/chatterMobileOverlay.apexp")).show()};this.getSalesforce1=function(){this.completeThisItem("getSalesforce1","listItem-getSalesforce1","completedItemClass",!0);Sfdc.logServer("WTDN",{userAction:"getSalesforce1TaskCompleted",linkUrl:"/HelpAndTrainingDoor?version\x3d2\x26resource\x3dhttp://www.salesforce.com/salesforce1/",
location:window.location.pathname});window.open("/HelpAndTrainingDoor?version\x3d2\x26resource\x3dhttp://www.salesforce.com/salesforce1/")};this.clickS1LinkInDesc=function(a){Sfdc.logServer("WTDN",{userAction:"s1LinkClicked",linkUrl:a,location:window.location.pathname});window.open(a)};this.getChatterDesktop=function(){this.completeThisItem("getChatterDesktop","listItem-getChatterDesktop","completedItemClass",!0);(new Sfdc.Chatter.ChatterDesktopWindow("/setup/chatterdesktop/chatterdesktopoverlay.apexp")).show()};
Ext.onReady(function(){f("chatter:joinGroup","onAfterJoin",function(){Ext.fly("listItem-findGroups")&&whatToDoNext.completeThisItem("findGroups","listItem-findGroups","completedItemClass",!1)});f("chatter:joinGroup","onAfterJoin",function(){Ext.fly("listItem-findGroupsIfCreated")&&whatToDoNext.completeThisItem("findGroupsIfCreated","listItem-findGroupsIfCreated","completedItemClass",!1)})},this)};
var omnitureWrapper={trackEvent:function(a){try{"undefined"==typeof OmniturePage?Sfdc.require("SfdcApp.Omni.Config",function(b){b.trackActivity(a,{events:["event8"]})}):OmniturePage.setStage(a)}catch(c){}}};
Sfdc.provide("SfdcApp.social.intents",function(d){return{follow:function(b,a,c){return chatter.getToolbox().post({url:UserContext.getUrl("/social/engage/follow/"+a),params:{follower:b},success:c.success,failure:c.failure})},unfollow:function(b,a,c){return chatter.getToolbox().post({url:UserContext.getUrl("/social/engage/follow/"+a)+";delete",params:{follower:b},success:c.success,failure:c.failure})},favorite:function(b,a,c){return chatter.getToolbox().post({url:UserContext.getUrl("/social/engage/twitter/favorite/"+
b),params:{accountId:a},success:c.success,failure:c.failure})},unfavorite:function(b,a){return chatter.getToolbox().post({url:UserContext.getUrl("/social/engage/twitter/favorite/"+b)+";delete",success:a.success,failure:a.failure})},deletePost:function(b,a){return chatter.getToolbox().post({url:UserContext.getUrl("/social/engage/socialPost/"+b)+";delete",success:a.success,failure:a.failure})},getFollowList:function(b,a){return chatter.getToolbox().get({url:UserContext.getUrl("/social/engage/following/"+
b.id),success:a.success,failure:a.failure})},like:function(b,a){return chatter.getToolbox().post({url:UserContext.getUrl("/social/engage/facebook/like/"+b),success:a.success,failure:a.failure})},unlike:function(b,a){return chatter.getToolbox().post({url:UserContext.getUrl("/social/engage/facebook/like/"+b.id)+";delete",success:a.success,failure:a.failure})},recall:function(b,a){return chatter.getToolbox().post({url:UserContext.getUrl("/social/engage/approval/recall/"+b)+";edit",success:a.success,
failure:a.failure})}}}(Sfdc));
Sfdc.provide("SfdcApp.social.attachmentsBuilder",function(f){function l(a){var b=a.type;if(b){b=a.type.split("/")[0].toLowerCase();if("video"==b)return g(a);if("image"==b)return h(a);if("unknown"===b)return b=e(a.fallbackUrl,b),h(a,g(a,b))}return e(a.url,b)}function g(a,b){if(document.createElement("video").canPlayType){var c=document.createElement("SPAN"),d=document.createElement("VIDEO");d.className="embeddedmedia";d.src=a.url;d.onerror=function(){b||(b=e(a.fallbackUrl,"video",LC.getLabel("EmbeddedSocialPost",
"AttachmentError")));f.Dom.hideByDisplay(c);c.parentNode.appendChild(b)};d.onfocus=function(){this.setAttribute("controls","");this.play()};d.onblur=function(){this.removeAttribute("controls");this.pause()};d.onclick=function(){this.focus()};d.tabIndex=-1;c.appendChild(d);c.appendChild(k("/img/chatter/play.png",d));return c}return e(a.url,"video")}function k(a,b){var c=document.createElement("IMG");c.tabIndex=-1;c.src=a;c.className="overlay";c.onclick=function(){b.click()};c.onfocus=function(){b.focus()};
return c}function h(a,b){var c=document.createElement("SPAN"),d=document.createElement("IMG");d.className="embeddedmedia";d.src=a.url;d.onerror=function(){b||(b=e(a.fallbackUrl,"image",LC.getLabel("EmbeddedSocialPost","AttachmentError")));f.Dom.hideByDisplay(c);c.parentNode.appendChild(b)};d.tabIndex=-1;d.onclick=function(){this.focus()};c.appendChild(d);c.appendChild(k("/img/chatterfiles/zoom24withbg.png",d));return c}function e(a,b,c){var d=document.createElement("A");d.href=f.Url.generateUrl(f.Url.resolveUrl("/servlet/servlet.ExternalRedirect"),
{url:a});d.target="_blank";var e=document.createElement("SPAN");e.appendChild(document.createTextNode(a));e.className="filename";d.appendChild(e);d.className+="embeddedmedia "+b;c&&(a=document.createElement("SPAN"),a.appendChild(document.createTextNode(c)),a.className="error",d.appendChild(a));return d}return{buildAttachments:function(a){if(a.attachments&&0<a.attachments.length){var b=document.createElement("div");b.className="attachments";for(var c=0;c<a.attachments.length;c++)b.appendChild(l(a.attachments[c]));
return b}return document.createTextNode("")}}}(Sfdc));
Sfdc.provide("SfdcApp.social.embeddedPost",function(a){function m(c){window.setTimeout(function(){a.Dom.hideByDisplay(c.parentNode)},2E3)}function l(c){k(c);a.Dom.addClass(c,"failed")}function g(a,d){a&&a.errors&&SfdcApp.social.postBuilder.setFailMessage(d,a.errors.message)}function k(c){a.Dom.removeClass(c,["failed","activated","processing"])}function q(c,d,b){return{success:function(){var e=h[b];e||(e={});e[d]=d;k(c);a.Dom.addClass(c,"activated");m(c)},failure:function(){l(c)}}}function r(a,d,b){return{success:function(){var e=
h[b];e&&delete e[d];k(a);m(a)},failure:function(){l(a)}}}function n(c,d){a.Dom.removeClass(d,"loading");d.focus()}function p(c,d,b){var e=h[b];(b=a.select(".personainfo",d))&&a.Array.forEach(b,function(b){a.Dom.removeClass(b,"failed");var c=a.Data.get(b,"managedAccountId");c&&e[c]?a.Dom.addClass(b,"activated"):a.Dom.removeClass(b,"activated")});n(c,d)}var h={};return{followOptionOnClick:function(c,d,b,e){var f=h[e];a.Dom.addClass(c,"processing");f&&f[d]?SfdcApp.social.intents.unfollow(d,b,r(c,d,e)):
SfdcApp.social.intents.follow(d,b,q(c,d,e))},favoriteOptionOnClick:function(c,d,b){a.Dom.addClass(c,"processing");var e=a.Dom.getParent(c,"div.socialpost");SfdcApp.social.postBuilder.removeFailMessage(e);a.Dom.addClass(e,"favoriting");d&&b&&SfdcApp.social.intents.favorite(b,d,{success:function(){a.Dom.addClass(e,"favorited");a.Dom.removeClass(e,["unfavorited","favoriting"]);k(c)},failure:function(b,d){l(c);g(d,a.Dom.getParent(c,"div.socialpost"));a.Dom.removeClass(e,"favoriting")}});a.Dom.hideByDisplay(c.parentNode)},
unfavoriteOnClick:function(c,d){var b=a.Dom.getParent(c,"div.socialpost");SfdcApp.social.postBuilder.removeFailMessage(b);a.Dom.addClass(b,"favoriting");d&&SfdcApp.social.intents.unfavorite(d,{success:function(){a.Dom.addClass(b,"unfavorited");a.Dom.removeClass(b,["favorited","favoriting"])},failure:function(d,f){g(f,a.Dom.getParent(c,"div.socialpost"));a.Dom.removeClass(b,"favoriting")}})},deleteOnClick:function(c,d){if(!0==confirm(LC.getLabel("DeleteIntentAction","DeleteConfirmation"))){var b=a.Dom.getParent(d),
e=a.Dom.getParent(b),b=a.get(".socialPostActionFail",e);a.Dom.removeClass(b,"socialPostActionFailMessage");SfdcApp.social.intents.deletePost(c,{success:function(b,c){a.Dom.addClass(e,"deleted");c&&SfdcApp.social.postBuilder.renderDeletedByElement(e,c)},failure:function(a,b){g(b,e)}})}},followOnClick:function(c,d,b){var e=a.Dom.getLocalOffsetXY(c);a.Dom.setStyle(d,"left",e.x+"px");a.Dom.show(d);h[b.externalId]?p(c,d,b.externalId):SfdcApp.social.intents.getFollowList(b,{success:function(a,e){h[b.externalId]=
e;p(c,d,b.externalId)},failure:function(a,b){n(c,d)}})},likeOnClick:function(c,d){var b=a.Dom.getParent(d,".socialpost");a.Dom.hasClass(b,"liking")||(SfdcApp.social.postBuilder.removeFailMessage(b),a.Dom.addClass(b,"liking"),SfdcApp.social.intents.like(c,{success:function(c,d){a.Dom.addClass(b,"liked");a.Dom.removeClass(b,"liking")},failure:function(c,d){g(d,b);a.Dom.removeClass(b,"liking")}}))},unlikeOnClick:function(c,d){var b=a.Dom.getParent(d,".socialpost");a.Dom.hasClass(b,"liking")||(SfdcApp.social.postBuilder.removeFailMessage(b),
a.Dom.addClass(b,"liking"),SfdcApp.social.intents.unlike(c,{success:function(c,d){a.Dom.removeClass(b,"liked");a.Dom.removeClass(b,"liking")},failure:function(c,d){g(d,b);a.Dom.removeClass(b,"liking")}}))},recallActionOnClick:function(c,d){var b=a.Dom.getParent(d,".socialpost");SfdcApp.social.postBuilder.removeFailMessage(b);var e=a.get(".approvalActions",d),f=a.Dom.create(d,{src:"/sfc/images/spinner.gif",className:"approvalActionsLoading"},"img");a.Dom.replace(f,e);SfdcApp.social.intents.recall(c,
{success:function(a,b){SfdcApp.social.postBuilder.refreshApprovalActionIntents(d,b,c)},failure:function(c,d){g(d,b);a.Dom.replace(e,f)}})}}}(Sfdc));
Sfdc.provide("SfdcApp.social.intentBuilder",function(f){function l(a,b){if(b&&b.reply){var c=g(LC.getLabel("WebIntents","Reply"),"javascript:void(0);","reply");c.onclick=function(){SfdcApp.social.publisher.revealPublisher(b.reply,b.actionId,b.apiName)};return c}return document.createTextNode("")}function m(a,b){if(b&&0<b.length&&a&&"Twitter"===a.provider.apiValue){var c=g(LC.getLabel("WebIntents","Favorite"),"javascript:void(0);","favorite"),d=h(b,a,c,{customizeListItem:function(a,b,c){a.onclick=
function(d){SfdcApp.social.embeddedPost.favoriteOptionOnClick(a,b.id,c.id);f.Event.stopPropagation(d);return!1}},showLoading:function(){return!1}}),e=f.get(".intentAnchor",c);f.Event.add(e,"click",function(){var a=f.Dom.getLocalOffsetXY(c);f.Dom.setStyle(d,"left",a.x+"px");f.Dom.show(d);e.focus()});f.Event.add(e,"blur",function(){window.setTimeout(function(){f.Dom.hideByDisplay(d)},200)});return c}return document.createTextNode("")}function n(a){if(a&&"Twitter"===a.provider.apiValue){var b=g(LC.getLabel("WebIntents",
"Unfavorite"),"javascript:void(0);","unfavorite");b.onclick=function(){SfdcApp.social.embeddedPost.unfavoriteOnClick(b,a.id);return!1};return b}return document.createTextNode("")}function p(a){if("Facebook"==a.provider.apiValue||"Instagram"==a.provider.apiValue){var b=g(LC.getLabel("WebIntents","Like"),"javascript:void(0);","like",!1);b.onclick=function(){SfdcApp.social.embeddedPost.likeOnClick(a.id,b)};return b}return document.createTextNode("")}function q(a){if("Facebook"==a.provider.apiValue){var b=
g(LC.getLabel("WebIntents","Unlike"),"javascript:void(0);","unlike",!1);b.onclick=function(){SfdcApp.social.embeddedPost.unlikeOnClick(a,b)};return b}return document.createTextNode("")}function k(a,b){if(b&&b.retweet){var c=k("javascript:void(0);");c.onclick=function(){SfdcApp.social.publisher.revealPublisher(b.retweet,b.actionId,b.apiName)};return c}return a?g(LC.getLabel("WebIntents","Retweet"),a,"retweet"):document.createTextNode("")}function r(a,b){var c=null;if((c=a.messageType&&"Retweet"===
a.messageType.apiValue?a.replyTo:a)&&!c.isOutbound){if(b&&0<b.length&&c&&c.author&&c.author.externalId)return s(b,c);if(c&&c.postUrl)return g(LC.getLabel("WebIntents","Follow"),c.postUrl,"follow",!0)}return document.createTextNode("")}function s(a,b){var c=g(LC.getLabel("WebIntents","Follow"),"javascript:void(0);","follow"),d=h(a,b,c,{customizeListItem:function(a,b,c){a.onclick=function(){SfdcApp.social.embeddedPost.followOptionOnClick(a,b.id,c.author.id,c.author.externalId);!1};a.appendChild(t())},
showLoading:function(){return!0}});c.onclick=function(){SfdcApp.social.embeddedPost.followOnClick(c,d,b.author)};return c}function h(a,b,c,d){a=u(a,b,d);c.appendChild(a);return a}function v(){var a=LC.getLabel("Global","loading"),b=document.createElement("LI");b.className="loadingHolder";var c=document.createElement("IMG");b.appendChild(c);c.src=UserContext.getUrl("/img/loading.gif");c.className="loadingImage";c=document.createElement("SPAN");b.appendChild(c);c.innerHTML=a;c.className="loadingDescription";
return b}function u(a,b,c){var d,e=document.createElement("UL");e.tabIndex=-1;e.onblur=function(){f.Dom.hideByDisplay(e)};f.Dom.hideByDisplay(e);c.showLoading()&&(e.appendChild(v()),e.className="loading");for(d=0;d<a.length;d++)b.author&&a[d].externalId!=b.author.externalId&&e.appendChild(w(a[d],b,c));return e}function t(){var a=document.createElement("SPAN");a.className="followingSuffix";a.appendChild(document.createTextNode(" "+LC.getLabel("FollowIntentAction","FollowSuffix")));return a}function x(a){if(a.name){var b=
document.createElement("SPAN");b.className="realname";b.appendChild(document.createTextNode(a.name));return b}return document.createTextNode("")}function y(a){if(a.handle){var b=document.createElement("SPAN");b.className="handle";b.appendChild(document.createTextNode(a.handle));return b}return document.createTextNode("")}function z(a){if(f.isDefAndNotNull(a.author)&&!f.isEmpty(a.accounts))for(var b in a.accounts)if(a.accounts[b].id===a.author.id)return!0;return!1}function A(a){if(a&&a.isOutbound&&
f.isDefAndNotNull(a.externalId)&&f.isDefAndNotNull(a.status)&&("SENT"==a.status.statusType||"REPLIED"==a.status.statusType)&&z(a)&&!("Instagram"==a.provider.apiValue&&a.messageType&&"Direct"===a.messageType.apiValue)){var b=g(LC.getLabel("WebIntents","Delete"),"javascript:void(0);","delete");b.onclick=function(){SfdcApp.social.embeddedPost.deleteOnClick(a.id,b)};return b}return document.createTextNode("")}function g(a,b,c,d){var e=document.createElement("LI");e.className="intent";c&&(e.className+=
" "+c);b=f.Dom.create(e,{href:b,className:"intentAnchor"},"A");f.Dom.setText(b,a);d&&(b.target="_blank");return e}var w=function(a,b,c){var d=document.createElement("LI");d.className="personainfo";f.Data.set(d,"managedAccountId",a.id);d.appendChild(x(a));d.appendChild(y(a));c.customizeListItem(d,a,b);return d};return{buildIntents:function(a,b){var c=document.createElement("UL");c.className="intents";c.appendChild(l(a.postUrl,b));c.appendChild(m(a,a.accounts));c.appendChild(n(a));c.appendChild(p(a));
c.appendChild(q(a));c.appendChild(k(a.postUrl,b));c.appendChild(r(a,a.accounts));c.appendChild(A(a));c.appendChild(a.postUrl?g(LC.getLabel("WebIntents","ViewSource"),a.postUrl,"viewsource",!0):document.createTextNode(""));return c}}}(Sfdc));
Sfdc.provide("SfdcApp.social.postBuilder",function(d){function v(a,b){var c=document.createElement("DIV");d.Data.set(c,"publisherInfo",b);d.Data.set(c,"socialPostInfo",a);c.className+=" "+w(a);var e;e=a&&a.messageType&&"RETWEET"===a.messageType.dbValue?x:y;var f=e.getBlueprint(a);f&&d.Array.forEach(f,function(d){(d=d.call(e,a,b))&&c.appendChild(d)});return c}function l(a,b){return b?SfdcApp.social.intentBuilder.buildIntents(a,b):null}function m(a){return SfdcApp.social.attachmentsBuilder.buildAttachments(a)}
function n(){var a=document.createElement("DIV");a.className="socialPostActionFail";return a}function p(a){var b=document.createElement("DIV");b.className="deletedByContainer";b.appendChild(q(a));return b}function q(a){var b=document.createElement("DIV");b.className="deletedBy";if(a&&a.deletedByUserUrl&&a.deletedByUserName){var c=document.createElement("SPAN");b.appendChild(c);d.Dom.setText(c,(a.messageType&&"RETWEET"===a.messageType.dbValue?LC.getLabel("DeleteIntentAction","RetweetDeletedBy"):LC.getLabel("DeleteIntentAction",
"DeletedBy"))+" ");c=document.createElement("A");c.href=a.deletedByUserUrl;d.Dom.setText(c,a.deletedByUserName);b.appendChild(c)}return b}function w(a){var b="socialpost";a.provider&&(b+=" "+g(a));if(a.messageType){var c;c=a.messageType&&a.messageType.apiValue?a.messageType.apiValue.toLowerCase():"";b+=" "+c}b=a.isOutbound?b+" outbound":b+" inbound";a.status&&(b+=" "+(a.status.statusType?a.status.statusType.toLowerCase():""));"twitter"===g(a)&&(b+=a.likedBy?" favorited":" unfavorited");"facebook"===
g(a)&&a.likedBy&&(b+=" liked");return b}function g(a){return a.provider&&a.provider.apiValue?a.provider.apiValue.toLowerCase():""}function r(a){return a.author?s(a.author,"author"):document.createTextNode("")}function t(a){return a.recipient?s(a.recipient,"recipient"):document.createTextNode("")}function s(a,b){var c=document.createElement("A");c.className="personainfo "+b;a.profileUrl&&(c.href=a.profileUrl,c.target="_blank");a.name&&c.appendChild(h("SPAN",a.name,"realname"));a.handle&&c.appendChild(h("SPAN",
a.handle,"handle"));return c}function u(a){var b=document.createElement("DIV");b.className+="content";var c=a.content;!c&&!a.isReplyable&&(c=a.name);if(c)if("twitter"===g(a))try{b.innerHTML=twttr.txt.autoLink(d.String.escapeToHtml(c),{targetBlank:!0,usernameIncludeSymbol:!0,symbolTag:"s",textWithSymbolTag:"b"})}catch(e){b.innerHTML=SfdcApp.social.urlAutoLinker.autoLink(c)}else b.innerHTML=SfdcApp.social.urlAutoLinker.autoLink(c);return b}function k(a,b){if(a.status&&a.status.statusMessage){var c=
a.status.statusType?a.status.statusType.toLowerCase():"",e=a.id,f=h("DIV",a.status.statusMessage,"status "+c);if(b){var g=d.Dom.create(f,{href:"javascript:void(0);",className:"approvalActions"},"A");"pending_approval"==c?z(f,g,e):("recall_approval"==c||"rejected_approval"==c)&&b.resubmit&&A(f,g,b)}return f}return document.createTextNode("")}function z(a,b,c){var e=LC.getLabel("SocialPostApprovalMsgs","RecallFeedAction");d.Dom.setText(b,e);b.onclick=function(){SfdcApp.social.embeddedPost.recallActionOnClick(c,
a)}}function A(a,b,c){a=LC.getLabel("SocialPostApprovalMsgs","RetryFeedAction");d.Dom.setText(b,a);b.onclick=function(){SfdcApp.social.publisher.revealPublisher(c.resubmit,c.actionId,c.apiName)}}function h(a,b,c){a=document.createElement(a);a.appendChild(document.createTextNode(b));c&&(a.className=c);return a}var y={getBlueprint:function(a){return[r,t,u,m,k,p,n,l]}},x={getBlueprint:function(a){return[this.buildAuthor,this.buildRecipient,this.buildContent,this.buildAttachment,this.buildRetweetedBy,
this.buildStatus,p,n,l]},buildAuthor:function(a){return a.replyTo?r(a.replyTo):null},buildRecipient:function(a){return a.replyTo?t(a.replyTo):null},buildContent:function(a){return a.replyTo?u(a.replyTo):null},buildAttachment:function(a){return a.replyTo?m(a):null},buildStatus:function(a,b){return k(a,b)},buildRetweetedBy:function(a){if(a.author&&a.author.handle){var b=document.createElement("DIV");b.className="retweetedBy";d.Dom.setText(b,LC.getLabel("EmbeddedSocialPost","RetweetedBy")+" @"+a.author.handle);
return b}}};return{buildPost:function(a,b){return v(a,b)},renderDeletedByElement:function(a,b){var c=d.get(".deletedByContainer",a);if(c){var e=d.get(".deletedBy",c);e&&c.removeChild(e)}c.appendChild(q(b))},setDeleteFailMessage:function(a,b){var c=d.get(".socialPostActionFail",a);d.Dom.setText(c,b);d.Dom.addClass(c,"socialPostActionFailMessage")},setFailMessage:function(a,b){var c=d.get(".socialPostActionFail",a);d.Dom.setText(c,b);d.Dom.addClass(c,"socialPostActionFailMessage")},removeFailMessage:function(a){a=
d.get(".socialPostActionFail",a);d.Dom.setText(a,"");d.Dom.removeClass(a,"socialPostActionFailMessage")},refreshApprovalActionIntents:function(a,b,c){c=d.Dom.getParent(a,".socialpost");var e=d.Data.get(c,"publisherInfo"),f=d.Data.get(c,"socialPostInfo");f.status.statusType=b.statusType;f.status.statusMessage=b.statusMsg;d.Data.set(c,"socialPostInfo",f);b=k(f,e);d.Dom.replace(b,a)}}}(Sfdc));
Sfdc.provide("SfdcApp.social.urlAutoLinker",function(f){var g=/\b(https?|ftp):\/\//ig,h=RegExp("("+g.source+")?("+/[-+a-z0-9]+\./ig.source+")*("+/[-a-zA-Z0-9]{1,62}\./ig.source+")("+/(com|edu|gov|int|mil|net|org|arpa|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cs|cu|cv|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|fi|fj|fk|fm|fo|fr|fx|ga|gb|gd|ge|gf|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|in|io|iq|ir|is|it|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nt|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|pt|pw|py|qa|re|ro|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sy|sz|tc|td|tf|tg|th|tj|tk|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|um|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|yu|za|zm|zr|zw)\b/ig.source+
")("+/:\d{2,5}/ig.source+")?("+/\/((\.|!)?((%[a-f0-9]{2})|[-a-z0-9$&'()*+,;=_~:@<>]))*/ig.source+")*("+/\?((\.|!)?((%[a-f0-9]{2})|[-a-z0-9$&'()*+,;=_~:@?\/|]))*/ig.source+")?("+/#((\.|!)?((%[a-f0-9]{2})|[-a-z0-9$&'()*+,;=_~:@?\/]))*/ig.source+")?","igm");return{autoLink:function(b){if(b){var c=b.match(h),a=b;b=[];if(c&&0<c.length)for(i=0;i<c.length;i++)b[b.length]=a.substring(0,a.indexOf(c[i])),a=a.substring(a.indexOf(c[i])+c[i].length);0<a.length&&(b[b.length]=a);a="";for(i=0;i<b.length;i++)if(a+=
f.String.escapeToHtml(b[i]),c&&c[i]){var d,e=d=c[i];RegExp("^"+g.source,"i").test(e)||(e="http://"+e);d='\x3ca href\x3d"'+e+'" target\x3d"_blank"\x3e'+f.String.escapeToHtml(d)+"\x3c/a\x3e";a+=d}return a}return""}}}(Sfdc));
Sfdc.provide("SfdcApp.social.sina.txt",function(f){return{getPostLength:function(b){var a;a=String(b);for(var c=0,d=0;d<a.length;d++)var e=a.charCodeAt(d),c=c+(255>=e?0.5:65535>=e?1:2);a=c;c=twttr.txt.extractUrlsWithIndices(b,{extractUrlsWithoutProtocol:!1});twttr.txt.modifyIndicesFromUTF16ToUnicode(b,c);for(b=0;b<c.length;b++)a+=Math.max(-140,c[b].indices[0]-c[b].indices[1])/2,a+=10;return Math.ceil(a)}}}(Sfdc));
Sfdc.provide("SfdcApp.social.publisher",function(b){function H(a,c){var b=g(c);if(b){var e=function(){u(c)};b.onkeyup=e;b.onkeypress=e;b.oncut=e;b.onpaste=e;b.onfocus=e;b.oninput=e;b.ondrop=e}I(a,c);if(b=k(c))b.onchange=function(){l(c);J(c)};if(b=r(c))b.onchange=function(){l(c)}}function I(a,c){var d=k(c);b.Event.add(d,"change",function(){if("TWEET"===this.value){var a=g(c);-1===a.value.indexOf(p)&&(a.value=p+a.value)}if("DIRECT"===this.value){var a=g(c),b=a.value;0===b.indexOf(p)&&(a.value=b.substring(p.length))}u(c)})}
function K(a){return a&&280<a.length?(a=a.substring(0,279),b.String.rtrim(a)+"..."):a}function B(a,c,d){if(a.provider){s[d]=a.provider;if(c=m("Provider",d))c.value=a.provider.dbValue,c=b.get(".socialPubProvider",b.Dom.getParent(c)),b.Dom.setText(c,a.provider.label);u(d);C(d)}if(a.replyTo){var e=m("ReplyTo",d);if(e){var f=a.replyTo;e.value=f.id;for(c=b.get(".socialPubReplyTo .socialpostcontainer",b.Dom.getParent(e));c.firstChild;)c.removeChild(c.firstChild);f.content=K(f.content);c.appendChild(SfdcApp.social.postBuilder.buildPost(f));
b.Data.set(e,"replyToData",a.replyTo)}else console.log("WARNING: The ReplyTo field is not accessible.")}a.accounts&&(D=a.author,v=a.accounts,(c=r(d))&&w(c,x(a.accounts,function(a){return new Option(a.label,a.id)})));y(r(d),a.author?a.author.id:null,!0);a.messageTypes&&(c=k(d))&&w(c,x(a.messageTypes,function(a){return new Option(a.label,a.dbValue)}));a.messageType&&a.messageType.dbValue&&(c=k(d),y(c,a.messageType.dbValue),L(d,a.messageType));M(a.content?a.content:"","replace",d);p=a.replyTo&&a.replyTo.handle?
"@"+a.replyTo.handle+" ":"";l(d)}function N(a,b){for(var d=0;d<b.length;d++)if(a.id===b[d].id)return!0;return!1}function M(a,c,d){if(d=g(d))b.resolve("Sfdc.EntityFeed.QuickAction")?b.EntityFeed.QuickAction.insertIntoTextField(d,a,c):"replace"===c&&(d.value=a)}function L(a,c){if(c&&c.dbValue&&"RETWEET"===c.dbValue){var d=E(g(a));d&&b.Dom.hideByDisplay(d)}else F(a)}function O(a){if(!b.Data.get(a,"animationInProgress")){b.Data.set(a,"animationInProgress","true");var c=b.Dom.getStyle(a,"backgroundColor");
b.Units.HexColor.isHexColor(c)||(c=(new b.Units.RGBColor(c)).toHex().toString());b.Animation.css(a,"backgroundColor","#F6F6A6",c,{duration:1500,onComplete:function(){b.Data.clear(a,"animationInProgress")}})}}function w(a,b){if(a){a.options.length=b.length;for(var d=0;d<b.length;d++)a.options[d]=b[d]}}function x(a,b){var d=[];a||(a=[]);0==a.length&&d.push(new Option(LC.getLabel("SelectElement","Required"),""));for(var e=0;e<a.length;e++)d.push(b(a[e]));return d}function y(a,b,d){if(a){for(var e=!1,
f=0;f<a.options.length;f++)if(a.options[f].value===b){a.options.selectedIndex=f;e=!0;break}if(!e&&d&&(b=0<a.options.length?a.options[0]:null,null===b||""!==b.value))a.add(new Option(LC.getLabel("SelectElement","Required"),""),b),a.options.selectedIndex=0}}function t(a){return!a?null:a.options[a.selectedIndex]}function C(a){a=s[a];var c=b.get("publishersharebutton");a&&c&&(c.value=G?LC.getLabel("SocialPostApprovalMsgs","SubmitForApproval"):a.createButtonText?a.createButtonText:LC.getLabel("Publisher",
"Create"))}function u(a){var c=g(a),d=t(k(a)),e=null!=d&&"DIRECT"===d.value;if(c){b.Dom.setStyle(c,"height",0);var f=10*Math.ceil(c.scrollHeight/10),f=Math.min(Math.max(f+10,100),350);b.Dom.setStyle(c,"height",f+"px");var f=s[a],q="";f&&(f.contentLengthLimit&&-1!=f.contentLengthLimit&&!e)&&(e=b.String.trim(c.value),c=f.contentLengthLimit,d=f&&"SinaWeibo"===f.apiValue?SfdcApp.social.sina.txt.getPostLength(e):f&&"Instagram"===f.apiValue?twttr.txt.getUnicodeTextLength(e):f&&"LinkedIn"===f.apiValue&&
d&&"COMMENT"==d.value?twttr.txt.getUnicodeTextLength(e):twttr.txt.getTweetLength(e),q=c-d);a=m("socialPubCharCount_Content",a);a.innerHTML=q;0>q?b.Dom.addClass(a,"charLimit"):b.Dom.removeClass(a,"charLimit")}}function m(a,c){return b.get(a+"__"+c)}function r(a){return m("OutboundSocialAccount",a)}function k(a){return m("MessageType",a)}function g(a){return m("Content",a)}function z(a){return b.get("."+a+".publisherTemplate .pbBody")}function E(a){return a?b.Dom.getParent(a,".quickActionField"):null}
function F(a){(a=E(g(a)))&&b.Dom.show(a)}function P(a){a=z(a);var c=b.select(".errorMsg",a).concat(b.select(".pbError",a));b.each(c,function(a){b.Dom.hideByDisplay(a)});b.each(b.select(".error",a),function(a){b.Dom.removeClass(a,"error")})}function A(a){a=b.get("."+a);return!a?null:b.get(".socialSendButton .zen-btn",a)}function Q(a){function c(){var a=d();a&&b.Dom.hideByDisplay(a)}function d(){return b.get("socialPublisherSpinner__"+a)}var e=function(){var c=z(a),d={};d.container=function(){var a=
b.Dom.create(null,null,"div");b.Dom.addClass(a,"socialPublisherNotification");return a}();b.Dom.hideByDisplay(d.container);c.insertBefore(d.container,b.Dom.getFirstChild(c));d.messageContainer=function(a){a=b.Dom.create(a,null,"div");b.Dom.addClass(a,"messageContainer");return a}(d.container);d.header=function(a){a=b.Dom.create(a,null,"span");b.Dom.addClass(a,"warningText");b.Dom.setText(a,LC.getLabel("SocialPublisher","Warning")+": ");return a}(d.messageContainer);d.message=function(a){a=b.Dom.create(a,
{style:{marginRight:"5px"}},"span");b.Dom.addClass(a,"messageText");return a}(d.messageContainer);d.refreshLink=function(c){c=b.Dom.create(c,{href:"javascript:void(0)"},"a");b.Dom.setText(c,LC.getLabel("SocialPublisher","Refresh"));b.Dom.addClass(c,"refreshLink");c.onclick=function(){l(a)};return c}(d.messageContainer);return d}(),f={error:"ERROR",warning:"WARNING",errorWithoutRefresh:"ERROR_WITHOUT_REFRESH"};this.Type=f;this.showLoading=function(){b.Dom.hideByDisplay(e.container);a:{var c=d();if(!c){var f=
A(a);if(!f)break a;var h=b.Dom.getParent(f,"div"),c=b.Dom.create(null,null,"span");b.Dom.addClass(c,"socialPublisherSpinner");b.Dom.set(c,"id","socialPublisherSpinner__"+a);b.Dom.create(c,{src:"/sfc/images/spinner.gif"},"img");b.Dom.getParent(f,"div").insertBefore(c,h.firstChild)}b.Dom.show(c)}};this.show=function(a,d){b.Dom.removeClass(e.container,["alertNotification","warningNotification"]);a==f.error?(b.Dom.addClass(e.container,"alertNotification"),b.Dom.setText(e.header,LC.getLabel("SocialPublisher",
"Error")+": "),b.Dom.show(e.refreshLink)):a==f.errorWithoutRefresh?(b.Dom.addClass(e.container,"alertNotification"),b.Dom.setText(e.header,LC.getLabel("SocialPublisher","Error")+": "),b.Dom.hideByDisplay(e.refreshLink)):a==f.warning&&(b.Dom.addClass(e.container,"warningNotification"),b.Dom.setText(e.header,LC.getLabel("SocialPublisher","Warning")+": "),b.Dom.show(e.refreshLink));b.Dom.setText(e.message,d);c();b.Dom.show(e.container)};this.hide=function(){c();b.Dom.hideByDisplay(e.container)}}var s=
{},n={},G=!1,v=[],D={},J=function(a){function c(a){a=b.Data.get(m("ReplyTo",a),"replyToData");return!a||!a.recipient?null:a.recipient}function d(a){a=t(k(a));return null!=a&&"PRIVATE_MESSAGE"==a.value}return function(a){var b=r(a);if(b){var q,g;d(a)?(g=c(a),q=N(g,v)?[g]:[]):(g=D,q=v);w(b,x(q,function(a){return new Option(a.label,a.id)}));y(r(a),g?g.id:null,!0)}}}(),l=function(){function a(a){var b=t(k(a));a=s[a];return null!=a&&"Twitter"==a.apiValue&&null!=b&&"DIRECT"==b.value}function c(a){n[a].hide();
f(a)}function d(a){n[a].show(n[a].Type.warning,LC.getLabel("SocialPublisher","UserMayNotFollowing"));f(a)}function e(a){n[a].show(n[a].Type.errorWithoutRefresh,LC.getLabel("SocialPublisher","CannotDMYourself"));g(a)}function f(a){if(a=A(a))a.disabled=!1}function g(a){if(a=A(a))a.disabled=!0}function p(a,b){if(!b||!b.author)return!1;var c=b.author.externalId,d;a:{if(b&&b.accounts)for(d in b.accounts)if(b.accounts[d].id==a){d=b.accounts[d].externalId;break a}d=null}return c===d}return function(h){if(a(h)){g(h);
var k=t(r(h)),l=b.Data.get(m("ReplyTo",h),"replyToData");p(k.value,l)?e(h):k&&(k.value&&l&&l.id)&&(n[h].showLoading(),chatter.getToolbox().get({url:UserContext.getUrl("/social/engage/account/"+k.value+"/relationships/"+l.id),success:function(b,e){a(h)&&(!e||void 0===e.followedBy?d(h):e.followedBy?c(h):(n[h].show(n[h].Type.warning,LC.getLabel("SocialPublisher","UserIsNotFollowing")),f(h)))},failure:function(b,c){a(h)&&d(h)}}))}else c(h)}}(),p="";return{initializePublisher:function(a,c,d,e){b.onReady(function(){G=
e;H(c,d);if(g(d)&&"undefined"!==typeof QuickTextAutoCompleteTextArea){var f=b.JSON.parse(a);new QuickTextAutoCompleteTextArea(f)}if(f=m("ReplyTo",d))f=b.Dom.getParent(f,".quickActionField"),b.Dom.addClass(f,"ReplyTo");n[d]=new Q(d)})},setPublisherValues:function(a,c,d){b.onReady(function(){B(a,c,d)})},revealPublisher:function(a,c,d){P(c);F(c);b.canvas.parent.publish({name:"publisher.selectAction",payload:{actionName:d}});B(a,d,c);if(a=g(c))a.selectionStart=a.selectionEnd=a.value.length,a.focus();
(a=z(c))&&a.scrollIntoView(!1);O(b.get("ReplyTo__"+c+"_container"))},onShowPanel:function(a){C(a)}}}(Sfdc));
(function(r,v){"object"===typeof exports&&"undefined"!==typeof module?module.exports=v():"function"===typeof define&&define.amd?define(v):(r.twttr=r.twttr||{},r.twttr.txt=v())})(this,function(){function r(a,c,b){return!b?"string"===typeof a&&a.match(c)&&RegExp["$\x26"]===a:!a||a.match(c)&&RegExp["$\x26"]===a}var v=/[a-z]{1,6}(?:[._][a-z]{1,2})?/i,O=/\!'#%&'\(\)*\+,\\\-\.\/:;<=>\?@\[\]\^_{|}~\$/,g=function(a,c,b){b=b||"";"string"!==typeof a&&(a.global&&0>b.indexOf("g")&&(b+="g"),a.ignoreCase&&0>b.indexOf("i")&&
(b+="i"),a.multiline&&0>b.indexOf("m")&&(b+="m"),a=a.source);return RegExp(a.replace(/#\{(\w+)\}/g,function(a,b){var f=c[b]||"";"string"!==typeof f&&(f=f.source);return f}),b)},P=/\x09-\x0D\x20\x85\xA0\u1680\u180E\u2000-\u200A\u2028\u2029\u202F\u205F\u3000/,Q=g(/[#{spacesGroup}]/,{spacesGroup:P}),na=g("(^|#{spaces})(\\$)(#{cashtag})(?\x3d$|\\s|[#{punct}])",{cashtag:v,spaces:Q,punct:O},"gi"),E=function(a){if(!a||-1===a.indexOf("$"))return[];var c=[];a.replace(na,function(a,d,e,f,h,k){a=h+d.length;
c.push({cashtag:f,indices:[a,a+f.length+1]})});return c},F=/[#\uff03]/,oa=g(/^(?:#{hashSigns}|:\/\/)/,{hashSigns:F}),R=g(RegExp("(?:(?:\ud55c\uad6d|\u9999\u6e2f|\u6fb3\u9580|\u65b0\u52a0\u5761|\u53f0\u7063|\u53f0\u6e7e|\u4e2d\u570b|\u4e2d\u56fd|\u10d2\u10d4|\u0e44\u0e17\u0e22|\u0dbd\u0d82\u0d9a\u0dcf|\u0d2d\u0d3e\u0d30\u0d24\u0d02|\u0cad\u0cbe\u0cb0\u0ca4|\u0c2d\u0c3e\u0c30\u0c24\u0c4d|\u0b9a\u0bbf\u0b99\u0bcd\u0b95\u0baa\u0bcd\u0baa\u0bc2\u0bb0\u0bcd|\u0b87\u0bb2\u0b99\u0bcd\u0b95\u0bc8|\u0b87\u0ba8\u0bcd\u0ba4\u0bbf\u0baf\u0bbe|\u0b2d\u0b3e\u0b30\u0b24|\u0aad\u0abe\u0ab0\u0aa4|\u0a2d\u0a3e\u0a30\u0a24|\u09ad\u09be\u09f0\u09a4|\u09ad\u09be\u09b0\u09a4|\u09ac\u09be\u0982\u09b2\u09be|\u092d\u093e\u0930\u094b\u0924|\u092d\u093e\u0930\u0924\u092e\u094d|\u092d\u093e\u0930\u0924|\u0680\u0627\u0631\u062a|\u067e\u0627\u06a9\u0633\u062a\u0627\u0646|\u0645\u0648\u0631\u064a\u062a\u0627\u0646\u064a\u0627|\u0645\u0644\u064a\u0633\u064a\u0627|\u0645\u0635\u0631|\u0642\u0637\u0631|\u0641\u0644\u0633\u0637\u064a\u0646|\u0639\u0645\u0627\u0646|\u0639\u0631\u0627\u0642|\u0633\u0648\u0631\u064a\u0629|\u0633\u0648\u062f\u0627\u0646|\u062a\u0648\u0646\u0633|\u0628\u06be\u0627\u0631\u062a|\u0628\u0627\u0631\u062a|\u0627\u06cc\u0631\u0627\u0646|\u0627\u0645\u0627\u0631\u0627\u062a|\u0627\u0644\u0645\u063a\u0631\u0628|\u0627\u0644\u0633\u0639\u0648\u062f\u064a\u0629|\u0627\u0644\u062c\u0632\u0627\u0626\u0631|\u0627\u0644\u0627\u0631\u062f\u0646|\u0570\u0561\u0575|\u049b\u0430\u0437|\u0443\u043a\u0440|\u0441\u0440\u0431|\u0440\u0444|\u043c\u043e\u043d|\u043c\u043a\u0434|\u0435\u044e|\u0431\u0435\u043b|\u0431\u0433|\u03b5\u03bb|zw|zm|za|yt|ye|ws|wf|vu|vn|vi|vg|ve|vc|va|uz|uy|us|um|uk|ug|ua|tz|tw|tv|tt|tr|tp|to|tn|tm|tl|tk|tj|th|tg|tf|td|tc|sz|sy|sx|sv|su|st|ss|sr|so|sn|sm|sl|sk|sj|si|sh|sg|se|sd|sc|sb|sa|rw|ru|rs|ro|re|qa|py|pw|pt|ps|pr|pn|pm|pl|pk|ph|pg|pf|pe|pa|om|nz|nu|nr|np|no|nl|ni|ng|nf|ne|nc|na|mz|my|mx|mw|mv|mu|mt|ms|mr|mq|mp|mo|mn|mm|ml|mk|mh|mg|mf|me|md|mc|ma|ly|lv|lu|lt|ls|lr|lk|li|lc|lb|la|kz|ky|kw|kr|kp|kn|km|ki|kh|kg|ke|jp|jo|jm|je|it|is|ir|iq|io|in|im|il|ie|id|hu|ht|hr|hn|hm|hk|gy|gw|gu|gt|gs|gr|gq|gp|gn|gm|gl|gi|gh|gg|gf|ge|gd|gb|ga|fr|fo|fm|fk|fj|fi|eu|et|es|er|eh|eg|ee|ec|dz|do|dm|dk|dj|de|cz|cy|cx|cw|cv|cu|cr|co|cn|cm|cl|ck|ci|ch|cg|cf|cd|cc|ca|bz|by|bw|bv|bt|bs|br|bq|bo|bn|bm|bl|bj|bi|bh|bg|bf|be|bd|bb|ba|az|ax|aw|au|at|as|ar|aq|ao|an|am|al|ai|ag|af|ae|ad|ac)(?\x3d[^0-9a-zA-Z@]|$))")),
B=/\uFFFE\uFEFF\uFFFF\u202A-\u202E/,S=function(a,c){return a.replace(/#\{(\w+)\}/g,function(a,d){return c[d]||""})},pa=S("#{punct}#{spacesGroup}#{invalidCharsGroup}",{punct:O,spacesGroup:P,invalidCharsGroup:B}),T=g(/[^#{invalidDomainChars}]/,{invalidDomainChars:pa}),qa=g(/(?:(?:#{validDomainChars}(?:-|#{validDomainChars})*)?#{validDomainChars}\.)/,{validDomainChars:T}),U=g(RegExp("(?:(?:\uc0bc\uc131|\ub2f7\ucef4|\ub2f7\ub137|\u9999\u683c\u91cc\u62c9|\u9910\u5385|\u98df\u54c1|\u98de\u5229\u6d66|\u96fb\u8a0a\u76c8\u79d1|\u96c6\u56e2|\u901a\u8ca9|\u8d2d\u7269|\u8c37\u6b4c|\u8bfa\u57fa\u4e9a|\u8054\u901a|\u7f51\u7edc|\u7f51\u7ad9|\u7f51\u5e97|\u7f51\u5740|\u7ec4\u7ec7\u673a\u6784|\u79fb\u52a8|\u73e0\u5b9d|\u70b9\u770b|\u6e38\u620f|\u6de1\u9a6c\u9521|\u673a\u6784|\u66f8\u7c4d|\u65f6\u5c1a|\u65b0\u95fb|\u653f\u5e9c|\u653f\u52a1|\u624b\u8868|\u624b\u673a|\u6211\u7231\u4f60|\u6148\u5584|\u5fae\u535a|\u5e7f\u4e1c|\u5de5\u884c|\u5bb6\u96fb|\u5a31\u4e50|\u5929\u4e3b\u6559|\u5927\u62ff|\u5927\u4f17\u6c7d\u8f66|\u5728\u7ebf|\u5609\u91cc\u5927\u9152\u5e97|\u5609\u91cc|\u5546\u6807|\u5546\u5e97|\u5546\u57ce|\u516c\u76ca|\u516c\u53f8|\u516b\u5366|\u5065\u5eb7|\u4fe1\u606f|\u4f5b\u5c71|\u4f01\u4e1a|\u4e2d\u6587\u7f51|\u4e2d\u4fe1|\u4e16\u754c|\u30dd\u30a4\u30f3\u30c8|\u30d5\u30a1\u30c3\u30b7\u30e7\u30f3|\u30bb\u30fc\u30eb|\u30b9\u30c8\u30a2|\u30b3\u30e0|\u30b0\u30fc\u30b0\u30eb|\u30af\u30e9\u30a6\u30c9|\u307f\u3093\u306a|\u0e04\u0e2d\u0e21|\u0938\u0902\u0917\u0920\u0928|\u0928\u0947\u091f|\u0915\u0949\u092e|\u0647\u0645\u0631\u0627\u0647|\u0645\u0648\u0642\u0639|\u0645\u0648\u0628\u0627\u064a\u0644\u064a|\u0643\u0648\u0645|\u0643\u0627\u062b\u0648\u0644\u064a\u0643|\u0639\u0631\u0628|\u0634\u0628\u0643\u0629|\u0628\u064a\u062a\u0643|\u0628\u0627\u0632\u0627\u0631|\u0627\u0644\u0639\u0644\u064a\u0627\u0646|\u0627\u0631\u0627\u0645\u0643\u0648|\u0627\u062a\u0635\u0627\u0644\u0627\u062a|\u0627\u0628\u0648\u0638\u0628\u064a|\u05e7\u05d5\u05dd|\u0441\u0430\u0439\u0442|\u0440\u0443\u0441|\u043e\u0440\u0433|\u043e\u043d\u043b\u0430\u0439\u043d|\u043c\u043e\u0441\u043a\u0432\u0430|\u043a\u043e\u043c|\u043a\u0430\u0442\u043e\u043b\u0438\u043a|\u0434\u0435\u0442\u0438|zuerich|zone|zippo|zip|zero|zara|zappos|yun|youtube|you|yokohama|yoga|yodobashi|yandex|yamaxun|yahoo|yachts|xyz|xxx|xperia|xin|xihuan|xfinity|xerox|xbox|wtf|wtc|wow|world|works|work|woodside|wolterskluwer|wme|winners|wine|windows|win|williamhill|wiki|wien|whoswho|weir|weibo|wedding|wed|website|weber|webcam|weatherchannel|weather|watches|watch|warman|wanggou|wang|walter|walmart|wales|vuelos|voyage|voto|voting|vote|volvo|volkswagen|vodka|vlaanderen|vivo|viva|vistaprint|vista|vision|visa|virgin|vip|vin|villas|viking|vig|video|viajes|vet|versicherung|verm\u00f6gensberatung|verm\u00f6gensberater|verisign|ventures|vegas|vanguard|vana|vacations|ups|uol|uno|university|unicom|uconnect|ubs|ubank|tvs|tushu|tunes|tui|tube|trv|trust|travelersinsurance|travelers|travelchannel|travel|training|trading|trade|toys|toyota|town|tours|total|toshiba|toray|top|tools|tokyo|today|tmall|tkmaxx|tjx|tjmaxx|tirol|tires|tips|tiffany|tienda|tickets|tiaa|theatre|theater|thd|teva|tennis|temasek|telefonica|telecity|tel|technology|tech|team|tdk|tci|taxi|tax|tattoo|tatar|tatamotors|target|taobao|talk|taipei|tab|systems|symantec|sydney|swiss|swiftcover|swatch|suzuki|surgery|surf|support|supply|supplies|sucks|style|study|studio|stream|store|storage|stockholm|stcgroup|stc|statoil|statefarm|statebank|starhub|star|staples|stada|srt|srl|spreadbetting|spot|spiegel|space|soy|sony|song|solutions|solar|sohu|software|softbank|social|soccer|sncf|smile|smart|sling|skype|sky|skin|ski|site|singles|sina|silk|shriram|showtime|show|shouji|shopping|shop|shoes|shiksha|shia|shell|shaw|sharp|shangrila|sfr|sexy|sex|sew|seven|ses|services|sener|select|seek|security|secure|seat|search|scot|scor|scjohnson|science|schwarz|schule|school|scholarships|schmidt|schaeffler|scb|sca|sbs|sbi|saxo|save|sas|sarl|sapo|sap|sanofi|sandvikcoromant|sandvik|samsung|samsclub|salon|sale|sakura|safety|safe|saarland|ryukyu|rwe|run|ruhr|rugby|rsvp|room|rogers|rodeo|rocks|rocher|rmit|rip|rio|ril|rightathome|ricoh|richardli|rich|rexroth|reviews|review|restaurant|rest|republican|report|repair|rentals|rent|ren|reliance|reit|reisen|reise|rehab|redumbrella|redstone|red|recipes|realty|realtor|realestate|read|raid|radio|racing|qvc|quest|quebec|qpon|pwc|pub|prudential|pru|protection|property|properties|promo|progressive|prof|productions|prod|pro|prime|press|praxi|pramerica|post|porn|politie|poker|pohl|pnc|plus|plumbing|playstation|play|place|pizza|pioneer|pink|ping|pin|pid|pictures|pictet|pics|piaget|physio|photos|photography|photo|phone|philips|phd|pharmacy|pfizer|pet|pccw|pay|passagens|party|parts|partners|pars|paris|panerai|panasonic|pamperedchef|page|ovh|ott|otsuka|osaka|origins|orientexpress|organic|org|orange|oracle|open|ooo|onyourside|online|onl|ong|one|omega|ollo|oldnavy|olayangroup|olayan|okinawa|office|off|observer|obi|nyc|ntt|nrw|nra|nowtv|nowruz|now|norton|northwesternmutual|nokia|nissay|nissan|ninja|nikon|nike|nico|nhk|ngo|nfl|nexus|nextdirect|next|news|newholland|new|neustar|network|netflix|netbank|net|nec|nba|navy|natura|nationwide|name|nagoya|nadex|nab|mutuelle|mutual|museum|mtr|mtpc|mtn|msd|movistar|movie|mov|motorcycles|moto|moscow|mortgage|mormon|mopar|montblanc|monster|money|monash|mom|moi|moe|moda|mobily|mobile|mobi|mma|mls|mlb|mitsubishi|mit|mint|mini|mil|microsoft|miami|metlife|merckmsd|meo|menu|men|memorial|meme|melbourne|meet|media|med|mckinsey|mcdonalds|mcd|mba|mattel|maserati|marshalls|marriott|markets|marketing|market|map|mango|management|man|makeup|maison|maif|madrid|macys|luxury|luxe|lupin|lundbeck|ltda|ltd|lplfinancial|lpl|love|lotto|lotte|london|lol|loft|locus|locker|loans|loan|lixil|living|live|lipsy|link|linde|lincoln|limo|limited|lilly|like|lighting|lifestyle|lifeinsurance|life|lidl|liaison|lgbt|lexus|lego|legal|lefrak|leclerc|lease|lds|lawyer|law|latrobe|latino|lat|lasalle|lanxess|landrover|land|lancome|lancia|lancaster|lamer|lamborghini|ladbrokes|lacaixa|kyoto|kuokgroup|kred|krd|kpn|kpmg|kosher|komatsu|koeln|kiwi|kitchen|kindle|kinder|kim|kia|kfh|kerryproperties|kerrylogistics|kerryhotels|kddi|kaufen|juniper|juegos|jprs|jpmorgan|joy|jot|joburg|jobs|jnj|jmp|jll|jlc|jio|jewelry|jetzt|jeep|jcp|jcb|java|jaguar|iwc|iveco|itv|itau|istanbul|ist|ismaili|iselect|irish|ipiranga|investments|intuit|international|intel|int|insure|insurance|institute|ink|ing|info|infiniti|industries|immobilien|immo|imdb|imamat|ikano|iinet|ifm|ieee|icu|ice|icbc|ibm|hyundai|hyatt|hughes|htc|hsbc|how|house|hotmail|hotels|hoteles|hot|hosting|host|hospital|horse|honeywell|honda|homesense|homes|homegoods|homedepot|holiday|holdings|hockey|hkt|hiv|hitachi|hisamitsu|hiphop|hgtv|hermes|here|helsinki|help|healthcare|health|hdfcbank|hdfc|hbo|haus|hangout|hamburg|hair|guru|guitars|guide|guge|gucci|guardian|group|grocery|gripe|green|gratis|graphics|grainger|gov|got|gop|google|goog|goodyear|goodhands|goo|golf|goldpoint|gold|godaddy|gmx|gmo|gmbh|gmail|globo|global|gle|glass|glade|giving|gives|gifts|gift|ggee|george|genting|gent|gea|gdn|gbiz|garden|gap|games|game|gallup|gallo|gallery|gal|fyi|futbol|furniture|fund|fun|fujixerox|fujitsu|ftr|frontier|frontdoor|frogans|frl|fresenius|free|fox|foundation|forum|forsale|forex|ford|football|foodnetwork|food|foo|fly|flsmidth|flowers|florist|flir|flights|flickr|fitness|fit|fishing|fish|firmdale|firestone|fire|financial|finance|final|film|fido|fidelity|fiat|ferrero|ferrari|feedback|fedex|fast|fashion|farmers|farm|fans|fan|family|faith|fairwinds|fail|fage|extraspace|express|exposed|expert|exchange|everbank|events|eus|eurovision|etisalat|esurance|estate|esq|erni|ericsson|equipment|epson|epost|enterprises|engineering|engineer|energy|emerck|email|education|edu|edeka|eco|eat|earth|dvr|dvag|durban|dupont|duns|dunlop|duck|dubai|dtv|drive|download|dot|doosan|domains|doha|dog|dodge|doctor|docs|dnp|diy|dish|discover|discount|directory|direct|digital|diet|diamonds|dhl|dev|design|desi|dentist|dental|democrat|delta|deloitte|dell|delivery|degree|deals|dealer|deal|dds|dclk|day|datsun|dating|date|data|dance|dad|dabur|cyou|cymru|cuisinella|csc|cruises|cruise|crs|crown|cricket|creditunion|creditcard|credit|courses|coupons|coupon|country|corsica|coop|cool|cookingchannel|cooking|contractors|contact|consulting|construction|condos|comsec|computer|compare|company|community|commbank|comcast|com|cologne|college|coffee|codes|coach|clubmed|club|cloud|clothing|clinique|clinic|click|cleaning|claims|cityeats|city|citic|citi|citadel|cisco|circle|cipriani|church|chrysler|chrome|christmas|chloe|chintai|cheap|chat|chase|channel|chanel|cfd|cfa|cern|ceo|center|ceb|cbs|cbre|cbn|cba|catholic|catering|cat|casino|cash|caseih|case|casa|cartier|cars|careers|career|care|cards|caravan|car|capitalone|capital|capetown|canon|cancerresearch|camp|camera|cam|calvinklein|call|cal|cafe|cab|bzh|buzz|buy|business|builders|build|bugatti|budapest|brussels|brother|broker|broadway|bridgestone|bradesco|box|boutique|bot|boston|bostik|bosch|boots|booking|book|boo|bond|bom|bofa|boehringer|boats|bnpparibas|bnl|bmw|bms|blue|bloomberg|blog|blockbuster|blanco|blackfriday|black|biz|bio|bingo|bing|bike|bid|bible|bharti|bet|bestbuy|best|berlin|bentley|beer|beauty|beats|bcn|bcg|bbva|bbt|bbc|bayern|bauhaus|basketball|baseball|bargains|barefoot|barclays|barclaycard|barcelona|bar|bank|band|bananarepublic|banamex|baidu|baby|azure|axa|aws|avianca|autos|auto|author|auspost|audio|audible|audi|auction|attorney|athleta|associates|asia|asda|arte|art|arpa|army|archi|aramco|arab|aquarelle|apple|app|apartments|aol|anz|anquan|android|analytics|amsterdam|amica|amfam|amex|americanfamily|americanexpress|alstom|alsace|ally|allstate|allfinanz|alipay|alibaba|alfaromeo|akdn|airtel|airforce|airbus|aigo|aig|agency|agakhan|africa|afl|afamilycompany|aetna|aero|aeg|adult|ads|adac|actor|active|aco|accountants|accountant|accenture|academy|abudhabi|abogado|able|abc|abbvie|abbott|abb|abarth|aarp|aaa|onion)(?\x3d[^0-9a-zA-Z@]|$))")),
V=/(?:xn--[\-0-9a-z]+)/,ra=g(/(?:(?:#{validDomainChars}(?:[_-]|#{validDomainChars})*)?#{validDomainChars}\.)/,{validDomainChars:T}),sa=g(/(?:#{validSubdomain}*#{validDomainName}(?:#{validGTLD}|#{validCCTLD}|#{validPunycode}))/,{validDomainName:qa,validSubdomain:ra,validGTLD:U,validCCTLD:R,validPunycode:V}),ta=/[0-9]+/,W=/\u0400-\u04FF/,C=/\xC0-\xD6\xD8-\xF6\xF8-\xFF\u0100-\u024F\u0253\u0254\u0256\u0257\u0259\u025B\u0263\u0268\u026F\u0272\u0289\u028B\u02BB\u0300-\u036F\u1E00-\u1EFF/,X=g(/[a-z#{cyrillicLettersAndMarks}0-9!\*';:=\+,\.\$\/%#\[\]\-\u2013_~@\|&#{latinAccentChars}]/i,
{cyrillicLettersAndMarks:W,latinAccentChars:C}),Y=g("\\((?:#{validGeneralUrlPathChars}+|(?:#{validGeneralUrlPathChars}*\\(#{validGeneralUrlPathChars}+\\)#{validGeneralUrlPathChars}*))\\)",{validGeneralUrlPathChars:X},"i"),ua=g(/[\+\-a-z#{cyrillicLettersAndMarks}0-9=_#\/#{latinAccentChars}]|(?:#{validUrlBalancedParens})/i,{cyrillicLettersAndMarks:W,latinAccentChars:C,validUrlBalancedParens:Y}),va=g("(?:(?:#{validGeneralUrlPathChars}*(?:#{validUrlBalancedParens}#{validGeneralUrlPathChars}*)*#{validUrlPathEndingChars})|(?:@#{validGeneralUrlPathChars}+/))",
{validGeneralUrlPathChars:X,validUrlBalancedParens:Y,validUrlPathEndingChars:ua},"i"),wa=g(/(?:[^A-Za-z0-9@\uff20$#\uff03#{invalidCharsGroup}]|^)/,{invalidCharsGroup:B}),xa=/[a-z0-9!?\*'@\(\);:&=\+\$\/%#\[\]\-_\.,~|]/i,ya=/[a-z0-9\-_&=#\/]/i,za=g("((#{validUrlPrecedingChars})((https?:\\/\\/)?(#{validDomain})(?::(#{validPortNumber}))?(\\/#{validUrlPath}*)?(\\?#{validUrlQueryChars}*#{validUrlQueryEndingChars})?))",{validUrlPrecedingChars:wa,validDomain:sa,validPortNumber:ta,validUrlPath:va,validUrlQueryChars:xa,
validUrlQueryEndingChars:ya},"gi"),Aa=/[-_.\/]$/,Z="undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},Ab="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};(function(){function a(a){this.value=a}function c(b){function d(f,h){try{var g=b[f](h),m=g.value;m instanceof a?Promise.resolve(m.value).then(function(a){d("next",
a)},function(a){d("throw",a)}):c(g.done?"return":"normal",g.value)}catch(l){c("throw",l)}}function c(a,b){switch(a){case "return":f.resolve({value:b,done:!0});break;case "throw":f.reject(b);break;default:f.resolve({value:b,done:!1})}(f=f.next)?d(f.key,f.arg):h=null}var f,h;this._invoke=function(a,b){return new Promise(function(c,e){var g={key:a,arg:b,resolve:c,reject:e,next:null};h?h=h.next=g:(f=h=g,d(a,b))})};"function"!==typeof b.return&&(this.return=void 0)}"function"===typeof Symbol&&Symbol.asyncIterator&&
(c.prototype[Symbol.asyncIterator]=function(){return this});c.prototype.next=function(a){return this._invoke("next",a)};c.prototype.throw=function(a){return this._invoke("throw",a)};c.prototype.return=function(a){return this._invoke("return",a)};return{wrap:function(a){return function(){return new c(a.apply(this,arguments))}},await:function(b){return new a(b)}}})();var Ba=Object.assign||function(a){for(var c=1;c<arguments.length;c++){var b=arguments[c],d;for(d in b)Object.prototype.hasOwnProperty.call(b,
d)&&(a[d]=b[d])}return a},Bb=function(a,c){return c={exports:{}},a(c,c.exports),c.exports}(function(a,c){(function(b){function d(a){throw new RangeError(F[a]);}function e(a,b){for(var c=a.length,d=[];c--;)d[c]=b(a[c]);return d}function f(a,b){var c=a.split("@"),d="";1<c.length&&(d=c[0]+"@",a=c[1]);a=a.replace(E,".");c=a.split(".");c=e(c,b).join(".");return d+c}function h(a){for(var b=[],c=0,d=a.length,f,e;c<d;)f=a.charCodeAt(c++),55296<=f&&56319>=f&&c<d?(e=a.charCodeAt(c++),56320==(e&64512)?b.push(((f&
1023)<<10)+(e&1023)+65536):(b.push(f),c--)):b.push(f);return b}function k(a){return e(a,function(a){var b="";65535<a&&(a-=65536,b+=I(a>>>10&1023|55296),a=56320|a&1023);return b+=I(a)}).join("")}function g(a,b,c){var d=0;a=c?w(a/v):a>>1;for(a+=w(a/b);a>B*r>>1;d+=x)a=w(a/B);return w(d+(B+1)*a/(a+u))}function n(a){var b=[],c=a.length,f,e=0,h=z,p=y,n,m,G,l,q;n=a.lastIndexOf(A);0>n&&(n=0);for(m=0;m<n;++m)128<=a.charCodeAt(m)&&d("not-basic"),b.push(a.charCodeAt(m));for(n=0<n?n+1:0;n<c;){m=e;f=1;for(G=x;;G+=
x){n>=c&&d("invalid-input");l=a.charCodeAt(n++);l=10>l-48?l-22:26>l-65?l-65:26>l-97?l-97:x;(l>=x||l>w((H-e)/f))&&d("overflow");e+=l*f;q=G<=p?t:G>=p+r?r:G-p;if(l<q)break;l=x-q;f>w(H/l)&&d("overflow");f*=l}f=b.length+1;p=g(e-m,f,0==m);w(e/f)>H-h&&d("overflow");h+=w(e/f);e%=f;b.splice(e++,0,h)}return k(b)}function m(a){var b,c,f,e,k,p,n,l,m,q=[],s,u,v;a=h(a);s=a.length;b=z;c=0;k=y;for(p=0;p<s;++p)m=a[p],128>m&&q.push(I(m));for((f=e=q.length)&&q.push(A);f<s;){n=H;for(p=0;p<s;++p)m=a[p],m>=b&&m<n&&(n=
m);u=f+1;n-b>w((H-c)/u)&&d("overflow");c+=(n-b)*u;b=n;for(p=0;p<s;++p)if(m=a[p],m<b&&++c>H&&d("overflow"),m==b){l=c;for(n=x;;n+=x){m=n<=k?t:n>=k+r?r:n-k;if(l<m)break;v=l-m;l=x-m;q.push(I(m+v%l+22+75*(26>m+v%l)-0));l=w(v/l)}q.push(I(l+22+75*(26>l)-0));k=g(c,u,f==e);c=0;++f}++c;++b}return q.join("")}var l=c&&!c.nodeType&&c,q=a&&!a.nodeType&&a,p="object"==Ab(Z)&&Z;if(p.global===p||p.window===p||p.self===p)b=p;var H=2147483647,x=36,t=1,r=26,u=38,v=700,y=72,z=128,A="-",C=/^xn--/,D=/[^\x20-\x7E]/,E=/[\x2E\u3002\uFF0E\uFF61]/g,
F={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input \x3e\x3d 0x80 (not a basic code point)","invalid-input":"Invalid input"},B=x-t,w=Math.floor,I=String.fromCharCode,s,p={version:"1.4.1",ucs2:{decode:h,encode:k},decode:n,encode:m,toASCII:function(a){return f(a,function(a){return D.test(a)?"xn--"+m(a):a})},toUnicode:function(a){return f(a,function(a){return C.test(a)?n(a.slice(4).toLowerCase()):a})}};if(l&&q)if(a.exports==l)q.exports=p;else for(s in p)p.hasOwnProperty(s)&&
(l[s]=p[s]);else b.punycode=p})(Z)}),$=g(/(?:(?:[\-a-z0-9#{latinAccentChars}]+)\.)+(?:#{validGTLD}|#{validCCTLD}|#{validPunycode})/gi,{latinAccentChars:C,validGTLD:U,validCCTLD:R,validPunycode:V}),Cb={toAscii:function(a){if("xn--"!==a.substring(0,4)||a.match($)){a=a.split(".");for(var c=0;c<a.length;c++){var b=Bb.toASCII(a[c]);if(1>b.length||63<b.length)return}return a.join(".")}}},Ca=/^https?:\/\/t\.co\/([a-z0-9]+)/i,Db={extractUrlsWithoutProtocol:!0},y=function(a){var c=1<arguments.length&&void 0!==
arguments[1]?arguments[1]:Db;if(!a||(c.extractUrlsWithoutProtocol?!a.match(/\./):!a.match(/:/)))return[];for(var b=[],d=function(){var a=RegExp.$2,d=RegExp.$3,h=RegExp.$4,k=RegExp.$5,g=RegExp.$7,n=za.lastIndex,m=n-d.length;if(!Eb(d,h||"https://",k))return"continue";if(h){if(d.match(Ca)){if((a=RegExp.$1)&&40<a.length)return"continue";d=RegExp.lastMatch;n=m+d.length}b.push({url:d,indices:[m,n]})}else{if(!c.extractUrlsWithoutProtocol||a.match(Aa))return"continue";var l=null,q=0;k.replace($,function(a){var c=
k.indexOf(a,q);q=c+a.length;l={url:a,indices:[m+c,m+q]};b.push(l)});if(null==l)return"continue";g&&(l.url=d.replace(k,l.url),l.indices[1]=n)}};za.exec(a);)d();return b},Eb=function(a,c,b){a=a.length;var d=Cb.toAscii(b);if(!d||!d.length)return!1;a=a+d.length-b.length;return 4096>=c.length+a},aa=function(a){a.sort(function(a,b){return a.indices[0]-b.indices[0]});for(var c=a[0],b=1;b<a.length;b++)c.indices[1]>a[b].indices[0]?(a.splice(b,1),b--):c=a[b]},ba=/\ud800[\udc00-\udc0b\udc0d-\udc26\udc28-\udc3a\udc3c\udc3d\udc3f-\udc4d\udc50-\udc5d\udc80-\udcfa\uddfd\ude80-\ude9c\udea0-\uded0\udee0\udf00-\udf1f\udf30-\udf40\udf42-\udf49\udf50-\udf7a\udf80-\udf9d\udfa0-\udfc3\udfc8-\udfcf]|\ud801[\udc00-\udc9d\udd00-\udd27\udd30-\udd63\ude00-\udf36\udf40-\udf55\udf60-\udf67]|\ud802[\udc00-\udc05\udc08\udc0a-\udc35\udc37\udc38\udc3c\udc3f-\udc55\udc60-\udc76\udc80-\udc9e\udd00-\udd15\udd20-\udd39\udd80-\uddb7\uddbe\uddbf\ude00-\ude03\ude05\ude06\ude0c-\ude13\ude15-\ude17\ude19-\ude33\ude38-\ude3a\ude3f\ude60-\ude7c\ude80-\ude9c\udec0-\udec7\udec9-\udee6\udf00-\udf35\udf40-\udf55\udf60-\udf72\udf80-\udf91]|\ud803[\udc00-\udc48]|\ud804[\udc00-\udc46\udc7f-\udcba\udcd0-\udce8\udd00-\udd34\udd50-\udd73\udd76\udd80-\uddc4\uddda\ude00-\ude11\ude13-\ude37\udeb0-\udeea\udf01-\udf03\udf05-\udf0c\udf0f\udf10\udf13-\udf28\udf2a-\udf30\udf32\udf33\udf35-\udf39\udf3c-\udf44\udf47\udf48\udf4b-\udf4d\udf57\udf5d-\udf63\udf66-\udf6c\udf70-\udf74]|\ud805[\udc80-\udcc5\udcc7\udd80-\uddb5\uddb8-\uddc0\ude00-\ude40\ude44\ude80-\udeb7]|\ud806[\udca0-\udcdf\udcff\udec0-\udef8]|\ud808[\udc00-\udf98]|\ud80c[\udc00-\udfff]|\ud80d[\udc00-\udc2e]|\ud81a[\udc00-\ude38\ude40-\ude5e\uded0-\udeed\udef0-\udef4\udf00-\udf36\udf40-\udf43\udf63-\udf77\udf7d-\udf8f]|\ud81b[\udf00-\udf44\udf50-\udf7e\udf8f-\udf9f]|\ud82c[\udc00\udc01]|\ud82f[\udc00-\udc6a\udc70-\udc7c\udc80-\udc88\udc90-\udc99\udc9d\udc9e]|\ud834[\udd65-\udd69\udd6d-\udd72\udd7b-\udd82\udd85-\udd8b\uddaa-\uddad\ude42-\ude44]|\ud835[\udc00-\udc54\udc56-\udc9c\udc9e\udc9f\udca2\udca5\udca6\udca9-\udcac\udcae-\udcb9\udcbb\udcbd-\udcc3\udcc5-\udd05\udd07-\udd0a\udd0d-\udd14\udd16-\udd1c\udd1e-\udd39\udd3b-\udd3e\udd40-\udd44\udd46\udd4a-\udd50\udd52-\udea5\udea8-\udec0\udec2-\udeda\udedc-\udefa\udefc-\udf14\udf16-\udf34\udf36-\udf4e\udf50-\udf6e\udf70-\udf88\udf8a-\udfa8\udfaa-\udfc2\udfc4-\udfcb]|\ud83a[\udc00-\udcc4\udcd0-\udcd6]|\ud83b[\ude00-\ude03\ude05-\ude1f\ude21\ude22\ude24\ude27\ude29-\ude32\ude34-\ude37\ude39\ude3b\ude42\ude47\ude49\ude4b\ude4d-\ude4f\ude51\ude52\ude54\ude57\ude59\ude5b\ude5d\ude5f\ude61\ude62\ude64\ude67-\ude6a\ude6c-\ude72\ude74-\ude77\ude79-\ude7c\ude7e\ude80-\ude89\ude8b-\ude9b\udea1-\udea3\udea5-\udea9\udeab-\udebb]|\ud840[\udc00-\udfff]|\ud841[\udc00-\udfff]|\ud842[\udc00-\udfff]|\ud843[\udc00-\udfff]|\ud844[\udc00-\udfff]|\ud845[\udc00-\udfff]|\ud846[\udc00-\udfff]|\ud847[\udc00-\udfff]|\ud848[\udc00-\udfff]|\ud849[\udc00-\udfff]|\ud84a[\udc00-\udfff]|\ud84b[\udc00-\udfff]|\ud84c[\udc00-\udfff]|\ud84d[\udc00-\udfff]|\ud84e[\udc00-\udfff]|\ud84f[\udc00-\udfff]|\ud850[\udc00-\udfff]|\ud851[\udc00-\udfff]|\ud852[\udc00-\udfff]|\ud853[\udc00-\udfff]|\ud854[\udc00-\udfff]|\ud855[\udc00-\udfff]|\ud856[\udc00-\udfff]|\ud857[\udc00-\udfff]|\ud858[\udc00-\udfff]|\ud859[\udc00-\udfff]|\ud85a[\udc00-\udfff]|\ud85b[\udc00-\udfff]|\ud85c[\udc00-\udfff]|\ud85d[\udc00-\udfff]|\ud85e[\udc00-\udfff]|\ud85f[\udc00-\udfff]|\ud860[\udc00-\udfff]|\ud861[\udc00-\udfff]|\ud862[\udc00-\udfff]|\ud863[\udc00-\udfff]|\ud864[\udc00-\udfff]|\ud865[\udc00-\udfff]|\ud866[\udc00-\udfff]|\ud867[\udc00-\udfff]|\ud868[\udc00-\udfff]|\ud869[\udc00-\uded6\udf00-\udfff]|\ud86a[\udc00-\udfff]|\ud86b[\udc00-\udfff]|\ud86c[\udc00-\udfff]|\ud86d[\udc00-\udf34\udf40-\udfff]|\ud86e[\udc00-\udc1d]|\ud87e[\udc00-\ude1d]|\udb40[\udd00-\uddef]/,
ca=/A-Za-z\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0300-\u0374\u0376\u0377\u037a-\u037d\u037f\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u0483-\u052f\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u05d0-\u05ea\u05f0-\u05f2\u0610-\u061a\u0620-\u065f\u066e-\u06d3\u06d5-\u06dc\u06df-\u06e8\u06ea-\u06ef\u06fa-\u06fc\u06ff\u0710-\u074a\u074d-\u07b1\u07ca-\u07f5\u07fa\u0800-\u082d\u0840-\u085b\u08a0-\u08b2\u08e4-\u0963\u0971-\u0983\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bc-\u09c4\u09c7\u09c8\u09cb-\u09ce\u09d7\u09dc\u09dd\u09df-\u09e3\u09f0\u09f1\u0a01-\u0a03\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a3c\u0a3e-\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a59-\u0a5c\u0a5e\u0a70-\u0a75\u0a81-\u0a83\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abc-\u0ac5\u0ac7-\u0ac9\u0acb-\u0acd\u0ad0\u0ae0-\u0ae3\u0b01-\u0b03\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3c-\u0b44\u0b47\u0b48\u0b4b-\u0b4d\u0b56\u0b57\u0b5c\u0b5d\u0b5f-\u0b63\u0b71\u0b82\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bbe-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcd\u0bd0\u0bd7\u0c00-\u0c03\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c39\u0c3d-\u0c44\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c58\u0c59\u0c60-\u0c63\u0c81-\u0c83\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbc-\u0cc4\u0cc6-\u0cc8\u0cca-\u0ccd\u0cd5\u0cd6\u0cde\u0ce0-\u0ce3\u0cf1\u0cf2\u0d01-\u0d03\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d-\u0d44\u0d46-\u0d48\u0d4a-\u0d4e\u0d57\u0d60-\u0d63\u0d7a-\u0d7f\u0d82\u0d83\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0dca\u0dcf-\u0dd4\u0dd6\u0dd8-\u0ddf\u0df2\u0df3\u0e01-\u0e3a\u0e40-\u0e4e\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb9\u0ebb-\u0ebd\u0ec0-\u0ec4\u0ec6\u0ec8-\u0ecd\u0edc-\u0edf\u0f00\u0f18\u0f19\u0f35\u0f37\u0f39\u0f3e-\u0f47\u0f49-\u0f6c\u0f71-\u0f84\u0f86-\u0f97\u0f99-\u0fbc\u0fc6\u1000-\u103f\u1050-\u108f\u109a-\u109d\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u135d-\u135f\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16f1-\u16f8\u1700-\u170c\u170e-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176c\u176e-\u1770\u1772\u1773\u1780-\u17d3\u17d7\u17dc\u17dd\u180b-\u180d\u1820-\u1877\u1880-\u18aa\u18b0-\u18f5\u1900-\u191e\u1920-\u192b\u1930-\u193b\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19b0-\u19c9\u1a00-\u1a1b\u1a20-\u1a5e\u1a60-\u1a7c\u1a7f\u1aa7\u1ab0-\u1abe\u1b00-\u1b4b\u1b6b-\u1b73\u1b80-\u1baf\u1bba-\u1bf3\u1c00-\u1c37\u1c4d-\u1c4f\u1c5a-\u1c7d\u1cd0-\u1cd2\u1cd4-\u1cf6\u1cf8\u1cf9\u1d00-\u1df5\u1dfc-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u20d0-\u20f0\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2183\u2184\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d7f-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2de0-\u2dff\u2e2f\u3005\u3006\u302a-\u302f\u3031-\u3035\u303b\u303c\u3041-\u3096\u3099\u309a\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua672\ua674-\ua67d\ua67f-\ua69d\ua69f-\ua6e5\ua6f0\ua6f1\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua7ad\ua7b0\ua7b1\ua7f7-\ua827\ua840-\ua873\ua880-\ua8c4\ua8e0-\ua8f7\ua8fb\ua90a-\ua92d\ua930-\ua953\ua960-\ua97c\ua980-\ua9c0\ua9cf\ua9e0-\ua9ef\ua9fa-\ua9fe\uaa00-\uaa36\uaa40-\uaa4d\uaa60-\uaa76\uaa7a-\uaac2\uaadb-\uaadd\uaae0-\uaaef\uaaf2-\uaaf6\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uab30-\uab5a\uab5c-\uab5f\uab64\uab65\uabc0-\uabea\uabec\uabed\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf870-\uf87f\uf882\uf884-\uf89f\uf8b8\uf8c1-\uf8d6\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe00-\ufe0f\ufe20-\ufe2d\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc/,
s=/[\uD800-\uDBFF][\uDC00-\uDFFF]/mg,Da=g(/(?:[#{bmpLetterAndMarks}]|(?=#{nonBmpCodePairs})(?:#{astralLetterAndMarks}))/,{bmpLetterAndMarks:ca,nonBmpCodePairs:s,astralLetterAndMarks:ba}),Ea=/\ud801[\udca0-\udca9]|\ud804[\udc66-\udc6f\udcf0-\udcf9\udd36-\udd3f\uddd0-\uddd9\udef0-\udef9]|\ud805[\udcd0-\udcd9\ude50-\ude59\udec0-\udec9]|\ud806[\udce0-\udce9]|\ud81a[\ude60-\ude69\udf50-\udf59]|\ud835[\udfce-\udfff]/,Fa=/0-9\u0660-\u0669\u06f0-\u06f9\u07c0-\u07c9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0de6-\u0def\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u1090-\u1099\u17e0-\u17e9\u1810-\u1819\u1946-\u194f\u19d0-\u19d9\u1a80-\u1a89\u1a90-\u1a99\u1b50-\u1b59\u1bb0-\u1bb9\u1c40-\u1c49\u1c50-\u1c59\ua620-\ua629\ua8d0-\ua8d9\ua900-\ua909\ua9d0-\ua9d9\ua9f0-\ua9f9\uaa50-\uaa59\uabf0-\uabf9\uff10-\uff19/,
Ga=/_\u200c\u200d\ua67e\u05be\u05f3\u05f4\uff5e\u301c\u309b\u309c\u30a0\u30fb\u3003\u0f0b\u0f0c\xb7/,da=g(/(?:[#{bmpLetterAndMarks}#{bmpNumerals}#{hashtagSpecialChars}]|(?=#{nonBmpCodePairs})(?:#{astralLetterAndMarks}|#{astralNumerals}))/,{bmpLetterAndMarks:ca,bmpNumerals:Fa,hashtagSpecialChars:Ga,nonBmpCodePairs:s,astralLetterAndMarks:ba,astralNumerals:Ea}),Ha=/(?:[^\uD800-\uDFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF])/,Ia=g(/(?:^|\uFE0E|\uFE0F|$|(?!#{hashtagAlphaNumeric}|&)#{codePoint})/,{codePoint:Ha,
hashtagAlphaNumeric:da}),Ja=g(/(#{hashtagBoundary})(#{hashSigns})(?!\uFE0F|\u20E3)(#{hashtagAlphaNumeric}*#{hashtagAlpha}#{hashtagAlphaNumeric}*)/gi,{hashtagBoundary:Ia,hashSigns:F,hashtagAlphaNumeric:da,hashtagAlpha:Da}),J=function(a,c){c||(c={checkUrlOverlap:!0});if(!a||!a.match(F))return[];var b=[];a.replace(Ja,function(a,c,d,e,n,g){g.slice(n+a.length).match(oa)||(a=n+c.length,b.push({hashtag:e,indices:[a,a+e.length+1]}))});if(c.checkUrlOverlap){var d=y(a);if(0<d.length){d=b.concat(d);aa(d);for(var b=
[],e=0;e<d.length;e++)d[e].hashtag&&b.push(d[e])}}return b},z=/[@\uff20]/,ea=g(/^(?:#{atSigns}|[#{latinAccentChars}]|:\/\/)/,{atSigns:z,latinAccentChars:C}),Ka=/(?:^|[^a-zA-Z0-9_!#$%&*@\uff20]|(?:^|[^a-zA-Z0-9_+~.-])(?:rt|RT|rT|Rt):?)/,fa=g("(#{validMentionPrecedingChars})(#{atSigns})([a-zA-Z0-9_]{1,20})(/[a-zA-Z][a-zA-Z0-9_-]{0,24})?",{validMentionPrecedingChars:Ka,atSigns:z},"g"),K=function(a){if(!a||!a.match(z))return[];var c=[];a.replace(fa,function(a,d,e,f,h,k,g){g.slice(k+a.length).match(ea)||
(h=h||"",a=k+d.length,c.push({screenName:f,listSlug:h,indices:[a,a+f.length+h.length+1]}))});return c},La=function(a,c){var b=y(a,c).concat(K(a)).concat(J(a,{checkUrlOverlap:!1})).concat(E(a));if(0==b.length)return[];aa(b);return b},D=function(a){var c={},b;for(b in a)a.hasOwnProperty(b)&&(c[b]=a[b]);return c},Fb={disabled:!0,readonly:!0,multiple:!0,checked:!0},Gb={urlClass:!0,listClass:!0,usernameClass:!0,hashtagClass:!0,cashtagClass:!0,usernameUrlBase:!0,listUrlBase:!0,hashtagUrlBase:!0,cashtagUrlBase:!0,
usernameUrlBlock:!0,listUrlBlock:!0,hashtagUrlBlock:!0,linkUrlBlock:!0,usernameIncludeSymbol:!0,suppressLists:!0,suppressNoFollow:!0,targetBlank:!0,suppressDataScreenName:!0,urlEntities:!0,symbolTag:!0,textWithSymbolTag:!0,urlTarget:!0,invisibleTagAttrs:!0,linkAttributeBlock:!0,linkTextBlock:!0,htmlEscapeNonEntities:!0},Ma=function(a){var c={},b;for(b in a){var d=a[b];Gb[b]||(Fb[b]&&(d=d?b:null),null!=d&&(c[b]=d))}return c},Hb={"\x26":"\x26amp;","\x3e":"\x26gt;","\x3c":"\x26lt;",'"':"\x26quot;","'":"\x26#39;"},
t=function(a){return a&&a.replace(/[&"'><]/g,function(a){return Hb[a]})},Ib={disabled:!0,readonly:!0,multiple:!0,checked:!0},Na=function(a){var c="",b;for(b in a){var d=a[b];Ib[b]&&(d=d?b:null);null!=d&&(c+=" "+t(b)+'\x3d"'+t(d.toString())+'"')}return c},L=function(a,c,b,d){d.suppressNoFollow||(b.rel="nofollow");d.linkAttributeBlock&&d.linkAttributeBlock(a,b);d.linkTextBlock&&(c=d.linkTextBlock(a,c));a={text:c,attr:Na(b)};return S("\x3ca#{attr}\x3e#{text}\x3c/a\x3e",a)},M=function(a,c,b,d,e){var f=
e.symbolTag?"\x3c"+e.symbolTag+"\x3e"+c+"\x3c/"+e.symbolTag+"\x3e":c;b=t(b);b=e.textWithSymbolTag?"\x3c"+e.textWithSymbolTag+"\x3e"+b+"\x3c/"+e.textWithSymbolTag+"\x3e":b;return e.usernameIncludeSymbol||!c.match(z)?L(a,f+b,d,e):f+L(a,b,d,e)},Oa=function(a,c,b){c=t(a.cashtag);var d=D(b.htmlAttrs||{});d.href=b.cashtagUrlBase+c;d.title="$"+c;d["class"]=b.cashtagClass;b.targetBlank&&(d.target="_blank");return M(a,"$",c,d,b)},Pa=/[\u0600-\u06FF]|[\u0750-\u077F]|[\u0590-\u05FF]|[\uFE70-\uFEFF]/mg,Qa=function(a,
c,b){c=c.substring(a.indices[0],a.indices[0]+1);var d=t(a.hashtag),e=D(b.htmlAttrs||{});e.href=b.hashtagUrlBase+d;e.title="#"+d;e["class"]=b.hashtagClass;d.charAt(0).match(Pa)&&(e["class"]+=" rtl");b.targetBlank&&(e.target="_blank");return M(a,c,d,e,b)},Ra=function(a,c){var b=a.display_url,d=a.expanded_url,e=b.replace(/\u2026/g,"");if(-1!=d.indexOf(e)){var f=d.indexOf(e),b={displayUrlSansEllipses:e,beforeDisplayUrl:d.substr(0,f),afterDisplayUrl:d.substr(f+e.length),precedingEllipsis:b.match(/^\u2026/)?
"\u2026":"",followingEllipsis:b.match(/\u2026$/)?"\u2026":""},h;for(h in b)b.hasOwnProperty(h)&&(b[h]=t(b[h]));b.invisible=c.invisibleTagAttrs;return S("\x3cspan class\x3d'tco-ellipsis'\x3e#{precedingEllipsis}\x3cspan #{invisible}\x3e\x26nbsp;\x3c/span\x3e\x3c/span\x3e\x3cspan #{invisible}\x3e#{beforeDisplayUrl}\x3c/span\x3e\x3cspan class\x3d'js-display-url'\x3e#{displayUrlSansEllipses}\x3c/span\x3e\x3cspan #{invisible}\x3e#{afterDisplayUrl}\x3c/span\x3e\x3cspan class\x3d'tco-ellipsis'\x3e\x3cspan #{invisible}\x3e\x26nbsp;\x3c/span\x3e#{followingEllipsis}\x3c/span\x3e",
b)}return b},Sa=/^https?:\/\//i,Ta=function(a,c,b){c=a.url;var d=t(c),e=b.urlEntities&&b.urlEntities[c]||a;e.display_url&&(d=Ra(e,b));var f=D(b.htmlAttrs||{});c.match(Sa)||(c="http://"+c);f.href=c;b.targetBlank&&(f.target="_blank");b.urlClass&&(f["class"]=b.urlClass);b.urlTarget&&(f.target=b.urlTarget);!b.title&&e.display_url&&(f.title=e.expanded_url);return L(a,d,f,b)},Ua=function(a,c,b){c=c.substring(a.indices[0],a.indices[0]+1);var d=t(a.screenName),e=t(a.listSlug),f=a.listSlug&&!b.suppressLists,
h=D(b.htmlAttrs||{});h["class"]=f?b.listClass:b.usernameClass;h.href=f?b.listUrlBase+d+e:b.usernameUrlBase+d;!f&&!b.suppressDataScreenName&&(h["data-screen-name"]=d);b.targetBlank&&(h.target="_blank");return M(a,c,f?d+e:d,h,b)},u=function(a,c,b){b=D(b||{});b.hashtagClass=b.hashtagClass||"tweet-url hashtag";b.hashtagUrlBase=b.hashtagUrlBase||"https://twitter.com/search?q\x3d%23";b.cashtagClass=b.cashtagClass||"tweet-url cashtag";b.cashtagUrlBase=b.cashtagUrlBase||"https://twitter.com/search?q\x3d%24";
b.listClass=b.listClass||"tweet-url list-slug";b.usernameClass=b.usernameClass||"tweet-url username";b.usernameUrlBase=b.usernameUrlBase||"https://twitter.com/";b.listUrlBase=b.listUrlBase||"https://twitter.com/";b.htmlAttrs=Ma(b);b.invisibleTagAttrs=b.invisibleTagAttrs||"style\x3d'position:absolute;left:-9999px;'";var d,e,f;if(b.urlEntities){d={};e=0;for(f=b.urlEntities.length;e<f;e++)d[b.urlEntities[e].url]=b.urlEntities[e];b.urlEntities=d}d="";f=0;c.sort(function(a,b){return a.indices[0]-b.indices[0]});
var h=b.htmlEscapeNonEntities?t:function(a){return a};for(e=0;e<c.length;e++){var k=c[e];d+=h(a.substring(f,k.indices[0]));k.url?d+=Ta(k,a,b):k.hashtag?d+=Qa(k,a,b):k.screenName?d+=Ua(k,a,b):k.cashtag&&(d+=Oa(k,a,b));f=k.indices[1]}return d+=h(a.substring(f,a.length))},Va=function(a,c,b){if(0!==c.length){var d=0,e=0;c.sort(function(a,b){return a.indices[0]-b.indices[0]});for(var f=0,h=c[0];d<a.length;){if(h.indices[0]===(b?d:e)){var k=h.indices[1]-h.indices[0];h.indices[0]=b?e:d;h.indices[1]=h.indices[0]+
k;f++;if(f===c.length)break;h=c[f]}k=a.charCodeAt(d);55296<=k&&(56319>=k&&d<a.length-1)&&(k=a.charCodeAt(d+1),56320<=k&&57343>=k&&d++);e++;d++}}},Wa=function(a,c){Va(a,c,!1)},Xa={version:2,maxWeightedTweetLength:280,scale:100,defaultWeight:200,transformedURLLength:23,ranges:[{start:0,end:4351,weight:100},{start:8192,end:8205,weight:100},{start:8208,end:8223,weight:100},{start:8242,end:8247,weight:100}]},A={defaults:Xa,version1:{version:1,maxWeightedTweetLength:140,scale:1,defaultWeight:1,transformedURLLength:23,
ranges:[]},version2:Xa},Ya=function(a){var c=[];a=J(a);for(var b=0;b<a.length;b++)c.push(a[b].hashtag);return c},Za=function(a){var c=[],b=void 0;a=K(a);for(var d=0;d<a.length;d++)b=a[d],""===b.listSlug&&c.push({screenName:b.screenName,indices:b.indices});return c},$a=function(a){var c=[];a=Za(a);for(var b=0;b<a.length;b++)c.push(a[b].screenName);return c},ab=g(/^(?:#{spaces})*#{atSigns}([a-zA-Z0-9_]{1,20})/,{atSigns:z,spaces:Q}),Jb=function(a,c){var b=c.ranges,d=c.defaultWeight,e=a.charCodeAt(0);
if(Array.isArray(b))for(var f=0,h=b.length;f<h;f++){var k=b[f];if(e>=k.start&&e<=k.end){d=k.weight;break}}return d},bb=g(/[#{invalidCharsGroup}]/,{invalidCharsGroup:B}),ga=function(a){return bb.test(a)},cb=function(){for(var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",c=Ba({},A.defaults,1<arguments.length&&void 0!==arguments[1]?arguments[1]:A.defaults),b=c.scale,d=c.maxWeightedTweetLength,e=c.transformedURLLength,f="function"===typeof String.prototype.normalize?a.normalize():a,h=y(f),
k=f.length,g=0,n=0,m=!0,l=function(a){var k=h.filter(function(b){return b.indices[0]===a})[0];k?(k=k.url,g+=e*b,a+=k.length-1):(Kb(f,a)&&(a+=1),g+=Jb(f.charAt(a),c));m&&(m=!ga(f.substring(a,a+1)));m&&g<=d*b&&(n=a);q=a},q=0;q<k;q++)l(q);g/=b;m=m&&0<g&&g<=d;k=Math.floor(1E3*(g/d));n+=a.length-f.length;return{weightedLength:g,valid:m,permillage:k,validRangeStart:0,validRangeEnd:n,displayRangeStart:0,displayRangeEnd:0<a.length?a.length-1:0}},Kb=function(a,c){if(c<a.length-1){var b=a.charCodeAt(c),d=a.charCodeAt(c+
1);return 55296<=b&&56319>=b&&56320<=d&&57343>=d}return!1},db=function(a){return cb(a,1<arguments.length&&void 0!==arguments[1]?arguments[1]:A.defaults).weightedLength},eb=function(a){a=a.split("\x3c");for(var c=void 0,b=[],c=void 0,d=0;d<a.length;d+=1)if(c=a[d])for(var c=c.split("\x3e"),e=0;e<c.length;e+=1)b.push(c[e]);else b.push("");return b},fb=function(a){if(!a)return"empty";var c=Ba({},A.defaults,1<arguments.length&&void 0!==arguments[1]?arguments[1]:A.defaults),b=c.maxWeightedTweetLength;return db(a,
c)>b?"too_long":ga(a)?"invalid_characters":!1},Lb=g(/^#{validMentionOrList}$/,{validMentionOrList:fa}),ha=/[a-z\u0400-\u04FF0-9\-._~]/i,ia=/(?:%[0-9a-f]{2})/i,ja=/[!$&'()*+,;=]/i,ka=g("(?:#{validateUrlUnreserved}|#{validateUrlPctEncoded}|#{validateUrlSubDelims}|:)*",{validateUrlUnreserved:ha,validateUrlPctEncoded:ia,validateUrlSubDelims:ja},"i"),gb=/(?:[a-z0-9](?:[a-z0-9\-]*[a-z0-9])?)/i,hb=/(?:[a-z](?:[a-z0-9\-]*[a-z0-9])?)/i,ib=/(?:[a-z0-9](?:[a-z0-9_\-]*[a-z0-9])?)/i,jb=g(/(?:(?:#{validateUrlSubDomainSegment}\.)*(?:#{validateUrlDomainSegment}\.)#{validateUrlDomainTld})/i,
{validateUrlSubDomainSegment:ib,validateUrlDomainSegment:gb,validateUrlDomainTld:hb}),kb=/(?:[0-9]|(?:[1-9][0-9])|(?:1[0-9]{2})|(?:2[0-4][0-9])|(?:25[0-5]))/i,lb=g(/(?:#{validateUrlDecOctet}(?:\.#{validateUrlDecOctet}){3})/i,{validateUrlDecOctet:kb}),mb=/(?:\[[a-f0-9:\.]+\])/i,la=g("(?:#{validateUrlIpv4}|#{validateUrlIpv6})",{validateUrlIpv4:lb,validateUrlIpv6:mb},"i"),nb=g("(?:#{validateUrlIp}|#{validateUrlDomain})",{validateUrlIp:la,validateUrlDomain:jb},"i"),ma=/[0-9]{1,5}/,ob=g("(?:(#{validateUrlUserinfo})@)?(#{validateUrlHost})(?::(#{validateUrlPort}))?",
{validateUrlUserinfo:ka,validateUrlHost:nb,validateUrlPort:ma},"i"),N=g("(?:#{validateUrlUnreserved}|#{validateUrlPctEncoded}|#{validateUrlSubDelims}|[:|@])",{validateUrlUnreserved:ha,validateUrlPctEncoded:ia,validateUrlSubDelims:ja},"i"),pb=g(/(#{validateUrlPchar}|\/|\?)*/i,{validateUrlPchar:N}),qb=g(/(\/#{validateUrlPchar}*)*/i,{validateUrlPchar:N}),rb=g(/(#{validateUrlPchar}|\/|\?)*/i,{validateUrlPchar:N}),sb=/(?:[a-z][a-z0-9+\-.]*)/i,tb=g("^(?:([^:/?#]+):\\/\\/)?([^/?#]*)([^?#]*)(?:\\?([^#]*))?(?:#(.*))?$",
"i"),ub=/(?:(?:[a-z0-9]|[^\u0000-\u007f])(?:(?:[a-z0-9_\-]|[^\u0000-\u007f])*(?:[a-z0-9]|[^\u0000-\u007f]))?)/i,vb=/(?:(?:[a-z0-9]|[^\u0000-\u007f])(?:(?:[a-z0-9\-]|[^\u0000-\u007f])*(?:[a-z0-9]|[^\u0000-\u007f]))?)/i,wb=/(?:(?:[a-z]|[^\u0000-\u007f])(?:(?:[a-z0-9\-]|[^\u0000-\u007f])*(?:[a-z0-9]|[^\u0000-\u007f]))?)/i,xb=g(/(?:(?:#{validateUrlUnicodeSubDomainSegment}\.)*(?:#{validateUrlUnicodeDomainSegment}\.)#{validateUrlUnicodeDomainTld})/i,{validateUrlUnicodeSubDomainSegment:ub,validateUrlUnicodeDomainSegment:vb,
validateUrlUnicodeDomainTld:wb}),yb=g("(?:#{validateUrlIp}|#{validateUrlUnicodeDomain})",{validateUrlIp:la,validateUrlUnicodeDomain:xb},"i"),zb=g("(?:(#{validateUrlUserinfo})@)?(#{validateUrlUnicodeHost})(?::(#{validateUrlPort}))?",{validateUrlUserinfo:ka,validateUrlUnicodeHost:yb,validateUrlPort:ma},"i");(function(){"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(a,c){if(null==a)throw new TypeError("Cannot convert undefined or null to object");for(var b=Object(a),
d=1;d<arguments.length;d++){var e=arguments[d];if(null!=e)for(var f in e)Object.prototype.hasOwnProperty.call(e,f)&&(b[f]=e[f])}return b},writable:!0,configurable:!0})})();return{autoLink:function(a,c){var b=La(a,{extractUrlsWithoutProtocol:!1});return u(a,b,c)},autoLinkCashtags:function(a,c){var b=E(a);return u(a,b,c)},autoLinkEntities:u,autoLinkHashtags:function(a,c){var b=J(a);return u(a,b,c)},autoLinkUrlsCustom:function(a,c){var b=y(a,{extractUrlsWithoutProtocol:!1});return u(a,b,c)},autoLinkUsernamesOrLists:function(a,
c){var b=K(a);return u(a,b,c)},autoLinkWithJSON:function(a,c,b){if(c.user_mentions)for(var d=0;d<c.user_mentions.length;d++)c.user_mentions[d].screenName=c.user_mentions[d].screen_name;if(c.hashtags)for(d=0;d<c.hashtags.length;d++)c.hashtags[d].hashtag=c.hashtags[d].text;if(c.symbols)for(d=0;d<c.symbols.length;d++)c.symbols[d].cashtag=c.symbols[d].text;var d=[],e;for(e in c)d=d.concat(c[e]);Wa(a,d);return u(a,d,b)},configs:A,convertUnicodeIndices:function(a,c,b){if(0!=c.length){var d=0,e=0;c.sort(function(a,
b){return a.indices[0]-b.indices[0]});for(var f=0,h=c[0];d<a.length;){if(h.indices[0]==(b?d:e)){var g=h.indices[1]-h.indices[0];h.indices[0]=b?e:d;h.indices[1]=h.indices[0]+g;f++;if(f==c.length)break;h=c[f]}g=a.charCodeAt(d);55296<=g&&(56319>=g&&d<a.length-1)&&(g=a.charCodeAt(d+1),56320<=g&&57343>=g&&d++);e++;d++}}},extractCashtags:function(a){var c=[];a=E(a);for(var b=0;b<a.length;b++)c.push(a[b].cashtag);return c},extractCashtagsWithIndices:E,extractEntitiesWithIndices:La,extractHashtags:Ya,extractHashtagsWithIndices:J,
extractHtmlAttrsFromOptions:Ma,extractMentions:$a,extractMentionsOrListsWithIndices:K,extractMentionsWithIndices:Za,extractReplies:function(a){if(!a)return null;a=a.match(ab);return!a||RegExp.rightContext.match(ea)?null:a[1]},extractUrls:function(a,c){for(var b=[],d=y(a,c),e=0;e<d.length;e++)b.push(d[e].url);return b},extractUrlsWithIndices:y,getTweetLength:db,getUnicodeTextLength:function(a){return a.replace(s," ").length},hasInvalidCharacters:ga,hitHighlight:function(a,c,b){c=c||[];b=b||{};if(0===
c.length)return a;b=b.tag||"em";b=["\x3c"+b+"\x3e","\x3c/"+b+"\x3e"];a=eb(a);for(var d=void 0,e=void 0,f="",g=0,k=a[0],r=0,n=0,m=!1,l=k,q=[],p=d=void 0,s=e=void 0,p=void 0,d=0;d<c.length;d+=1)for(e=0;e<c[d].length;e+=1)q.push(c[d][e]);for(d=0;d<q.length;d+=1){p=q[d];e=b[d%2];for(s=!1;null!=k&&p>=r+k.length;)f+=l.slice(n),m&&p===r+l.length&&(f+=e,s=!0),a[g+1]&&(f+="\x3c"+a[g+1]+"\x3e"),r+=l.length,n=0,g+=2,l=k=a[g],m=!1;!s&&null!=k?(p-=r,f+=l.slice(n,p)+e,n=p,m=0===d%2?!0:!1):s||(f+=e)}if(null!=k){n<
l.length&&(f+=l.slice(n));for(d=g+1;d<a.length;d+=1)f+=0===d%2?a[d]:"\x3c"+a[d]+"\x3e"}return f},htmlEscape:t,isInvalidTweet:fb,isValidHashtag:function(a){if(!a)return!1;var c=Ya(a);return 1===c.length&&c[0]===a.slice(1)},isValidList:function(a){a=a.match(Lb);return!(!a||!(""==a[1]&&a[4]))},isValidTweetText:function(a,c){return!fb(a,c)},isValidUrl:function(a,c,b){null==c&&(c=!0);null==b&&(b=!0);if(!a)return!1;var d=a.match(tb);if(!d||d[0]!==a)return!1;a=d[1];var e=d[2],f=d[3],g=d[4],d=d[5];return b&&
(!r(a,sb)||!a.match(/^https?$/i))||!r(f,qb)||!r(g,rb,!0)||!r(d,pb,!0)?!1:c&&r(e,zb)||!c&&r(e,ob)},isValidUsername:function(a){if(!a)return!1;var c=$a(a);return 1===c.length&&c[0]===a.slice(1)},linkTextWithEntity:Ra,linkToCashtag:Oa,linkToHashtag:Qa,linkToMentionAndList:Ua,linkToText:L,linkToTextWithSymbol:M,linkToUrl:Ta,modifyIndicesFromUTF16ToUnicode:function(a,c){Va(a,c,!0)},modifyIndicesFromUnicodeToUTF16:Wa,regexen:{astralLetterAndMarks:ba,astralNumerals:Ea,atSigns:z,bmpLetterAndMarks:ca,bmpNumerals:Fa,
cashtag:v,codePoint:Ha,cyrillicLettersAndMarks:W,endHashtagMatch:oa,endMentionMatch:ea,hashSigns:F,hashtagAlpha:Da,hashtagAlphaNumeric:da,hashtagBoundary:Ia,hashtagSpecialChars:Ga,invalidChars:bb,invalidCharsGroup:B,invalidDomainChars:pa,invalidUrlWithoutProtocolPrecedingChars:Aa,latinAccentChars:C,nonBmpCodePairs:s,punct:O,rtlChars:Pa,spaces:Q,spacesGroup:P,urlHasHttps:/^https:\/\//i,urlHasProtocol:Sa,validAsciiDomain:$,validateUrlAuthority:ob,validateUrlDecOctet:kb,validateUrlDomain:jb,validateUrlDomainSegment:gb,
validateUrlDomainTld:hb,validateUrlFragment:pb,validateUrlHost:nb,validateUrlIp:la,validateUrlIpv4:lb,validateUrlIpv6:mb,validateUrlPath:qb,validateUrlPchar:N,validateUrlPctEncoded:ia,validateUrlPort:ma,validateUrlQuery:rb,validateUrlScheme:sb,validateUrlSubDelims:ja,validateUrlSubDomainSegment:ib,validateUrlUnencoded:tb,validateUrlUnicodeAuthority:zb,validateUrlUnicodeDomain:xb,validateUrlUnicodeDomainSegment:vb,validateUrlUnicodeDomainTld:wb,validateUrlUnicodeHost:yb,validateUrlUnicodeSubDomainSegment:ub,
validateUrlUnreserved:ha,validateUrlUserinfo:ka,validCashtag:na,validCCTLD:R,validDomain:sa,validDomainChars:T,validDomainName:qa,validGeneralUrlPathChars:X,validGTLD:U,validHashtag:Ja,validMentionOrList:fa,validMentionPrecedingChars:Ka,validPortNumber:ta,validPunycode:V,validReply:ab,validSubdomain:ra,validTcoUrl:Ca,validUrlBalancedParens:Y,validUrlPath:va,validUrlPathEndingChars:ua,validUrlPrecedingChars:wa,validUrlQueryChars:xa,validUrlQueryEndingChars:ya},removeOverlappingEntities:aa,parseTweet:cb,
splitTags:eb,tagAttrs:Na}});
function HelpBubble(){this.isOpen=!1;this.currentParentDivElement=this.bubbleDivElement=null;this.isParentDivHighlighted=!1;this.preferenceConfigOnBubbleClose=this.additionalClass=null;this.currentParentOriginalBorderColor="transparent";this.hideCloseX=!1;this.TAB_MAP={invitePeople:{tabId:"OtherUserProfile_Tab",contentText:LC.getLabel("whatToDoNext","showPeopleTabBubble"),redirectUrl:"/_ui/core/chatter/people/PeopleListPage?displayInviteTip\x3dtrue",additionalClass:"showPeopleTabBubble"},followPeople:{tabId:"OtherUserProfile_Tab",
contentText:LC.getLabel("whatToDoNext","showPeopleTabBubble"),redirectUrl:"/_ui/core/chatter/people/PeopleListPage?displayFollowTip\x3dtrue",additionalClass:"showPeopleTabBubble"},createGroup:{tabId:"CollaborationGroup_Tab",contentText:LC.getLabel("whatToDoNext","showGroupsTabBubble"),redirectUrl:"/_ui/core/chatter/groups/GroupListPage?displayCreateGroupTip\x3dtrue",additionalClass:"showGroupsTabBubble"},joinGroup:{tabId:"CollaborationGroup_Tab",contentText:LC.getLabel("whatToDoNext","showGroupsTabBubble"),
redirectUrl:"/_ui/core/chatter/groups/GroupListPage?filter\x3dall\x26displayJoinGroupTip\x3dtrue",additionalClass:"showGroupsTabBubble"},showProfile:{tabId:"UserProfile_Tab",contentText:LC.getLabel("whatToDoNext","showProfileTabBubble"),redirectUrl:"/_ui/core/userprofile/UserProfilePage",additionalClass:"showProfileTabBubble"}}}HelpBubble.prototype.getBubbleDivId=function(){return HelpBubble.HELP_BUBBLE};HelpBubble.prototype.getBubbleTextContainerId=function(){return"helpBubbleContent"};
HelpBubble.prototype.getBubbleDirectionId=function(){return"helpBubbleDirection"};HelpBubble.prototype.getCloseXId=function(){return"helpBubbleCloseX"};HelpBubble.prototype.hasClass=function(a){return Sfdc.Dom.hasClass(this.bubbleDivElement,a)};
HelpBubble.prototype.resetParentAndBubbleDiv=function(){this.isOpen&&(this.isParentDivHighlighted&&this.currentParentDivElement&&Sfdc.Dom.setStyle(this.currentParentDivElement,HelpBubble.BORDER_COLOR_PROPERTY,this.currentParentOriginalBorderColor),this.additionalClass&&(Sfdc.Dom.removeClass(this.bubbleDivElement,this.additionalClass),this.additionalClass=null),this.hideCloseX&&(Sfdc.Dom.removeClass(Sfdc.get(this.getCloseXId()),HelpBubble.INVISIBLE_CLASS),this.hideCloseX=!1),this.bubbleUniqueId=this.preferenceConfigOnBubbleClose=
this.currentParentDivElement=null,this.isOpen=!1)};HelpBubble.prototype.close=function(a){this.isOpen&&(this.hide(),this.preferenceConfigOnBubbleClose&&UserContext.userPreferences.setBoolean(this.preferenceConfigOnBubbleClose.preferenceBit,this.preferenceConfigOnBubbleClose.value,function(){a&&a()}))};HelpBubble.prototype.hide=function(a){this.isOpen&&(!a||"undefined"==typeof a?this.fadeOut():(Sfdc.Dom.setStyle(this.bubbleDivElement,"opacity",0),this.resetParentAndBubbleDiv()))};
HelpBubble.prototype.fadeIn=function(a){Sfdc.Effects.fadeIn(this.bubbleDivElement,a)};HelpBubble.prototype.fadeOut=function(){var a=this;Sfdc.Effects.fadeOut(this.bubbleDivElement,function(){a.resetParentAndBubbleDiv()})};HelpBubble.LEFT={align:"l-r",pointerClass:"left",offset:[25,0],pointerAlign:"r-l",pointerOffset:[2,0]};HelpBubble.RIGHT={align:"r-l",pointerClass:"right",offset:[-25,0],pointerAlign:"l-r",pointerOffset:[0,0]};
HelpBubble.TOP={align:"t-b",pointerClass:"top",offset:[0,16],pointerAlign:"b-t",pointerOffset:[0,2]};HelpBubble.BOTTOM={align:"b-t",pointerClass:"bottom",offset:[0,-10],pointerAlign:"t-b",pointerOffset:[0,-4]};HelpBubble.BOTTOMLEFT={align:"bl-t",pointerClass:"bottom",offset:[-30,-10],pointerAlign:"t-bl",pointerOffset:[30,0]};HelpBubble.BORDER_COLOR_PROPERTY="borderColor";HelpBubble.HIGHTLIGHT_BORDER_COLOR="#FFE5A9";HelpBubble.INVISIBLE_CLASS="helpBubbleInvisible";HelpBubble.HELP_BUBBLE="helpBubble";
HelpBubble.helpBubble=null;HelpBubble.getElement=function(a){return Sfdc.get(a)||Sfdc.select(a)[0]};HelpBubble.getTabMap=function(){return HelpBubble.getBubble().TAB_MAP};HelpBubble.hideBubble=function(a,c){HelpBubble.isBubblePresent(a)&&HelpBubble.getBubble().hide(c)};HelpBubble.closeBubble=function(a,c){HelpBubble.isBubblePresent(a)&&HelpBubble.getBubble().close(c)};HelpBubble.isBubblePresent=function(a){return HelpBubble.helpBubble&&(!a||HelpBubble.getBubble().hasClass(a))};
HelpBubble.display=function(a){var c=HelpBubble.getElement(a.parentDiv);if(c){var b=HelpBubble.getBubble();b.resetParentAndBubbleDiv();b.currentParentDivElement=c;if(b.isParentDivHighlighted=a.highLightParentDiv)b.currentParentOriginalBorderColor=Sfdc.Dom.getStyle(c,HelpBubble.BORDER_COLOR_PROPERTY),Sfdc.Dom.setStyle(c,HelpBubble.BORDER_COLOR_PROPERTY,HelpBubble.HIGHTLIGHT_BORDER_COLOR);Sfdc.Dom.updateHTML(b.getBubbleTextContainerId(),a.contentText);var f=b.bubbleDivElement;a.additionalClass&&(b.additionalClass=
a.additionalClass,Sfdc.Dom.addClass(f,a.additionalClass));b.preferenceConfigOnBubbleClose=a.preferenceConfigOnBubbleClose;var d=a.pointerDirection;LC.isRtlPage()&&(a.pointerDirection==HelpBubble.LEFT?d=HelpBubble.RIGHT:a.pointerDirection==HelpBubble.RIGHT&&(d=HelpBubble.LEFT));a.hideCloseX&&(Sfdc.Dom.addClass(Sfdc.get(b.getCloseXId()),HelpBubble.INVISIBLE_CLASS),this.hideCloseX=!0);var e=d.offset;a.customExtraOffset&&(e=[e[0]+(LC.isRtlPage()?-a.customExtraOffset[0]:a.customExtraOffset[0]),e[1]+a.customExtraOffset[1]]);
Sfdc.Dom.alignTo(f,c,d.align,e);c=Sfdc.get(b.getBubbleDirectionId());a.hidePointer?Sfdc.Dom.addClass(c,HelpBubble.INVISIBLE_CLASS):(Sfdc.Dom.removeClass(c,[HelpBubble.LEFT.pointerClass,HelpBubble.RIGHT.pointerClass,HelpBubble.TOP.pointerClass,HelpBubble.BOTTOM.pointerClass,HelpBubble.INVISIBLE_CLASS]),Sfdc.Dom.addClass(c,d.pointerClass),Sfdc.Dom.alignTo(c,f,d.pointerAlign,d.pointerOffset));b.fadeIn(a.fadeInCallBackFn);b.isOpen=!0}};
HelpBubble.displayBubble=function(a,c,b,f,d){HelpBubble.display({parentDiv:a,pointerDirection:c,contentText:b,highLightParentDiv:d,additionalClass:f})};HelpBubble.showTabBubble=function(a){HelpBubble.display({parentDiv:a.tabId,pointerDirection:HelpBubble.BOTTOM,contentText:a.contentText,fadeInCallBackFn:function(){navigateToUrl(a.redirectUrl)},additionalClass:a.additionalClass})};
HelpBubble.createBubble=function(){var a=new HelpBubble,c=document.createElement("div");c.id=a.getBubbleDivId();c.className="helpBubbleCommon";var b=[];b.push(Sfdc.String.format('\x3ca id\x3d"{0}" href\x3d"#" class\x3d"closeHelpBubble" onclick\x3d"HelpBubble.getBubble().close();"\x3e',[a.getCloseXId()]));b.push(Sfdc.String.format('\x3cimg title\x3d"{0}" class\x3d"dialogClose" src\x3d"/s.gif"\x3e',[LC.getLabel("ProfileFilterEdit","Close")]));b.push("\x3c/a\x3e");b.push(Sfdc.String.format('\x3cdiv class\x3d"helpBubbleContainer" id\x3d"{0}"\x3e\x3c/div\x3e',
[a.getBubbleTextContainerId()]));b.push(Sfdc.String.format('\x3cdiv class\x3d"helpBubblePointer" id\x3d"{0}"/\x3e',[a.getBubbleDirectionId()]));c.innerHTML=b.join("");document.body.appendChild(c);a.bubbleDivElement=c;return a};HelpBubble.getBubble=function(){var a=HelpBubble.helpBubble;a||(a=HelpBubble.createBubble(),HelpBubble.helpBubble=a);return a};
HelpBubble.getHelpTextWithTitleAndLink=function(a,c,b,f){a=Sfdc.String.format("\x3cdiv class\x3d'helpBubbleTitle'\x3e{0}\x3c/div\x3e\x3cp\x3e{1}\x3c/p\x3e",[a,c]);b=Sfdc.String.format('\x3ca href\x3d"{0}"\x3e{1}\x3c/a\x3e',[f,b]);return a+b};
HelpBubble.showWhatAreGuestsBubble=function(a){a=HelpBubble.getHelpTextWithTitleAndLink(LC.getLabel("onboarding","whatAreGuestsMsgTitle"),LC.getLabel("onboarding","whatAreGuestsMsgText"),LC.getLabel("onboarding","whatAreGuestsMsgOnlineHelpText"),a);HelpBubble.display({parentDiv:"allowGuests",pointerDirection:HelpBubble.LEFT,contentText:a,additionalClass:"widerHelpBubble",preferenceConfigOnBubbleClose:{preferenceBit:"HideWhatAreGuestsMsg",value:!0}})};
HelpBubble.getHelpTitleWithNew=function(a){return Sfdc.String.format("\x3cdiv class\x3d'helpBubbleTitle'\x3e\x3cspan class\x3d'new'\x3e{0}\x3c/span\x3e {1}\x3c/div\x3e",[LC.getLabel("Global","exciting_and_new"),a])};
HelpBubble.showQueueHelpBubble=function(a){var c=HelpBubble.getHelpTitleWithNew(LC.getLabel("QueueCallouts","bubbleTitle"));a=Sfdc.String.format('\x3ca id\x3d"{0}" href\x3d"{1}"\x3e{2}\x3c/a\x3e',[BaseAssociationConstants.HELP_LINK_ID,a,LC.getLabel("QueueCallouts","bubbleOnlineHelpText")]);a=LC.getLabel("QueueCallouts","queueHelpBubble",a);var b=Sfdc.select("div#queueTabs ul\x3eli"),f=0<b.length,b=f?b[b.length-1]:"input[name\x3d'save']",d=[];d.push(c);d.push(a);HelpBubble.display({parentDiv:b,pointerDirection:f?
HelpBubble.LEFT:HelpBubble.RIGHT,contentText:d.join(""),additionalClass:"queueHelpBubble",preferenceConfigOnBubbleClose:{preferenceBit:"HideAssociationQueueCallout",value:!0},hidePointer:!0})};
HelpBubble.showInfluenceHelpBubble=function(a){var c=Sfdc.String.format("\x3cdiv class\x3d'helpBubbleTitle'\x3e{0}\x3c/div\x3e{1}",a?[LC.getLabel("Influence","otherUserNotStarted_0",a),LC.getLabel("Influence","otherUserNotStarted_1",a)]:[LC.getLabel("Influence","selfNotStarted_0"),LC.getLabel("Influence","selfNotStarted_1")]);HelpBubble.display({parentDiv:"influenceBox",pointerDirection:HelpBubble.LEFT,contentText:c,additionalClass:"influenceHelpBubble",customExtraOffset:[-15,0],preferenceConfigOnBubbleClose:{preferenceBit:a?
"HideOtherInfluenceGetStarted":"HideSelfInfluenceGetStarted",value:!0}})};HelpBubble.showEnhancedProfileHelpBubble=function(a){a=LC.getLabel("UserProfilePage","WelcomeText",a);HelpBubble.display({parentDiv:"profileTabSetHeader",pointerDirection:HelpBubble.TOP,contentText:a,additionalClass:"enhancedProfileHelpBubble",customExtraOffset:[-280,10],preferenceConfigOnBubbleClose:{preferenceBit:"HideEnhancedProfileHelpBubble",value:!0}})};
HelpBubble.showAtMentionsInGroupFileSharingHelpBubble=function(){var a=LC.getLabel("ChatterFileSharing","sharedWithGroupsAtMentionsHelpBubble");HelpBubble.display({parentDiv:"notificationEmailPanelTextArea",pointerDirection:HelpBubble.TOP,contentText:a,additionalClass:"sharedWithGroupsAtMentionsHelpBubble",customExtraOffset:[-280,0],preferenceConfigOnBubbleClose:{preferenceBit:"HideAtMentionsHelpBubble",value:!0}})};
HelpBubble.showDomainOverflowHelpBubble=function(a,c){HelpBubble.display({parentDiv:a,pointerDirection:HelpBubble.TOP,hidePointer:!0,contentText:c,additionalClass:"domainOverflowHelpBubble",customExtraOffset:[0,-8]})};
HelpBubble.showSmartSearchBubble=function(a){var c=HelpBubble.getHelpTitleWithNew(LC.getLabel("SmartSearchOneTimeCallOut","title")),b='\x3cli class\x3d"smartSearchCallOutFeeds"\x3e\x3cimg alt\x3d\''+LC.getLabel("Page_UnifiedSearch","feedsToggleLabel")+"' src\x3d'/s.gif' /\x3e\x3cspan\x3e"+LC.getLabel("SmartSearchOneTimeCallOut","chatterFeeds")+"\x3c/span\x3e\x3c/li\x3e",f='\x3cli class\x3d"smartSearchCallOutResults"\x3e\x3cimg alt\x3d\''+LC.getLabel("Page_UnifiedSearch","recordsToggleLabel")+"' src\x3d'/s.gif' /\x3e\x3cspan\x3e"+
LC.getLabel("SmartSearchOneTimeCallOut","orderedResults")+"\x3c/span\x3e\x3c/li\x3e",d='\x3cli class\x3d"smartSearchCallOutPinning"\x3e\x3cimg alt\x3d\''+LC.getLabel("Page_UnifiedSearch","pinAlt")+"' src\x3d'/s.gif' /\x3e\x3cspan\x3e"+LC.getLabel("SmartSearchOneTimeCallOut","pinning")+"\x3c/span\x3e\x3c/li\x3e";a="\x3cdiv class\x3d'smartSearchCallOutSeeMore'\x3e"+String.format('\x3ca href\x3d"{0}" id\x3d"smartSearchOneTimeCallOutLink"\x3e{1}\x3c/a\x3e',a,LC.getLabel("SmartSearchOneTimeCallOut","tellMeMore"))+
"\x3cdiv style\x3d'clear:both'\x3e\x3c/div\x3e\x3c/div";var e=[];e.push(c);e.push('\x3cul class\x3d"smartSearchCallOutList"\x3e');e.push(b);e.push(f);e.push(d);e.push("\x3c/ul\x3e");e.push(a);HelpBubble.display({parentDiv:SfdcApp.Search.Sidetabs.RECORD_TOGGLE_ID,pointerDirection:HelpBubble.LEFT,contentText:e.join(""),additionalClass:"smartSearchCallOut",customExtraOffset:[0,-20],preferenceConfigOnBubbleClose:{preferenceBit:"HideSmartSearchCallOut",value:!0}})};
Sfdc.ns("Sfdc.AccessibleMultiUploadFilesDialog");Sfdc.AccessibleMultiUploadFilesDialog=function(a,b){Sfdc.BaseAccessibleFileDialog.call(this,{id:a,useCSS:!0,extraClass:"multiUploadFilesDialog"});this.id=a;this.content="";this.height=500;this.width=590;this.filterParentId=b.filterParentId;this.uploaderOrigin=b.uploaderOrigin;this.title=Sfdc.String.escapeToHtml(Sfdc.AccessibleMultiUploadFilesDialog.getDialogTitle(this,b.parentEntityName))};Ext.extend(Sfdc.AccessibleMultiUploadFilesDialog,Sfdc.BaseAccessibleFileDialog);
Sfdc.AccessibleMultiUploadFilesDialog.prototype.getContent=function(){return this.content};Sfdc.AccessibleMultiUploadFilesDialog.UPLOAD_FILE_DIALOG_ID="chatterFilesMultiUploadDialog";Sfdc.AccessibleMultiUploadFilesDialog.DRAG_AND_DROP_TARGET_DIV_ID="dragAndDropTargetDiv";Sfdc.AccessibleMultiUploadFilesDialog.uploadFileDialog=null;Sfdc.AccessibleMultiUploadFilesDialog.uploader=null;Sfdc.AccessibleMultiUploadFilesDialog.XPATH_CHATTER_PAGE_FILES_LIST="#mainNavigation .primaryNavList .fileListView";
Sfdc.AccessibleMultiUploadFilesDialog.XPATH_CHATTER_PAGE_FILESYNC_LIST="#mainNavigation .primaryNavList .fileSync";
Sfdc.AccessibleMultiUploadFilesDialog.loadForm=function(a,b){var c=sfdcPage.getDialogById(Sfdc.AccessibleMultiUploadFilesDialog.UPLOAD_FILE_DIALOG_ID);c?b(c):chatter.getToolbox().get({url:"/chatterfilemultiuploadform",success:function(d,e){c=new Sfdc.AccessibleMultiUploadFilesDialog(Sfdc.AccessibleMultiUploadFilesDialog.UPLOAD_FILE_DIALOG_ID,a);c.content="\x3cdiv id\x3dcontentPublisherSlideDown\x3e"+e.html+"\x3c/div\x3e";c.created=!0;c.register();b&&b(c)}})};
Sfdc.AccessibleMultiUploadFilesDialog.prototype.position=function(){if(this.dialog){var a=this.dialog.style;a.marginTop=-0.5*this.dialog.offsetHeight+"px";LC&&LC.isRtlPage()?a.marginRight=-0.5*this.dialog.offsetWidth+"px":a.marginLeft=-0.5*this.dialog.offsetWidth+"px"}};
Sfdc.AccessibleMultiUploadFilesDialog.getDialogTitle=function(a,b){if(a.uploaderOrigin===Sfdc.ChatterFileUploader.GROUP_PAGE||a.uploaderOrigin===Sfdc.ChatterFileUploader.RELATED_LIST||a.uploaderOrigin===Sfdc.ChatterFileUploader.CAMPAIGN_PAGE)return LC.getLabel("ChatterFileMultiUpload","uploadTo",b);if(a.uploaderOrigin===Sfdc.ChatterFileUploader.PROFILE_PAGE)return LC.getLabel("ChatterFileMultiUpload","uploadToProfile",b);var c=LC.getLabel("ChatterFilesTabPage","myFilesLabel");if(Sfdc.ChatterFileUploader.isFileSync)var c=
Sfdc.get("folderNavigationMutton"),d=Sfdc.get("folderNavigationMuttonDropDownElement"),c=c&&"none"!==c.style.display&&d?d.getAttribute("title"):LC.getLabel("ChatterFilesTabPage","myChatterbox");return LC.getLabel("ChatterFileMultiUpload","uploadTo",c)};Sfdc.AccessibleMultiUploadFilesDialog.getGroupFileListUrl=function(a){return chatter.getToolbox().sitePrefix()+"/_ui/core/chatter/content/GroupFileListPage?g\x3d"+a};
Sfdc.AccessibleMultiUploadFilesDialog.getUserFileListUrl=function(a){return chatter.getToolbox().sitePrefix()+"/_ui/core/chatter/content/UserFileListPage?u\x3d"+a};Sfdc.AccessibleMultiUploadFilesDialog.getFileTabUrl=function(a){return chatter.getToolbox().sitePrefix()+"/_ui/core/chatter/files/FileTabPage?f\x3d"+a};
Sfdc.AccessibleMultiUploadFilesDialog.open=function(a,b){var c=sfdcPage.getDialogById(Sfdc.AccessibleMultiUploadFilesDialog.UPLOAD_FILE_DIALOG_ID);Sfdc.MultiFileUploaderUtil.checkFileSyncOption();if(c){var d=Sfdc.AccessibleMultiUploadFilesDialog.getDialogTitle(c),e=Sfdc.get(Sfdc.AccessibleMultiUploadFilesDialog.UPLOAD_FILE_DIALOG_ID+"Title");Sfdc.Dom.setText(e,d);Sfdc.AccessibleMultiUploadFilesDialog.init(c,a)}else b&&chatter.getToolbox().setToken(b),Sfdc.AccessibleMultiUploadFilesDialog.loadForm(a,
function(b){Sfdc.AccessibleMultiUploadFilesDialog.init(b,a)})};
Sfdc.AccessibleMultiUploadFilesDialog.init=function(a,b){if(!0!==b.displayDDTargetIcon||Sfdc.ChatterFileUploader.dragAndDropZone.isDragAndDropInProgress())a.config=b,a.show(),Sfdc.get("uploadingStatusInfo").innerHTML=LC.getLabel("ChatterFileMultiUpload","prepareToUpload"),Sfdc.Dom.show(Sfdc.get("overallProgress")),Sfdc.get("overallProgress").childNodes.item(0).style.width=0,Sfdc.Dom.hideByDisplay(Sfdc.get("multiUploadSharingSettingsBtn")),!0===b.displayDDTargetIcon?Sfdc.AccessibleMultiUploadFilesDialog.displayDragAndDropTargetIcon(!0):
Sfdc.AccessibleMultiUploadFilesDialog.displayDragAndDropTargetIcon(!1),Sfdc.AccessibleMultiUploadFilesDialog.uploader=a.uploaderOrigin===Sfdc.ChatterFileUploader.GROUP_PAGE||a.uploaderOrigin===Sfdc.ChatterFileUploader.PROFILE_PAGE?Sfdc.ChatterFileUploader.createInstance(b,a.filterParentId):Sfdc.ChatterFileUploader.createInstance(b),Sfdc.Dom.show(Sfdc.get("multiUploadCancelRemainingBtn")),Sfdc.Dom.hideByDisplay(Sfdc.get("multiUploadCloseBtn")),a.uploaderOrigin===Sfdc.ChatterFileUploader.PUBLISHER&&
(Sfdc.Dom.setStyle(Sfdc.get("multiUploadCancelUploadBtn"),"display","inline-block"),Sfdc.Dom.hideByDisplay(Sfdc.get("multiUploadCancelRemainingBtn")),Sfdc.Dom.hideByDisplay(Sfdc.get("multiUploadCloseBtn")))};Sfdc.AccessibleMultiUploadFilesDialog.closeIt=function(a){var b=sfdcPage.getDialogById(Sfdc.AccessibleMultiUploadFilesDialog.UPLOAD_FILE_DIALOG_ID);b&&b.cancel(a)};
Sfdc.AccessibleMultiUploadFilesDialog.cancelIt=function(){var a=sfdcPage.getDialogById(Sfdc.AccessibleMultiUploadFilesDialog.UPLOAD_FILE_DIALOG_ID);a&&(a.config.customHandlers&&a.config.customHandlers.cancelHandler&&a.config.customHandlers.cancelHandler(),a.cancel(!0))};
Sfdc.AccessibleMultiUploadFilesDialog.prototype.cancel=function(a){if(0<Sfdc.AccessibleMultiUploadFilesDialog.uploader.filesInProgress)this.uploaderOrigin===Sfdc.ChatterFileUploader.PUBLISHER?(this.config.customHandlers&&this.config.customHandlers.cancelHandler&&this.config.customHandlers.cancelHandler(),Sfdc.BaseAccessibleFileDialog.prototype.cancel.call(this)):Sfdc.MultiUploadCancelRemainingConfirmDialog.open();else if(Sfdc.BaseAccessibleFileDialog.prototype.cancel.call(this),!(!0===a||0==Sfdc.AccessibleMultiUploadFilesDialog.uploader.filesCompleted)&&
Sfdc.AccessibleMultiUploadFilesDialog.uploader.filesCompleted===Sfdc.AccessibleMultiUploadFilesDialog.uploader.filesSelected)if(this.uploaderOrigin===Sfdc.ChatterFileUploader.GROUP_PAGE)window.location=Sfdc.AccessibleMultiUploadFilesDialog.getGroupFileListUrl(this.filterParentId);else if(this.uploaderOrigin===Sfdc.ChatterFileUploader.PROFILE_PAGE)window.location=Sfdc.AccessibleMultiUploadFilesDialog.getUserFileListUrl(this.filterParentId);else if(this.uploaderOrigin===Sfdc.ChatterFileUploader.CHATTER_FILE_PAGE){if(a=
Sfdc.select(Sfdc.AccessibleMultiUploadFilesDialog.XPATH_CHATTER_PAGE_FILES_LIST),0===a.length&&(a=Sfdc.select(Sfdc.AccessibleMultiUploadFilesDialog.XPATH_CHATTER_PAGE_FILESYNC_LIST)),a=a[0])if("undefined"===typeof Sfdc.ChatterFileUploader.isFileSync||!Sfdc.ChatterFileUploader.isFileSync)(a=Sfdc.get("myFilesLinkInChatterTab",Sfdc.get(a)))&&Sfdc.Event.fireEvent(a,"click");else if(a=Sfdc.get("chatterboxFilesLinkInChatterTab")){var b=Sfdc.get("folderNavigationMutton");b?(a=b.getAttribute("data-contentsfdc-currentfolderid"))&&
chatter.getChatterTab().refresh("ListViews",{type:"file",filter:"fs",fldr:a}):Sfdc.Event.fireEvent(a,"click")}}else this.uploaderOrigin===Sfdc.ChatterFileUploader.RELATED_LIST?(a=(window.location.href||"/"+this.config.filterParentId).split("?"),b=Sfdc.Url.getUrlParameters(a[1]),this.config.isdtp&&(b.isdtp=this.config.isdtp),window.location=Sfdc.Url.generateUrl(Sfdc.Url.stripDomainFromUrl(a[0]),b)):this.uploaderOrigin!==Sfdc.ChatterFileUploader.CAMPAIGN_PAGE&&(a="undefined"===typeof Sfdc.ChatterFileUploader.isFileSync||
!Sfdc.ChatterFileUploader.isFileSync?Sfdc.AccessibleMultiUploadFilesDialog.getFileTabUrl(UserContext.userId):this.config.fldr?"/"+this.config.fldr:Sfdc.AccessibleMultiUploadFilesDialog.getFileTabUrl(UserContext.userId)+"\x26fs\x3dtrue",window.location=a)};Sfdc.AccessibleMultiUploadFilesDialog.isOpened=function(){var a=sfdcPage.getDialogById(Sfdc.AccessibleMultiUploadFilesDialog.UPLOAD_FILE_DIALOG_ID);return a&&a.isOpen};
Sfdc.AccessibleMultiUploadFilesDialog.displayDragAndDropTargetIcon=function(a){var b='\x3cdiv id\x3d"'+Sfdc.AccessibleMultiUploadFilesDialog.DRAG_AND_DROP_TARGET_DIV_ID+'" class\x3d"'+Sfdc.AccessibleMultiUploadFilesDialog.DRAG_AND_DROP_TARGET_DIV_ID+'"\x3e\x3cdiv class\x3d"dragAndDropTargetImg"\x3e\x3c/div\x3e\x3cdiv class\x3d"dragAndDropTargetTextDiv"\x3e'+LC.getLabel("ChatterFileMultiUpload","dropFiles")+"\x3c/div\x3e\x3c/div\x3e",c=document.getElementById(Sfdc.AccessibleMultiUploadFilesDialog.UPLOAD_FILE_DIALOG_ID);
if(c&&c.childNodes){for(var d=c.childNodes,e=!1,g=0;g<d.length;g++){var f=d[g];Sfdc.Dom.hasClass(f,Sfdc.AccessibleMultiUploadFilesDialog.DRAG_AND_DROP_TARGET_DIV_ID)?(!1!==a?Sfdc.Dom.removeClass(f,"hidden"):Sfdc.Dom.addClass(f,"hidden"),e=!0):!1!==a?Sfdc.Dom.addClass(f,"hidden"):Sfdc.Dom.removeClass(f,"hidden")}e||(b=Sfdc.MultiFileUploaderUtil.createElementFromHTML(b),c.appendChild(b),!1===a&&Sfdc.Dom.addClass(b,"hidden"));Sfdc.Function.delay(function(){sfdcPage.getDialogById(Sfdc.AccessibleMultiUploadFilesDialog.UPLOAD_FILE_DIALOG_ID).position()},
10)}};
Sfdc.ns("Sfdc.BaseAccessibleFileListDialog");Sfdc.BaseAccessibleFileListDialog=function(a){Sfdc.BaseAccessibleFileDialog.call(this,a);this.id=a.id;this.title=a.title;this.dataLoadUrl=a.dataLoadUrl;this.docId=a.docId;this.height=a.height;this.content="";this.width=0;this.background=Sfdc.select(".overlayBackground")[0]};Ext.extend(Sfdc.BaseAccessibleFileListDialog,Sfdc.BaseAccessibleFileDialog);Sfdc.BaseAccessibleFileListDialog.prototype.getContent=function(){return this.content};
Sfdc.BaseAccessibleFileListDialog.prototype.open=function(a){this.loadList(a)};Sfdc.BaseAccessibleFileListDialog.prototype.loadList=function(a){var c=this.dataLoadUrl+this.docId,b=this;a=a||{};chatter.getToolbox().get({url:c,params:a,success:function(a,d){b.updateContent(d);b.callback&&b.callback(c,d)}})};Sfdc.BaseAccessibleFileListDialog.prototype.updateContent=function(a){this.content=a.html;this.display()};
Sfdc.BaseAccessibleFileListDialog.prototype.nextPage=function(a,c,b){(a=sfdcPage.getDialogById(this.id))&&a.loadList({p:b+1})};Sfdc.BaseAccessibleFileListDialog.prototype.prevPage=function(a,c,b){(a=sfdcPage.getDialogById(this.id))&&a.loadList({p:b-1})};Sfdc.BaseAccessibleFileListDialog.closeDialog=function(a){return(Sfdc.BaseAccessibleFileDialog.prototype.isInAccessibilityMode()?window.opener?window.opener:window.parent:window).sfdcPage.getDialogById(a).cancel()};
Sfdc.BaseAccessibleFileListDialog.prototype.hook_cancel=function(){var a=Sfdc.BaseAccessibleFileDialog.getDialogById(this.id);a&&a.refreshPage&&location.reload(!0)};
Sfdc.ns("Sfdc.AccessibleUploadFileDialog");Sfdc.AccessibleUploadFileDialog=function(a,b,c){Sfdc.BaseAccessibleFileDialog.call(this,{id:a});this.id=a;this.title=b;this.docId=c;this.content="";this.height=400;this.width=520};Ext.extend(Sfdc.AccessibleUploadFileDialog,Sfdc.BaseAccessibleFileDialog);Sfdc.AccessibleUploadFileDialog.prototype.getContent=function(){return this.content};
Sfdc.AccessibleUploadFileDialog.prototype.resetCompletionHandlers=function(){this.failureAndErrorHandler=this.cancelHandler=this.successHandler=void 0};Sfdc.AccessibleUploadFileDialog.getSuccessHandler=function(a){return function(b,c){if(c&&c.docid)if(a)location.reload();else{var d=Sfdc.AccessibleUploadFileDialog.getBaseUrl()+"/"+c.docid;c.so&&(d+="?so\x3d"+c.so);navigateToUrl(d)}}};
Sfdc.AccessibleUploadFileDialog.prototype.getSuccessHandler=function(a){return void 0===this.successHandler?Sfdc.AccessibleUploadFileDialog.getSuccessHandler(a):this.successHandler};Sfdc.AccessibleUploadFileDialog.prototype.setSuccessHandler=function(a){void 0!==a&&(this.successHandler=a)};Sfdc.AccessibleUploadFileDialog.prototype.setCancelHandler=function(a){void 0!==a&&(this.cancelHandler=a)};
Sfdc.AccessibleUploadFileDialog.getFailureAndErrorHandler=function(){return function(a,b){var c=Sfdc.AccessibleSelectFileDropDownPanel.getSelectFileDropdown();c&&(c.source=null);var c=b&&b.html?b.html:LC.getLabel("ChatterFilesTabPage","uploadGeneralErrorMessage"),d=Dialogs.types.ERROR;Dialogs.createDialog({id:Dialogs.getNextId(),title:LC.getLabel("Global","error"),message:c,backgroundClass:d.backgroundClass,contentClass:d.contentClass,iconClass:d.iconClass,iconAlt:d.getIconAlt(),actions:[null],actionLabels:[LC.getLabel("Buttons",
"ok")]},!0).show()}};Sfdc.AccessibleUploadFileDialog.prototype.getFailureAndErrorHandler=function(){return Sfdc.AccessibleUploadFileDialog.getFailureAndErrorHandler()};Sfdc.AccessibleUploadFileDialog.prototype.setFailureAndErrorHandler=function(a){void 0!==a&&(this.failureAndErrorHandler=a)};Sfdc.AccessibleUploadFileDialog.prototype.enableButton=function(a){var b=Sfdc.get("uploadToMyFilesButton");a?chatter.getToolbox().enableButton(b):chatter.getToolbox().disableButton(b)};
Sfdc.AccessibleUploadFileDialog.prototype.hook_cancel=function(){this.cancelHandler&&this.cancelHandler();var a=Sfdc.AccessibleSelectFileDropDownPanel.getSelectFileDropdown();a&&(a.source=null)};Sfdc.AccessibleUploadFileDialog.UPLOAD_FILE_DIALOG_ID="chatterFilesTabPageUploadDialog";Sfdc.AccessibleUploadFileDialog.REQUIRED_LEGEND_ID="requiredLegend"+ChatterFilesConstants.UPLOAD_DIALOG_APPENDIX;Sfdc.AccessibleUploadFileDialog.FILE_FIELD_ID="chatterFile"+ChatterFilesConstants.UPLOAD_DIALOG_APPENDIX;
Sfdc.AccessibleUploadFileDialog.FILE_FIELD_NEW_LABEL_ID="chatterFileNewLabel"+ChatterFilesConstants.UPLOAD_DIALOG_APPENDIX;Sfdc.AccessibleUploadFileDialog.FILE_ROW_ID="chatterFileRow"+ChatterFilesConstants.UPLOAD_DIALOG_APPENDIX;Sfdc.AccessibleUploadFileDialog.FILE_NAME_FIELD_ID="fileName"+ChatterFilesConstants.UPLOAD_DIALOG_APPENDIX;Sfdc.AccessibleUploadFileDialog.FILE_DESCRIPTION_FIELD_ID="desc"+ChatterFilesConstants.UPLOAD_DIALOG_APPENDIX;
Sfdc.AccessibleUploadFileDialog.FILE_NAME_ROW_ID="fileNameRow"+ChatterFilesConstants.UPLOAD_DIALOG_APPENDIX;Sfdc.AccessibleUploadFileDialog.FILE_DESCRIPTION_ROW_ID="descRow"+ChatterFilesConstants.UPLOAD_DIALOG_APPENDIX;Sfdc.AccessibleUploadFileDialog.FILE_SHARE_OPT_PANEL_ID="sharedWithOptionPanel"+ChatterFilesConstants.UPLOAD_DIALOG_APPENDIX;Sfdc.AccessibleUploadFileDialog.UPLOAD_MSG_PANEL_ID="uploadFileMsgPanel"+ChatterFilesConstants.UPLOAD_DIALOG_APPENDIX;
Sfdc.AccessibleUploadFileDialog.UPLOAD_FILE_FORM_ID="chatterFileForm"+ChatterFilesConstants.UPLOAD_DIALOG_APPENDIX;Sfdc.AccessibleUploadFileDialog.SHARE_OPTION_FIELD_ID="shareOption"+ChatterFilesConstants.UPLOAD_DIALOG_APPENDIX;Sfdc.AccessibleUploadFileDialog.SHARE_OPTION_STATUS_ID="shareOptionStatus"+ChatterFilesConstants.UPLOAD_DIALOG_APPENDIX;Sfdc.AccessibleUploadFileDialog.uploadFileDialog=null;
Sfdc.AccessibleUploadFileDialog.open=function(a,b){var c=sfdcPage.getDialogById(Sfdc.AccessibleUploadFileDialog.UPLOAD_FILE_DIALOG_ID);if(c)Sfdc.AccessibleUploadFileDialog.init(c,a);else{var d={nv:Sfdc.AccessibleUploadFileDialog.isNewVersionUpload(a),cc:Sfdc.AccessibleUploadFileDialog.isContentComment(a)};a&&a.origin&&(d.origin=a.origin);a&&a.maxFileSize&&(d.mfs=a.maxFileSize);b&&chatter.getToolbox().setToken(b);chatter.getToolbox().get({url:"/chatterfileuploadform",params:d,success:function(b,d){c=
new Sfdc.AccessibleUploadFileDialog(Sfdc.AccessibleUploadFileDialog.UPLOAD_FILE_DIALOG_ID,Sfdc.AccessibleUploadFileDialog.getDialogTitle(a),a?a[ChatterFilesConstants.FILE_CONFIG_KEY_DOCID]:null);c.content='\x3cdiv id\x3d"contentPublisherSlideDown" class\x3d"contentPublisherSlideDown"\x3e'+d.html+"\x3c/div\x3e";c.created=!0;c.register();Sfdc.AccessibleUploadFileDialog.init(c,a);var g=Sfdc.get(Sfdc.AccessibleUploadFileDialog.UPLOAD_FILE_DIALOG_ID);Sfdc.on(g,"dragover",function(a){a&&a.preventDefault()});
Sfdc.on(g,"drop",function(a){a&&(a.target&&("INPUT"!==a.target.tagName||"file"!==a.target.type))&&a.preventDefault()})}})}};Sfdc.AccessibleUploadFileDialog.getBaseUrl=function(){return chatter.getToolbox().sitePrefix()};Sfdc.AccessibleUploadFileDialog.getFileDetailPageUrl=function(){return Sfdc.AccessibleUploadFileDialog.getBaseUrl()+"/_ui/core/chatter/files/FileDetailPage"};
Sfdc.AccessibleUploadFileDialog.isNewVersionUpload=function(a){return a?a[ChatterFilesConstants.FILE_CONFIG_KEY_DOCID]?!0:!1:!1};Sfdc.AccessibleUploadFileDialog.isContentComment=function(a){return a?a.isContentComment?!0:!1:!1};Sfdc.AccessibleUploadFileDialog.isUploadAndShareWithLocation=function(a){return a?a.filterParentId?!0:!1:!1};Sfdc.AccessibleUploadFileDialog.getFilterParentId=function(a){return a?a.filterParentId:void 0};
Sfdc.AccessibleUploadFileDialog.getDialogTitle=function(a){return a?a.title?a.title:Sfdc.AccessibleUploadFileDialog.isNewVersionUpload(a)?LC.getLabel("ChatterFileDetailPage","uploadNewVersionDialogTitle"):LC.getLabel("Publisher","postFileFormTitle"):LC.getLabel("ChatterFilesTabPage","uploadFileDialogTitle")};Sfdc.AccessibleUploadFileDialog.hideField=function(a,b){a&&(b?Sfdc.Dom.addClass(a,"hidden"):Sfdc.Dom.removeClass(a,"hidden"))};
Sfdc.AccessibleUploadFileDialog.adjustUploadLayout=function(a){var b=Sfdc.AccessibleUploadFileDialog.isNewVersionUpload(a),c=Sfdc.AccessibleUploadFileDialog.isContentComment(a);a=Sfdc.AccessibleUploadFileDialog.isUploadAndShareWithLocation(a);if(!b&&!c&&!a){var d=Sfdc.get(Sfdc.AccessibleUploadFileDialog.FILE_ROW_ID),e=Sfdc.select("th",d)[0];if(e&&(Sfdc.Dom.addClass(e,"hidden"),!Sfdc.get(Sfdc.AccessibleUploadFileDialog.FILE_FIELD_NEW_LABEL_ID))){var d=Sfdc.get(Sfdc.Dom.getParent(d,"table")),f=document.createElement("div");
f.id=Sfdc.AccessibleUploadFileDialog.FILE_FIELD_NEW_LABEL_ID;f.innerHTML=Sfdc.get(e).innerHTML;d.parentNode.insertBefore(f,d)}}Sfdc.AccessibleUploadFileDialog.hideField(Sfdc.get(Sfdc.AccessibleUploadFileDialog.FILE_NAME_ROW_ID),!0);Sfdc.AccessibleUploadFileDialog.hideField(Sfdc.get(Sfdc.AccessibleUploadFileDialog.FILE_DESCRIPTION_ROW_ID),!0);Sfdc.AccessibleUploadFileDialog.hideField(Sfdc.get(Sfdc.AccessibleUploadFileDialog.FILE_SHARE_OPT_PANEL_ID),b||c||a);(b=Sfdc.get(Sfdc.AccessibleUploadFileDialog.SHARE_OPTION_DROPDOWN_ID+
"Item1"))&&Sfdc.AccessibleUploadFileDialog.selectShareOption(b,"pvt");Sfdc.AccessibleUploadFileDialog.hideField(Sfdc.get(Sfdc.AccessibleUploadFileDialog.UPLOAD_MSG_PANEL_ID),!0)};
Sfdc.AccessibleUploadFileDialog.init=function(a,b){chatter.getFileUploader().setDialogAppendix(ChatterFilesConstants.UPLOAD_DIALOG_APPENDIX);a.resetCompletionHandlers();Sfdc.AccessibleUploadFileDialog.adjustUploadLayout(b);a.show();a.enableButton(!1);var c="",d="";if(b){b.successHandler&&b.cancelHandler&&(a.setSuccessHandler(b.successHandler),a.setCancelHandler(b.cancelHandler));a.isContentComment=Sfdc.AccessibleUploadFileDialog.isContentComment(b);a.filterParentId=Sfdc.AccessibleUploadFileDialog.getFilterParentId(b);
b.origin&&(a.origin=b.origin);b.sharingOption_upload&&(a.sharingOption_upload=b.sharingOption_upload);b.maxFileSize&&(a.maxFileSize=b.maxFileSize);if(Sfdc.AccessibleUploadFileDialog.isNewVersionUpload(b)){var e=Sfdc.get("fileTitle");e&&(c=unescapeHTML(e.innerHTML));(e=Sfdc.get("fileDescriptionText"))&&(d=unescapeHTML(e.innerHTML))}b.fldr&&(a.fldr=b.fldr)}chatter.getFileUploader().reset(a.enableButton,c,d);chatter.getFileUploader().initValidation(a.enableButton)};
Sfdc.AccessibleUploadFileDialog.close=function(){var a=sfdcPage.getDialogById(Sfdc.AccessibleUploadFileDialog.UPLOAD_FILE_DIALOG_ID);a&&a.cancel()};
Sfdc.AccessibleUploadFileDialog.upload=function(){var a=sfdcPage.getDialogById(Sfdc.AccessibleUploadFileDialog.UPLOAD_FILE_DIALOG_ID);if(a){a.hide();var b=chatter.getToolbox().sitePrefix()+chatter.getToolbox().apiurl()+"/chatterfile/",c={cc:a.isContentComment};a.docId&&(c={id:a.docId});a.origin&&(c.origin=a.origin);a.sharingOption_upload&&(c.sharingOption_upload=a.sharingOption_upload);a.maxFileSize&&(c.mfs=a.maxFileSize);var d;a.filterParentId?(c.fpid=a.filterParentId,d=!0):d=!1;var e=Sfdc.get("browseLabel");
e&&"fs"===e.getAttribute("data-contentsfdc-filter")&&(c.fileSync=!0,a.fldr&&(c.fldr=a.fldr));chatter.getFileUploader().upload(b,c,{failureHandler:a.getFailureAndErrorHandler(),errorHandler:a.getFailureAndErrorHandler(),successHandler:a.getSuccessHandler(d)})}};Sfdc.AccessibleUploadFileDialog.SHARE_OPTION_DROPDOWN_ID="shareOptionDropdown";
Sfdc.FileSharedWithOptionDropdown=function(a,b){Sfdc.DropdownPanel.call(this,a);this.groupsAvailable=this.pubLinkEnabled=!1;b&&!0===b.pubLinkEnabled&&(this.pubLinkEnabled=!0);b&&!0===b.groupsAvailable&&(this.groupsAvailable=!0);this.isRendered=!1};Ext.extend(Sfdc.FileSharedWithOptionDropdown,Sfdc.DropdownPanel);
Sfdc.FileSharedWithOptionDropdown.prototype.getXY=function(){var a=Sfdc.get("chatterFilesTabPageUploadDialog"),b=getObjX(this.anchorElem),c=getObjY(this.anchorElem);0==b&&(b=parseInt(a.style.left)+44);0==c&&(c=parseInt(a.style.top)+182);b+=Sfdc.Window.getScrollX()-1;c+=Sfdc.Window.getScrollY()+this.anchorElem.offsetHeight+1;return{x:b,y:c}};Sfdc.FileSharedWithOptionDropdown.prototype.getSize=function(){return{width:this.anchorElem.offsetWidth}};
Sfdc.FileSharedWithOptionDropdown.prototype.getContent=function(a){return!this.isRendered?(a=[],a.push('\x3cul\x3e\x3cli class\x3d"sharedWithStatusBar checked"\x3e\x3ca id\x3d"'+Sfdc.AccessibleUploadFileDialog.SHARE_OPTION_DROPDOWN_ID+'Item1" onclick\x3d"Sfdc.AccessibleUploadFileDialog.selectShareOption(this, \'pvt\');return false;" class\x3d"lockItemIcon" href\x3d"javascript:void(0);"\x3e'+LC.getLabel("ChatterFileSharing","shareOptionPrivate")+"\x3c/a\x3e\x3c/li\x3e"),this.groupsAvailable&&a.push('\x3cli class\x3d"sharedWithStatusBar"\x3e\x3ca id\x3d"'+
Sfdc.AccessibleUploadFileDialog.SHARE_OPTION_DROPDOWN_ID+'Item2"  onclick\x3d"Sfdc.AccessibleUploadFileDialog.selectShareOption(this, \'grp\');return false;" class\x3d"groupItemIcon" href\x3d"javascript:void(0);"\x3e'+LC.getLabel("ChatterFileSharing","shareOptionGroup")+"\x3c/a\x3e\x3c/li\x3e"),a.push('\x3cli class\x3d"sharedWithStatusBar"\x3e\x3ca id\x3d"'+Sfdc.AccessibleUploadFileDialog.SHARE_OPTION_DROPDOWN_ID+'Item3"  onclick\x3d"Sfdc.AccessibleUploadFileDialog.selectShareOption(this, \'ppl\');return false;" class\x3d"peopleItemIcon" href\x3d"javascript:void(0);"\x3e'+
LC.getLabel("ChatterFileSharing","shareOptionPeople")+"\x3c/a\x3e\x3c/li\x3e"),this.pubLinkEnabled&&a.push('\x3cli class\x3d"sharedWithStatusBar"\x3e\x3ca id\x3d"'+Sfdc.AccessibleUploadFileDialog.SHARE_OPTION_DROPDOWN_ID+'Item4"  onclick\x3d"Sfdc.AccessibleUploadFileDialog.selectShareOption(this, \'lnk\');return false;" class\x3d"linkItemIcon" href\x3d"javascript:void(0);"\x3e'+LC.getLabel("ChatterFileSharing","shareOptionLink")+"\x3c/a\x3e\x3c/li\x3e"),a.push("\x3c/ul\x3e"),this.isRendered=!0,a.join("")):
null};Sfdc.AccessibleUploadFileDialog.getShareOptionDropdown=function(a){var b=Sfdc.DropdownPanel.getPanel(Sfdc.AccessibleUploadFileDialog.SHARE_OPTION_DROPDOWN_ID);b||(b=new Sfdc.FileSharedWithOptionDropdown(Sfdc.AccessibleUploadFileDialog.SHARE_OPTION_DROPDOWN_ID,a));return b};Sfdc.AccessibleUploadFileDialog.showShareOptionDropdown=function(a,b){var c=Sfdc.AccessibleUploadFileDialog.getShareOptionDropdown(b);c&&c.show(a)};
Sfdc.AccessibleUploadFileDialog.closeShareOptionDropdown=function(){var a=Sfdc.AccessibleUploadFileDialog.getShareOptionDropdown();a&&a.close()};
Sfdc.AccessibleUploadFileDialog.selectShareOption=function(a,b){for(var c=Sfdc.select("li.sharedWithStatusBar",Sfdc.Dom.getParent(Sfdc.get(a),"ul")),d=0;d<c.length;d++)Sfdc.Dom.removeClass(c[d],"checked");Sfdc.Dom.addClass(Sfdc.Dom.getParent(Sfdc.get(a),"li"),"checked");c=Sfdc.get(Sfdc.AccessibleUploadFileDialog.SHARE_OPTION_STATUS_ID);c.className=a.className;c.firstChild.innerHTML=a.innerHTML;Sfdc.get(Sfdc.AccessibleUploadFileDialog.SHARE_OPTION_FIELD_ID).value=b;Sfdc.AccessibleUploadFileDialog.closeShareOptionDropdown()};
Sfdc.ns("Sfdc.AccessibleSelectFileDropDownPanel");Sfdc.AccessibleSelectFileDropDownPanel=function(a,b,c){Sfdc.DropdownPanel.call(this,a);this.isFileSyncEnabled=b;this.isSFSUserPermEnabled=c};Ext.extend(Sfdc.AccessibleSelectFileDropDownPanel,Sfdc.DropdownPanel);Sfdc.AccessibleSelectFileDropDownPanel.prototype.resizeEventHandler=function(a){return function(){}};Sfdc.AccessibleSelectFileDropDownPanel.prototype.scrollEventHandler=function(a){return function(){}};
Sfdc.AccessibleSelectFileDropDownPanel.prototype.clickEventHandler=function(a,b){return function(){}};Sfdc.AccessibleSelectFileDropDownPanel.prototype.keydownEventHandler=function(a){return function(){}};
Sfdc.AccessibleSelectFileDropDownPanel.prototype.getXY=function(){return LC.isRtlPage()?{x:this.anchorElem.offsetParent.offsetWidth-this.anchorElem.offsetLeft-this.anchorElem.offsetWidth+10,y:this.anchorElem.offsetTop+20,interpretXasRightOffset:!0}:{x:this.anchorElem.offsetLeft+10,y:this.anchorElem.offsetTop+20}};
Sfdc.AccessibleSelectFileDropDownPanel.prototype.getContent=function(a){a=UserContext.isDefaultNetwork?LC.getLabel("Publisher","linkAFile"):LC.getLabel("Publisher","linkAFileChatter");var b=LC.getLabel("Publisher","uploadAFile");if(!this.isRendered){var c=[];c.push("\x3cul\x3e");c.push('\x3cli class\x3d"contentCommentMenuItem"\x3e\x3ca class\x3d"contentCommentLink" onclick\x3d"Sfdc.AccessibleSelectFileDropDownPanel.doAction(\'sfs\');return false;"  href\x3d"javascript:void(0);"\x3e'+chatter.getToolbox().htmlEncode(a)+
"\x3c/a\x3e\x3c/li\x3e");c.push('\x3cli class\x3d"contentCommentMenuItem"\x3e\x3ca class\x3d"contentCommentLink" onclick\x3d"Sfdc.AccessibleSelectFileDropDownPanel.doAction(\'uploadFile\');return false;"  href\x3d"javascript:void(0);"\x3e'+chatter.getToolbox().htmlEncode(b)+"\x3c/a\x3e\x3c/li\x3e");c.push("\x3c/ul\x3e");this.isRendered=!0;return c.join("")}return null};
Sfdc.AccessibleSelectFileDropDownPanel.hideDropDown=function(){var a=Sfdc.AccessibleSelectFileDropDownPanel.getSelectFileDropdown();if(a){var b=Sfdc.get(Sfdc.AccessibleSelectFileDropDownPanel.SELECT_FILE_DROPDOWN_ID);b&&Sfdc.Dom.isVisible(b)&&a.close()}};
Sfdc.AccessibleSelectFileDropDownPanel.doAction=function(a){var b=Sfdc.AccessibleSelectFileDropDownPanel.getSelectFileDropdown();chatter.getFeed().setAttachingContent(b.anchorElem,!0);Sfdc.AccessibleSelectFileDropDownPanel.hideDropDown();b.source=a;"uploadFile"==a?chatter.getFeed().showContentCommentUpload(b.anchorElem):"sfs"==a&&chatter.getFeed().showContentCommentLink(b.anchorElem)};Sfdc.AccessibleSelectFileDropDownPanel.SELECT_FILE_DROPDOWN_ID="contentCommentDropdown";
Sfdc.AccessibleSelectFileDropDownPanel.getSelectFileDropdown=function(a,b){var c=Sfdc.AccessibleSelectFileDropDownPanel.SELECT_FILE_DROPDOWN_ID,d=Sfdc.DropdownPanel.getPanel(c);d||(d=new Sfdc.AccessibleSelectFileDropDownPanel(c,a,b));return d};Sfdc.AccessibleSelectFileDropDownPanel.showSelectFileDropdown=function(a){var b=Sfdc.AccessibleSelectFileDropDownPanel.getSelectFileDropdown(config);b&&b.show(a)};Sfdc.AccessibleSelectFileDropDownPanel.prototype.hasFocusInitially=function(){return!1};
Sfdc.AccessibleSelectFileDropDownPanel.closeSelectFileDropdown=function(){var a=Sfdc.AccessibleSelectFileDropDownPanel.getSelectFileDropdown();a&&a.close()};Sfdc.AccessibleSelectFileDropDownPanel.prototype.close=function(){Sfdc.DropdownPanel.prototype.close.call(this);var a=Sfdc.AccessibleSelectFileDropDownPanel.getSelectFileDropdown();a&&a.anchorElem&&chatter.getFeed().setDisableCommentBoxBlur(a.anchorElem,!1)};
Sfdc.AccessibleSelectFileDropDownPanel.prototype.show=function(a,b){Sfdc.DropdownPanel.prototype.show.call(this,a,b);a.parentNode.appendChild(this.domObj)};
var PostToWidget=function(r,h){function s(){return LC.getLabel("Publisher","SearchGroups")}function t(){var a=d();Sfdc.Dom.removeClass(a,"hasFocus");Sfdc.Dom.set(a,"value",s())}function v(){if(!c){var a=d();c=new UserAndGroupAutoCompleteInputElement({elementId:a.id,entityType:UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_GROUP,disableGhostText:!0,handleSelect:function(a){var b=a.itemName,c=a.isExternalUserOrGroup,k=a.imageHtml,g="private"===a.itemPrivacy;e=a={subjectId:a.itemId,entityType:LC.getLabel("Publisher",
"CollaborationGroupLabel"),isExternalGroup:c,isPrivateGroup:g};h(a);Sfdc.Dom.hideByDisplay(d());Sfdc.Dom.set(d(),"value","");a=l();m||(m=Sfdc.get(w,f()));c=m;c.innerHTML=k;k=Sfdc.get(".chatter-avatar",c);Sfdc.Dom.removeClass(k,"chatter-avatarMedium");Sfdc.Dom.addClass(k,"chatter-avatarSmall");Sfdc.get(".groupInfo",a).innerHTML=b;b=l();Sfdc.Dom.setStyle(b,"display","inline-block");Sfdc.get(".removeGroup",b).focus();this.clearSuggestions()},getACXPosition:function(){return 8},getACYPosition:function(){return Sfdc.Dom.getHeight(a)-
2},getMinimumWidth:function(){return 209}});c.addACBoxToPage=function(b){Sfdc.Dom.getParent(a).appendChild(b)};c.clearGhostText=function(){a.value===s()&&(Sfdc.Dom.addClass(a,"hasFocus"),Sfdc.Dom.set(a,"value",""))};Sfdc.on(a,"blur",function(){""===a.value&&t()});var b=Sfdc.get(".removeGroup",l());Sfdc.on(b,"click",function(a,b){u();d().focus()})}}function u(){var a={};e=a;h(a);Sfdc.Dom.hideByDisplay(l());Sfdc.Dom.show(d())}function f(){g||(g=Sfdc.get(x,r));return g}function d(){n||(n=Sfdc.get(y,
f()));return n}function l(){p||(p=Sfdc.get(z,f()));return p}var x=".groupSelection",y=".groupSelectionInput",z=".groupRecipient",w=".groupIconContainer",c=null,g=null,n=null,p=null,m=null,A=this,q={subjectId:UserContext.userId,entityType:LC.getLabel("Publisher","UserLabel")},e=q,b="me";this.setTargetToGroup=function(){if("group"!=b){var a={};e=a;h(a);t();v();Sfdc.Dom.setStyle(f(),"display","inline-block");b="group"}};this.setTargetToMyProfile=function(){"me"!=b&&(Sfdc.Dom.hideByDisplay(f()),u(),e=
q,h(q),b="me")};this.reset=function(){A.setTargetToMyProfile();var a=Sfdc.get(".zen-select",r);SfdcCmp.getInstance(a).reset()};this.getSubject=function(){return e}};
Sfdc.ns("Sfdc.ChatterFileUploadHandler");
Sfdc.ChatterFileUploadHandler=function(a){var c=function(){this.size=0;this.map={}};c.prototype.put=function(a,b){a&&"undefined"!=typeof b&&(a in this.map||this.size++,this.map[a]=b)};c.prototype.remove=function(a){a in this.map&&(delete this.map[a],this.size--)};c.prototype.get=function(a){return this.map[a]};c.prototype.getSize=function(){return this.size};c.prototype.each=function(a){for(var b in this.map)this.map.hasOwnProperty(b)&&a(b)};this.config=Sfdc.apply(a,{uploadActionUrl:"",onProgressCallback:function(a,
b,c,f){},onCompleteCallback:function(a,b,c){},onCancelCallback:function(a,b){},onErrorCallback:function(a,b,c){}});this.uploadActionUrl=this.config.uploadActionUrl;this.fileUploadWaitingQueue=[];this.uploadParams=[];this.inProgressXhrs=new c;this.filesToUpload=[]};
Sfdc.MultiFileUploaderUtil.extend(Sfdc.ChatterFileUploadHandler.prototype,{addToUploadList:function(a){!a instanceof File&&!a.name&&alert("Not File object in Sfdc.ChatterFileUploadHandler!");var c=new Sfdc.MultiFileUploaderFile(a);this.filesToUpload.push({fileObject:a,fileInfo:c,canceled:!1});return this.filesToUpload.length-1},scheduleUpload:function(a,c){1==this.addToWaitingQueue(a,c)&&this.uploadFileToServer(a)},uploadNextIfExists:function(){0<this.fileUploadWaitingQueue.length&&this.uploadFileToServer(this.fileUploadWaitingQueue[0])},
uploadNextIfNoneInProgress:function(){0===this.inProgressXhrs.getSize()&&this.uploadNextIfExists()},cancelCurrentUpload:function(a){this.cancelUploadFileToServer(a);this.removeFromWaitingQueue(a);this.config.onCancelCallback(a,this.filesToUpload[a].fileObject)},cancelRemainingUploads:function(){this.cancelInProgressUploads();this.cancelWaitingUploads()},removeFromWaitingQueue:function(a){a=Sfdc.Array.indexOf(this.fileUploadWaitingQueue,a);this.fileUploadWaitingQueue.splice(a,1)},addToWaitingQueue:function(a,
c){var d=this.fileUploadWaitingQueue.push(a);this.uploadParams[a]=c||{};return d},removeFromWaitingQueueAndUploadNext:function(a){this.removeFromWaitingQueue(a);this.uploadNextIfExists()},constructFormData:function(a,c,d){var b=new FormData;b.append("token",chatter.getToolbox().token());b.append("fileName_upload",c);b.append("fileName",c);b.append("desc_upload","");b.append("desc","");b.append("hiddenFileName",c);b.append("shareOption_upload","pvt");b.append("mfu","1");b.append("file",a);d.fileSync&&
b.append("fileSync",!0);d.filterParentId&&b.append("fpid",d.filterParentId);d.fldr&&b.append("fldr",d.fldr);if(d.params)for(var e in d.params)e&&d.params[e]&&b.append(e,d.params[e]);return b},uploadFileToServer:function(a){var c=this.constructFormData(this.filesToUpload[a].fileObject,this.filesToUpload[a].fileInfo.shortName,this.uploadParams[a]);this.submitXhr(a,c)},cancelUploadFileToServer:function(a){this.filesToUpload[a].canceled=!0;var c=this.inProgressXhrs.get(a.toString());c&&(c.abort(),this.inProgressXhrs.remove(a.toString()))},
submitXhr:function(a,c){var d=this,b=new XMLHttpRequest,e=this.filesToUpload[a].fileInfo.name;b.upload.onprogress=function(b){if(b.lengthComputable)d.config.onProgressCallback(a,e,b.loaded,b.total)};b.onreadystatechange=function(){if(this.readyState==XMLHttpRequest.DONE)d.onXhrDone(a,this)};this.inProgressXhrs.put(a.toString(),b);b.open("POST",this.config.uploadActionUrl,!0);b.send(c)},parseAndDecodeResponse:function(a){if(a=Sfdc.MultiFileUploaderUtil.parseResponseResult(a))a.html&&(a.html=chatter.getFileUploader().getBase64Decoder().decode(a.html)),
a.errormessage&&(a.errormessage=chatter.getFileUploader().getBase64Decoder().decode(a.errormessage));return a},runCustomHandlers:function(a,c,d){var b=this.config.customHandlers;b&&("Failure"===a&&b.failureHandler?b.failureHandler(d.response,c):"Error"===a&&b.errorHandler?b.errorHandler(d.response,c):"Success"==a&&b.successHandler&&b.successHandler(d.response,c))},onXhrDone:function(a,c){if(!0!==this.filesToUpload[a].canceled){var d=this.filesToUpload[a].fileObject,b=this.filesToUpload[a].fileInfo.size;
this.config.onProgressCallback(a,this.filesToUpload[a].fileInfo.name,b,b);if(200==c.status){if(b=this.parseAndDecodeResponse(c.responseText),null!==b)if("Failure"===b.message||"Error"===b.message)this.config.onErrorCallback(a,d,b.html),"true"===b.ignoreIt?(this.cancelCurrentUpload(a),this.uploadNextIfExists()):this.cancelRemainingUploads(),this.runCustomHandlers(b.message,b,c);else{if(b.errormessage)this.config.onErrorCallback(a,d,b.errormessage);else this.config.onCompleteCallback(a,d,b),this.runCustomHandlers("Success",
b,c);this.inProgressXhrs.remove(a.toString());this.removeFromWaitingQueueAndUploadNext(a)}}else alert(LC.getLabel("Feeds","GenericFailureNoGack"))}},cancelInProgressUploads:function(){var a=this;this.inProgressXhrs.each(function(c){var d=parseInt(c,10);a.cancelCurrentUpload(d);a.inProgressXhrs.remove(c)})},cancelWaitingUploads:function(){for(;0<this.fileUploadWaitingQueue.length;){var a=this.fileUploadWaitingQueue[0];a&&this.cancelCurrentUpload(a)}this.fileUploadWaitingQueue=[]}});
Sfdc.ns("Sfdc.MultiFileUploaderUsageStats");Sfdc.MultiFileUploaderUsageStats=function(a){this.filterParentId=a.filterParentId;this.origin=a.origin;this.uploadMethod=a.uploadMethod;this.statsActionUrl=a.statsActionUrl;this.uploadStats=[]};Sfdc.MultiFileUploaderUsageStats.prototype.start=function(a){var b=(new Date).getTime();this.uploadStats[a.name]={fileType:a.type,fileSize:a.size,startTime:b}};
Sfdc.MultiFileUploaderUsageStats.prototype.finish=function(a){var b=(new Date).getTime();this.uploadStats[a.name].endTime=b};
Sfdc.MultiFileUploaderUsageStats.prototype.sendUsageStats=function(a){var b=Sfdc.MultiFileUploaderUtil.getBrowserName(),c="",e;for(e in this.uploadStats)if(this.uploadStats.hasOwnProperty(e)){var d=this.uploadStats[e],f=0;d.endTime&&(f=d.endTime-d.startTime);c+=d.fileType+",";c+=d.fileSize+",";c+=f+",";c+=";"}b={mfu:"1",stats:c,browser:b,method:this.uploadMethod,count:a,origin:this.origin};this.filterParentId&&(this.origin===Sfdc.ChatterFileUploader.PROFILE_PAGE&&this.filterParentId!=UserContext.userId)&&
(b.fcnt=a,b.fpid=this.filterParentId);chatter.getToolbox().post({url:this.statsActionUrl,params:b,failure:function(a,b){},success:function(a,b){}})};
Sfdc.ns("Sfdc.UploadButton");Sfdc.UploadButton=function(b){this.config={uploadBtnAnchor:null,name:"file",onChange:function(a){}};Sfdc.MultiFileUploaderUtil.extend(this.config,b);this.uploadBtnAnchor=this.config.uploadBtnAnchor;this.uploadBtnAnchor.style.position="relative";this.uploadBtnAnchor.style.overflow="hidden";this.uploadBtnAnchor.style.direction="ltr";this.inputElem=this.createInputBtn()};Sfdc.UploadButton.HIDDEN_MULTI_INPUT_ID="multiFileInput";Sfdc.UploadButton.HIDDEN_SINGLE_INPUT_ID="singleFileInput";
Sfdc.UploadButton.prototype={getInput:function(){return this.inputElem},reset:function(){Sfdc.Dom.removeChild(this.inputElem);this.inputElem=this.createInputBtn()},createFocusInputBtn:function(){var b=document.createElement("input");b.setAttribute("type","button");b.setAttribute("class","btnImportant");b.id="multiUploadBtn";b.value=LC.getLabel("ChatterFilesTabPage","uploadMultiFilesLinkText");return b},createHiddenInputBtn:function(b){var a=document.createElement("input");a.setAttribute("type","file");
a.setAttribute("name","chatterFile_upload");a.setAttribute("title",LC.getLabel("ChatterFilesTabPage","uploadMultiFilesLinkText"));!0===b?(a.setAttribute("multiple","multiple"),a.setAttribute("class","multifile-upload-input-button"),a.id=Sfdc.UploadButton.HIDDEN_MULTI_INPUT_ID):(a.setAttribute("class","singlefile-upload-input-button"),a.id=Sfdc.UploadButton.HIDDEN_SINGLE_INPUT_ID);this.uploadBtnAnchor.appendChild(a);var c=this;addEvent(a,"change",function(){c.config.onChange(a)});return a},createInputBtn:function(){var b=
this.createHiddenInputBtn(!0),a=this.createFocusInputBtn();this.uploadBtnAnchor.appendChild(a);Sfdc.on(this.uploadBtnAnchor,"click",function(a){document.getElementById(Sfdc.UploadButton.HIDDEN_MULTI_INPUT_ID).click()});Sfdc.on(document.getElementById(Sfdc.UploadButton.HIDDEN_MULTI_INPUT_ID),"click",function(a){Sfdc.Event.stopPropagation(a)});return b}};
Sfdc.ns("Sfdc.UploadFileDragDropZone");Sfdc.UploadFileDragDropZone=function(a){this.DRAG_AND_DROP_TARGET_OVERLAY_ID="dragAndDropTargetOverlay";this.config={onEnterCallback:function(){},onLeaveCallback:function(){},onDropCallback:function(a){}};Sfdc.MultiFileUploaderUtil.extend(this.config,a);this.dragFromOS=!0;this.isEntered=!1;this.errorDialog=null;this.attachDragDropEvents()};
Sfdc.UploadFileDragDropZone.prototype={attachDragDropEvents:function(){var a=this;addEvent(document,"dragstart",function(b){a.dragFromOS=!1});addEvent(document,"dragend",function(b){a.dragFromOS=!0});addEvent(document,"dragover",function(b){b.stopPropagation();b.preventDefault();if(a.isValidFileDrag(b)){var c=Sfdc.userAgent.isIE10||Sfdc.userAgent.isIE11?"move":b.dataTransfer.effectAllowed;b.dataTransfer.dropEffect="move"==c||"linkMove"==c?"move":"copy"}});addEvent(document,"dragenter",function(b){b.stopPropagation();
b.preventDefault();if((!a.errorDialog||!a.errorDialog.isOpen)&&!a.isDragAndDropInProgress()&&a.isValidFileDrag(b))a.config.onEnterCallback()});addEvent(document,"dragleave",function(b){b.stopPropagation();b.preventDefault();if(a.isDragAndDropInProgress()&&a.isEventFromDragAndDropOverlay(b))a.config.onLeaveCallback()});addEvent(document,"drop",function(b){b.stopPropagation();b.preventDefault();if(a.isDragAndDropInProgress()&&a.isValidFileDrag(b))a.config.onDropCallback(b)})},createDragAndDropOverlay:function(){var a=
document.createElement("div");a.id=this.DRAG_AND_DROP_TARGET_OVERLAY_ID;document.body.appendChild(a)},destroyDragAndDropOverlay:function(){var a=document.getElementById(this.DRAG_AND_DROP_TARGET_OVERLAY_ID);a.parentNode.removeChild(a)},isEventFromDragAndDropOverlay:function(a){return a.target.id===this.DRAG_AND_DROP_TARGET_OVERLAY_ID},isValidFileDrag:function(a){a=a.dataTransfer;return Sfdc.get(".multifile-upload-draganddrop-indicactor")&&this.dragFromOS&&(Sfdc.userAgent.isIE10||Sfdc.userAgent.isIE11||
a&&"none"!=a.effectAllowed&&(a.files||!Sfdc.userAgent.isWebkit&&a.types.contains&&a.types.contains("Files")))},isDragAndDropInProgress:function(){return this.isEntered}};
Sfdc.ns("Sfdc.MultiFileUploaderUiComponents.FileUploadBadge");
Sfdc.MultiFileUploaderUiComponents.FileUploadBadge=function(a,b,c,g,h,d){d=Sfdc.MultiFileUploaderUiComponents.FileUploadBadge;var e=d.makeFileTypeIcon(b.type),k=b.name,l=b.name,f=Sfdc.MultiFileUploaderUtil.formatFileSize(b.size),f=LC.getLabel("ChatterFileMultiUpload","valueInParentheses",f);d=Sfdc.String.format(d.HTML_TEMPLATE,{type:e,name:Sfdc.String.escapeToHtml(k),title:Sfdc.String.escapeToHtml(l),size:f});this.dom=d=Sfdc.MultiFileUploaderUtil.createElementFromHTML(d);e=LC.getLabel("ChatterFileMultiUpload",
"waiting");Sfdc.get(".multifile-upload-status",this.dom).innerHTML=e;this.fileDoesNotMeetLimits=!1;this.progressBar=new Sfdc.MultiFileUploaderUiComponents.ProgressBar(Sfdc.get(".singleProgress",this.dom),h);b.size?c&&b.size>c&&(this.displayWarningMessage(LC.getLabel("ChatterFileMultiUpload","fileLargerThanMaxLimit",g)),this.fileDoesNotMeetLimits=!0):(this.displayWarningMessage(LC.getLabel("ChatterFileMultiUpload","fileIsEmpty")),this.fileDoesNotMeetLimits=!0);d.mfuFileId=a};
Sfdc.MultiFileUploaderUiComponents.FileUploadBadge.HTML_TEMPLATE='\x3cli class\x3d"multi-item"\x3e\x3cspan class\x3d"multifile-upload-file"\x3e\x3cspan class\x3d"multifile-upload-type"\x3e{type}\x3c/span\x3e\x3cspan class\x3d"multifile-upload-name" title\x3d"{title}"\x3e{name}\x3c/span\x3e\x3cspan class\x3d"multifile-upload-size"\x3e{size}\x3c/span\x3e\x3c/span\x3e\x3cspan class\x3d"singleProgress"\x3e\x3cspan\x3e\x3c/span\x3e\x3c/span\x3e\x3cspan class\x3d"warningMessage hidden"\x3e\x3cspan class\x3d"warningMessageSpan"\x3e\x3c/span\x3e\x3c/span\x3e\x3cspan class\x3d"multifile-upload-status"\x3e\x3c/span\x3e\x3ca class\x3d"multifile-upload-cancel" href\x3d"javascript:void(0);"\x3e\x3cimg title\x3d"" alt\x3d"" src\x3d"/s.gif" class\x3d"deleteIconClass"/\x3e\x3c/a\x3e\x3cimg title\x3d"" alt\x3d"" src\x3d"/s.gif" class\x3d"uploadDoneIconClass hidden"/\x3e\x3cimg title\x3d"" alt\x3d"" src\x3d"/s.gif" class\x3d"uploadWarningIconClass hidden"/\x3e\x3c/li\x3e';
Sfdc.MultiFileUploaderUiComponents.FileUploadBadge.CSS={successClass:"successClass",failClass:""};Sfdc.MultiFileUploaderUiComponents.FileUploadBadge.makeFileTypeIcon=function(a){return'\x3cimg height\x3d"16" width\x3d"16" src\x3d"/s.gif"  class\x3d"'+Sfdc.MultiFileUploaderUtil.formatFileTypeCSS(a,"16")+'" /\x3e'};Sfdc.MultiFileUploaderUiComponents.FileUploadBadge.prototype.updateProgressBar=function(a){this.progressBar.update(a)};
Sfdc.MultiFileUploaderUiComponents.FileUploadBadge.prototype.updateFileProgressPercentage=function(a){Sfdc.get(".multifile-upload-status",this.dom).innerHTML=a+"%"};
Sfdc.MultiFileUploaderUiComponents.FileUploadBadge.prototype.displayWarningMessage=function(a){Sfdc.Dom.addClass(this.dom,"warningBackGround");Sfdc.Dom.hideByDisplay(Sfdc.get(".singleProgress",this.dom));Sfdc.Dom.show(Sfdc.get(".warningMessage",this.dom));var b=Sfdc.get(".warningMessageSpan",this.dom);Sfdc.Dom.setText(b,a.replace(/&nbsp;/gi," "));Sfdc.Dom.addClass(b,"warningLabelInRed");Sfdc.Dom.addClass(Sfdc.get(".multifile-upload-cancel",this.dom),"hidden");Sfdc.Dom.removeClass(Sfdc.get(".uploadWarningIconClass",
this.dom),"hidden");Sfdc.Dom.hideByVisibility(Sfdc.get(".multifile-upload-status",this.dom))};
Sfdc.MultiFileUploaderUiComponents.FileUploadBadge.prototype.displayAsCanceled=function(){var a=this.dom;Sfdc.Dom.addClass(a,"warningBackGround");a&&(a.isAbort=!0);Sfdc.Dom.hideByVisibility(Sfdc.get(".singleProgress",a));Sfdc.Dom.hideByVisibility(Sfdc.get(".multifile-upload-cancel",a));a=Sfdc.get(".multifile-upload-status",a);Sfdc.Dom.setText(a,LC.getLabel("ChatterFileMultiUpload","cancelled"));Sfdc.Dom.hasClass(a,"doneLabelInGreen")&&Sfdc.Dom.removeClass(a,"doneLabelInGreen");Sfdc.Dom.addClass(a,
"warningLabelInRed")};
Sfdc.MultiFileUploaderUiComponents.FileUploadBadge.prototype.displayAsCompleted=function(a){var b=this.dom;if(b){var c=Sfdc.get(".multifile-upload-status",b);Sfdc.Dom.addClass(c,"doneLabelInGreen");Sfdc.Dom.hideByVisibility(Sfdc.get(".singleProgress",b));c.innerHTML=LC.getLabel("ChatterFileMultiUpload","done");Sfdc.Dom.hasClass(c,"warningLabelInRed")&&Sfdc.Dom.removeClass(c,"warningLabelInRed");Sfdc.Dom.addClass(Sfdc.get(".multifile-upload-cancel",b),"hidden");Sfdc.Dom.removeClass(Sfdc.get(".uploadDoneIconClass",b),
"hidden")}a&&"Success"===a.message?Sfdc.Dom.addClass(b,Sfdc.MultiFileUploaderUiComponents.FileUploadBadge.CSS.successClass):Sfdc.Dom.addClass(b,Sfdc.MultiFileUploaderUiComponents.FileUploadBadge.CSS.failClass)};
function ExternalFileProgressDialog(b,c,d,a){ActionProgressDialog.call(this,b,c,d,a)}ExternalFileProgressDialog.prototype=new ActionProgressDialog;ExternalFileProgressDialog.show=function(b,c,d){var a=sfdcPage.getDialogById(b);a||(a=new ExternalFileProgressDialog(b),a.register());a.setProgressMsgTitle(c);a.setProgressMsgText(d);a.createContent();a.show();return a};
ExternalFileProgressDialog.showOnGetFileInfo=function(b){var c=LC.getLabel("Publisher","externalFileGetInfoProgressTitle"),d=LC.getLabel("Publisher","externalFileGetInfoProgressText");return ExternalFileProgressDialog.show(b,c,d)};
ExternalFileProgressDialog.showOnPostFile=function(b,c){var d=LC.getLabel("Publisher","externalFilePostProgressTitle"),a;a=c?LC.getLabel("Publisher","externalFilePostAsReferenceProgressText"):LC.getLabel("Publisher","externalFilePostAsCopyProgressText");return ExternalFileProgressDialog.show(b,d,a)};
function FeedPostContentUploadDialog(c,b,d,e){ActionProgressDialog.call(this,c,b,d,e)}FeedPostContentUploadDialog.prototype=new ActionProgressDialog;FeedPostContentUploadDialog.prototype.addButtonBar=function(){this.overrideButton(0,LC.getLabel("Publisher","postFileProgressCancel"),"chatter.getPublisher().getHandler('ContentPost').handleFileUploadCancel()")};
FeedPostContentUploadDialog.getDialog=function(c,b,d,e){var a=sfdcPage.getDialogById(c);a||(a=new FeedPostContentUploadDialog(c),a.register());d?(b+=d,c='\x3cspan class\x3d"multifile-upload-type"\x3e\x3cimg height\x3d"16" width\x3d"16" src\x3d"/s.gif"  class\x3d"'+Sfdc.MultiFileUploaderUtil.formatFileTypeCSS(d)+'" /\x3e\x3c/span\x3e',a.setProgressMsgTitle(c+"\x26nbsp;"+b,b)):a.setProgressMsgTitle(LC.getLabel("Publisher","postFileUploading")+" "+b,b);a.setProgressMsgText(LC.getLabel("Publisher","postFileProgressText"));
a.setHelpUrl(e);a.createContent();return a};
function ApprovalPostDialog(a,b,c,d,e){this.workItemId=a;this.transitionType=b;this.targetObjectType=c;this.servletUrl=d;this.csrfToken=e;this.lookupMode=!1;this.comments=this.lookupInputHTML="";this.receivedResponse=this.showNextApprover=!1;this.timeOutId=null}ApprovalPostDialog.prototype=new OverlayDialog;ApprovalPostDialog.prototype.createContent=OverlayDialogElement.prototype.createContent;
ApprovalPostDialog.prototype.getDialog=function(a){var b=sfdcPage.getDialogById(a);if(b)return this.resetDlgContents(),b;OverlayDialogElement.call(this,a);this._initApprovalOverlay();this.register();return this};
ApprovalPostDialog.prototype._initApprovalOverlay=function(){this.allowKeyboardEsc=this.displayX=this.hasButtonsBar=this.isModal=!0;this.extraClass="";this.refreshOnClose=this.isAbsolutePositioned=!1;var a=this._getIdBase();this.buttonContents='\x3cinput value\x3d"'+LC.getLabel("Buttons","ok")+'" class\x3d"'+ZenCss.btn+'" name\x3d"ok" onclick\x3d"'+a+'Var.executeProcessAction();" title\x3d"OK" type\x3d"button" /\x3e\x3cinput value\x3d"'+LC.getLabel("Buttons","cancel")+'" class\x3d"'+ZenCss.btn+'" name\x3d"cancel" onclick\x3d"'+
a+"Var.getDialog('"+a+'overlay\').cancel()" title\x3d"Cancel" type\x3d"button" /\x3e';this.contents='\x3cdiv id\x3d"'+a+'commentDiv" style\x3d"display:block; padding:5px"\x3e\x3cdiv id\x3d"commentPrompt" style\x3d"padding-bottom:5px"\x3e'+LC.getLabel("FeedPostAction","OverlayCommentPrompt")+'\x3c/div\x3e\x3ctextarea class\x3d"feedPostComment" cols\x3d"60" id\x3d"'+a+'comment" maxlength\x3d"1000" name\x3d"'+a+'comment" rows\x3d"5" type\x3d"text" wrap\x3d"soft"\x3e\x3c/textarea\x3e\x3c/div\x3e\x3cdiv id\x3d"'+
a+'nextApproverDiv" class\x3d"overlayPanel nextApproverOverlay" style\x3d"display:none"\x3e\x3c/div\x3e\x3cdiv class\x3d"spinner" id\x3d"'+a+'spinnerDiv" style\x3d"display:none"\x3e\x3c/div\x3e\x3cdiv class\x3d"overlayPanel" id\x3d"'+a+'errorDiv" style\x3d"display:none"\x3e\x3cdiv class\x3d"message errorM3" id\x3d"'+a+'errorMsg"\x3e\x3cdiv class\x3d"messageDiv"\x3e\x3cimg src\x3d"/s.gif" alt\x3d"Error" class\x3d"msgIcon" title\x3d"Error"/\x3e\x3cdiv class\x3d"messageText" style\x3d"padding-left:18px"\x3e\x3c/div\x3e\x3c/div\x3e\x3cscript type\x3d"text/javascript"\x3eif (window.sfdcPage) sfdcPage.registerMessage(\''+
a+'errorMsg\');\x3c/script\x3e\x3c/div\x3e\x3cdiv class\x3d"buttons" id\x3d"'+a+'error_buttons" style\x3d"display:none"\x3e\x3cinput value\x3d"'+LC.getLabel("Buttons","ok")+'" class\x3d"'+ZenCss.btn+'" name\x3d"rejectButton" onclick\x3d"'+a+"Var.getDialog('"+a+'overlay\').cancel()" title\x3d"OK" type\x3d"button" /\x3e\x3c/div\x3e\x3c/div\x3e';this.setWidth(480);"A"==this.transitionType?this.setTitle(LC.getLabel("FeedPostAction","OverlayApproveTitle")):this.setTitle(LC.getLabel("FeedPostAction","OverlayRejectTitle"))};
ApprovalPostDialog.prototype.resetDlgContents=function(){var a=this._getIdBase(),b=Sfdc.get(a+"comment"),a=Sfdc.get(a+"nextApprover");b&&(b.value="");a&&(a.value="");this.lookupMode=!1;a&&this.lookupInputHTML&&this._updateLookupControl(this.lookupInputHTML);this._updateErrorMsg("","error");this._updateLookupErrorMsg("");this._updateCommentErrorMsg("");this.showNextApprover=!1;this._showCommentInputState(!0);this._showButtonBarState(!0);this._showNextApproverInputState(!1);this._showErrorState(!1);
this._showPendingState(!1)};
ApprovalPostDialog.prototype.executeProcessAction=function(){var a=this._getIdBase(),b="",c="",d="005";if(this.showNextApprover){Sfdc.get(a+"nextApproverDiv");var b=(b=Sfdc.get(a+"nextApprover_lkid"))&&b.value?b.value:"",e=Sfdc.get(a+"nextApprover_mlktp");e&&(d=e.value);if(0===b.length||b==Udd.EMPTY_KEY)if(this.lookupMode=!0,b="",c=(c=Sfdc.get(a+"nextApprover"))&&c.value?Sfdc.String.trim(c.value):"",0===c.length){this._updateLookupErrorMsg(LC.getLabel("Edit","Required"));return}}else if(this.comments=
(e=Sfdc.get(a+"comment"))&&e.value?e.value:"",1E3<e.value.length){this._updateCommentErrorMsg(LC.getLabel("Edit","TooLong"));return}this._showCommentInputState(!1);this._showNextApproverInputState(!1);this._showButtonBarState(!1);this._showErrorState(!1);this._showPendingState(!0);d={workitemId:this.workItemId,transitionType:this.transitionType,targetObjectType:this.targetObjectType,comments:this.comments,nextOwnerId:b,nextOwnerLookupVal:c,lookupType:d};d[a+"nextApprover"]=c;d[CSRFConstants.CSRF_TOKEN]=
this.csrfToken;this.timeOutId&&(clearTimeout(this.timeOutId),this.timeOutId=null);var f=window[a+"Var"];this.timeOutId=setTimeout(function(){f._onTimeoutAjaxRequest(f)},6E4);this.receivedResponse=!1;Sfdc.Ajax.post(UserContext.getUrl(this.servletUrl),this.onCompleteProcessAction,{data:d,failure:this.onHttpFailure,context:this,escape:encodeURIComponent})};
ApprovalPostDialog.prototype.onCompleteProcessAction=function(a){this.receivedResponse=!0;a=Util.evalAjaxServletOutput(a);a.actionSucceeded?this._processSuccessResponse():this._processFailureResponse(a)};ApprovalPostDialog.prototype.onHttpFailure=function(a,b,c){this.receivedResponse=!0;this._getIdBase();this._showPendingState(!1);a=LC.getLabel("FeedPostAction","ServletHttpError",b.status);this._updateErrorMsg(a,"error");this._showErrorState(!0)};
ApprovalPostDialog.prototype.expandMore=function(a,b){var c=Sfdc.Dom.getParent(a,".approvalMoreContainer");if(c){var d=Sfdc.get(".approvalMoreLink",c);d&&(d.style.display="none")}d=null;b&&(d=Sfdc.Dom.getParent(a,b));if(c=Sfdc.get(".approvalExpandedContent",d?d:c))c.style.display="inline"};
ApprovalPostDialog.prototype._processSuccessResponse=function(){var a=this._getIdBase(),b=sfdcPage.getDialogById(a+"overlay");b&&b.cancel();if(b=Sfdc.get("buttons_"+this.workItemId))b.style.display="none";if(a=Sfdc.get(a+"status"))a.style.display="block"};
ApprovalPostDialog.prototype._processFailureResponse=function(a){if(a&&a.errMsg&&0<a.errMsg.length){var b=this._getIdBase();this._showPendingState(!1);if(0<a.missingNextApprover.length||this.lookupMode){if(this.lookupMode){this._updateLookupErrorMsg(a.errMsg);if(b=Sfdc.get(b+"nextApprover"))b.value="";this.lookupInputHTML=this._updateLookupControl(a.lookupHtml)}else this._populateNextApproverInput(a.missingNextApprover);ForeignKeyInputElement.reload();this.showNextApprover=!0;this._showNextApproverInputState(!0);
this._showButtonBarState(!0)}else this._updateErrorMsg(a.errMsg,a.severity),this._showErrorState(!0)}};ApprovalPostDialog.prototype._onTimeoutAjaxRequest=function(a){if(!a.receivedResponse){a._showPendingState(!1);var b=LC.getLabel("FeedPostAction","ServletTimeoutError");a._updateErrorMsg(b,"error");a._showErrorState(!0)}a.timeOutId&&(clearTimeout(a.timeOutId),a.timeOutId=null)};
ApprovalPostDialog.prototype._updateCommentErrorMsg=function(a){var b=this._getIdBase();if(b=Sfdc.get(b+"commentDiv")){var c=Sfdc.get(".errorMsg",b);c&&Sfdc.Dom.removeChild(c);c="\x3cdiv class\x3d'errorMsg'\x3e\x3c/div\x3e";0<a.length&&(c="\x3cdiv class\x3d'errorMsg'\x3e\x3cb\x3e"+LC.getLabel("Apex","Error")+"\x3c/b\x3e"+a+"\x3c/div\x3e");Sfdc.Dom.insertHTML(b,c)}};
ApprovalPostDialog.prototype._updateLookupErrorMsg=function(a){var b=this._getIdBase();if(b=Sfdc.get(b+"nextApproverDiv"))if(b=Sfdc.get(".requiredInput",b)){var c=Sfdc.get(".errorMsg",b);c&&Sfdc.Dom.removeChild(c);c="\x3cdiv class\x3d'errorMsg'\x3e\x3c/div\x3e";0<a.length&&(c="\x3cdiv class\x3d'errorMsg'\x3e\x3cb\x3e"+LC.getLabel("Apex","Error")+"\x3c/b\x3e"+a+"\x3c/div\x3e");Sfdc.Dom.insertHTML(b,c)}};
ApprovalPostDialog.prototype._updateLookupControl=function(a){var b=this._getIdBase();if((b=Sfdc.get(b+"nextApproverDiv"))&&a)(b=Sfdc.get(".requiredInput",b))&&Sfdc.Dom.updateHTML(b,a);return""};ApprovalPostDialog.prototype._updateErrorMsg=function(a,b){var c=this._getIdBase();if(c=Sfdc.get(c+"errorMsg"))if(b&&"info"==b?c.className="message infoM3":b&&"error"==b&&(c.className="message errorM3"),c=Sfdc.get(".messageText",c))c.innerHTML=a};
ApprovalPostDialog.prototype._showCommentInputState=function(a){var b=this._getIdBase();if(b=Sfdc.get(b+"commentDiv"))b.style.display=a?"block":"none"};ApprovalPostDialog.prototype._populateNextApproverInput=function(a){var b=this._getIdBase();(b=Sfdc.get(b+"nextApproverDiv"))&&Sfdc.Dom.updateHTML(b,a);this._updateLookupErrorMsg("")};
ApprovalPostDialog.prototype._showNextApproverInputState=function(a){var b=this._getIdBase();if(b=Sfdc.get(b+"nextApproverDiv"))a&&this.showNextApprover?(b.style.display="block",this._centerLookupElement()):b.style.display="none"};
ApprovalPostDialog.prototype._centerLookupElement=function(){var a=this._getIdBase(),b=Sfdc.get(a+"nextApproverLookup");if(b){var c=0,d=Sfdc.get(a+"nextApprover_top");d&&(d.style.display="inline");var e=Sfdc.get(".errorMsg",b);e&&(e.style.display="none");c=b.offsetWidth;d&&!Ext.isIE7&&(d.style.display="");a=Sfdc.get(a+"nextApproverDiv").offsetWidth;c=Math.round((parseInt(a)-parseInt(c))/2);b.style.left=c+"px";e&&(e.style.display="",e.style.left="-"+c+"px")}};
ApprovalPostDialog.prototype._showButtonBarState=function(a){var b=this._getIdBase();if(b=Sfdc.get(b+"overlay_buttons"))b.style.display=a?"block":"none"};ApprovalPostDialog.prototype._showPendingState=function(a){var b=this._getIdBase();if(b=Sfdc.get(b+"spinnerDiv"))b.style.display=a?"block":"none"};
ApprovalPostDialog.prototype._showErrorState=function(a){var b=this._getIdBase(),c=Sfdc.get(b+"errorDiv"),b=Sfdc.get(b+"error_buttons");c&&(c.style.display=a?"block":"none");b&&(b.style.display=a?"block":"none")};ApprovalPostDialog.prototype._getIdBase=function(){return this.transitionType+"_"+this.workItemId+"_"};chatter.extend("ApprovalPost",ApprovalPostDialog,null);
(function(){chatter.extend("CanvasAuxThumbnailRetriever",function(){function a(){var a=Sfdc.select("."+c.classPrefetch);a&&0<a.length&&Sfdc.each(a,function(a){Sfdc.Dom.removeClass(a,c.classPrefetch);Sfdc.get("\x3e a \x3e img",a).setAttribute("src",a.getAttribute("data-canvasThumbnailUrl"));Sfdc.Dom.addClass(a,c.classFetched)})}var b=chatter.getEventBus(),c={classPrefetch:"canvasThumbnail-prefetch",classFetched:"canvasThumbnail-fetched"};b.addEventListener("chatter:feed","onAfterFeedRefresh",a);b.addEventListener("chatter:feed",
"onAfterShowMoreFeedItems",a);b.addEventListener("chatter:feed","onAfterNewPostFeedUpdate",a);b.addEventListener("chatter:rechat","onAfterPreviewLoaded",a);b.addEventListener("unifiedSearchPage:feedSearchResults","onAfterResultsShown",a);this.parseDOMAndRender=function(){a()}},null);Sfdc.onload(function(){chatter.getCanvasAuxThumbnailRetriever().parseDOMAndRender()})})();
chatter.getToolbox().getPerfEnabled()&&Perf.mark("Sfdc.ChatterFeed:Start");
function Feed(){function D(){return Sfdc.get("feedwrapper")}function m(){var a=D();return a?Sfdc.get(".cxfeedcontainer",a):null}function u(a,c,b,d,e,f){var h;try{h=I(a+"_"+b,c,d,e,f)}catch(k){h=void 0}h||(h=I(a,c,d,e,f));return h}function I(a,c,b,d,e){return b&&d&&e?LC.getLabel(a,c,b,d,e):b&&d?LC.getLabel(a,c,b,d):b?LC.getLabel(a,c,b):LC.getLabel(a,c)}function $(){var a=Sfdc.get("chatterfeedshell");return a&&Sfdc.select(".feedrightbar",a)[0]}function l(a){return Ext.get(a).findParent(".cxfeeditem",
50,!0)}function s(a){return Ext.get(a).findParent(".cxfeedcomment",50,!0)}function aa(a,c){if(c){var b=!(g.getCommentElement(c.id).getInputValueLength()<=J),d=chatter.getTextareaMessageUtil().isMessageDisplayed(c.id,"CommentMaxLengthErrorMsg"),e=LC.getLabel("Feeds","CommentMaxLengthErrorMsg",J);b!=d&&(d=chatter.getTextareaMessageUtil(),b?(d.showMessage({el:c.id,type:1,append:!0,msg_html:e,msg_id:"CommentMaxLengthErrorMsg"}),chatter.getToolbox().disableButton(K(c))):d.hideMessage({el:c.id,msg_id:"CommentMaxLengthErrorMsg"})||
chatter.getToolbox().enableButton(K(c)))}}function K(a){a=Sfdc.Dom.getParent(a,".cxchattertextareacontainer");return Sfdc.get(".cxchattersubmit",a)}function E(a,c,b){if(!a.hasClass("cxiswired")){b||(a.dom.value="");a.on("keyup",aa);chatter.getToolbox().expandableTextArea(a.dom,q,B);chatter.getToolbox().initializeIE8JPNTypingFix(a.dom);var d=a.hasClass("groupAtMentionsEnabled"),e=a.hasClass("chatterTopicsEnabled"),f=a.hasClass("hashtagACDisabled"),h=a.hasClass("externalGroupInputElement"),k=null;Sfdc.Dom.hasClass(c,
"cxrechatfeeditem")||(k=c.id);var v=g.getFeedItemData(c),d=new PublisherAutoComplete(a.dom.id,"/autocomplete",{},k,d,e,f,v.parentid,v.parentname);b&&(e=g.getAtMentionsData(a),d.atMentions=e,chatter.getToolbox().updateHeight(a.dom,q,q*B));(Sfdc.Dom.hasClass(c,"cxfeeditemoverlay")||b)&&d.setIsOverlay(!0);h&&d.toggleExternalGroupWarning(!0);C[d.id]=d;b||ba(a,c);a.addClass("cxiswired");return d}return null}function ba(a,c){var b=g.getFeedItemData(c),d=g.getConfig();if(d&&d.isPrivateGroup&&b&&d.subjectId!==
b.parentid){var d=Sfdc.get(".feeditemvisibilitycontainer",c),e=Sfdc.Dom.create(d,{},"div");Sfdc.Dom.addClass(e,"visibilityWidgetParent");e=Sfdc.Dom.create(e,{href:"javascript:void(0);",title:LC.getLabel("Feeds","WhoCanSeeYourComment")},"a");Sfdc.Dom.addClass(e,"visibilityicon");var f=Sfdc.Dom.create(e,{},"span");Sfdc.Dom.addClass(f,"zen-assistiveText");Sfdc.Dom.insertHTML(f,LC.getLabel("Feeds","WhoCanSeeYourComment"));if(Sfdc.userAgent.isIE7)var h=Sfdc.Dom.getParent(d,".chattertextareacontainer"),
k=function(){Sfdc.Dom.addClass(h,"feeditemZIndex")},v=function(){Sfdc.Dom.removeClass(h,"feeditemZIndex")};var w=new VisibilityWidget({icon:e,helpUrl:g.getCommentVisibilityHelpLink(),onexpand:k,oncollapse:v});Sfdc.Event.add(e,"click",function(){w.toggleDisplay()});var t={text:LC.getLabel("Feeds","WhoCanSeeThisCommentMsg",b.parentActualName),title:LC.getLabel("Feeds","WhoCanSeeThisCommentTitle")},r={text:LC.getLabel("Feeds","WhereCanOthersFindThisCommentMsg",b.parentActualName),title:LC.getLabel("Feeds",
"WhereCanOthersFindThisCommentTitle")};w.registerHandler(function(){return[t,r]});b=LC.getLabel("Feeds","CommentPostAtmentionPrivateGroupMsg");d=Sfdc.Dom.create(d,{},"div");Sfdc.Dom.addClass(d,"visibilityWarningMessage");Sfdc.Dom.insertHTML(d,b)}}function L(a,c){var b=a.child(".cxfeedcommentcount");if(b){var d=parseInt(b.getAttribute("attr-count"),10);if(!d)return;var e=d+c,f=b.dom.innerHTML.replace(/[0-9]+/g,e);if(1==e||1==d){b=a.child(".cxshowmorecommentslabel").dom;d=Ext.DomHelper.markup({cls:"cxfeedcommentcount",
tag:"span",html:e});e=1==e?LC.getLabel("Feeds","ShowOneComment",d):LC.getLabel("Feeds","ShowAllComments",d);b.innerHTML=e;return}b.dom.innerHTML=f;b.dom.setAttribute("attr-count",e)}if(b=a.child(".cxsummarycommentcount"))count=b.dom.getAttribute("data-commentcount"),e=count+c,0<e?n.show(b):n.hide(b),b.dom.setAttribute("data-commentcount",e)}function M(a){var c=chatter.getToolbox(),b=a.select("div.cxfeedcomment"),d=a.select("div.cxfeeditemlike"),e=a.child(".cxfeedcommentsshowmore"),f=a.child(".cxnewcommenttext"),
f=f?f.dom.value:"",h=a.child(".linkedContentDetailsContainer");0===b.getCount()&&(null===e&&0===d.getCount())&&(c.hide(a.child("div.cxcomments")),c.stringIsEmpty(f)&&!h&&(c.hide(a.child("div.cxnewcomment")),c.hide(a.child("div.cxcommentplaceholder"))))}function N(a,c,b){var d=a.child(".cxshowmorecommentscontainer"),e=chatter.getToolbox();e.mask(d);var f=g.getConfig();c.writable=f.writable;var h=g.search,k;for(k in h)c[k]=h[k];h=g.pagingParams;for(k in h)c[k]=e.htmlDecode(h[k]);c.returnCommentExpanded=
f.alwaysShowFullText;e.get({url:"/feeditems/"+c.feeditemid+"/comments",params:c,failure:function(){e.unmask(d)},success:function(c,h){b();a.child(".cxfeedcommentsshowmore").remove();var f=a.child(".cxcomments");f.createChild(h.html,a.child(".cxcomments\x3e.cxfeedcomment:first"));var k=document.createElement("div");k.innerHTML=h.html;k=Sfdc.select(".feeditemcomment.cxfeedcomment",k);Sfdc.Array.forEach(k,function(a){chatter.getFeed().displayShowMoreAndFadeOut(a.id)});k=chatter.getEventBus();k.fireEvent("chatter:feed",
"onAfterShowMoreComments");SfdcApp.MruHovers.isHoverSection(a)&&k.fireEvent("chatter:hover","onAfterUpdate",{container:f});SfdcCmp.init(f.dom);e.unmask(d);a.child(".cxaddcommentaction").focus()}});return!1}function F(a,c){if(g.getConfig().isCompactFeed){var b=m();b&&(b=Sfdc.select(".cxfeeditem",b),c&&b.length>c&&(b=b.slice(0,c)),Sfdc.each(b,a),chatter.getEventBus().fireEvent("chatter:feed","onAfterExpandedStateChange",{subjectId:g.getConfig().subjectId}))}}function y(){return Sfdc.get(".feedsupermenu",
m())}function O(a,c){g.searchString=c;var b={isPost:!0,verb:";edit",feedType:"SEARCH",isFullRefresh:!1},d;d=a.params?a.params:a;d.showFeedItemsOnly=!0;d.initialViewMode="feeds";d.str=g.searchString;var e=Sfdc.get("filterDisplay");e&&(d.label=e.innerHTML);"SEARCH"!==a.feedType&&(g.findInFeedType=a.feedType);d.findInFeedType=g.findInFeedType;b.params=d;var f=Sfdc.clone(b.onSuccess);b.onSuccess=function(){g.expandSearchAndShowMenu(c);Sfdc.isFunction(f)&&f(json);if(d.isDropDownFiltersVisible){var a=Sfdc.get("filterDisplay");
a&&Sfdc.Dom.updateHTML(a,d.label)}};return b}var g=this,n=chatter.getToolbox(),J=1E4,q=16,B=2,P=3,x=null,C={},G={};g.config={};g.commentVisibilityHelpLink;var ca=function(a){return(a=a.select("div.cxfeedcomment"))&&0<a.getCount()},Q=function(a,c){var b=chatter.getToolbox(),d=l(a);b.hide(d.child(".cxcontentcommentaction"));chatter.getToolbox().get({params:{q:";linkedContentDetails",contentDocumentId:c,cc:!0},success:function(b,c){l(a).child(".cxcontentcommentinfo").dom.innerHTML=c.html},failure:function(a,
c){b.show(d.child(".cxcontentcommentaction"))}})},da=function(a,c,b){var d=chatter.getToolbox(),e=l(a);d.hide(e.child(".cxcontentcommentaction"));var f=ExternalFileProgressDialog.showOnGetFileInfo("extFileProgress");chatter.getToolbox().get({url:"/contenthub/linkedfiledetails/"+c+"/"+encodeURIComponent(b),params:{cc:!0},success:function(b,c){f.hide();l(a).child(".cxcontentcommentinfo").dom.innerHTML=c.html},failure:function(a,b){f.hide()}})},z=function(a){return attachFileEl=a.child(".cxcontentcommentaction")},
R=function(a,c,b){a=l(a).child(".cxnewcommenttext");b?a.addClass(c):a.removeClass(c)},S=function(a){chatter.getToolbox().log("Fetching feed");var c=a.params||{};c.isFullRefresh=!1;var b=a.verb||"",d=c.subjectId?c.subjectId:UserContext.userId,b=a.url||"/feed/"+d+"/"+a.feedType+b;c.isCompactFeed||(c.isCompactFeed=g.getConfig().isCompactFeed);c={url:b,params:c,success:a.onSuccess,failure:a.onFailure,abortTargets:["feedRefresh"],ajaxInstanceKey:"feedRefresh"};a=a.isPost?"post":"get";chatter.getToolbox()[a](c)},
T=function(a,c){chatter.getToolbox().log("Replacing feed with fetched feed");var b=m();Sfdc.Dom.hideByVisibility(b);var d=chatter.getEventBus();d.fireEvent("chatter:feed","onBeforeRemoveFeed");var e=a.html;Sfdc.Dom.updateHTML(D(),e,!0);(e=Sfdc.get(c.feedItemId,b))&&g.removeItemElement(e);Sfdc.Dom.show(b,!0);a.pollingToken=c.pollingToken;d.fireEvent("chatter:feed","onAfterFeedRefresh",{json:a});H(c)},H=function(a){var c=chatter.getEventBus();c.fireEvent("chatter:feed","onBeforeNewPostFeedUpdate",{json:a});
var b=chatter.getToolbox().runScriptReturnHtml(a.html,chatter.getYoutubeVideo().fetchVideoPreviews),b=g.addFeedItem(b);c.fireEvent("chatter:feed","onAfterNewPostFeedUpdate",{json:a,feedItem:b})},U=function(a,c){H(c.json)},V=function(a,c,b){a=s(b);b=c.html;var d=document.createElement("div");d.innerHTML=b;b=Sfdc.get(".feeditemcomment",d);b=Sfdc.Dom.replace(b,a.dom);chatter.getFeed().displayShowMoreAndFadeOut(a.id);SfdcCmp.init(b);c={json:c,element:b};chatter.getEventBus().fireEvent("chatter:publisher",
"onAfterEditComment",c)},W=function(a,c){var b=c.feedItemEl,d=b.child(".questionTitleAndBody"),e=b.child(".QuestionPostAuxBody");d&&e&&b.child(".bestAnswerBody").dom.getAttribute("data-bestanswerid")===c.commentId&&e.remove()},ea=function(a,c){chatter.getToolbox().get({url:"/"+c+"/actionlinks/"+a.id,success:function(a,d){X(c,d)},failure:function(){}})},X=function(a,c){if(c.primaryGroupHtml){var b=Sfdc.get("#"+a+" .actionlinkscontainer.primary",m());b&&Sfdc.Dom.updateHTML(b,c.primaryGroupHtml)}else c.unclassifiedGroupHtml&&
(b=Sfdc.get("#"+a+" .actionlinkscontainer.unclassified",m()))&&Sfdc.Dom.updateHTML(b,c.unclassifiedGroupHtml)},Y=function(a,c,b,d){a={feedItemType:a,entityId:c,parentId:b,feedItemVisibility:d};if(c=chatter.getFeed()){if(b=c.getConfig())b.feedType&&(a.feedType=b.feedType),b.isCompactFeed&&(a.isCompactFeed=b.isCompactFeed);if(c=c.getPollToken())a.pollingToken=c}return a},fa=function(a,c){var b={contextId:c},d=a,e=Sfdc.get(".quickActionSubmitButton"),f=!1;b.getTextAreaWidget=function(){return d};b.isRichText=
function(){return d?d.isRichText():!1};b.getRawBody=function(){return d?d.getInputWithEncodedAtMentions():""};b.setRawBody=function(a,b){d&&(d.setValue(a),Sfdc.isArray(b)&&(d.atMentions=b))};b.setSubjectId=function(a){this.contextId=a};b.getSubjectId=function(){return this.contextId};b.setIsExtensionValidForSubmit=function(a){(f=a)?this.enableShareButtonIfValid():this.disableShareButton()};b.showErrors=function(a){Dialogs.showSimpleError("",a,null)};b.isPromptText=function(a){return a===h()};b.resetPublisher=
function(){if(d){d.clearAtMentions();var a=d.element;a.value=h();a.title=h();Sfdc.Dom.removeClass(a,"publishertextareafocus")}this.setIsExtensionValidForSubmit(!0)};b.enablePublisher=function(){this.enableShareButtonIfValid()};b.disablePublisher=function(){this.disableShareButton()};b.enableShareButtonIfValid=function(){e&&(e.disabled=!1)};b.disableShareButton=function(){e&&(e.disabled=!0)};b.focusOnTextArea=function(){d&&(d.focus(),Sfdc.userAgent.isIE&&!d.isRichText()&&d.setValue(d.getValue()))};
b.restoreDefaultUIState=function(){};b.cleanUp=function(){d&&(d.acBox&&d.acBox.div)&&Sfdc.Dom.removeChild(d.acBox.div);d&&d.ckEditor&&chatter.getToolbox().destroyCKEditor(d.ckEditor.name);e=d=null};var h=function(){var a=null,b=chatter.getPublisher().getHandler("PlatformActionHandler");b&&Sfdc.isString(b.config.promptText)&&(a=b.config.promptText);a||(a=Sfdc.Dom.getAttribute(Sfdc.get("quickactiondata",Sfdc.get("quickActionContainerContent")),"data-defaultprompttext"));return a};return b},p=null,ga=
function(){x&&(x.cleanUp(),x=null);if(p){var a=p.background;a&&Sfdc.Dom.removeChild(a);(a=p.dialog)&&Sfdc.Dom.removeChild(a)}},ha=function(a){a={};var c=null,b=chatter.getEventBus();b.addEventListener("chatter:publisher","onAfterUpdateFeedItem",function(a,b){p.closeDialog()});b.addEventListener("chatter:publisher","onAfterQuickActionSuccess",function(a,b){p.closeDialog()});var d=function(a){a=a&&"09D"===a.substring(0,3)?a+"actionLink":"PlatformActionHandler";return chatter.getPublisher().getHandler(a)},
e=function(a,b){return a&&"09D"===a.substring(0,3)?chatter.getPublisher().getHandler(a+"actionLink"):chatter.getPublisher().registerPlatformActionHandler(a)},f=function(a,b,d){c=fa(a,b);d.publisherCore=c};a.cleanUp=function(){c&&c.cleanUp()};a.launchQuickAction=function(a,b,c,d,g){function r(){var b=Sfdc.get("quickActionContainerContent"),d=null,k=null;b&&(d=Sfdc.get("quickactiondata",b))&&(k=e(Sfdc.Dom.getAttribute(d,"data-quickactionid")));if(b&&k){var g=function(a){var b=k.publisherCore.getTextAreaWidget();
a=a>chatter.getPublisher().DEFAULT_MAX_BODY_LENGTH;var c=b.isNoticeDisplayed("PublisherMaxLengthErrorMsg");a!=c&&(c=LC.getLabel("Publisher","PublisherMaxLengthErrorMsg"),a?b.showNotice("PublisherMaxLengthErrorMsg",c,1):b.hideNotice("PublisherMaxLengthErrorMsg"))};(function(){var a=[];a.push({placeholder:".publisherTextAreaPlaceholder",component:".publisherTextAreaContainer"});a.push({placeholder:".publisherBottomBarPlaceholder",component:".bottomBar"});a.push({placeholder:".publisherShareButtonPlaceholder",
component:".quickActionSubmitButton"});k.isEdit&&a.push({placeholder:".publisherCancelLinkPlaceholder",component:".quickActionCancelLink"});for(var c=0;c<a.length;c++){var d=a[c].component,e=Sfdc.get(a[c].placeholder,b),d=Sfdc.get(d,b);e&&d&&Sfdc.Dom.replaceChildrenWith(e,d)}for(c=0;c<a.length;c++)(e=Sfdc.get(a[c].component,b))&&Sfdc.Dom.show(e)})();(function(a,b){if(a){var e=Sfdc.Dom.hasClass(a,"groupAtMentionsEnabled"),h=Sfdc.Dom.hasClass(a,"chatterTopicsEnabled"),f=Sfdc.Dom.hasClass(a,"hashtagACDisabled"),
t=Sfdc.get("#quickActionRichTextEditor");if(k.config.allowRichText&&t){Sfdc.Dom.hideByDisplay(t);Sfdc.Dom.hideByDisplay(Sfdc.get("#quickActionContainer .publisherTextAreaInner"));var w=Sfdc.Dom.getStyle(Sfdc.get("quickActionContainer"),"zIndex");chatter.getToolbox().addCKEditorAsync(t,{baseFloatZIndex:w,autoGrow_onStartup:!0},function(d){var k=new PublisherCKEditorAutoComplete(a.id,d,"/autocomplete",{},null,e,h,f,c,"");k.setIsOverlay(!0);b(k);d.on("change",function(a){g(chatter.getToolbox().getDataFromCKEditor(d).length)})},
!1)}else{var l=k.config.promptText;l||d&&(l=Sfdc.Dom.getAttribute(d,"data-defaultprompttext"));Sfdc.Dom.set(a,"value",l);Sfdc.on(a,"focus",function(){l===a.value&&(Sfdc.Dom.set(a,"value",""),(Sfdc.userAgent.isIE9||Sfdc.userAgent.isIE10)&&setTimeout(function(){Sfdc.Dom.set(a,"value"," ");Sfdc.Dom.set(a,"value","")}));Sfdc.Dom.addClass(a,"publishertextareafocus")});chatter.getToolbox().expandableTextArea(a,q,P);chatter.getToolbox().initializeIE8JPNTypingFix(a);var r=new PublisherAutoComplete(a.id,"/autocomplete",
{},null,e,h,f,c,"");r.setIsOverlay(!0);b(r);Sfdc.on(a,"keyup",function(){var b=r?r.getInputValueLength():a.value.length;g(b)})}}else b()})(Sfdc.get(".publishertextarea",b),function(c){f(c,a,k);var d=function(c){k.setupPanel(c);k.onShowPanel(function(){p.positionTop()});if(c=Sfdc.get(".quickActionSubmitButton",b))if(Sfdc.isObject(k.config.submitValueAndTitle)){var d=k.config.submitValueAndTitle;Sfdc.Dom.set(c,{value:!d.value||5<d.value.length?d.value:" "+d.value+" ",title:d.title})}else k.isEdit&&
(d=LC.getLabel("Publisher","Save"),Sfdc.Dom.set(c,{value:!d||5<d.length?d:" "+d+" ",title:d}));Sfdc.get(".publishertextarea",b)&&chatter.getToolbox().updateHeight(Sfdc.get(".publishertextarea",b),q,q*P);SfdcCmp.init(Sfdc.get(".postTo"+a))};if(k.isEdit&&a){var e=new LoadingScreen(b,LC.getLabel("Global","loading"));e.show();chatter.getToolbox().get({url:"/feeditems/edit/"+a,success:function(a,b){d(b);p.positionTop();e.hide();setTimeout(function(){k.focusFirstElement()},200)},failure:function(a,b){d(b);
e.hide();b.errors&&Dialogs.showSimpleError("",b.errors.message,null)}})}else d()})}else 50>l&&(l++,setTimeout(r,200))}b={id:"quickActionContainer",title:b.label,url:"/feeditems/quickactions/"+encodeURIComponent(b.apiName)+"/form",width:"564px",extraClass:"zen publishercontainer quickActionContainer",isDialogPositionAbsolute:!0,params:{contextId:a,parentId:c,visibility:d,isEdit:g},onClose:ga};if(p=chatter.createModalOverlay(b))p.register(),p.open();var l=0;setTimeout(r,200)};a.setFeedItemVisibility=
function(a){this.visibility=a};a.getFeedItemVisibility=function(){return this.visibility};a.submitQuickAction=function(a,b,c){var e=chatter.getEventBus(),f=d(a);e.fireEvent("chatter:publisher","onBeforeUpdateStatus");var g=Sfdc.get(".quickActionSubmitButton");g&&(g.disabled=!0);f.config.omnitureEvent&&omnitureWrapper&&omnitureWrapper.trackEvent(chatter.getOmnitureEventMap()[f.config.omnitureEvent]);c=Y(a,b,c,this.visibility);var l=function(a,c){if(f.isEdit){var d={feedItemEl:Sfdc.get("#"+b),feedItemHTML:c.html,
feedItemId:c.feedItemId,summaryDescriptionHTML:c.summaryDescriptionHtml,isExternallyVisible:c.isExternallyVisible,isPostInPendingReview:c.isPostInPendingReview};e.fireEvent("chatter:publisher","onAfterUpdateFeedItem",d);Sfdc.isDefAndNotNull(d.isPostInPendingReview)?Sfdc.Dom.toggleClass(d.feedItemEl,"cxFeedPendingReview",d.isPostInPendingReview):Sfdc.isDefAndNotNull(d.isPostInDraft)&&Sfdc.Dom.toggleClass(d.feedItemEl,"cxFeedDraft",d.isPostInDraft)}else chatter.getPublisher().fireOnAfterUpdateStatusAndQuickActionSuccess({json:c});
if(Sfdc.isFunction(f.onSuccess))f.onSuccess(a,c)},m=function(a,b){if(Sfdc.isFunction(f.onFailure))f.onFailure(a,b)};a=function(a){if(Sfdc.isFunction(f.validatePayload)){var c=f.validatePayload(a);if(!c.isValid){if(Sfdc.isFunction(f.onValidationFailure))f.onValidationFailure(c.errorPayload);return}}Sfdc.isFunction(f.postWithCustomFunction)?f.postWithCustomFunction(a):(c="/feeditems",f.isEdit&&(c+="/"+b+";edit"),n.post({url:c,params:a,failure:m,success:l}))};c=f.getPayload(c,a);f.publisherCore.isRichText()&&
(c.text&&!n.stringIsEmpty(c.text))&&(c.isRichText=!0);Sfdc.isDefAndNotNull(c.isAsync)||a(c)};a.reflow=function(){var a=Sfdc.get("quickActionContainerContent");a&&(Sfdc.Dom.addClass(a,"reflow"),Sfdc.Dom.removeClass(a,"reflow"))};return a};this.wire=function(){SfdcCmp.init(m());var a=$();a&&SfdcCmp.init(a);G={};C={};g.config=g.getConfig();g.listenersWired||(a=chatter.getEventBus(),a.addEventListener("chatter:publisher","onAfterUpdateStatus",function(a,b){m()&&U(a,b)}),a.addEventListener("chatter:feed",
"onAfterMarkAsBest",function(a,b){var d=chatter.getEventBus(),e=b.feedItemEl,f=e.child(".questionTitleAndBody"),h=e.child(".cxfeeditemattachments");f&&(Ext.DomHelper.insertBefore(f,b.feedItemBodyHtml),chatter.getFeed().displayShowMoreAndFadeOut(e.id),chatter.getFeed().displayShowMoreAndFadeOut(e.id," .bestAnswerBody"),f.remove(),h&&(h.remove(),d.fireEvent("chatter:feed","onAuxBodyChange",{json:b})))}),a.addEventListener("chatter:feed","onAfterDeleteFeedComment",function(a,b){W(a,b)}),a.addEventListener("chatter:publisher",
"onAfterUpdateFeedItem",function(a,b){var d=l(b.feedItemEl),e=b.feedItemHTML,f=d.child(".feeditembodyandfooter");Sfdc.Dom.updateHTML(f.dom,e);chatter.getFeed().displayShowMoreAndFadeOut(d.id);chatter.getFeed().displayShowMoreAndFadeOut(d.id," .bestAnswerBody");SfdcCmp.init(f.dom);b.summaryDescriptionHTML&&(d=d.child(".feeditemsummarywrapper"),Sfdc.Dom.updateHTML(d.dom,b.summaryDescriptionHTML));Sfdc.isDefAndNotNull(b.isExternallyVisible)&&Sfdc.Dom.toggleClass(b.feedItemEl,"externallyVisible",b.isExternallyVisible);
chatter.getEventBus().fireEvent("chatter:feed","onAfterEditPostFeedUpdate",{json:b,feedItem:b.feedItemEl})}),g.listenersWired=!0)};this.onFeedLoad=function(){chatter.getFeed().getConfig().isCompactFeed&&chatter.getFeed().expandLastCompactFeedItem();Sfdc.onload(function(){chatter.getEventBus().fireEvent("chatter:publisher","onAfterFeedLoad",{objectId:chatter.getFeed().getConfig().subjectId})})};this.initializeFeedFilterReset=function(){chatter.getFeed().wireFeedSwitchAfterPost(Sfdc.clone(chatter.getFeed().getConfig()),
function(){return"all"!==chatter.getFeed().getConfig().feedfilter})};this.wireFeedSwitchAfterPost=function(a,c){var b=null,d=chatter.getEventBus();d.addEventListener("chatter:publisher","onBeforeUpdateStatus",function(e,f){if(m()&&c()){b=null;var h={};h.params=a;h.feedType=a.feedType;h.onSuccess=function(a,c){b=c;d.fireEvent("chatter:feed","onAfterSwitchFeedRetrieved")};h.onFailure=function(a,b){0!==a.status&&(!b||!b.errormessage)&&Dialogs.showSimpleError("",LC.getLabel("Feeds","GenericFailureNoGack"),
null)};S(h)}});U=function(a,f){if(c())if(b)T(b,f.json);else{var h=function(){d.removeEventListener("chatter:feed","onAfterSwitchFeedRetrieved",h);T(b,f.json)};d.addEventListener("chatter:feed","onAfterSwitchFeedRetrieved",h)}else H(f.json)}};this.getConfig=function(){var a={},c=m();c&&(c=c.getAttribute("data-feed"))&&Sfdc.apply(a,Sfdc.JSON.parse(c),!0);return a};this.getFeedItemData=function(a){var c={};a&&(a=Sfdc.Dom.getAttribute(a,"data-feeditem"))&&Sfdc.apply(c,Sfdc.JSON.parse(a),!0);return c};
this.getAtMentionsData=function(a){if(a&&(a=Sfdc.Dom.getAttribute(a,"data-atmentions")))if(a=Sfdc.JSON.parse(a),Sfdc.isArray(a))return a;return[]};this.lazyLoadRechatDropdown=function(a){G[a]||(G[a]=new CheckedMenu(a,!1))};this.setSearch=function(a){g.search=a};this.setAdditionalPagingParams=function(a){g.pagingParams=a};this.setItemTypeFilter=function(a){g.itemTypeFilter=a};this.isLiveFeed=function(){var a=g.getConfig();return!!g.activePoller&&"NEWS"===a.feedType&&"all"===a.feedfilter};this.getFeedItemData=
function(a){return feedItemData=(a=a.getAttribute("data-feeditem"))?Sfdc.JSON.parse(a):{}};this.setCommentVisibilityHelpLink=function(a){this.commentVisibilityHelpLink||(this.commentVisibilityHelpLink=a)};this.getCommentVisibilityHelpLink=function(){return this.commentVisibilityHelpLink};this.showCommentPlaceholder=function(a){a=Ext.get(a).parent(".feeditemcontent");a.child(".feeditemcommentplaceholder").show();a.child(".cxfeeditemcommentdot").setStyle("display","none");a.child(".feeditemactionlink").setStyle("display",
"none")};this.showCommentBoxViaAnchor=function(a,c){var b=l(a),d=chatter.getToolbox(),e=b.child(".cxnewcommentaction"),f=Sfdc.AccessibleSelectFileDropDownPanel.getSelectFileDropdown(!1,c);f&&(f.source=null);chatter.onDeferLoad(function(){d.show(b.child(".cxnewcomment").addClass("feedArrow"));d.hide(b.child(".cxcommentplaceholder"));e&&d.enableButton(e);var a=b.child(".cxnewcommenttext"),c=l(a).dom;E(a,c);a.dom.style.minHeight=q*B+"px";d.show(b.child(".cxnewcomment").addClass("feedArrow"));chatter.getFeed().addFileDragListenerToComment(b);
a.focus()});return!1};this.showCommentBoxViaPlaceholder=function(a,c){var b=l(a),d=chatter.getToolbox(),e=b.child(".cxnewcommentaction"),f=Sfdc.AccessibleSelectFileDropDownPanel.getSelectFileDropdown(!1,c);f&&(f.source=null);chatter.onDeferLoad(function(){d.hide(b.child(".cxcommentplaceholder"));d.show(b.child(".cxnewcomment").removeClass("feedArrow"));e&&d.enableButton(e);var a=b.child(".cxnewcommenttext"),c=l(a).dom;E(a,c);a.dom.style.minHeight=q*B+"px";d.show(b.child(".cxnewcomment").removeClass("feedArrow"));
chatter.getFeed().addFileDragListenerToComment(b);a.focus()});return!1};this.showCommentBoxForEdit=function(a,c,b){var d=chatter.getToolbox();chatter.onDeferLoad(function(){d.show(a.child(".cxnewcomment").removeClass("feedArrow"));var e=a.child(".cxnewcommenttext");e.dom.id="quickActionFeedBodyInput";var f=E(e,c,!0);e.dom.style.minHeight=5*q+"px";e.addClass("publishertextareafocus");e.focus();e.dom.selectionStart=e.getValue().length;b.setClean(function(){f&&(f.acBox&&f.acBox.div)&&Sfdc.Dom.removeChild(f.acBox.div)})});
return!1};this.addFileDragListenerToComment=function(a){if(!Sfdc.userAgent.isIE&&!Sfdc.userAgent.isSafariIOS)Sfdc.on(a.child(".cxnewcomment").dom,"dragenter",function(c){c&&(c.dataTransfer.types&&-1<chatter.getFeed().getDraggedType("Files",c.dataTransfer.types))&&((c=Sfdc.AccessibleSelectFileDropDownPanel.getSelectFileDropdown())&&"uploadFile"===c.source||chatter.getFeed().createContentComment(a.dom,a.dom.id,!1))})};this.getDraggedType=function(a,c){for(var b=0,d=c.length;b<d;b++)if(c[b]===a)return b;
return-1};this.showCommentBoxViaPlaceholderOnKeyPress=function(a,c){if(c.keyCode==KEY_ENTER)return this.showCommentBoxViaPlaceholder(a)};this.showFirstCommentBoxAtPageLoad=function(){var a=Ext.get(m()).child(".cxfeeditem").child(".cxcomments"),c=a.child(".cxfeedcomment");Ext.onReady(function(){c?g.showCommentBoxViaPlaceholder(a):g.showCommentBoxViaAnchor(a)})};this.hideMoreChanges=function(a){a=l(a);var c=chatter.getToolbox();c.show(a.child(".feedTrackedChangePreambleMessage"));c.hide(a.child(".cxexpandedtext"))};
this.showMoreChanges=function(a){a=l(a);var c=chatter.getToolbox();c.hide(a.child(".feedTrackedChangePreambleMessage"));c.show(a.child(".cxexpandedtext"))};this.addFeedItem=function(a){var c=Ext.get(m()),b=c.child(".cxfeeditem");if(null===b){if(b=c.child(".emptyfeed"))Ext.DomHelper.insertBefore(b,a),b.remove()}else Ext.DomHelper.insertBefore(b,a);SfdcCmp.init(Sfdc.Dom.getFirstChild(m(),".cxfeeditem"));if(b=c.child(".feeditem"))return b.dom};this.commentBoxBlur=function(a,c){var b=l(a),d=chatter.getToolbox(),
e=b.child(".cxnewcommenttext").dom,f=g.getCommentElement(e.id).getValue();chatter.getToolbox().stringIsEmpty(f)&&(!this.getDisableCommentBoxBlur(a)&&!this.getAttachingContent(a)&&!this.hasContentAttached(a)&&!e.hasFocus)&&(d.hide(b.child(".cxnewcomment")),d.show(b.child(".cxcommentplaceholder")))};this.setDisableCommentBoxBlur=function(a,c){R(a,"disableCommentBoxBlur",c)};this.getDisableCommentBoxBlur=function(a){return l(a).child(".cxnewcommenttext").hasClass("disableCommentBoxBlur")};this.setAttachingContent=
function(a,c){R(a,"attachingContent",c)};this.getAttachingContent=function(a){return l(a).child(".cxnewcommenttext").hasClass("attachingContent")};this.hasContentAttached=function(a){return l(a).child(".linkedContentDetailsContainer")?!0:!1};this.contentCommentActionBlur=function(a){this.setDisableCommentBoxBlur(a,!1);a=Sfdc.AccessibleSelectFileDropDownPanel.getSelectFileDropdown();(!a||!a.hasFocus)&&a&&a.close()};this.contentCommentActionFocus=function(a){this.setDisableCommentBoxBlur(a,!0)};this.contentCommentActionMouseDown=
function(a){this.setDisableCommentBoxBlur(a,!0)};this.createContentComment=function(a,c,b,d){this.setDisableCommentBoxBlur(a,!0);a.focus();a=l(a);a=z(a).dom;if(b=Sfdc.AccessibleSelectFileDropDownPanel.getSelectFileDropdown(b))(c=Ext.get(Sfdc.AccessibleSelectFileDropDownPanel.SELECT_FILE_DROPDOWN_ID))&&!c.isStyle("display","none")?b.close():(b.show(a),d||Sfdc.AccessibleSelectFileDropDownPanel.doAction("uploadFile"))};this.showContentCommentLink=function(a){var c=function(){return chatter.getFeed().getFeedItemData(Sfdc.Dom.getParent(a,
".cxfeeditem")).parentid},b="findExistingContentForContentComment"+c();chatter.getFeed().handleLinkedFile=function(c){OverlayDialogElement.getDialog(b).hide();Q(a,c)};chatter.getFeed().handleExternalLinkedFile=function(c,e){OverlayDialogElement.getDialog(b).hide();da(a,c,e)};c=chatter.getPublisher().getHandler("ContentPost").openSelectFilesToAttach(b,!0,c);c.display();c.cancel=function(){IFrameDialog.prototype.cancel.call(this);var b=l(a);z(b).focus()};c.hide=function(){IFrameDialog.prototype.hide.call(this);
chatter.getFeed().setAttachingContent(a,!1)}};this.showContentCommentUpload=function(a){var c=l(a);Sfdc.AccessibleUploadFileDialog.open({successHandler:function(b,d){chatter.getFeed().setAttachingContent(a,!1);var e=Sfdc.AccessibleSelectFileDropDownPanel.getSelectFileDropdown();e&&(e.docId=d.docid);Q(a,d.docid);e=z(c);n.hide(e)},isContentComment:!0,cancelHandler:function(){chatter.getFeed().setAttachingContent(a,!1);z(c).focus()}})};this.removeContentComment=function(a,c){var b=Sfdc.AccessibleSelectFileDropDownPanel.getSelectFileDropdown();
if(c&&b&&"uploadFile"==b.source){b.source=null;var b=b.docId,d=chatter.getToolbox();d.post({url:"/chatterfile/"+b+";delete",id:b,success:function(){},failure:function(a,b){}})}d=l(a);b=z(d);(d=d.child(".linkedContentDetailsContainer"))&&d.remove();d=chatter.getToolbox();d.show(b);b.focus()};this.getCommentElement=function(a){return C[a]};this.removeCommentElement=function(a){C[a]=null};this.newComment=function(a,c,b){var d=l(a),e=chatter.getToolbox(),f=d.child(".cxnewcommenttext").dom;e.disable(f);
var h=d.child(".cxnewcommentaction");e.disableButton(h);var k=g.getCommentElement(f.id),v=k.getInputWithEncodedAtMentions(),w=JSON.stringify(k.getMentionLogEntries()),t=d.child(".cxversionid"),r=d.child(".cxexternaldatasourceid"),m=d.child(".cxexternaldocumentid"),n=d.child(".cxsharedbyreference");if(chatter.getToolbox().stringIsEmpty(v)&&!t&&(!r||!m))e.enable(f),e.enableButton(h);else{var Z;t&&(Z=t.dom.innerHTML);var p,q;r&&m&&(p=r.dom.innerHTML,q=m.dom.innerHTML);e.log("comment submit");var u=chatter.getEventBus(),
A={feeditemid:c,dom:a};u.fireEvent("chatter:publisher","onBeforeComment",A);t=g.getPollToken();omnitureWrapper.trackEvent(chatter.getOmnitureEventMap().postComment);var s;p&&q&&(s=ExternalFileProgressDialog.showOnPostFile("extFileProgress",n?"true"==n.dom.innerHTML:!1));e.post({url:"/feeditems/"+c+"/comments",params:{text:v,pollingToken:t,relatedRecordId:Z,returnCommentExpanded:g.getConfig().alwaysShowFullText,feedItemType:b,externalDataSourceId:p,externalDocumentId:q,feedType:g.getConfig().feedType,
mentionLogging:w},failure:function(a,b){s&&s.hide();b&&(b.errors&&b.errors.comment)&&Dialogs.showSimpleError("",b.errors.comment,null);e.enable(f);e.enableButton(h)},success:function(b,c){s&&s.hide();f.value="";f.style.height="";k.clearAtMentions();e.hide(d.child(".cxnewcomment"));e.enable(f);e.show(d.child(".cxcommentplaceholder"));var h=d.child(".cxcomments");e.show(h);chatter.getTextareaMessageUtil().hideMessage({el:f.id,hideAll:!0});h.createChild(c.html);chatter.getFeed().displayShowMoreAndFadeOut(c.commentId);
L(d,1);A.json=c;var h=Sfdc.select(".cxfeedcomment",h.dom),g=null;0<h.length&&(g=h[h.length-1]);A.element=g;SfdcCmp.init(A.element);u.fireEvent("chatter:publisher","onAfterComment",A);chatter.getFeed().removeContentComment(a,!1)}})}};this.updateComment=function(a,c,b){a=Ext.get(a).findParent("#editComment",50,!0);var d=chatter.getToolbox(),e=a.child(".cxnewcommenttext").dom,f=a.child(".quickActionSubmitButton");a=g.getCommentElement(e.id).getInputWithEncodedAtMentions();var h=l(Sfdc.get("#"+c));chatter.getToolbox().stringIsEmpty(a)||
(d.disable(e),d.disableButton(f),d.log("comment update"),d.post({url:"/feeditems/"+c+"/comments/"+b+";edit",params:{text:a,feedType:g.getConfig().feedType},failure:function(a,b){b&&(b.errors&&b.errors.comment)&&Dialogs.showSimpleError("",b.errors.comment,null);d.enable(e);d.enableButton(f)},success:function(a,c){chatter.getEventBus().fireEvent("chatter:publisher","onAfterUpdateComment",c);Sfdc.isDefAndNotNull(c.isCommentInPendingReview)&&c.isCommentInPendingReview&&W(null,{feedItemEl:h,commentId:b})}}))};
this.IE7ZIndexFeedItemOverflowMenuFix=function(a){var c=Sfdc.Dom.getParent(a,".cxallfeedactions"),b=SfdcCmp.findInstance(c,SfdcCmp.Ui.Dropdown,!0);if(b){var d=Sfdc.Dom.getParent(c,".feeditembodyandfooter");b.attach("onexpand",function(){Sfdc.Dom.addClass(d,"feeditemZIndex")});b.attach("oncollapse",function(){Sfdc.Dom.removeClass(d,"feeditemZIndex")})}a.onclick=null};this.IE7ZIndexCommentOverflowMenuFix=function(a){var c=Sfdc.Dom.getParent(a,".feedcommentactions"),b=SfdcCmp.findInstance(c,SfdcCmp.Ui.Dropdown,
!0);if(b){var d=Sfdc.Dom.getParent(c,".feeditemcomment");b.attach("onexpand",function(){Sfdc.Dom.addClass(d,"feeditemZIndex")});b.attach("oncollapse",function(){Sfdc.Dom.removeClass(d,"feeditemZIndex")})}a.onclick=null};this.checkAccessAndDeleteItem=function(a,c,b){var d=this,e=chatter.getToolbox();e.log("checking access before deleting post with id: "+c);e.get({url:"/feeditems/"+c+"/deleteable",success:function(){d.deleteItem(a,c,b)}})};this.deleteItem=function(a,c,b){var d=g.getFeedItemData(Sfdc.Dom.getParent(a,
".cxfeeditem")),e=d.parentid,f=d.feedItemType,d=u("Feeds","FeedPostDeleteConfirmation",f),h=u("Feeds","FeedConversationDeleteConfirmation",f),f=u("Feeds","FeedPostDeleteNonCreatorMsg",f),d=ca(l(a))?h:d;b||(d=d+"\n\n"+f);Dialogs.showSimpleConfirmation("",d,function(){var b=chatter.getToolbox();b.mask(Ext.fly(a));var d=!1,f=null;0<Ext.query(".contentActionLink",l(a).dom).length&&(d=chatter.getRecentFiles().isWidgetPresent())&&(f=chatter.getRecentFiles().getEntityId());b.post({url:"/feeditems/"+c+";delete",
params:{refreshRecentFiles:d,recentFilesEntityId:f,feedItemParentId:e},failure:function(){b.unmask(Ext.fly(a))},success:function(b,c){g.removeItemElement(a);d&&chatter.getRecentFiles().refresh(c.recentFilesPanelHtml)}});chatter.getEventBus().fireEvent("chatter:feed","onAfterDeleteFeedItem",{el:this})})};this.muteItem=function(a,c){var b=g.getFeedItemData(Sfdc.Dom.getParent(a,".cxfeeditem")).feedItemType,b=u("Feeds","FeedPostHideConfirmation",b),d=LC.getLabel("Feeds","FeedPostUnhideVerb"),e=LC.getLabel("Feeds",
"UnhideTooltip");Dialogs.showSimpleConfirmation("",b,function(){var b=chatter.getToolbox();b.mask(Ext.fly(a));b.post({url:"/feeditems/"+c+"/mute",failure:function(){b.unmask(Ext.fly(a))},success:function(b,f){a.onclick=null;a.onclick=function(){chatter.getFeed().unmuteItem(a,c)};Sfdc.Dom.setText(a,d);Sfdc.Dom.set(a,{title:e});chatter.getFeed().getConfig().isSingleFeedItemMode||g.removeItemElement(a)}});chatter.getEventBus().fireEvent("chatter:feed","onAfterDeleteFeedItem",{el:this})})};this.unmuteItem=
function(a,c){g.getFeedItemData(Sfdc.Dom.getParent(a,".cxfeeditem"));var b=LC.getLabel("Feeds","FeedPostHideVerb"),d=LC.getLabel("Feeds","HideTooltip"),e=chatter.getToolbox();e.mask(Ext.fly(a));e.post({url:"/feeditems/"+c+"/mute;delete",failure:function(){e.unmask(Ext.fly(a))},success:function(e,h){a.onclick=null;a.onclick=function(){chatter.getFeed().muteItem(a,c)};Sfdc.Dom.setText(a,b);Sfdc.Dom.set(a,{title:d});chatter.getFeed().getConfig().isSingleFeedItemMode||g.removeItemElement(a)}});chatter.getEventBus().fireEvent("chatter:feed",
"onAfterDeleteFeedItem",{el:this})};this.removeItemElement=function(a){var c=l(a),b=Ext.get(m());c.remove();n.unmask(Ext.fly(a));b.child(".cxfeeditem")||Ext.DomHelper.append(b,{cls:"emptyfeed",tag:"div",html:LC.getLabel("Feeds","emptyFeed")})};this.checkAccessAndEditComment=function(a,c,b,d){var e=this,f=chatter.getToolbox();f.log("checking access before update comment with id: "+d);f.get({url:"/feeditems/"+b+"/comments/"+d+"/updatable",success:function(){e.editComment(a,c,b,d)}})};this.editComment=
function(a,c,b,d){var e,f={setClean:function(a){this.clean=a},clean:function(){}};c={id:"editComment",height:"564px",title:LC.getLabel("Feeds","EditCommentTitle"),url:"/feeditems/edit/"+b+"/comment/"+d,extraClass:"zen publishercontainer quickActionContainer cxchattertextareacontainer chattertextareacontainer",isDialogPositionAbsolute:!0,onShow:function(){setTimeout(function(){var a=l(Sfdc.get("#"+b)).dom;g.showCommentBoxForEdit(Ext.get("editComment"),a,f)},200)},onClose:function(){if(h){var a=h.background;
a&&Sfdc.Dom.removeChild(a);(a=h.dialog)&&Sfdc.Dom.removeChild(a)}chatter.getEventBus().removeEventListener("chatter:publisher","onAfterUpdateComment",e);f.clean()}};var h=chatter.createModalOverlay(c);h&&(h.register(),h.open(),e=function(b,c){h.closeDialog();V(b,c,a)},chatter.getEventBus().addEventListener("chatter:publisher","onAfterUpdateComment",e))};this.checkAccessAndDeleteComment=function(a,c,b,d){var e=chatter.getToolbox(),f=this,h=l(a).dom.id,g=f.getFeedItemData(Sfdc.Dom.getParent(a,".cxfeeditem")).feedItemType;
e.log("checking access before deleting comment with id: "+b+" from feed item with id "+h);e.get({url:"/feeditems/"+h+"/comments/"+b+"/deleteable",success:function(){f.deleteComment(a,c,g,b,d)}})};this.deleteComment=function(a,c,b,d,e){c=u("Feeds","CommentDeleteConfirmation",b);b=u("Feeds","CommentDeleteNonCreatorMsg",b);e||(c=c+"\n\n"+b);Dialogs.showSimpleConfirmation("",c,function(){var b=chatter.getToolbox(),c=Ext.get(a);b.mask(c);var e=l(a).dom.id;b.log("delete comment with id: "+d+" from feed item with id "+
e);b.post({url:"/feeditems/"+e+"/comments/"+d+";delete",failure:function(){b.unmask(c)},success:function(){var b=l(a);Ext.fly(a).findParent(".cxfeedcomment",50,!0).remove();L(b,-1);M(b);chatter.getEventBus().fireEvent("chatter:feed","onAfterDeleteFeedComment",{feedItemEl:b,commentId:d})}})})};this.likeItem=function(a,c,b){var d=chatter.getToolbox(),e=l(a),f=e.child(".cxlikeitemaction");d.mask(f);d.post({url:"/feeditems/"+c+"/likes",params:{feedItemType:b,feedType:g.getConfig().feedType},success:function(a,
b){d.hide(f);d.show(e.child(".cxunlikeitemaction"));d.unmask(f);d.show(e.child(".cxcomments"));e.child(".cxlikecontainer").dom.innerHTML=b.html;d.show(e.child(".cxlikecontainer"))},failure:function(a,b){d.unmask(f)}})};this.unlikeItem=function(a,c){var b=chatter.getToolbox(),d=l(a),e=d.child(".cxunlikeitemaction");b.mask(e);b.post({url:"/feeditems/"+c+"/likes;delete",success:function(a,c){b.hide(e);var g=d.child(".cxlikeitemaction");g?b.show(g):b.hide(d.child(".cxfeeditemlikedot"));b.unmask(e);d.child(".cxlikecontainer").dom.innerHTML=
c.html;M(d)},failure:function(a,c){b.unmask(e)}})};this.likeComment=function(a,c,b){var d=chatter.getToolbox(),e=s(a),f=e.child(".cxlikecommentaction");d.mask(f);d.post({url:"/feeditems/"+c+"/likes?commentid\x3d"+b,params:{feedType:g.getConfig().feedType},success:function(a,b){d.hide(f);d.show(e.child(".cxunlikecommentaction"));e.child(".cxcommentlikecontainer").dom.innerHTML=b.html;d.show(e.child(".cxcommentlikecontainer"));d.unmask(f)},failure:function(a,b){d.unmask(f)}})};this.unlikeComment=function(a,
c,b){var d=chatter.getToolbox(),e=s(a),f=e.child(".cxunlikecommentaction");d.mask(f);d.post({url:"/feeditems/"+c+"/likes;delete?commentid\x3d"+b,success:function(a,b){d.hide(f);var c=e.child(".cxlikecommentaction");c?d.show(c):d.hide(e.child(".cxcommentlikedot"));e.child(".cxcommentlikecontainer").dom.innerHTML=b.html;d.unmask(f)},failure:function(a,b){d.unmask(f)}})};this.markAsBest=function(a,c,b){var d=chatter.getToolbox(),e=s(a),f=l(a),h=e.child(".cxmarkasbestaction");d.mask(h);d.post({url:"/feeditems/"+
c+"/bestanswer",params:{feedtype:g.getConfig().feedType,commentid:b},success:function(a,b){d.hide(h);var c=f.query(".cxremovebestaction");c&&Ext.each(c,function(a){d.hide(Ext.get(a))});(c=f.query(".bestAnswerHeader"))&&Ext.each(c,function(a){d.hide(Ext.get(a))});(c=f.query(".cxmarkasbestaction"))&&Ext.each(c,function(a){d.show(Ext.get(a))});(c=e.child(".cxremovebestaction"))&&d.show(c);if(c=e.child(".bestAnswerHeader"))c.dom.innerHTML=b.bestAnswerHeaderHtml,d.show(c);chatter.getEventBus().fireEvent("chatter:feed",
"onAfterMarkAsBest",{feedItemEl:f,feedItemBodyHtml:b.feedItemBodyHtml});d.unmask(h);d.hide(h)},failure:function(a,b){d.unmask(h)}})};this.removeAsBest=function(a,c){var b=chatter.getToolbox(),d=s(a),e=d.child(".cxremovebestaction");b.mask(e);var f=l(a);b.post({url:"/feeditems/"+c+"/bestanswer;delete",success:function(a,c){b.hide(e);var g=d.child(".cxmarkasbestaction");g&&b.show(g);(g=d.child(".bestAnswerHeader"))&&b.hide(g);(g=f.child(".QuestionPostAuxBody"))&&b.hide(g);b.unmask(e)},failure:function(a,
c){b.unmask(e)}})};this.bringIntoView=function(a){Sfdc.Dom.removeClass(a,"zen-assistiveText")};this.removeFromView=function(a){Sfdc.Dom.addClass(a,"zen-assistiveText")};this.commentDeleteAddZenAssist=function(a){a=Sfdc.get(".commentDeleteLink",a);n.addZenAssist(a)};this.commentDeleteRemoveZenAssist=function(a){a=Sfdc.get(".commentDeleteLink",a);n.removeZenAssist(a)};this.bookmark=function(a,c){var b=chatter.getToolbox(),d=Sfdc.Dom.getParent(a,".cxallfeedactions"),e=Sfdc.get(".bookmarked",d),f=LC.getLabel("Feeds",
"FeedPostUnbookmarkVerb"),h=LC.getLabel("Feeds","FeedPostUnbookmarkTooltip");b.post({url:"/feeditems/"+c+"/bookmarks",success:function(b,d){Sfdc.Dom.show(e);a.onclick=null;a.onclick=function(){chatter.getFeed().unbookmark(a,c)};Sfdc.Dom.setText(a,f);Sfdc.Dom.set(a,{title:h})},failure:function(a,b){}})};this.unbookmark=function(a,c){var b=chatter.getToolbox(),d=Sfdc.Dom.getParent(a,".cxallfeedactions"),e=Sfdc.get(".bookmarked",d),f=LC.getLabel("Feeds","FeedPostBookmarkVerb"),h=LC.getLabel("Feeds",
"FeedPostBookmarkTooltip");b.post({url:"/feeditems/"+c+"/bookmarks;delete",success:function(b,d){Sfdc.Dom.hideByDisplay(e);a.onclick=null;a.onclick=function(){chatter.getFeed().bookmark(a,c)};Sfdc.Dom.setText(a,f);Sfdc.Dom.set(a,{title:h})},failure:function(a,b){}})};this.approveFeedItem=function(a,c){var b=chatter.getToolbox(),d=chatter.getFeed().getFeedItemData(Sfdc.Dom.getParent(a,".cxfeeditem")),e=d.parentid,f=this.getConfig().feedType,d=d.visibility,h=l(a),g=chatter.getEventBus();b.post({url:"/feeditems/"+
c+"/approve",success:function(a,b){var d={feedItemEl:Sfdc.get("#"+c),feedItemHTML:b.html,feedItemId:b.feedItemId,summaryDescriptionHTML:b.summaryDescriptionHtml,isExternallyVisible:b.isExternallyVisible};h.removeClass("cxFeedPendingReview");g.fireEvent("chatter:publisher","onAfterUpdateFeedItem",d)},failure:function(a,b){},params:{feedType:f,entityId:c,parentId:e,feedItemVisibility:d}})};this.approveComment=function(a,c,b){var d=chatter.getToolbox();s(a);var e=this.getConfig().feedType;d.post({url:"/feeditems/"+
c+"/approve",success:function(b,c){V(null,c,a)},params:{commentid:b,feedType:e,entityId:b,parentId:c}})};this.checkAccessAndEditFeedItem=function(a,c,b,d){var e=this,f=chatter.getToolbox();f.log("checking access before update post with id: "+c);f.get({url:"/feeditems/"+c+"/updatable",success:function(){e.editFeedItem(a,c,b,d)}})};this.editFeedItem=function(a,c,b){var d=chatter.getFeed().getFeedItemData(Sfdc.Dom.getParent(a,".cxfeeditem")),e=d.parentid,f={ContentPost:"TextPost",LinkPost:"TextPost"},
d=d.feedItemType;a={apiName:f[d]?f[d]:d,label:a.innerHTML};chatter.getFeed().getQuickActionPublisher().setFeedItemVisibility(b);chatter.getFeed().getQuickActionPublisher().launchQuickAction(c,a,e,b,!0)};this.changeFeedItemVisibility=function(a,c,b){var d="INTERNAL_USERS"===b?LC.getLabel("CaseInteraction","MakePrivateAlertMessage"):LC.getLabel("CaseInteraction","MakePublicAlertMessage");Dialogs.showSimpleConfirmation("",d,function(){var d=chatter.getFeed().getFeedItemData(Sfdc.Dom.getParent(a,".cxfeeditem")),
d=Y(d.feedItemType,c,d.parentid,b);d.editVisibilityOnly=!0;n.post({url:"/feeditems/"+c+";edit",params:d,failure:function(a,b){b.errors&&Dialogs.showSimpleError("",b.errors.message,null)},success:function(a,b){var d={feedItemEl:Sfdc.get("#"+c),feedItemHTML:b.html,summaryDescriptionHTML:b.summaryDescriptionHtml,isExternallyVisible:b.isExternallyVisible};chatter.getEventBus().fireEvent("chatter:publisher","onAfterUpdateFeedItem",d)}})})};this.invokeActionLink=function(a,c){var b=Sfdc.JSON.parse(a.getAttribute("data-actionlink-json"))||
{},d=function(){"Api"===b.subtype||"ApiAsync"===b.subtype?(n.disable(a),n.post({url:"/"+c+"/actionlinks/"+b.id,success:function(a,d){if(d.unclassifiedGroupHtml)for(var g=Sfdc.get("#"+c+" .feeditemActionMenu .zen-options",m()),g=Sfdc.Dom.getFirstChild(g);g;){var k=Sfdc.Dom.getFirstChild(g),l=!1;k&&(k=Sfdc.JSON.parse(k.getAttribute("data-actionlink-json"))||{},k.actionLinkGroup&&k.actionLinkGroup.id===d.modifiedActionLinkGroupId&&(l=!0));l?(l=g,g=Sfdc.Dom.getNext(g),Sfdc.Dom.removeChild(l)):g=Sfdc.Dom.getNext(g)}X(c,
d);"Api"===b.subtype&&ea(b,c)},failure:function(b,c){n.enable(a);c&&(c.errors&&c.errors.comment)&&Dialogs.showSimpleError("",c.errors.comment,null)}})):"Ui"===b.subtype||"Download"===b.subtype?window.open(b.actionUrl):"QuickAction"===b.type&&chatter.getFeed().getQuickActionPublisher().launchQuickAction(c,b)};b.confirmationMessage?Dialogs.showSimpleConfirmation("",b.confirmationMessage,d):d()};this.getQuickActionPublisher=function(){x||(x=ha());return x};this.displayShowMoreAndFadeOutAllFeed=function(){var a=
document.getElementsByTagName("script");Sfdc.each(a,function(a){a=a.innerHTML.trim();0===a.indexOf("chatter.getFeed().displayShowMoreAndFadeOut")&&eval(a)})};this.displayShowMoreAndFadeOutForElement=function(a){if(a=Sfdc.get(a,document))(a=Sfdc.Dom.getParent(a,".cxfeeditem"))&&this.displayShowMoreAndFadeOut(a.getAttribute("id"))};this.displayShowMoreAndFadeOut=function(a,c){var b="#"+a;c&&(b+=c);(b=Sfdc.get(b+" .cxfeeditemtextwrapper"))&&this.displayShowMoreAndFadeOutForFeedItemElement(a,b)};this.displayShowMoreAndFadeOutForFeedItemElement=
function(a,c){var b=Sfdc.get(".cxfeeditemtextadditional",c);if(b)if(0===b.offsetHeight)this.expandOrCollapseFeedItem(Sfdc.Dom.getParent(b,".cxfeeditemtextwrapper"),!0);else{var d=this.getMaxHeightForFeedItem(a);40<b.scrollHeight-d?this.expandOrCollapseFeedItem(Sfdc.Dom.getParent(b,".cxfeeditemtextwrapper"),!1):this.expandOrCollapseFeedItem(Sfdc.Dom.getParent(b,".cxfeeditemtextwrapper"),!0)}};this.getMaxHeightForFeedItem=function(a){var c=null;0===a.indexOf("0D7")?c=Sfdc.get(".feedcommenttext .feeditemtextadditional",
document):0===a.indexOf("0D5")&&(c=Sfdc.get(".feeditemtextadditional",document));if(!c)return Number.MAX_VALUE;a=Sfdc.Dom.getStyle(c,"maxHeight");a=parseInt(a.substring(0,a.length-2));return isNaN(a)?Number.MAX_VALUE:a};this.toggleFeed=function(a,c){var b=Sfdc.Dom.getParent(a,".cxfeeditemtextwrapper");this.expandOrCollapseFeedItem(b,c);b.setAttribute("tabIndex","0");b.focus();b.addEventListener("blur",function e(a){a.target.removeAttribute("tabIndex");a.target.removeEventListener("blur",e)})};this.expandAttachments=
function(a,c){var b=Sfdc.Dom.getParent(a,".cxfeeditemattachments"),d=Sfdc.get(".hiddenAttachments",b),b=Sfdc.get(".cxmorelink",b);Sfdc.Dom.toggleClass(d,"hidden",!c);Sfdc.Dom.toggleClass(b,"hidden",c)};this.expandOrCollapseFeedItem=function(a,c){var b=Sfdc.get(".cxfeeditemtextadditional",a),d=Sfdc.get(".fadeout",a),e=Sfdc.get(".cxmorelink",a),f=Sfdc.get(".cxlesslink",a),g=Sfdc.get(".sectionBreak",a);c&&Sfdc.userAgent.isIE10&&(Sfdc.Dom.hideByDisplay(b),b.offsetHeight,Sfdc.Dom.show(b));Sfdc.Dom.toggleClass(b,
"feeditemtextadditional",!c);Sfdc.Dom.toggleClass(d,"hidden",c);Sfdc.Dom.toggleClass(e,"hidden",c);Sfdc.Dom.toggleClass(f,"hidden",!c);Sfdc.Dom.toggleClass(g,"hidden",c)};this.expandItem=function(a,c){var b=chatter.getToolbox(),d=Ext.get(a).findParent(".cxmorecontainer",50,!0);b.hide(d.child(".cxmorelink"));b.show(d.child(".cxexpandedcontent"));b.show(d.child(".cxlesslink"))};this.collapseItem=function(a,c){var b=chatter.getToolbox(),d=Ext.get(a).findParent(".cxmorecontainer",50,!0);b.hide(d.child(".cxlesslink"));
b.hide(d.child(".cxexpandedcontent"));b.show(d.child(".cxmorelink"))};this.expandRecordSummaryItem=function(a,c){var b=chatter.getToolbox(),d=Ext.get(a).findParent(".rsmorecontainer",50,!0);b.hide(d.child(".rsmorelink"));b.show(d.child(".rsexpandedcontent"))};this.toggle=function(a,c){var b={};Sfdc.apply(b,Sfdc.JSON.parse(a),!0);var d=chatter.getToolbox(),e=Sfdc.get(".chatterexpando"),f=null!==e,g=f&&Sfdc.Dom.isVisible(e),k=function(){d.log("Started running animation callback.  Hiding: "+g);var a=
Sfdc.get(".hideFeedLink"),c=Sfdc.get(".showFeedLink");g?(Sfdc.Dom.hideByDisplay(a),Sfdc.Dom.show(c),Sfdc.Dom.set(c,{style:{display:"inline-block"}})):(Sfdc.Dom.hideByDisplay(c),Sfdc.Dom.show(a),Sfdc.Dom.set(a,{style:{display:"inline-block"}}),chatter.getEventBus().fireEvent("chatter:feed","onAfterToggleShow",{entityId:b.subjectId}));Sfdc.Dom.setStyle(e,"overflow","visible");e=null};f&&(Sfdc.Dom.setStyle(e,"overflow","hidden"),g?Sfdc.Effects.rollOut(e,k):Sfdc.Effects.rollIn(e,k));d.post({params:{q:"toggleFeed",
id:b.subjectId,feedType:b.feedType,renderFeed:!f,withRecs:c},success:function(a,b){if(!f){var c=Sfdc.get(".chatterfeedshell");Sfdc.Dom.updateHTML(c,b.html,!0);k()}}});return!1};this.onCompactFeedItemClick=function(a,c){g.getConfig().isCompactFeed&&Sfdc.Dom.hasClass(a,"collapsed")&&(Sfdc.Dom.removeClass(a,"collapsed"),chatter.getEventBus().fireEvent("chatter:feed","onAfterExpandedStateChange",{subjectId:g.getConfig().subjectId}),Sfdc.Event.stop(c))};this.onCompactFeedItemPreambleClick=function(a,c){if(g.getConfig().isCompactFeed){var b=
l(a);if(b&&!Sfdc.Dom.hasClass(b.dom,"collapsed")){var d=Sfdc.Event.getEventTarget(c);!Sfdc.Dom.isMatch(d,"a")&&!Sfdc.Dom.getParent(d,"a")&&(Sfdc.Dom.addClass(b.dom,"collapsed"),chatter.getEventBus().fireEvent("chatter:feed","onAfterExpandedStateChange",{subjectId:g.getConfig().subjectId}),Sfdc.Event.stop(c))}}};this.onCompactFeedItemKeyPress=function(a,c){g.getConfig().isCompactFeed&&(Sfdc.Event.isKeyAction(c,Sfdc.Event.keyCode.ENTER)&&a===Sfdc.Event.getEventTarget(c))&&(Sfdc.Dom.toggleClass(a,"collapsed"),
chatter.getEventBus().fireEvent("chatter:feed","onAfterExpandedStateChange",{subjectId:g.getConfig().subjectId}),Sfdc.Event.stop(c))};this.expandLastCompactFeedItem=function(){F(function(a){Sfdc.Dom.removeClass(a,"collapsed")},1)};this.isCompactFeedFullyExpanded=function(){if(!g.getConfig().isCompactFeed)return!1;var a=m();return a&&0==Sfdc.select(".cxfeeditem.collapsed",a).length};this.expandAllCompactFeedItems=function(){var a=new Date;a.setDate(a.getDate()+14);Sfdc.Cookie.setCookie("entityFeedIsExpanded",
"true",a);F(function(a){Sfdc.Dom.removeClass(a,"collapsed")})};this.collapseAllCompactFeedItems=function(){Sfdc.Cookie.deleteCookie("entityFeedIsExpanded");F(function(a){Sfdc.Dom.addClass(a,"collapsed")})};this.expandSearch=function(a){var c=Sfdc.get(".feedSearch"),b=Sfdc.get(".feedSearchTerm");c&&b&&(Sfdc.Dom.addClass(c,"feedSearchOpen"),Sfdc.isDefAndNotNull(a)?(Sfdc.get(".feedSearchForm")&&Sfdc.Dom.set(b,"value",a),Sfdc.Dom.addClass(c,"feedSearchActive")):(Sfdc.Dom.set(b,"value",""),Sfdc.Dom.removeClass(c,
"feedSearchActive")),b.focus())};this.expandSearchAndHideMenu=function(a){this.expandSearch(a);a=y();Sfdc.Dom.addClass(a,"menuhidden")};this.expandSearchAndShowMenu=function(a){this.expandSearch(a);a=y();Sfdc.Dom.removeClass(a,"menuhidden");Sfdc.Dom.addClass(a,"shift")};this.closeSearchBox=function(){var a=m(),c=Sfdc.get(".feedSearch",a),a=Sfdc.get(".feedSearchTerm",a);c&&a&&(a.value="",Sfdc.Dom.removeClass(c,"feedSearchOpen"),c=y(),Sfdc.Dom.removeClass(c,"menuhidden"),Sfdc.Dom.removeClass(c,"shift"))};
this.runSearch=function(a){a&&Sfdc.Event.preventDefault(a);a=Sfdc.get(".feedSearchTerm").value;Sfdc.String.trim(a||"")?(a=O(g.getConfig(),a),g.refresh(a)):g.clearSearch()};this.clearSearch=function(){g.closeSearchBox();if(g.findInFeedType){var a=g.getConfig(),c={isPost:!0,verb:";edit",feedType:g.findInFeedType,isFullRefresh:!1,onSuccess:function(){g.closeSearchBox()}};if("SEARCH"==a.feedType&&g.search)for(var b in g.search)a[b]=chatter.getToolbox().htmlDecode(g.search[b]);var d=g.pagingParams;for(b in d)a[b]=
chatter.getToolbox().htmlDecode(d[b]);c.params=a;g.searchString=null;g.findInFeedType=null;g.refresh(c)}};this.searchAllFeeds=function(a){if(a&&(a=a.getAttribute("data-search-url")))window.location.href=Sfdc.Url.generateUrl(a,{str:Sfdc.String.trim(Sfdc.get(".feedSearchTerm").value||"")},{allowMultipleOfParam:!0})};this.toggleSort=function(a,c,b){b&&Sfdc.Event.preventDefault(b);var d=g.getConfig(),e=chatter.getEventBus(),f={sortByComments:c};e.fireEvent("chatter:FeedSort","onBeforeSortFeed",f);a={isPost:!0,
verb:";edit",feedType:d.feedType,isFullRefresh:!1,onSuccess:function(){if("SEARCH"==d.feedType){g.expandSearch(h.str);var a=y();Sfdc.Dom.addClass(a,"shift")}h.isDropDownFiltersVisible&&((a=Sfdc.get("sortDisplay"))&&Sfdc.Dom.updateHTML(a,h.label),(a=Sfdc.get("filterDisplay"))&&Sfdc.Dom.updateHTML(a,h.label));e.fireEvent("chatter:FeedSort","onAfterSortFeed",f)}};var h=d;h.toggleSort=c;h.showFeedItemsOnly=!0;if(c=Sfdc.get("sortDisplay"))h.label=c.innerHTML;if(c=Sfdc.get("filterDisplay"))h.label=c.innerHTML;
if("SEARCH"==d.feedType&&g.search)for(var k in g.search)h[k]=chatter.getToolbox().htmlDecode(g.search[k]);g.itemTypeFilter&&"ENTITY"==d.feedType&&(h.feedfilter="feeditemtype",h.itemtypefilter=g.itemTypeFilter);c=g.pagingParams;for(k in c)h[k]=chatter.getToolbox().htmlDecode(c[k]);a.params=h;g.refresh(a)};this.showMoreFeedItems=function(a,c){var b=Ext.get(m()),d=b.child(".cxshowmorefeeditemscontainer"),e=chatter.getToolbox(),f=chatter.getEventBus();(new LoadingScreen(d.dom,LC.getLabel("Global","loading"))).show();
var h=Sfdc.select("body");0<d.dom.children.length&&(0<h.length&&document.activeElement==h[0]&&chatter.getAutoShowOlder().isReachedMaxExecutions())&&d.dom.children[0].focus();h=g.getConfig();c.writable=h.writable;var k=g.search,l;for(l in k)l&&(c[l]=e.htmlDecode(k[l]));k=g.pagingParams;for(l in k)l&&(c[l]=e.htmlDecode(k[l]));g.itemTypeFilter&&"ENTITY"==h.feedType&&(c.feedfilter="feeditemtype",c.itemtypefilter=g.itemTypeFilter);"ENTITY"==h.feedType&&(c.itemVisibilityFilter=h.itemVisibilityFilter,c.isCompactFeed=
h.isCompactFeed);if(h.feedfilter&&("NEWS"==h.feedType||"ENTITY"==h.feedType))c.feedfilter=h.feedfilter,c.keyprefix=h.keyprefix;"custom"==h.feedfilter&&"ENTITY"==h.feedType&&(c.customFilterId=h.customFilterId);chatter.getToolbox().get({url:"/feed/"+h.subjectId+"/"+h.feedType,params:c,failure:function(){e.unmask(d);f.fireEvent("chatter:feed","onAfterShowMoreFeedItems",{firstFeedItem:null})},success:function(a,c){var d=b.child(".emptyfeed");null!==d&&d.remove();var g=e.runScriptReturnHtml(c.html,chatter.getYoutubeVideo().fetchVideoPreviews),
d=b.child(".cxshowmorefeeditemscontainer"),h=d.prev(".cxfeeditem"),k=m();Sfdc.Dom.insertHTML(k,g);SfdcCmp.init(k);if(0<d.dom.children.length&&document.activeElement==d.dom.children[0]){g=d.dom.nextSibling;for(k=[];0==k.length&&null!=g;)k=Sfdc.select("a",g),g=g.nextSibling,0<k.length&&k[0].focus()}d.remove();f.fireEvent("chatter:feed","onAfterShowMoreFeedItems",{firstFeedItem:h.next(".cxfeeditem")})}});return!1};this.showMoreComments=function(a,c){var b=l(a);return N(b,c,function(){})};this.showFirstPageOfComments=
function(a,c){var b=l(a);if(1==b.select(".showmorecommentscontainer").elements.length)return N(b,c,function(){b.select(".cxfeedcomment").each(function(a){a.remove()})})};this.applyDropDownFilter=function(a){var c=g.getConfig(),b={feedType:c.feedType,isFullRefresh:!1};b.params={feedfilter:a.filterType,keyprefix:a.keyprefix,showFeedItemsOnly:!0,isDropDownFiltersVisible:!0,subjectId:c.subjectId||UserContext.userId,str:g.searchString,findInFeedType:g.findInFeedType,itemVisibilityFilter:a.itemVisibilityFilter};
b.onSuccess=function(){if(g.searchString){g.expandSearch(g.searchString);var b=y();Sfdc.Dom.addClass(b,"shift")}(b=Sfdc.get("filterDisplay"))&&Sfdc.Dom.updateHTML(b,a.label)};g.refresh(b);omnitureWrapper.trackEvent(function(a){var b=chatter.getOmnitureEventMap().showDropdownFilter+"-"+a.filterType;"record"==a.filterType&&(b+="-"+a.keyprefix);return b}(a))};this.close=function(a,c){chatter.getEventBus();var b=null,d=document.querySelectorAll(".nonFeedSuccess")[0],e=document.querySelectorAll(".nonFeedSuccessMessage")[0];
Sfdc.Dom.setText(e,c.successMessage);Sfdc.Dom.setStyle(d,"display","block");Sfdc.Animation.opacity(d,0,1,{duration:1E3});clearTimeout(b);b=setTimeout(function(){Sfdc.Animation.opacity(d,1,0,{duration:1E3,onComplete:function(){Sfdc.Dom.setStyle(d,"display","none")}});"true"===c.refresh.toLowerCase()&&(c.refreshTarget?c.refreshTarget.refresh(a.params.subjectId,c.refreshPayload):g.refresh(a))},3E3)};this.refresh=function(a){var c=chatter.getEventBus();if("SEARCH"!==a.feedType){var b=Sfdc.get(".feedSearchTerm",
m());if(b){var d=Sfdc.String.trim(b.value||"");d&&(""!=d&&d!=Sfdc.Dom.getAttribute(b,"placeholder"))&&(a=O(a,d))}}var e=Sfdc.clone(a.onSuccess),f=Sfdc.clone(a.onFailure);a.onSuccess=function(a,b){if(!b||!b.html)refreshFailure(a,b);else{c.fireEvent("chatter:feed","onBeforeRemoveFeed");var d=b.html;Sfdc.Dom.updateHTML(D(),d,!0);c.fireEvent("chatter:feed","onAfterFeedRefresh",{json:b});Sfdc.isFunction(e)&&e(b)}};a.onFailure=function(a,b){Sfdc.isFunction(f)&&f();0!==a.status&&(!b||!b.errormessage)&&Dialogs.showSimpleError("",
LC.getLabel("Feeds","GenericFailureNoGack"),null);g.loadingScreen&&g.loadingScreen.hide()};c.fireEvent("chatter:feed","onBeforeRemoveFeed");g.loadingScreen=new LoadingScreen(m(),LC.getLabel("Global","loading"));g.loadingScreen.show();S(a)};this.insertFeedItems=function(a){var c=Ext.get(m());c.select(".cxfeeditem").each(function(a){a.remove()});var b=c.child(".cxshowmorefeeditemscontainer");b&&b.remove();(b=c.child(".emptyfeed"))&&b.remove();(b=c.child(".cxfeedtitle"))?Ext.DomHelper.insertAfter(b,
a):Ext.DomHelper.insertFirst(c,a)};this.showNewUpdates=function(){var a=Ext.get(m()).child(".newFeedItemsMessage");a&&a.remove();g.refresh({feedType:"NEWS",params:{isDropDownFiltersVisible:!0}})};this.getPollToken=function(){var a=null;g.isLiveFeed()&&(a=g.pollToken);return a};this.wireLiveFeed=function(a,c){function b(){chatter.getToolbox().log("PAUSING STATUS POLLER");g.activePoller.stop();l=(new Date).getTime()}function d(a,b){b&&(b.json&&b.json.pollingToken)&&(e(b.json.pollingToken),k&&(b.json.hasNewUpdates?
f(b.json):(chatter.getToolbox().log("UNPAUSING STATUS POLLER"),g.activePoller.start())))}function e(a){chatter.getToolbox().log("UPDATE POLL TOKEN: "+a);g.pollToken=a}function f(a){if(k){chatter.getToolbox().log("SHOWING NEW ITEMS MESSAGE");var c=Ext.get(m());if(!c.child(".newFeedItemsMessage")){var d=c.child(".feeditem");c.createChild(a.liveFeedHtml,d);c.first().fadeIn({endOpacity:1,duration:1.25});Sfdc.Aria.notify(LC.getLabel("Feeds","live_newitems"));chatter.getEventBus().fireEvent("chatter:feed",
"onAfterLiveFeedMessageShown")}b()}else chatter.getToolbox().log("NEW ITEMS MESSAGE NOT SHOWN BECAUSE NOT ALLOWED")}function h(){var a;if(c)a=[[3,100]];else{a=Math.round(30);var d=Math.round(90),h=Math.round(840/d),k=Math.round(300),m=Math.round(2700/k),n=Math.round(3600);a=[[a,2],[d,h],[k,m],[n,-1]]}return{name:"live feed- "+UserContext.userId,callback:function(){var a=(new Date).getTime();chatter.getToolbox().log("POLLING ("+a+")");chatter.getToolbox().get({url:"/feed/"+UserContext.userId+"/news/ismodified",
params:{pollingToken:g.pollToken},success:function(b,c){c.pollingToken&&e(c.pollingToken);c.hasNewUpdates&&(0!=l&&a&&a<l?chatter.getToolbox().log("NEW ITEMS MESSAGE NOT SHOWN BECAUSE gatekeeperTimestamp BLOCKED IT"):(chatter.getToolbox().log("NEW MESSAGE GATEKEEPER PASSED("+l+", "+a+")"),f(c)))},failure:b});return!0},intervals:a}}if(null==g.activePoller){var k=!0,l=0;g.pollToken=a;g.activePoller=chatter.getToolbox().poll(h());var n=chatter.getEventBus();n.addEventListener("chatter:feed","onBeforeRemoveFeed",
b);n.addEventListener("chatter:feed","onAfterFeedRefresh",function(a,b){var c=g.getConfig(),e=!c.feedfilter||"all"===c.feedfilter;k="NEWS"===c.feedType&&e;d(a,b)});n.addEventListener("chatter:feed","onBeforeRechat",b);n.addEventListener("chatter:publisher","onBeforeUpdateStatus",b);n.addEventListener("chatter:feed","onAfterNewPostFeedUpdate",d);n.addEventListener("chatter:publisher","onBeforeComment",function(){g.getConfig().sortByComments&&b()});n.addEventListener("chatter:publisher","onAfterComment",
function(a,b){g.getConfig().sortByComments&&d(a,b)})}};this.removeCaseCommentFromPortal=function(a,c,b,d){var e=chatter.getToolbox();l(a);d=d?LC.getLabel("CaseInteraction","ConfirmRemoveCustomerPortalPost"):LC.getLabel("CaseInteraction","ConfirmRemovePortalPost");Dialogs.showSimpleConfirmation("",d,function(){var d={url:"/caseinteraction/privateanswer/"+b+";edit",params:{removeFromPortal:!0}};"undefined"!=typeof caseInteraction?caseInteraction.getCaseFeed().postRemoveCaseComment(c,d):(d.success=function(b,
c){c.feedItem&&feed.addFeedItem(c.feedItem);g.removeItemElement(a)},e.post(d))})};this.deleteReplyFromCase=function(a,c,b){Dialogs.showSimpleConfirmation("",LC.getLabel("CaseInteraction","ConfirmRemoveCustomerPortalPost"),function(){chatter.getToolbox().post({url:"/caseinteraction/publicanswer/"+b+";delete",params:{replyId:c},success:function(b,c){l(a).remove();n.unmask(Ext.fly(a))}})})}}chatter.getToolbox().getPerfEnabled()&&Perf.mark("Sfdc.ChatterFeed:End");chatter.extend("Feed",Feed,null);
function NavigationGroups(){var b={},g;this.addNavigationGroup=function(c){g=c.associatedGroup;var e=c.id;"null"!=g?(b[g]||(b[g]={}),b[g][e]=new NavigationGroup(c)):b[e]?Sfdc.log("NavigationGroups.addNavigationGroup - the id: "+e+" is already in use."):b[e]=new NavigationGroup(c)};this.getAssociatedGroup=function(c){return b[c]};var l=this.clearSelectedStateInAssociatedGroup=function(c){if(b[c]){var e=b[c].selected;e&&(b[c][e].reset(),b[c].selected=null)}};this.changeNavigationItemState=function(c,
e,g,h){l(c);b[c][e].changeNavigationItemState(g,h)}}
function NavigationGroup(b){function g(a){m=a;e?chatter.getNavigationGroups().clearSelectedStateInAssociatedGroup(e):l();f=a;Sfdc.Dom.addClass(f,"selected");(a=Sfdc.Dom.getParent(f,".subNavSection"))&&Sfdc.Dom.setStyle(a,"display","block");a=Sfdc.get(".trigger",f);Sfdc.Dom.set(a,{title:(""!==a.title?a.title:a.innerHTML)+p});e&&(chatter.getNavigationGroups().getAssociatedGroup(e).selected=b.id);m=null}function l(){if(f){var a=m,d=Sfdc.Dom.getParent(f,"div.subNavSection"),a=a?Sfdc.Dom.getParent(a,"div.subNavSection"):
!1;d&&d!=a&&Sfdc.Dom.setStyle(d,"display","none");Sfdc.Dom.removeClass(f,"selected");d=Sfdc.get(".trigger",f);Sfdc.Dom.set(d,{title:(""!==d.title?d.title:d.innerHTML).replace(p,"")});chatter.getEventBus().fireEvent("chatter:navigation","onAfterLeavingItem",f);f=null}}function c(a){var d=Sfdc.get(".subNavSection .default",a);return d?d:Sfdc.get(".subNavSection .trigger",a)}var e=b.associatedGroup,k=b.id,h=Sfdc.get(k),f,m,q=Sfdc.select(".trigger",h),r=Sfdc.get(".overflow",h),n=Sfdc.get(".showMore",
h),p=LC.getLabel("ChatterNavigation","SelectedTitleExtra");(f=Sfdc.get(".subNavSection li.selected",h))||(f=Sfdc.get("li.selected",h));f&&(chatter.getNavigationGroups().getAssociatedGroup(e).selected=k);for(k=0;k<q.length;k++)Sfdc.on(q[k],"click",function(){var a=Sfdc.Dom.getParent(this,"li");if(Sfdc.Dom.hasClass(a,"hasSubNav")){a=c(a);if(a.onclick)a.onclick();a=Sfdc.Dom.getParent(a,"li")}g(a);"undefined"!=typeof directMessage&&directMessage&&directMessage.removeFixedPosition()});if(n)Sfdc.on(n,"click",
function(){Perf.mark("NavigationGroupShowMoreStart");Sfdc.Dom.show(r);Sfdc.Dom.addClass(r,"opened");Sfdc.Dom.hideByDisplay(n);Perf.endMark("NavigationGroupShowMoreStart")});this.reset=function(){l()};this.selectDefaultItem=function(a){var d=Sfdc.get(".trigger",h),b=Sfdc.Dom.getParent(d,"li");Sfdc.Dom.hasClass(b,"hasSubNav")&&(d=c(b),b=Sfdc.Dom.getParent(d,"li"));if(a&&d.onclick)d.onclick();g(b)};this.changeNavigationItemState=function(a,b){var c=Sfdc.select("li.hasSubNav",h);c.length<=a||(c=Sfdc.select(".subNavSection li",
c[a]),c.length<=b||g(c[b]))};this.getSelectedNavItem=function(){return f}}chatter.extend("NavigationGroups",NavigationGroups,null);
Sfdc.ns("Sfdc.PublisherHandlers");chatter.getToolbox().getPerfEnabled()&&Perf.mark("Sfdc.ChatterPublisher:Start");
function Publisher(){function pa(a,b){ba(b)&&setTimeout(function(){var a=d.destroyRTE(!1,!0);Sfdc.Dom.updateHTML(Sfdc.get("publisherRichTextEditor"),d.getRTEData());d.showRTEAsync(!Q,null,!1,a,{autoGrow_onStartup:!0})},0)}function ba(a){var b=m.getCKEIframeDomEl(a);if(!b.contentDocument)return!0;b=b.contentDocument.body;return a&&a.editable()&&(Sfdc.isEmpty(a.editable().getWindow())||b&&!Sfdc.Dom.getAttribute(b,"contentEditable")&&!Sfdc.Dom.getAttribute(b,"class"))}function qa(a){var b=B-1;return b=
ba(a)?window.getComputedStyle(m.getCKEIframeDomEl(a)).height:a.editable().getWindow().$.innerHeight}function ra(a){a="";Sfdc.get(".chattertextareahaserror #cke_publisherRichTextEditor")&&(a="#fce8e8");return a}function n(){return p[k.actionId].config.allowRichText&&s?s:C}function ca(a,b){if("true"===Sfdc.Dom.getAttribute(a,"lazyInit")){var c=Sfdc.String.trim(a.innerHTML).slice(4,-3);a.setAttribute("lazyInit","");Sfdc.Dom.updateHTML(a,c,!0,b)}else b()}function da(a){try{a.onShowPanel()}catch(b){Sfdc.error(b)}}
function ea(a){var b=d.getHandler(a);if(!fa[a]&&Sfdc.isFunction(b.setupPanel))try{b.setupPanel(),fa[a]=!0}catch(c){Sfdc.error(c)}}function ga(a){var b=d.getHandler(k.actionId);a=window.event||a;!(a.shiftKey&&9==a.keyCode)&&(9===a.keyCode&&!b.focusFirstElement())&&(a.preventDefault?a.preventDefault():a.returnValue=!1)}function D(){v||chatter.getToolbox().updateHeight(h,J,J*R)}function ha(){v&&(v=!1);"TextPost"==t.actionId&&S()&&Sfdc.Dom.hasClass(f,"defaultState")&&(Sfdc.Dom.removeClass(f,"defaultState"),
D())}function ia(){return{subjectId:null,entityType:null,isPrivateGroup:!1,isExternalGroup:!1}}function S(){var a=f.getAttribute("data-publisher");return a?Sfdc.JSON.parse(a).useDefaultState:!0}function sa(){var a=f.getAttribute("data-publisher");return a?Sfdc.JSON.parse(a).useEnhancedKeyboardNavigation:!0}function T(){var a=h;a.value=x();a.title=x();Sfdc.Dom.removeClass(a,"publishertextareafocus");D();K(!1)}function ja(a){var b=Sfdc.get(".publisherFeedItemTypeChoices",f),c=Sfdc.get(".withArrowAttached",
b);Sfdc.Dom.removeClass(c,"withArrowAttached");a=Sfdc.get(a,b);Sfdc.Dom.getParent(a,".publisherTypeOverflow")?Sfdc.Dom.addClass(Sfdc.Dom.getParent(a,".publisherTypeOverflow"),"withArrowAttached"):Sfdc.Dom.addClass(a,"withArrowAttached")}function x(){var a=p[k.actionId];if(a&&Sfdc.isString(a.config.promptText))return a.config.promptText;U||(U=Ext.fly("publisherprompttext").getValue());return U}function ka(){var a=q||Sfdc.get("publishersharebutton"),b;a:{b=p[k.actionId];if(Sfdc.isObject(b.config.submitValueAndTitle)&&
(b=b.config.submitValueAndTitle,b.value&&b.title&&Sfdc.isString(b.value)&&Sfdc.isString(b.title)))break a;b=!1}b?Sfdc.Dom.set(a,{value:b.value,title:b.title}):(b=LC.getLabel("Publisher","Share"),Sfdc.Dom.set(a,{value:b,title:b}))}function ta(a,b){if(a){var c=Sfdc.get(".publisherTypeOverflow .zen-trigger",f),d=null!=Sfdc.Dom.getParent(a,".publisherTypeOverflow");if(c){var e=Sfdc.get(".publisherTypeOverflowSelected",c);if(e){var g=Sfdc.get(".publisherattachtext",e);if(g)if(Sfdc.each(g.childNodes,function(a){3==
a.nodeType&&g.removeChild(a)}),d){if(Sfdc.Dom.removeClass(e,"hidden"),d=Sfdc.get(".publisherFeedItemTypeChoice.publisherattach"+b,f),d=Sfdc.Dom.getText(d))g.appendChild(document.createTextNode(d)),Sfdc.Dom.set(c,{title:d})}else Sfdc.Dom.addClass(e,"hidden"),Sfdc.Dom.set(c,{title:LC.getLabel("Publisher","OverflowMenuTitle")})}}}}function ua(){var a=h;d.isPromptText(a.value)&&(a.value="",Ext.isSafari&&a.focus());Sfdc.Dom.addClass(h,"publishertextareafocus");Sfdc.Dom.addClass(f,"publisheronfocus");la=
Sfdc.Dom.get(h,"title");Sfdc.Dom.set(h,"title","");ha();a=d.getCurrentActionId();d.getHandler(a).config.allowRichText&&d.showRTEAsync(!1,null,!0)}function ma(){d.isTextBoxEmpty()&&T()}function L(){var a;a=(a=n())?a.getInputValueLength():h.value.length;a=a>V;var b=n().isNoticeDisplayed("PublisherMaxLengthErrorMsg"),c=q.disabled;a&&!c&&d.disableShareButton();a!=b?(b=LC.getLabel("Publisher","PublisherMaxLengthErrorMsg"),a?(K(!0),n().showNotice("PublisherMaxLengthErrorMsg",b,1)):n().hideNotice("PublisherMaxLengthErrorMsg")||
K(!1)):a&&b&&K(!0)}function K(a){E!==a&&((E=a)?d.disableShareButton():d.enableShareButtonIfValid())}function va(){for(var a=0;a<F.length;a++){var b=F[a];w.removeEventListener(b.namespace,b.eventname,b.listener)}F=[]}function wa(){for(var a=y.widgetsToAdd,b=0;b<a.length;b++){var c=a[b];if(Sfdc.isFunction(c.wire))try{c.wire()}catch(d){Sfdc.error(d)}y.currentWidgets[c.widgetName]=c}y.widgetsToAdd=[]}function na(){var a=Sfdc.get(".activeTemplate",r),b=Sfdc.get("."+k.actionId,r);Sfdc.Dom.hideByVisibility(r);
Sfdc.Dom.removeClass(a,"activeTemplate");Sfdc.Dom.addClass(b,"activeTemplate");if(!M){var a=Sfdc.get("publisherTextArea",r),c=Sfdc.get("publisherBottomBar",r),d=Sfdc.get("publisherPostToElement",c),e=Sfdc.get("publisherVisibilityWidget",c),g=Sfdc.get("publishersharebutton",c);M=[{className:"publisherTextAreaPlaceholder",element:a},{className:"publisherBottomBarPlaceholder",element:c},{className:"publisherPostToElementPlaceholder",element:d},{className:"publisherVisibilityWidgetPlaceholder",element:e},
{className:"publisherShareButtonPlaceholder",element:g}]}a=M;for(c=0;c<a.length;c++)if(d=a[c],e=Sfdc.get("."+d.className,b))e.appendChild(d.element),Sfdc.Dom.hasClass(d.element,"hideElement")&&Sfdc.Dom.removeClass(d.element,"hideElement");Sfdc.Dom.show(r)}var xa={TextPost:"createTextPostHandler",QuestionPost:"createQuestionPostHandler"},d=this,t={actionId:"",actionType:""},k={actionId:"",actionType:""},m=chatter.getToolbox(),w=chatter.getEventBus(),U,la,p={},fa={},F=[],y={widgetsToAdd:[],currentWidgets:{}},
C=null,s=null,W,X,Y,V,J,R,v,z,E,N,Z,u,O,$,P,aa,M=null,h=null,f=null,r=null,q=null,G=null,A=[],H=!1,B=85,I={height:B,bgColor:""},Q=!1,oa="";this.DEFAULT_MAX_BODY_LENGTH=1E4;this.FEEDITEM_VISIBILITY_INTERNAL_USERS="INTERNAL_USERS";this.FEEDITEM_VISIBILITY_ALL_USERS="ALL_USERS";this.getSubjectId=function(){return d.getSubject().subjectId};this.getRawBody=function(){return n().getInputWithEncodedAtMentions()};this.isRichText=function(){return n().isRichText()};this.getTextArea=function(){return h};this.getTextAreaWidget=
function(){return n()};this.getRTEData=function(){return oa};this.setRTEData=function(a){oa=a};this.isPromptText=function(a){return a==x()};this.addTopicId=function(a){null!=a&&""!=a&&A.push(a)};this.removeTopicIds=function(a){a=A.lastIndexOf(a);-1<a&&(A=A.splice(a,1))};this.getTopicIds=function(){return A};this.clearTopicIds=function(){A=[]};this.wire=function(a,b){ca(Sfdc.get(".publishercontainer .publisherWrapper ."+a),function(){d.wireDefaultPublisher(a,b)})};this.wireDefaultPublisher=function(a,
b){m.log("publisher core wiring started");var c=m.now();va();y.currentWidgets={};E=!1;Z=N=!0;v="TextPost"===a;u=null;isInternalOnly=aa=P=$=O=!1;d.setDefaultAction(a,b);k.actionId=a||b;k.actionType=b;M=null;h=Sfdc.get("publishereditablearea");f=Sfdc.Dom.getParent(h,".publishercontainer");Sfdc.get(".publisherTextAreaContainer",f);r=Sfdc.Dom.getParent(h,".publisherWrapper");q=Sfdc.get("publishersharebutton");wa();SfdcCmp.init(f);var l=k.actionId,e=d.getHandler(l);e&&(na(),ea(l),ja("publisherAttach"+
k.actionId),Sfdc.on(h,"blur",function(){Sfdc.Dom.set(h,"title",la)}),h.value=x(),z=d.getSubject(),W=Sfdc.Dom.hasClass(h,"groupAtMentionsEnabled"),X=Sfdc.Dom.hasClass(h,"chatterTopicsEnabled"),Y=Sfdc.Dom.hasClass(h,"hashtagACDisabled"),chatter.onDeferLoad(function(){Sfdc.on(h,"focus",ua);chatter.getToolbox().initializeIE8JPNTypingFix(h);C=new PublisherAutoComplete("publishereditablearea","/autocomplete",{},null,W,X,Y,z.subjectId,z.entityType,u)}),Sfdc.on(h,"drop",ma),J=16,R=e.config.defaultTextAreaLines||
3,D(),Sfdc.on(h,Sfdc.userAgent.isIE8||Sfdc.userAgent.isIE7?"keyup":"input",D),V=d.DEFAULT_MAX_BODY_LENGTH,Sfdc.on(h,"keyup",L),Sfdc.on(h,"blur",ma),m.log("publisher core wiring finished in "+(m.now()-c)+"ms"),Sfdc.userAgent.isIE7&&(Sfdc.on(q,"mouseover",function(){Sfdc.Dom.addClass(q,"onHover")}),Sfdc.on(q,"mouseout",function(){Sfdc.Dom.removeClass(q,"onHover")})),ka(),da(e))};this.submit=function(){var a=chatter.getEventBus(),b=p[k.actionId];m.log("publisher submit");d.disablePublisher();a.fireEvent("chatter:publisher",
"onBeforeUpdateStatus");b.config.omnitureEvent&&omnitureWrapper.trackEvent(chatter.getOmnitureEventMap()[b.config.omnitureEvent]);a=f.getAttribute("data-topics");d.addTopicId(a);var a={feedItemType:k.actionId,entityId:d.getSubjectId(),feedItemVisibility:u,topicIds:d.getTopicIds(),mentionLogging:JSON.stringify(n().getMentionLogEntries())},c=chatter.getFeed();if(c){var l=c.getConfig();l&&(l.feedType&&(a.feedType=l.feedType),l.isCompactFeed&&(a.isCompactFeed=l.isCompactFeed));if(c=c.getPollToken())a.pollingToken=
c}var e=function(a,c){d.fireOnAfterUpdateStatusAndQuickActionSuccess({json:c});Sfdc.isFunction(b.onSuccess)&&(d.destroyRTE(!0),b.onSuccess(a,c),Sfdc.isFunction(b.clearPanelState)&&b.clearPanelState());d.switchToDefaultPublisherType()},g=function(a,c){if(Sfdc.isFunction(b.onFailure))b.onFailure(a,c)},c=function(a){if(Sfdc.isFunction(b.validatePayload)){var c=b.validatePayload(a);if(!c.isValid){if(Sfdc.isFunction(b.onValidationFailure))b.onValidationFailure(c.errorPayload);return}}Sfdc.isFunction(b.postWithCustomFunction)?
b.postWithCustomFunction(a):m.post({url:"/feeditems",params:a,failure:g,success:e})},a=b.getPayload(a,c);d.isRichText()&&(a.text&&!m.stringIsEmpty(a.text))&&(a.isRichText=!0);Sfdc.isDefAndNotNull(a.isAsync)||c(a)};this.getPublisherContainer=function(){return f};this.isPublisherPresent=function(){return!!Sfdc.get("publishereditablearea")};this.show=function(){Sfdc.Dom.show(f)};this.hide=function(){Sfdc.Dom.hideByDisplay(f)};this.resetPublisher=function(){T();C&&C.clearAtMentions();s&&s.clearAtMentions();
d.clearTopicIds();d.setIsExtensionValidForSubmit(!0)};this.enablePublisher=function(){d.enableShareButtonIfValid();d.enableTextArea(!0)};this.disablePublisher=function(){d.disableShareButton();d.enableTextArea(!1)};this.setIsExtensionValidForSubmit=function(a){(Z=a)?d.enableShareButtonIfValid():d.disableShareButton()};this.enableShareButtonIfValid=function(){var a=Sfdc.get("."+k.actionId,r),b=Z&&N;Sfdc.select(".publishertextarea",a).length&&(b=b&&!E);b&&(q.disabled=!1)};this.disableShareButton=function(){q.disabled=
!0};this.enableTextArea=function(a){this.getTextAreaWidget().toggleEnabled(a)};this.focusOnTextArea=function(){var a=this.getTextAreaWidget();a.focus();!a.isRichText()&&Sfdc.userAgent.isIE&&(h.value=h.value)};this.showErrors=function(a){Dialogs.showSimpleError("",a,null)};this.isTextBoxEmpty=function(){var a=this.getTextAreaWidget().getValue();return m.stringIsEmpty(a)||d.isPromptText(a)};this.restoreDefaultUIState=function(){chatter.getTextareaMessageUtil().hideMessage({el:h.id,hideAll:!0});d.resetPublisher();
d.enablePublisher();v||(v=!0);"TextPost"==t.actionId&&S()&&(Sfdc.Dom.addClass(f,"defaultState"),h.style.height="16px");w.fireEvent("chatter:publisher","onAfterRestoreDefaultUIState");H&&(H=!1)};this.registerFeedItemTypeHandler=function(a,b,c){c=c||{};a=c.handlerId||a;return(!p[a]||c.replace)&&Sfdc.isObject(b)&&Sfdc.isFunction(b.getPayload)&&Sfdc.isFunction(b.onShowPanel)&&Sfdc.isFunction(b.onSuccess)&&Sfdc.isFunction(b.onFailure)&&Sfdc.isObject(b.config)?(b.publisherCore=c.publisherCore||this,p[a]=
b,!0):!1};this.getHandler=function(a){return p[a]};this.registerPlatformActionHandler=function(a){(a=xa[a])&&Sfdc.isFunction(Sfdc.PublisherHandlers[a])&&chatter.getPublisher().registerFeedItemTypeHandler("PlatformActionHandler",Sfdc.PublisherHandlers[a](!0),{publisherCore:{},replace:!0});return p.PlatformActionHandler};this.getCurrentActionId=function(){return k.actionId};this.getCurrentActionType=function(){return k.actionType};this.initializeExtension=function(a,b,c,l){var e=d.getHandler(b);if(e){l=
Sfdc.isBoolean(l)&&l;ea(b);var g=d.getHandler(k.actionId);if(g)try{Sfdc.isFunction(g.removeEventsForPostType)&&g.removeEventsForPostType(),Sfdc.isFunction(g.clearPanelState)&&g.clearPanelState()}catch(h){Sfdc.error(h)}g=C.getValue();g=m.stringIsEmpty(g)||g===x();k.actionId=b;k.actionType=c;g&&T();J=e.config.lineHeight||16;R=e.config.defaultTextAreaLines||3;V=e.config.maxBodyLength||d.DEFAULT_MAX_BODY_LENGTH;b=d.destroyRTE();I.bgColor=b.bgColor;b.height>=B&&(I.height=b.height);b=!1;var f=function(){w.fireEvent("chatter:publisher",
"onOpenTypeSpecificPanel",e)};e.config.allowRichText&&!H&&(b=d.showRTEAsync(!1,function(){L();f()},l,I));na();ja("publisherAttach"+k.actionId);c=Sfdc.get("."+k.actionId,r);!b&&Sfdc.select(".publishertextarea",c).length&&(D(),L());ha();if(sa()){G&&Sfdc.un(G,"keydown",ga);G=a;if(k.actionId!=t.actionId)Sfdc.on(G,"keydown",ga);if(!Sfdc.userAgent.isIE7)try{G.focus()}catch(n){}}ka();da(e);ta(a,k.actionId);b||(f(),l&&Sfdc.isFunction(e.focusFirstElement)&&e.focusFirstElement())}};this.openTypeSpecificPanel=
function(a,b,c,l){var e=c||b;(k.actionId!==e||v)&&ca(Sfdc.get(".publishercontainer .publisherWrapper ."+e),function(){d.initializeExtension(a,e,b,l)})};this.switchToDefaultPublisherType=function(){H||(H=!0);if(S()){var a=Sfdc.get("publisherAttach"+t.actionId,f);d.openTypeSpecificPanel(a,t.actionType,t.actionId)}d.restoreDefaultUIState()};this.hideShowFollowV2Message=function(){chatter.getToolbox().get({url:"/commands/hideFollowV2Message",success:function(){var a=chatter.getPublisher();a.setShowFollowV2Message(!1);
a.getWidget("visibilityWidget").hideVisibilityBox();Sfdc.Dom.removeClass(Sfdc.get("publisherVisibilityIcon"),"active")}})};this.getVisibilityMessages=function(){var a=f.getAttribute("data-topics"),b=[];if($){var c=LC.getLabel("ChatterVisibility","GotIt");b.push({HTML:'\x3cdiv class\x3d"zen-box zen-simple visibilityInfoBox"\x3e\x3cdiv class\x3d"zen-inner"\x3e\x3cdiv class\x3d"zen-body"\x3e\x3cp\x3e\x3ch3 class\x3d"infoMessageTitle"\x3e'+LC.getLabel("ChatterVisibility","New")+'\x3c/h3\x3e\x3cp class\x3d"followV2Message"\x3e'+
LC.getLabel("ChatterVisibility","FollowV2Message","\x3cb\x3e"+c+"\x3c/b\x3e")+'\x3c/p\x3e\x3cbutton  class\x3d"zen-btn" onclick\x3d"chatter.getPublisher().hideShowFollowV2Message()"title\x3d"'+c+'"\x3e'+c+"\x3c/button\x3e\x3c/p\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e"})}b=b.concat(PublisherVisibilityMessages.getVisibilityMessages(d.getSubject(),P,u,O,a));return(c=p[k.actionId])&&Sfdc.isFunction(c.getVisibilityMessages)?b.concat(c.getVisibilityMessages(d.getSubject(),P,u,O,a,aa)):b};this.addEventListener=
function(a,b,c){w.addEventListener(a,b,c);F[F.length]={namespace:a,eventname:b,listener:c}};this.setSubject=function(a){var b=ia();Sfdc.apply(b,a,!0);n().updateParent(a.subjectId,a.entityType);a.subjectId?(N=!0,d.enableShareButtonIfValid()):(N=!1,d.disableShareButton());a.isExternalGroup?Sfdc.Dom.addClass(f,"externalGroup"):Sfdc.Dom.removeClass(f,"externalGroup");if(!a.useDefaultState&&(b=f.getAttribute("data-publisher")))b=Sfdc.JSON.parse(b),a.useDefaultState=b.useDefaultState;f.setAttribute("data-publisher",
Sfdc.JSON.stringify(a));w.fireEvent("chatter:publisher","onAfterUpdateSubject",{subjectId:a.subjectId})};this.setFeedItemVisibility=function(a){u=a;(a=n())&&a.updateFeedItemVisibility(u)};this.setHasUserSharingMessage=function(a){O=a};this.setShowFollowV2Message=function(a){$=a};this.setIsFollowV2Enabled=function(a){P=a};this.setIsFilesUserSharingEnabled=function(a){aa=a};this.setDefaultAction=function(a,b){t.actionId=a;t.actionType=b};this.getHasTextareaErrors=function(){return E};this.getSubject=
function(){var a=f.getAttribute("data-publisher"),b=ia();a&&Sfdc.apply(b,Sfdc.JSON.parse(a),!0);return b};this.getOriginalSubject=function(){return z};this.addWidget=function(a){a.lazyLoad=function(){a.instance||(a.instance=a.get());return a.instance};var b=y.widgetsToAdd;b[b.length]=a};this.getWidget=function(a){var b=y.currentWidgets[a];Sfdc.isDebug&&!b&&Sfdc.log(a+" has not been wired yet.  Either the widget wasn't added with addWidget() or wireWidgets() was not called after it was added.",Sfdc.Logging.LogLevel.ERROR);
return b.lazyLoad()};this.addPostToWidget=function(){var a=chatter.getPublisher();a.addWidget({widgetName:"postToWidget",get:function(){var b=Sfdc.get(".postTo",a.getPublisherContainer()),c=new PostToWidget(b,a.setSubject);a.addEventListener("chatter:publisher","onAfterRestoreDefaultUIState",c.reset);a.addEventListener("chatter:publisher","onOpenTypeSpecificPanel",function(b){b=Sfdc.get(".activeTemplate",a.getPublisherContainer());Sfdc.get(".postTo",b)?d.setSubject(c.getSubject()):d.setSubject(a.getOriginalSubject())});
return c}})};this.addVisibilityWidget=function(a,b,c,d,e){var g=chatter.getPublisher();g.addWidget({widgetName:"visibilityWidget",get:function(){g.setHasUserSharingMessage(b);g.setShowFollowV2Message(d);g.setIsFollowV2Enabled(c);g.setIsFilesUserSharingEnabled(e);var h=Sfdc.Dom.getParent(Sfdc.get("publisherVisibilityIcon")),h=new VisibilityWidget({icon:h,helpUrl:a});h.registerHandler(g.getVisibilityMessages);return h},wire:function(){g.addEventListener("chatter:publisher","onAfterUpdateSubject",function(a,
b){var c=g.getWidget("visibilityWidget");b.subjectId?c.enableWidget():c.disableWidget()})}})};this.addVisibilityDropdownWidget=function(){var a=chatter.getPublisher();a.addWidget({widgetName:"visibilityDropdownWidget",get:function(){a.addEventListener("chatter:publisher","onAfterRestoreDefaultUIState",function(){a.setFeedItemVisibility(a.FEEDITEM_VISIBILITY_INTERNAL_USERS);var b=Sfdc.get(".internalExternalDropdown .zen-select",a.getPublisherContainer());SfdcCmp.getInstance(b).reset()});return{setFeedItemVisibility:function(b){a.setFeedItemVisibility(b)}}},
wire:function(){a.setFeedItemVisibility(a.FEEDITEM_VISIBILITY_INTERNAL_USERS)}})};this.showRTEAsync=function(a,b,c,l,e){var g=Sfdc.get("#richTextEditorContainer"),f=m.getCKEditorInstance("publisherRichTextEditor");if(!g)return!1;var k=function(a){if(s)s.setCKEditor(a);else chatter.onDeferLoad(function(){s=new PublisherCKEditorAutoComplete(h.id,a,"/autocomplete",{},null,W,X,Y,z.subjectId,z.entityType,u)})};if(!f||!Sfdc.get("cke_publisherRichTextEditor")){var n={placeholder:Sfdc.String.escapeToHtml(x())};
if(e)for(var p in e)n[p]=e[p];l&&(l.height&&"100%"!==l.height)&&(n.height=l.height);f=m.addCKEditorAsync(Sfdc.get("#publisherRichTextEditor"),n,function(a){l&&l.bgColor&&f.editable().setStyle("background-color",l.bgColor);k(a);Sfdc.isFunction(b)&&b(a)},a)}if(f){f.on("instanceReady",function(a){m.getCKEIframeDomEl(f).onload=function(b){pa(b,a.editor)}});if(a)return Sfdc.Dom.hideByDisplay(g),!0;Q=!0;Sfdc.Dom.show(g);Sfdc.Dom.addClass(g,"rteContainerMinHeight");Sfdc.Dom.hideByDisplay(Sfdc.get(".publisherTextAreaInner"));
if(c)m.onCkEditorInstanceReady(f,function(){m.focusAtEndOfTextOnCKEditor(f)});f.on("change",function(a){d.setRTEData(s.getValue());L()});f.on("afterPaste",function(a){a=m.getPlainTextData(m.getDataFromCKEditor(a.editor));m.linkDetectionAndPublisherSwitch(a)});return!0}return!1};this.destroyRTE=function(a,b){var c=m.getCKEditorInstance("publisherRichTextEditor"),d=Sfdc.get("publisherRichTextEditor"),e=B-1,g=I.bgColor;if(c){b||(Q=!1);e=qa(c);g=ra(c);Sfdc.Dom.removeClass(Sfdc.get("richTextEditorContainer"),
"rteContainerMinHeight");Sfdc.userAgent.isIE&&Sfdc.get("#richTextPlaceholderInput").focus();if(a)try{setTimeout(function(){c.setData("")},0)}catch(f){}m.destroyCKEditor("publisherRichTextEditor");Sfdc.Dom.show(Sfdc.get(".publisherTextAreaInner"))}a&&d&&(Sfdc.Dom.setText(d,""),I={height:B,bgColor:""});return{height:e,bgColor:g}};this.fireOnAfterUpdateStatusAndQuickActionSuccess=function(a){w.fireEvent("chatter:publisher","onAfterUpdateStatus",a);w.fireEvent("chatter:publisher","onAfterQuickActionSuccess",
a)};if(m.getPerfEnabled()){var ya=this.openTypeSpecificPanel,za=this.submit,Aa=this.registerFeedItemTypeHandler;this.openTypeSpecificPanel=function(a,b,c){Perf.mark("openTypeSpecificPanel: "+b);ya.call(this,a,b,c);Perf.endMark("openTypeSpecificPanel: "+b)};this.submit=function(){Perf.mark("Publisher: submit");za.call()};this.registerFeedItemTypeHandler=function(a,b,c){if(a=Aa.call(this,a,b,c)){var d=b.onSuccess,e=b.onFailure;b.onSuccess=function(a,c){d.call(b,a,c);Perf.endMark("Publisher: submit")};
b.onFailure=function(a,c){e.call(b,a,c);Perf.endMark("Publisher: submit")}}return a}}}chatter.getToolbox().getPerfEnabled()&&Perf.mark("Sfdc.ChatterPublisher:End");chatter.extend("Publisher",Publisher,null);
chatter.getToolbox().getPerfEnabled()&&Perf.mark("Sfdc.ChatterTabUtil:Start");
function ChatterTab(){function n(a,b,c,d){x();var e="get";d.isPost&&(e="post");chatter.getEventBus().fireEvent("chatter:feed","onBeforeRemoveFeed");(null!=d.params.showRefreshStatus?d.params.showRefreshStatus:1)&&C(a);var y=function(a,c){if(d.onFailure)d.onFailure(c);0!==a.status&&(!c||!c.errormessage)&&Dialogs.showSimpleError("",LC.getLabel("Feeds","GenericFailureNoGack"),null);if(b)for(var e=0;e<b.length;e++)Sfdc.Dom.updateHTML(b[e].pane.dom,b[e].html,!0);x()},G={url:d.url,params:d.params,success:function(b,
e){if(Sfdc.isFunction(c)&&!c(e))y(b,e);else{Sfdc.Dom.updateHTML(f().dom,"",!1);Sfdc.Dom.updateHTML(k().dom,"",!1);Sfdc.Dom.updateHTML(h().dom,"",!1);d.params.showDefaultRightPane&&D();for(var g=0;g<a.length;g++)Sfdc.Dom.updateHTML(a[g].pane.dom,e[a[g].responseHTMLKey],!0);if(d.onSuccess)d.onSuccess(b,e);e.showVideoLink&&"true"==e.showVideoLink?(e.videoLinkUrl&&(g=e.videoLinkUrl,Ext.select("a.videoLinkElement").set({href:g})),chatter.getToolbox().show(Ext.select("a.videoLinkElement"))):E();defaultHelpLinkUrl&&
(e.helpLinkUrl?z(e.helpLinkUrl):F());chatter.getEventBus().fireEvent("chatter:navigation","onAfterHtmlUpdate")}},failure:y,abortTargets:["feedRefresh","chatterTabRefresh"],ajaxInstanceKey:["chatterTabRefresh"]};chatter.getToolbox()[e](G)}function x(){for(var a=0;a<l.length;a++)l[a].hide();l=[]}function C(a){for(var b=0;b<a.length;b++){var c=new LoadingScreen(a[b].pane.dom,LC.getLabel("Global","loading"));c.show();l.push(c)}}function p(a){switch(a){case "middle":return q||(q=Ext.get("centerContent")),
q;case "right":return r||(r=Ext.get("rightContent")),r;case "whole":return s||(s=Ext.get("wholeContent")),s;default:Dialogs.showSimpleError("","unknown pane type",null)}}function H(a,b){switch(a){case "ListViews":return chatter.getOmnitureEventMap().showListView+"-"+b.type+"-"+b.filter;default:var c="",d;for(d in b)c+=d+"\x3d"+b[d]+"\x26";return a+"?"+c}}var l=[],r,q,s,t,u={},v=null,I=this.refreshMiddlePane=function(a){m();var b=h(),b=w([b]),c=[{pane:k(),responseHTMLKey:"html"}];a.params.showDefaultRightPane=
!0;n(c,b,function(a){return a&&a.html},a)},J=this.refreshWholePane=function(a){m();var b=k(),c=f(),d=h(),b=w([b,c]);n([{pane:d,responseHTMLKey:"html"}],b,function(a){return a&&a.html},a)},K=this.refreshBothPanes=function(a){m();var b=k(),c=f(),d=h(),d=w([d]);n([{pane:b,responseHTMLKey:"middlePaneHtml"},{pane:c,responseHTMLKey:"rightPaneHtml"}],d,function(a){return a&&a.middlePaneHtml&&Sfdc.isString(a.rightPaneHtml)},a)},F=this.revertToDefaultHelpLinkUrl=function(){z(defaultHelpLinkUrl)},A={};this.isOnChatterTab=
function(){return null!==Ext.get("chatterTab")};this.handleMainFeedFiltersClick=function(){m();Sfdc.Dom.updateHTML(h().dom,"",!1)};this.setDefaultHelpLinkUrl=function(a){defaultHelpLinkUrl=a};this.getHelpLinkHref=function(a){return(a=A[a])?a:null};this.setHelpLinkHref=function(a,b){A[a]=b};var k=this.getMiddlePane=function(){return p("middle")},f=this.getRightPane=function(){return p("right")},h=this.getWholePane=function(){return p("whole")};this.handleListViewSearch=function(a){var b=Sfdc.select("#chatterListViewContainer h2 span.text")[0];
switch(a){case "groups":a=!1;var c=Sfdc.get("#mainNavigation .ftr_recent");c&&(a=Sfdc.Dom.hasClass(c.parentNode,"selected"));if(a){if(Sfdc.get("#mainNavigation .ftr_all")){Sfdc.Dom.setText(b,LC.getLabel("ChatterGroups","groupFilter_all"));chatter.getNavigationGroups().changeNavigationItemState("chatterTabNavigation","mainNavigation",2,2);break}if(Sfdc.get("#mainNavigation .ftr_my")){Sfdc.Dom.setText(b,LC.getLabel("ChatterGroups","groupFilter_my"));chatter.getNavigationGroups().changeNavigationItemState("chatterTabNavigation",
"mainNavigation",2,0);break}}break;default:Sfdc.log(a+" not supported")}};this.initializeFeedTypeList=function(){chatter.getFeed().wireFeedSwitchAfterPost({feedType:"NEWS",isDropDownFiltersVisible:!0},function(){var a=chatter.getFeed().getConfig();return"NEWS"!==a.feedType||"all"!==a.feedfilter});chatter.getEventBus().addEventListener("chatter:feed","onAfterNewPostFeedUpdate",function(){B().selectDefaultItem()})};this.registerRefreshTypeHandler=function(a,b){u[a]?Sfdc.error(a+" refresh handler has already been implemented"):
u[a]=b};this.refresh=function(a,b){omnitureWrapper.trackEvent(H(a,b));var c=u[a],d={isPost:!1};if(!c||!c.getRefreshTarget||!c.getEndPoint)Dialogs.showSimpleError("","handler "+a+" is not implemented properly.",null);else{var e=c.getRefreshTarget(b),f={};d.url=c.getEndPoint(b);c.getAjaxParams&&(f=c.getAjaxParams(b));d.params=f;c.getAjaxMethod&&(d.isPost="post"===c.getAjaxMethod());d.onSuccess=function(a,b){if(c.onSuccess)try{c.onSuccess(a,b)}catch(d){Sfdc.error(d)}};d.onFailure=function(a,b){if(c.onFailure)try{c.onFailure(a,
b)}catch(d){Sfdc.error(d)}};switch(e){case "middle":I(d);break;case "both":K(d);break;case "whole":J(d);break;case "feed":d.feedType=d.params.feedType;chatter.getFeed().refresh(d);break;default:Dialogs.showSimpleError("","refreshTarget: "+e+" not supported",null)}}};this.isDefaultFeedSelected=function(){var a=B();if(!a)return!1;a=a.getSelectedNavItem();return!!Sfdc.get(".trigger.NEWS",a)};var D=this.showDefaultRightContent=function(){if(t){var a=t;Sfdc.Dom.updateHTML(f().dom,a,!0)}else chatter.getToolbox().get({url:"/chattertab/rightContent",
success:function(a,c){Sfdc.Dom.updateHTML(f().dom,c.html,!0)}})},m=this.cacheDefaultRightContent=function(){var a=f().select(".defaultRightContentDiv").item(0);a&&(t=a.dom.innerHTML)},w=function(a){var b=[];if(Sfdc.isArray(a))for(var c=0;c<a.length;c++)b[c]={pane:a[c],html:a[c].dom.innerHTML},Sfdc.Dom.updateHTML(a[c].dom,"",!1);return b},z=function(a){Ext.select("a.helpLinkElement").set({href:a})},E=this.hideVideoLink=function(){chatter.getToolbox().hide(Ext.select("a.videoLinkElement"))},B=function(){return chatter.getNavigationGroups().getAssociatedGroup("chatterTabNavigation").mainNavigation};
this.customFilterRefresh=function(a,b){var c=this;v=null;v={refresh:function(d){d&&(b.customFilterParams=Sfdc.JSON.stringify(d));c.refresh(a,b)}};this.refresh(a,b)};this.currentCustomFilter=function(){return v}}chatter.getToolbox().getPerfEnabled()&&Perf.mark("Sfdc.ChatterTabUtil:End","Sfdc.ChatterTabUtil:Start");chatter.extend("ChatterTab",ChatterTab,null);
chatter.getChatterTab().registerRefreshTypeHandler("CanvasApps",function(){return{getAjaxParams:function(a){return{showRefreshStatus:!1}},getEndPoint:function(a){return"/canvas?canvas\x3d"+a.canvas+(a.namespace?"\x26namespace\x3d"+a.namespace:"")},getRefreshTarget:function(a){return"whole"},onSuccess:function(a,b){if(Sfdc.canvas){var d=Sfdc.get("canvas-iframe"),e=Sfdc.JSON.parse(b.application),c=Sfdc.JSON.parse(b.xorSessionResult);Sfdc.canvas.parent.render({app:e,login:b.loginUrl,version:b.version,
sid:Sfdc.String.decryptXOR(c.maskedSid,c.mask)},d,function(){var a={displayLocation:"Chatter"};UserContext.siteUrlPrefix&&(a.customPathPrefix=UserContext.siteUrlPrefix);return a}())}},onFailure:function(a,b){}}}());
chatter.getChatterTab().registerRefreshTypeHandler("DirectMessages",function(){return{getEndPoint:function(a){return"/directmessages/"},getRefreshTarget:function(a){return"both"},onSuccess:function(a,b){HelpBubble.hideBubble();directMessage.renderInboxOnSuccess(b)}}}());
chatter.getChatterTab().registerRefreshTypeHandler("FeedFavorites",function(){return{getEndPoint:function(a){return"/feed/favorites/"+a.feedFavoriteId},getAjaxParams:function(a){return{feedFavoriteId:a.feedFavoriteId,type:a.type,str:a.str,filterId:a.filterId,topicId:a.topicId,isPost:!0}},getAjaxMethod:function(a){return"post"},onSuccess:function(a,b){chatter.getEventBus().fireEvent("chatter:feed","onAfterFeedRefresh",{json:b})},getRefreshTarget:function(a){return"middle"}}}());
chatter.getChatterTab().registerRefreshTypeHandler("FeedTypes",function(){return{getEndPoint:function(a){return"/feed/"+UserContext.userId+"/"+a.type},getAjaxParams:function(a){var b="NEWS"===a.type;return{feedType:a.type,showFeedItemsOnly:chatter.getPublisher().isPublisherPresent(),isDropDownFiltersVisible:b}},getRefreshTarget:function(a){return chatter.getPublisher().isPublisherPresent()?"feed":"middle"},onSuccess:function(a,b){chatter.getEventBus().fireEvent("chatter:feed","onAfterFeedRefresh",
{json:b})}}}());
function ChatterTabGuidedTour(){var c=LC.getLabel("ChatterTab","GuidedTourSortByText"),b=LC.getLabel("ChatterTab","LearnMoreLink"),b="\x3ca class\x3d'chattertabguidedtour' href\x3d\""+chatter.getChatterTab().getHelpLinkHref("SortByHelpDoc")+'"\x3e'+b+"\x3c/a\x3e",c=c+"\x3cbr\x3e\x3cbr\x3e"+b,e={locator:".feedcontainer .feedSortMenuContainer",position:"tr-b",useArrow:!0,offsets:[15,-3],arrowOffset:-60,width:350,title:LC.getLabel("ChatterTab","GuidedTourSortByTitle"),content:c,countStep:!0,toolbarItems:[{xtype:"tbfill"}]};
this.startGuidedTour=function(c){var b=new Sfdc.GuidedTour({steps:[e]});b.closeForeverHandler=function(){var a;a:{for(a=this.currentStepNum;a<this.steps.length-1;)if(a+=1,this.shouldShowTheStep(this.steps[a])){a=!0;break a}a=!1}a?this.nextStepHandler():(UserContext.userPreferences.setBoolean("ShowChatterTab178GuidedTour",!1),Sfdc.GuidedTour.prototype.closeForeverHandler.call(this))};var d=chatter.getEventBus();d.addEventListener("chatter:feed","onBeforeRemoveFeed",function(){d.removeEventListener("chatter:feed",
"onBeforeRemoveFeed",arguments.callee);b.showLaterHandler()});b.start()}}chatter.extend("ChatterTabGuidedTour",ChatterTabGuidedTour,null);
chatter.getChatterTab().registerRefreshTypeHandler("ListViews",function(){return{getEndPoint:function(a){return"/listview/"+a.type},getAjaxParams:function(a){return{type:a.type,filter:a.filter,fldr:a.fldr,linkDesc:a.linkDesc,customFilterParams:a.customFilterParams,isSearchSupported:a.isSearchSupported}},getRefreshTarget:function(a){return"file"===a.type?(Sfdc.ChatterFileUploader&&(Sfdc.ChatterFileUploader.isFileSync="fs"===a.filter?!0:!1),"whole"):"note"===a.type||"topics"===a.type?"whole":"both"}}}());
(function(){chatter.extend("CodeSnippetHighlightingManager",function(){function a(){0<Sfdc.select(".prettyprint:not(.prettyprinted)").length&&window.PR&&prettyPrint()}var b=chatter.getEventBus();this.highlightCode=function(){a()};b.addEventListener("chatter:feed","onAfterFeedRefresh",a);b.addEventListener("chatter:feed","onAfterShowMoreFeedItems",a);b.addEventListener("chatter:feed","onAfterNewPostFeedUpdate",a);b.addEventListener("chatter:feed","onAuxBodyChange",a);b.addEventListener("chatter:feed",
"onAfterEditPostFeedUpdate",a);b.addEventListener("chatter:rechat","onAfterPreviewLoaded",a);b.addEventListener("unifiedSearchPage:feedSearchResults","onAfterResultsShown",a);b.addEventListener("chatter:feed","onAfterShowMoreComments",a)},null);Sfdc.onload(function(){chatter.getCodeSnippetHighlightingManager().highlightCode()})})();
chatter.getPublisher().registerFeedItemTypeHandler("ContentPost",function(){var k={visiblePanel:null,config:{omnitureEvent:"postFile",allowRichText:!0},setupPanel:function(){this.config.promptText=LC.getLabel("Publisher","FileGhostText")},state:{currentContentAction:null},clearPanelState:function(){this.onShowPanel();Sfdc.get("chatterFileStageOne")&&(this.state={currentContentAction:null});chatter.getFileUploader().reset(this.fileInfoUpdate)},onShowPanel:function(){Sfdc.get("chatterFileStageOne")?
this.showPanel("chatterFileStageOne"):this.showFileInfo(this,null,!1);this.publisherCore.setIsExtensionValidForSubmit(!1)},onFailure:function(a,b){var c=chatter.getPublisher().getHandler("ContentPost");"UPLOAD"===c.state.currentContentAction?c.publisherCore.showErrors(b.html):"ATTACH_EXISTING"===c.state.currentContentAction?c.publisherCore.showErrors(b.errors.message):"ATTACH_EXTERNAL"===c.state.currentContentAction&&c.publisherCore.showErrors(b.errors.message);c.publisherCore.enablePublisher()},
onSuccess:function(a,b){var c=chatter.getPublisher().getHandler("ContentPost");c.clearPanelState();c.publisherCore.switchToDefaultPublisherType();chatter.getRecentFiles().isWidgetPresent()&&b.recentFilesPanelHtml&&(c=chatter.getFileUploader().getBase64Decoder().decode(b.recentFilesPanelHtml),chatter.getRecentFiles().refresh(c))},getPayload:function(a){var b=this.publisherCore.getRawBody();"UPLOAD"===this.state.currentContentAction?a.q=";postFile":"ATTACH_EXISTING"===this.state.currentContentAction?
a.contentDocumentId=this.state.contentDocumentId:"ATTACH_EXTERNAL"===this.state.currentContentAction&&(a.externalDataSourceId=this.state.externalDataSourceId,a.externalDocumentId=this.state.externalDocumentId);a.refreshRecentFiles=chatter.getRecentFiles().isWidgetPresent();this.publisherCore.isPromptText(b)||(a.text=b);return a},postWithCustomFunction:function(a){var b=chatter.getToolbox(),c=this.publisherCore,d=c.getHandler("ContentPost"),e=function(a,b){c.fireOnAfterUpdateStatusAndQuickActionSuccess({json:b});
c.destroyRTE(!0);d.onSuccess(a,b)};if("UPLOAD"===this.state.currentContentAction)if(!0===d.state.showNewStageTwo){var f=function(a,d){Sfdc.AccessibleMultiUploadFilesDialog.closeIt(!0);b.xhrFailure(a,d);c.switchToDefaultPublisherType();c.enablePublisher()},g=Sfdc.get("sfdcSyncOption");g&&(a.sfdcSync=g.checked?"1":"0");Sfdc.AccessibleMultiUploadFilesDialog.open({fileInput:this.state.fileInput,displayDDTargetIcon:!1,filterParentId:"",parentEntityName:"",uploaderOrigin:"PUBLISHER",uploadActionUrl:b.sitePrefix()+
b.apiurl(),params:a,customHandlers:{failureHandler:function(a,b){Sfdc.AccessibleMultiUploadFilesDialog.closeIt(!0);d.onFailure(a,b)},errorHandler:f,successHandler:function(a,b){Sfdc.AccessibleMultiUploadFilesDialog.closeIt(!0);e(a,b)},cancelHandler:function(){Sfdc.AccessibleMultiUploadFilesDialog.uploader.cancelRemainingUploads();c.openTypeSpecificPanel(Sfdc.get("publisherAttachContentPost"),"ContentPost");c.enablePublisher()}}})}else chatter.getFileUploader().upload(b.sitePrefix()+b.apiurl(),a,{failureHandler:this.onFailure,
errorHandler:f,successHandler:e},this.state.helpUrl);else if("ATTACH_EXISTING"==this.state.currentContentAction)b.post({url:"/feeditems",params:a,failure:this.onFailure,success:e});else if("ATTACH_EXTERNAL"==this.state.currentContentAction){var h=ExternalFileProgressDialog.showOnPostFile("extFileProgress",this.state.externalFileSharedByReference);b.post({url:"/feeditems",params:a,failure:function(a,b){h.hide();d.onFailure(a,b)},success:function(a,b){h.hide();e(a,b)}})}},fileInfoUpdate:function(){var a=
chatter.getPublisher().getHandler("ContentPost");chatter.getFileUploader().fileInfoUpdate();a.publisherCore.setIsExtensionValidForSubmit(!0)},fileNewInfoUpdate:function(a){var b=chatter.getPublisher().getHandler("ContentPost");if(a.files&&1==a.files.length){b.state.showNewStageTwo=!0;b.state.currentContentAction="UPLOAD";b.state.fileInput=a;a=a.files[0];var c="undefined"!=typeof a.fileName?a.fileName:a.name,d="undefined"!=typeof a.fileSize?a.fileSize:a.size,d=Sfdc.MultiFileUploaderUtil.formatFileSize(d);
Sfdc.get("chatterSelectedFileName").innerHTML=chatter.getToolbox().htmlEncode(c);Sfdc.get("chatterSelectedFileSize").innerHTML=chatter.getToolbox().htmlEncode(LC.getLabel("ChatterFileMultiUpload","valueInParentheses",d));a=Sfdc.MultiFileUploaderUtil.formatFileTypeCSS(a.type,"32");Sfdc.get("chatterSelectedFileTypeIcon").className=a;b.showPanel("chatterFileNewStageTwo");b.publisherCore.setIsExtensionValidForSubmit(!0)}},focusFirstElement:function(){var a=Sfdc.get("chatterLinkFileAction");if(Sfdc.Dom.isVisible(a,
!0))a.focus();else return!0},showFileInfo:function(a,b,c){isIPhone||isIPad?Dialogs.showSimpleError("",LC.getLabel("Publisher","fileUploadNotSupportedOnDevice"),null):c&&Sfdc.MultiFileUploaderUtil.isFileAPISupported()&&!Sfdc.userAgent.isSafari&&!Sfdc.userAgent.isChromium?Sfdc.get("hiddenFileBtn").click():(this.showPanel("chatterFileStageTwo"),this.state.currentContentAction="UPLOAD",this.state.helpUrl=b?b:null,a=chatter.getFileUploader(),a.resetDialogAppendix(),a.initFields(),a.initValidation(function(a){var b=
chatter.getPublisher().getHandler("ContentPost");a?b.publisherCore.setIsExtensionValidForSubmit(!0):b.publisherCore.setIsExtensionValidForSubmit(!1)}))},setMyFilesFilterFlag:function(a){this.config.isMyFilesFilterOn=a},openSelectFilesToAttach:function(a,b,c){this.getCurrentFeedParentId=c;if(c=sfdcPage.getDialogById(a))return c;c=574;Ext.isIE&&(c=565);var d="?feedParentId\x3d"+this.getCurrentFeedParentId();b&&(d+="\x26cc\x3dtrue");c=new IFrameDialog(a,LC.getLabel("Publisher","selectFileDialogTitle"),
UserContext.getUrl("/_ui/content/view/files/sharing/FindLinkedFilesPage"+d),c,946);c.getContent=function(){return'\x3ciframe frameborder\x3d"no" scrolling\x3d"no" id\x3d"'+this.contentId+'" style\x3d"overflow:hidden; border:0;height:'+this.height+'px;width: 100%;" src\x3d"'+this.url+'"\x3e\x3c/iframe\x3e'};c.register();return c},showLinkFile:function(){this.openSelectFilesToAttach("chatterFindExistingContent",!1,function(){return chatter.getPublisher().getSubjectId()}).display()},validatePayload:function(a){if(a.isRichText){var b=
chatter.getToolbox().getPlainTextData(a.text);chatter.getToolbox().stringIsEmpty(b)&&(a.text="")}return{isValid:!0}},onValidationFailure:function(){this.publisherCore.resetPublisher();this.publisherCore.enablePublisher()},showLinkedFileInfo:function(a){this.state.currentContentAction="ATTACH_EXISTING";OverlayDialogElement.getDialog("chatterFindExistingContent").hide();var b=this;chatter.getToolbox().get({params:{q:";linkedContentDetails",contentDocumentId:a},failure:function(a,d){d.errors&&b.publisherCore.showErrors(d.errors);
b.publisherCore.setIsExtensionValidForSubmit(!1)},success:function(c,d){b.showPanel("chatterFileContent");var e=Ext.get("chatterExistContentInfo");Ext.DomHelper.overwrite(e,d.html);b.state.contentDocumentId=a;b.publisherCore.setIsExtensionValidForSubmit(!0);Ext.get("publishersharebutton").focus()}})},showExternalLinkedFileInfo:function(a,b,c){this.state.currentContentAction="ATTACH_EXTERNAL";OverlayDialogElement.getDialog("chatterFindExistingContent").hide();var d=this,e=ExternalFileProgressDialog.showOnGetFileInfo("extFileProgress");
chatter.getToolbox().get({url:"/contenthub/linkedfiledetails/"+a+"/"+encodeURIComponent(b),failure:function(a,b){e.hide();b.errors&&d.publisherCore.showErrors(b.errors.message);d.publisherCore.setIsExtensionValidForSubmit(!1)},success:function(f,g){e.hide();d.showPanel("chatterFileContent");var h=Ext.get("chatterExistContentInfo");Ext.DomHelper.overwrite(h,g.html);d.state.externalDataSourceId=a;d.state.externalDocumentId=b;d.state.externalFileSharedByReference=c;d.publisherCore.setIsExtensionValidForSubmit(!0);
Ext.get("publishersharebutton").focus()}})},handleFileUploadCancel:function(){for(i=0;i<window.frames.length;i++)try{0<=window.frames[i].name.indexOf("ext-gen")&&(window.frames[i].location="/img/s.gif")}catch(a){}this.publisherCore.openTypeSpecificPanel(Sfdc.get("publisherAttachContentPost"),"ContentPost");this.publisherCore.enablePublisher();return!0},getVisibilityMessages:function(a,b,c,d,e,f){b=UserContext.isDefaultNetwork;a=a.subjectId.substr(0,3);e="0F9"===a;c="005"===a?d&&f?LC.getLabel("ContentPostVisibility",
"whoCanSeeThis_UserPost_UserSharing"):b?LC.getLabel("ContentPostVisibility","whoCanSeeThis_UserPostInCompany"):LC.getLabel("ContentPostVisibility","whoCanSeeThis_UserPostInNetwork"):e?LC.getLabel("ContentPostVisibility","whoCanSeeThis_GroupPost"):"INTERNAL_USERS"==c?LC.getLabel("ContentPostVisibility","whoCanSeeThis_RecordPost_InternalUsers"):LC.getLabel("ContentPostVisibility","whoCanSeeThis_RecordPost_AllUsers");d=LC.getLabel("ContentPostVisibility","whoCanSeeThisFileTitle");return[{text:c,title:d}]},
showPanel:function(a){var b=this.publisherCore.getPublisherContainer(),c=Sfdc.get(k.visiblePanel,b);c&&Sfdc.Dom.addClass(c,"hidden");(b=Sfdc.get(a,b))&&Sfdc.Dom.removeClass(b,"hidden");k.visiblePanel=a},_addDragEnterListener:function(a){var b=chatter.getPublisher().getPublisherContainer(),c=Sfdc.get("publisherAttachContentPost");null!=b&&null!=c?(Sfdc.on(b,"drop",function(a){a&&(a.target&&("INPUT"!==a.target.tagName||"file"!==a.target.type))&&a.preventDefault()}),Sfdc.on(b,"dragover",function(a){a&&
a.preventDefault()}),Sfdc.on(b,"dragenter",function(a){a=chatter.getPublisher();var b=a.getHandler("ContentPost"),f=a.getCurrentActionType();"TextPost"!==f&&"ContentPost"!==f||("TextPost"===f&&a.openTypeSpecificPanel(c,"ContentPost"),"UPLOAD"!=b.state.currentContentAction&&b.showFileInfo(b.state.fileInput,null,!1))})):20>a&&window.setTimeout(function(){chatter.getPublisher().getHandler("ContentPost")._addDragEnterListener(++a)},1E3)}};!Sfdc.userAgent.isIE&&!Sfdc.userAgent.isSafariIOS&&window.setTimeout(function(){chatter.getPublisher().getHandler("ContentPost")._addDragEnterListener(1)},
100);return k}());
Sfdc.ns("Sfdc.CreateRecordHandler");
Sfdc.CreateRecordHandler=function(){this.registerFeedItemTypeHandler=function(k,m,r,f,t,u,v){f||(f=k);chatter.getPublisher().registerFeedItemTypeHandler("CreateRecordEvent",function(){function p(){window.picklist&&(picklist.initialized=!1,picklist.initAll())}function q(b,a){var d=Sfdc.get(c.config.formId);if(d){var w=d.parentNode;Sfdc.Dom.removeChild(d);Sfdc.Dom.insertHTML(w,b.htmlForm);Sfdc.userAgent.isIE7&&chatter.getFeed().getQuickActionPublisher().reflow();if(d=Sfdc.get(c.config.formId))if(d=
Sfdc.Resource.getScriptsFromHtml(d),a){var h=0,g=[],e=[],f=!1;Sfdc.Array.forEach(d,function(a){a.src?(0<a.src.indexOf("ckeditor")&&(f=!0),g.push(a.src)):e.push(a)});if(f){var l=function(){"loaded"===CKEDITOR.status?Sfdc.Resource.execScripts(e,p):20>h&&(h++,setTimeout(l,500))};Sfdc.Resource.addJavaScripts(g,function(){setTimeout(l,200)})}else Sfdc.Resource.execScripts(d,p)}else Sfdc.Resource.execScripts(d,p)}}var c={config:{omnitureEvent:"recordCreate",urlMaxLen:1E3,urlNameMaxLen:255,disallowedLinkChars:/[\s\\]+/},
state:{}};c.config.actionIdParam=k;c.config.formId=m;c.config.formSuffix=f;c.setupPanel=function(){Sfdc.onload(function(){window.picklist&&picklist.initAll()});c.config.submitValueAndTitle={value:r,title:r}};c.clearPanelState=function(){};c.focusFirstElement=function(){var b;a:{b=Sfdc.get(m);for(var a=b.getElementsByTagName("input"),d=0;d<a.length;d++)if("text"==a[d].getAttribute("type")){b=a[d];break a}for(var c="undefined"!==typeof CKEDITOR,a=b.getElementsByTagName("textarea"),d=0;d<a.length;){b=
c&&CKEDITOR.instances[a[d].name]?CKEDITOR.instances[a[d].name]:a[d];break a}b=null}b&&(b.focus(),"undefined"!==typeof CKEDITOR&&b instanceof CKEDITOR.editor?b.createRange&&(a=b.createRange(),a.moveToElementEditEnd(a.root),b.getSelection().selectRanges([a])):b.select())};c.onShowPanel=function(b){var a=Sfdc.get(c.config.formId);Sfdc.Dom.hasClass(a,"stub")&&(a={url:"/quickcreate/",params:{entityId:this.publisherCore.getSubjectId(),actionIdParam:k,formSuffix:c.config.formSuffix},success:function(a,c){q(c,
!0);Sfdc.isFunction(b)&&b()}},"undefined"!==typeof entityFeedPage?entityFeedPage.getObjectUpdate(chatter.getFeed().getConfig().subjectId,a):chatter.getToolbox().get(a));this.publisherCore.setIsExtensionValidForSubmit(!0)};var s=null;c.onSuccess=function(b,a){var d=chatter.getEventBus();a.feedItemId&&"undefined"===typeof entityFeedPage&&d.fireEvent("chatter:publisher","onAfterUpdateStatus",{json:a});q(a);if(a.successMessage){var f=document.querySelectorAll(".nonFeedSuccess")[0],h=document.querySelectorAll(".nonFeedSuccessMessage")[0];
Sfdc.Dom.setText(h,a.successMessage);Sfdc.Dom.setStyle(f,"display","block");Sfdc.Animation.opacity(f,0,1,{duration:1E3});clearTimeout(s);s=setTimeout(function(){Sfdc.Animation.opacity(f,1,0,{duration:1E3,onComplete:function(){Sfdc.Dom.setStyle(f,"display","none");"undefined"===typeof entityFeedPage&&window.location.reload()}})},3E3)}d.fireEvent("chatter:publisher","onAfterQuickActionSuccess",{json:a});c.publisherCore.enablePublisher()};c.onFailure=function(b,a){a.errors?c.publisherCore.showErrors(a.errors.message):
q(a);c.publisherCore.enablePublisher()};c.getPayload=function(b){b.actionIdParam=this.config.actionIdParam;b.formSuffix=c.config.formSuffix;for(var a=["input","select","textarea"],d=document.getElementById(m),f="undefined"!==typeof CKEDITOR,h=0;h<a.length;h++)for(var g=d.getElementsByTagName(a[h]),e=0;e<g.length;e++)if("checkbox"!=g[e].getAttribute("type")||g[e].checked)if("TEXTAREA"==g[e].tagName&&(f&&CKEDITOR.instances[g[e].name])&&(CKEDITOR.instances[g[e].name].updateElement(),CKEDITOR.instances[g[e].name].destroy(!0)),
"SELECT"==g[e].tagName){for(var k=[],l=g[e].options,n=0;n<l.length;n++)l[n].selected&&k.push(l[n].value);b[g[e].name]=k}else b[g[e].name]=g[e].value;b.save_new="Saving...";return b};c.postWithCustomFunction=function(b){b={url:"/quickcreate",params:b,failure:this.onFailure,success:this.onSuccess};"undefined"!==typeof entityFeedPage?entityFeedPage.postObjectUpdate(chatter.getFeed().getConfig().subjectId,b):chatter.getToolbox().post(b)};return c}(),{handlerId:f,publisherCore:t});Sfdc.resolve("Sfdc.EntityFeed.QuickAction")&&
Sfdc.EntityFeed.QuickAction.register({actionName:u,actionId:k,handlerId:f,formId:m,contextId:v,excludeClass:"stub"})}};var createRecordHandler=new Sfdc.CreateRecordHandler;
chatter.getPublisher().registerFeedItemTypeHandler("AnnouncementPost",function(){var c={config:{omnitureEvent:"post"},setupPanel:function(){this.config.promptText=LC.getLabel("ChatterAnnouncements","announcementGhostText");this.config.expirationDateElement=Sfdc.get("expirationDate");this.config.sendEmailsCheckbox=Sfdc.get("sendEmailsCheckbox");d(this.config.expirationDateElement,e);var a=chatter.getPublisher().getTextArea();d(a,e)}},e=function(){var a=chatter.getPublisher().getHandler("AnnouncementPost"),
b=chatter.getPublisher(),c=b.getRawBody(),b=!(chatter.getToolbox().stringIsEmpty(c)||b.isPromptText(c))&&a.dateValidator(a.config.expirationDateElement.value);a.publisherCore.setIsExtensionValidForSubmit(b)}.bind(this),d=function(a,b){Sfdc.Event.add(a,"keyup",b);Sfdc.Event.add(a,"change",function(){b.defer(10)});Sfdc.Event.add(a,"cut",function(){b.defer(10)});Sfdc.Event.add(a,"paste",function(){b.defer(10)})};c.dateValidator=function(a){a=Sfdc.Date.isDate(a,UserContext.dateFormat);var b=Sfdc.get(".expirationDateErrorMsg");
a?Sfdc.Dom.addClass(b,"hidden"):(Sfdc.Dom.updateHTML(b,LC.getLabel("ChatterAnnouncements","announcementExpirationDateInvalid")),Sfdc.Dom.removeClass(b,"hidden"));return a};c.onShowPanel=function(){this.publisherCore.setIsExtensionValidForSubmit(!1)};c.focusFirstElement=function(){this.publisherCore.focusOnTextArea()};c.onSuccess=function(a,b){chatter.getPublisher().getHandler("AnnouncementPost").publisherCore.restoreDefaultUIState();if(b.announcement){var c=Sfdc.get("announcementPanel");Sfdc.Dom.updateHTML(c,
b.announcement);(c=Sfdc.get("announcementActionDropDownButton"))&&SfdcCmp.init(c)}};c.onFailure=function(a,b){var c=chatter.getPublisher().getHandler("AnnouncementPost");b.errors&&c.publisherCore.showErrors(b.errors.message);c.publisherCore.enablePublisher()};c.getPayload=function(a){var b=this.publisherCore.getRawBody();a.text=b;a.expirationDate=this.config.expirationDateElement.value;this.config.sendEmailsCheckbox&&(a.isSendEmails=this.config.sendEmailsCheckbox.checked);return a};c.validatePayload=
function(a){var b=!(Sfdc.isEmpty(a.text)||this.publisherCore.isPromptText(a.text));a=Sfdc.Date.isDate(a.expirationDate,UserContext.dateFormat);return{isValid:b&&a}};c.onValidationFailure=function(){this.publisherCore.resetPublisher();this.publisherCore.enablePublisher()};return c}());
(function(){chatter.extend("LinkMetadataRetriever",function(){function r(){for(var a=Sfdc.select("div.richPost div.inlinePlayer iframe"),b=a.length,c=0;c<b;c++){var h=a[c],f=t(h),d=Sfdc.get(".content",f),f=Sfdc.get(".inlinePlayerTrigger",f);Sfdc.Dom.show(f);Sfdc.Dom.removeClass(d,"full");Sfdc.Dom.hideByDisplay(h);Sfdc.Dom.removeChild(h)}}function D(){var a=E();n++;""!==a&&(a={url:"/link/metadata",params:{urls:a},success:function(a,c){v&&console.log(c);for(var h=c.linkMetadata,f=0;f<h.length;f++){var d=
h[f];try{if(y(d)){var e=d.original_url,k=d.type,p=g[e],q=d.title?x(d.title,l.titleLength):"",s="";d.description&&(s=x(d.description,l.descriptionLength));if(p){p.type=k;p.state="fetched";p.data={source:d.source,title:q,thumbnail_url:d.thumbnail_url,description:s,original_url:d.original_url,provider_url:d.provider_url};d.frame_source&&(p.data.frame_source=d.frame_source+"\x26width\x3d"+d.width+"\x26height\x3d"+d.height+"\x26autoplay\x3d1\x26wmode\x3dtransparent",p.data.frame_width=d.width,p.data.frame_height=
d.height);for(var d=e,m=g[d],r=m.previews,t=z(m),s=0;s<r.length;s++){var n=r[s],u=Sfdc.get(n.getPlaceholderId());Sfdc.Dom.hasClass(u,l.classFetching)&&d===n.getUrl()&&t(n,m.data)}}}}catch(w){v&&Sfdc.log('chatter:richLinkPost failed on parsing link preview service response for "'+e+'": '+w,Sfdc.Logging.LogLevel.ERROR)}}},failure:function(){},dieSilently:!0},q&&(a.params.runningTest=q),F.get(a))}function y(a){if(q)return!0;if(a.error_code)return!1;var b=a.thumbnail_url;return b&&(0!==b.indexOf("http")||
"SFDC"!==a.source&&(0!==b.indexOf("https")||-1<b.indexOf(window.location.hostname)))?!1:!0}function x(a,b){var c=document.createElement("DIV");Sfdc.Dom.setText(c,a);a=c.innerHTML;return a.length>b?a.substr(0,b)+"...":a}function z(a){var b=function(){};switch(a.type){case "link":b=m;break;case "photo":b=m;break;case "video":b=a.data&&a.data.frame_source?w:m;break;case "rich":b=a.data&&a.data.frame_source?w:m}return b}function m(a,b){var c=A(a,G,b),c=b.thumbnail_url&&""!==b.thumbnail_url?c.replace("{!#thumbnail}",
H).replace("{!#thumbnail_url}",b.thumbnail_url).replace("{!#rich_link_url}",b.original_url):c.replace("{!#thumbnail}",B).replace("{!#rich_link_url}",b.original_url);C(a.getPlaceholderId(),c)}function w(a,b){var c=A(a,I,b),c=b.thumbnail_url&&""!==b.thumbnail_url?c.replace("{!#thumbnail}",J).replace("{!#thumbnail_url}",b.thumbnail_url).replace("{!#frame_source}",b.frame_source).replace("{!#frameWidth}",b.frame_width).replace("{!#frameHeight}",b.frame_height):c.replace("{!#thumbnail}",B).replace("{!#rich_link_url}",
b.original_url);C(a.getPlaceholderId(),c)}function C(a,b){var c=Sfdc.get(a);if(c){var h=t(c),h=Sfdc.select(".linkPostLinkContainer",h);Sfdc.Dom.hideByDisplay(h);Sfdc.Dom.insertHTML(c,b)}Sfdc.Dom.removeClass(c,l.classFetching);Sfdc.Dom.addClass(c,l.classFetched);K(c)}function t(a){return Sfdc.Dom.getParent(a,".feeditem")}function A(a,b,c){a=""!=a.getTitle()?a.getTitle():c.title;""===a&&(a=c.provider_url);return b=b.replace("{!#title}",a).replace("{!#description}",c.description).replace(/{!#original_url}/g,
c.original_url).replace(/{!#provider_url}/g,c.provider_url)}function E(){var a="",b=0,c;for(c in g){if(b>=u)break;"initial"===g[c].state&&(a+=encodeURIComponent(c)+",",g[c].state="fetching",b++)}return a.substring(0,a.length-1)}function k(a){n=0;var b=Sfdc.select("."+l.classPrefetch);v&&console.log("event: "+a+" | found:"+b.length);if(0<b.length){Sfdc.each(b,function(a,b){var f=a.id,d=a.getAttribute("data-richUrl"),e=a.getAttribute("data-title")||"";q="true"==a.getAttribute("data-runningTest")||!1;
Sfdc.Dom.removeClass(a,l.classPrefetch);Sfdc.Dom.addClass(a,l.classFetching);f=new L(f,d,e);g[d]?"fetching"===g[d].state||"initial"===g[d].state?g[d].previews.push(f):"fetched"===g[d].state&&(d=g[d],z(d)(f,d.data)):g[d]={state:"initial",previews:[f],type:"",data:{}}});for(a=0;a<b.length/u;a++)D()}}function K(a){function b(){Sfdc.logServer("LinkMetadataRetriever",l.brokenImageErrorMessage,Sfdc.Logging.LogLevel.ERROR);Sfdc.un(c,"error",b,null);Sfdc.Dom.addClass(e,["thumbnail","default"]);Sfdc.Dom.updateHTML(e,
M)}var c=Sfdc.get(".thumb",a),e=Sfdc.get(".thumbContainer",a);Sfdc.on(c,"error",b,null,null)}function L(a,b,c){this.getPlaceholderId=function(){return a};this.getTitle=function(){return c};this.getUrl=function(){return b}}var l={titleLength:60,descriptionLength:150,classPrefetch:"richLink-prefetch",classFetching:"richLink-fetching",classFetched:"richLink-fetched",brokenImageErrorMessage:"Thumbnail url is broken."},q=!1,v=!1,g={},e=chatter.getEventBus(),F=chatter.getToolbox(),u=5,n=0,J="\x3cspan class\x3d'thumbContainer'\x3e\x3ca data-iframeSrc\x3d'{!#frame_source}' data-frameWidth\x3d'{!#frameWidth}' data-frameHeight\x3d'{!#frameHeight}' href\x3d'javascript:;' onclick\x3d'chatter.getLinkMetadataRetriever().launchVideo(this);' class\x3d'thumbnail inlinePlayerTrigger'\x3e\x3cimg src\x3d'/img/chatter/play.png' class\x3d'play' /\x3e\x3cimg src\x3d'{!#thumbnail_url}' class\x3d'thumb' width\x3d'120px' /\x3e\x3c/a\x3e\x3c/span\x3e",
H="\x3cspan class\x3d'thumbContainer'\x3e\x3ca target\x3d'_blank' href\x3d'{!#rich_link_url}' class\x3d'thumbnail'\x3e\x3cimg class\x3d'thumb' src\x3d'{!#thumbnail_url}'/\x3e\x3c/a\x3e\x3c/span\x3e",B="\x3cspan class\x3d'thumbContainer default'\x3e\x3ca target\x3d'_blank' href\x3d'{!#rich_link_url}' class\x3d'thumbnail default'\x3e\x3cimg class\x3d'thumb' src\x3d'/s.gif'/\x3e\x3c/a\x3e\x3c/span\x3e",G="\x3cdiv class\x3d'richPost {!#type}'\x3e{!#thumbnail}{!#inlinePlayer}\x3cdiv class\x3d'content'\x3e\x3ch4 class\x3d'title'\x3e\x3ca target\x3d'_blank' href\x3d'{!#original_url}'\x3e{!#title}\x3c/a\x3e\x3c/h4\x3e\x3ch5 class\x3d'provider'\x3e\x3ca target\x3d'_blank' href\x3d'{!#provider_url}'\x3e{!#provider_url}\x3c/a\x3e\x3c/h5\x3e\x3cdiv class\x3d'desc'\x3e{!#description}\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'chatter-clear'/\x3e\x3c/div\x3e".replace("{!#type}",
"link").replace("{!#inlinePlayer}",""),I="\x3cdiv class\x3d'richPost {!#type}'\x3e{!#thumbnail}{!#inlinePlayer}\x3cdiv class\x3d'content'\x3e\x3ch4 class\x3d'title'\x3e\x3ca target\x3d'_blank' href\x3d'{!#original_url}'\x3e{!#title}\x3c/a\x3e\x3c/h4\x3e\x3ch5 class\x3d'provider'\x3e\x3ca target\x3d'_blank' href\x3d'{!#provider_url}'\x3e{!#provider_url}\x3c/a\x3e\x3c/h5\x3e\x3cdiv class\x3d'desc'\x3e{!#description}\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'chatter-clear'/\x3e\x3c/div\x3e".replace("{!#type}",
"video").replace("{!#inlinePlayer}","\x3cdiv class\x3d'inlinePlayer'\x3e\x3c/div\x3e"),M="\x3cimg src\x3d'/s.gif'\x3e";this.setRunningTest=function(a){q=a};this.setDebugMode=function(a){v=a};this.getBatchSize=function(){return u};this.getBatchCallCount=function(){return n};this.parseDOMAndRender=function(){k()};this.launchVideo=function(a){var b=a.getAttribute("data-iframeSrc"),c=a.getAttribute("data-frameWidth"),e=a.getAttribute("data-frameHeight"),f=t(a);a=Sfdc.get(".content",f);var d=Sfdc.get(".inlinePlayerTrigger",
f),f=Sfdc.get(".inlinePlayer",f);Sfdc.Dom.addClass(a,"full");Sfdc.Dom.hideByDisplay(d);Sfdc.Dom.insertHTML(f,"\x3ciframe src\x3d'{!#frame_source}' width\x3d'100%' height\x3d'{!#frameHeight}px' frameborder\x3d'0' scrolling\x3d'no' allowfullscreen\x3d'true'\x3e\x3c/iframe\x3e".replace("{!#frame_source}",b).replace("{!#frameWidth}",c).replace("{!#frameHeight}",e))};this.isResultSafeToRender=function(a){return y(a)};this.getProperLengthString=function(a,b){return x(a,b)};e.addEventListener("chatter:feed",
"onAfterFeedRefresh",k);e.addEventListener("chatter:feed","onAfterShowMoreFeedItems",k);e.addEventListener("chatter:feed","onAfterNewPostFeedUpdate",k);e.addEventListener("chatter:feed","onAuxBodyChange",k);e.addEventListener("chatter:feed","onAfterEditPostFeedUpdate",k);e.addEventListener("chatter:rechat","onAfterPreviewLoaded",k);e.addEventListener("unifiedSearchPage:feedSearchResults","onAfterResultsShown",k);e.addEventListener("chatter:modalOverlay","onBeforeOverlayShown",r);e.addEventListener("chatter:feed",
"onBeforeRemoveFeed",r);e.addEventListener("UIComponent:OverlayDialog","onBeforeOverlayShow",r)},null);Sfdc.onload(function(){chatter.getLinkMetadataRetriever().parseDOMAndRender()})})();
chatter.getPublisher().registerFeedItemTypeHandler("LinkPost",function(){var e={config:{omnitureEvent:"postLink",urlMaxLen:1E3,urlNameMaxLen:255,disallowedLinkChars:/[\s\\]+/,allowRichText:!0},state:{},setupPanel:function(){var a=this;a.config.promptText=LC.getLabel("Publisher","LinkGhostText");a.config.urlElement=Ext.get("url");a.config.urlNameElement=Ext.get("urlName");a.config.urlErrorEl=chatter.getToolbox().getElementErrorContainer(e.config.urlElement);a.config.urlNameErrorEl=chatter.getToolbox().getElementErrorContainer(e.config.urlNameElement);
var b=function(){var b=chatter.getToolbox(),f=b.stringTrim(a.config.urlElement.getValue()),d=f,c=d.indexOf("https://");0<c&&10>c?d=d.substring(c):(c=d.indexOf("ftp://"),0<c&&10>c?d=d.substring(c):(c=d.indexOf("http://"),0<c&&10>c?d=d.substring(c):0===c&&(c=d.substring(7).indexOf("http://"),-1<c&&3>c&&(d=d.substring(7+c)))));d!=f&&(f=a.config.urlElement.dom.value=d);var e=f.length,g=b.stringTrim(a.config.urlNameElement.getValue()).length,d=LC.getLabel("Publisher","postInvalidLinkUrl"),c=LC.getLabel("Publisher",
"postLinkRequired"),h=LC.getLabel("Publisher","postValueMaxLen",a.config.urlMaxLen),k=LC.getLabel("Publisher","postValueMaxLen",a.config.urlNameMaxLen);b.validateElement(a.config.urlErrorEl,function(){return 0<e},c)&&b.validateElement(a.config.urlErrorEl,function(){return e<=a.config.urlMaxLen},h)&&b.validateElement(a.config.urlErrorEl,function(){return!a.config.disallowedLinkChars.test(f)},d)&&b.validateElement(a.config.urlNameErrorEl,function(){return g<=a.config.urlNameMaxLen},k)?a.publisherCore.setIsExtensionValidForSubmit(!0):
a.publisherCore.setIsExtensionValidForSubmit(!1)};chatter.getToolbox().wireFieldChange(a.config.urlElement,b);chatter.getToolbox().wireFieldChange(a.config.urlNameElement,b)},clearPanelState:function(){this.config.urlElement.dom.value=LC.getLabel("Publisher","httpProtocolPrefix");this.config.urlNameElement.dom.value="";Sfdc.Dom.addClass(this.config.urlErrorEl.dom,"hidden");Sfdc.Dom.addClass(this.config.urlNameErrorEl.dom,"hidden")},focusFirstElement:function(){this.config.urlElement.focus();this.config.urlElement.dom.select()},
onShowPanel:function(){var a=Sfdc.get("publishereditablearea"),b=Sfdc.get("#publisherRichTextEditor");if(b||a){var e=b?chatter.getToolbox().getPlainTextData(b.innerHTML):a.value;if(e=chatter.getToolbox().checkIfStringIsALink(e)){this.config.urlElement.dom.value=e;a.value="";b&&Sfdc.Dom.setText(b,"");this.publisherCore.setIsExtensionValidForSubmit(!0);this.config.urlNameElement.focus();this.config.urlNameElement.dom.select();return}}this.publisherCore.setIsExtensionValidForSubmit(!1)},onSuccess:function(a,
b){chatter.getPublisher().getHandler("LinkPost");chatter.getYoutubeVideo().fetchVideoPreviews()},onFailure:function(a,b){var e=chatter.getPublisher().getHandler("LinkPost");b.errors&&e.publisherCore.showErrors(b.errors.message);e.publisherCore.enablePublisher()},getPayload:function(a){var b=this.publisherCore.getRawBody();this.publisherCore.isPromptText(b)||(a.text=b);a.url=this.config.urlElement.getValue();a.urlName=this.config.urlNameElement.getValue();return a}};return e}());
chatter.getPublisher().registerFeedItemTypeHandler("ContentNote",function(){var d={config:{},state:{},setupPanel:function(){this.config.promptText=LC.getLabel("Publisher","NoteGhostText");var a=LC.getLabel("Publisher","Create");this.config.submitValueAndTitle={value:a,title:a};this.unsubmittedContent="";Sfdc.on(window,"unload",f)},removeEventsForPostType:function(){e()},onShowPanel:function(){var a=Sfdc.ChatterNotes,b={readOnly:!1,height:"62px",width:"100%",extraPlugins:"divarea",removePlugins:"elementspath, magicline,resize",
toolbar:[{name:"basicstyles",groups:["basicstyles","cleanup"]}],on:{instanceReady:function(a){chatter.getPublisher().setIsExtensionValidForSubmit(!0)}}};d.editor||(d.editor=a.initEditor("",!1,b),d.editor.root=document.querySelector("#editor"))},clearPanelState:function(){chatter.getPublisher().getHandler("ContentNote").unsubmittedContent=g();d.editor.setData("");Sfdc.get(".noteTitleInput").value="";e()},postWithCustomFunction:function(a){var b=Sfdc.ChatterNotes,c={},h=chatter.getPublisher().getSubjectId();
h&&(c.parentId=h);c.retUrl=Sfdc.Url.stripDomainFromUrl(window.location.href);c.title=a.noteTitle;c.content=a.content;b.createNote(null,c,!0,function(a,b){chatter.getFeed().applyDropDownFilter({requestType:"filter",filterType:"all",keyprefix:"",shouldPoll:!1,label:"All Updates",itemVisibilityFilter:""})});d.clearPanelState();chatter.getPublisher().switchToDefaultPublisherType()},getPayload:function(a){var b=chatter.getToolbox(),c=g(),d=Sfdc.get(".noteTitleInput"),b=b.stringTrim(d.value);a.content=
c;a.noteTitle=b;return a},validatePayload:function(a){return{isValid:!0,errorPayload:{hasContent:!0}}},onValidationFailure:function(a){var b=chatter.getPublisher().getHandler("ContentNote"),c=LC.getLabel("Publisher","noteMissingBody");a.hasContent||b.publisherCore.showErrors(c);b.publisherCore.enablePublisher()},onSuccess:function(a,b){var c=chatter.getPublisher().getHandler("ContentNote");Sfdc.get(".noteTitleInput").value="";c.editor.setData("");c.unsubmittedContent="";e()},onFailure:function(a,
b){var c=chatter.getPublisher().getHandler("ContentNote");b.errors&&c.publisherCore.showErrors(b.errors.message);c.publisherCore.enablePublisher()}},f=function(){Sfdc.un(window,"unload",f)},k=function(){chatter.getPublisher().setIsExtensionValidForSubmit(!0)},g=function(){return chatter.getPublisher().getHandler("ContentNote").editor.getData()},e=function(){var a=chatter.getPublisher().getHandler("ContentNote"),b=Sfdc.get(".noteTitleInput");Sfdc.Event.remove(b,"keyup",k);Sfdc.Event.remove(a.editor.root,
"keyup",k)};return d}());
function PollPostHelper(){function g(a){a=new LoadingScreen(a,LC.getLabel("Global","loading"));a.show();b=a}var e=chatter.getToolbox(),b=null;this.vote=function(a){var c=Ext.get(a),d=c.findParent(".pollauxiliarybody",null,!0);if(a=d.child(".pollchoices").child("input:checked")){a=a.dom.id;var b=Sfdc.Dom.getParent(d.dom,".cxfeeditem").id;e.disableButton(c);e.post({url:"/poll/choices/"+a+"/votes",params:{feeditemid:b},success:function(a,b){b.html&&Sfdc.Dom.updateHTML(d.dom,b.html)},failure:function(a,
b){e.enableButton(c)}})}else Dialogs.showSimpleError("",LC.getLabel("Feeds","PollNoChoiceSelectedVoteError"),null)};this.toggleView=function(a,c,d){var f=Ext.get(c).parent(".pollauxiliarybody");d&&g(f.dom);c=Sfdc.Dom.getParent(f.dom,".cxfeeditem").id;e.get({url:"/poll/"+c+"/",params:{viewtype:a},success:function(a,c){d&&(b.hide(),b=null);c.html&&Sfdc.Dom.updateHTML(f.dom,c.html)},failure:function(a,c){d&&(b.hide(),b=null)}})}}chatter.extend("PollPostHelper",PollPostHelper,null);
chatter.getPublisher().registerFeedItemTypeHandler("PollPost",function(){var k={config:{defaultNumChoicesDisplayed:2,minNumChoices:2,maxNumChoices:10,maxChoiceLength:100},state:{numChoicesShown:2},wiredFields:{},setupPanel:function(){this.config.promptText=LC.getLabel("Publisher","QuestionGhostPrompt");Sfdc.on(window,"unload",l)},validatePollChoices:function(){for(var a=chatter.getPublisher().getHandler("PollPost"),b=chatter.getToolbox(),d=LC.getLabel("Feeds","PollChoiceLengthError",a.config.maxChoiceLength),
c=Sfdc.select(".publisherpollchoiceinput"),e=c.length,f=!0,g=0;g<e;g++){var h=b.stringTrim(c[g].value),k=Sfdc.get(".errorMsg",Sfdc.Dom.getParent(c[g]));h?f=a.validateElement(k,function(){return h.length<=a.config.maxChoiceLength},d)&&f:Sfdc.Dom.addClass(k,"hidden")}return f},validateElement:function(a,b,d){if(b())return Sfdc.Dom.addClass(a,"hidden"),!0;Sfdc.Dom.updateHTML(a,d);Sfdc.Dom.removeClass(a,"hidden");return!1},removeEventsForPostType:function(){m()},focusFirstElement:function(){this.publisherCore.focusOnTextArea()},
onShowPanel:function(){chatter.getPublisher().getHandler("PollPost");this.publisherCore.setIsExtensionValidForSubmit(!1);for(var a=Sfdc.select("input.publisherpollchoiceinput"),b=a.length,d=chatter.getPublisher().getHandler("PollPost"),c=0;c<b;c++){var e=a[c];d.wiredFields[a[c].id]=e.value;Sfdc.Event.add(e,"keyup",n)}a=chatter.getPublisher().getTextArea();Sfdc.Event.add(a,"keyup",h);this.publisherCore.enablePublisher()},clearPanelState:function(){var a=this.config.defaultNumChoicesDisplayed;LC.getLabel("Publisher",
"MoreChoicesLabel");for(var b=Sfdc.select("div.publisherpollchoice"),d=b.length,c=0;c<d;c++){var e=b[c];c<a?Sfdc.get(".publisherpollchoiceinput",e).value="":e.parentNode.removeChild(e)}chatter.getPublisher().getHandler("PollPost").wiredFields={};a=Sfdc.get(".publisherpolladdchoice");Sfdc.Dom.show(a);k.state.numChoicesShown=k.config.defaultNumChoicesDisplayed;a=Sfdc.select(".errorMsg",Sfdc.get(".publisherpollchoices"));for(b=0;b<a.length;b++)Sfdc.Dom.setText(a[b],"")},getPayload:function(a){for(var b=
chatter.getToolbox(),d=this.publisherCore.getRawBody(),c=Sfdc.select(".publisherpollchoiceinput"),e=[],f=0;f<c.length;f++){var g=b.stringTrim(c[f].value);g&&e.push(g)}a.question=d;a.choices=e;return a},validatePayload:function(a){var b=chatter.getPublisher().getHandler("PollPost"),d=chatter.getToolbox(),c=a.choices.length;a=!(d.stringIsEmpty(a.question)||chatter.getPublisher().isPromptText(a.question));d=c>=b.config.minNumChoices;c=c<=b.config.maxNumChoices;return{isValid:a&&d&&c&&b.validatePollChoices(),
errorPayload:{questionPresent:a,hasMinNumChoices:d,hasLessThanMaxNumChoices:c}}},onValidationFailure:function(a){var b=chatter.getPublisher().getHandler("PollPost"),d=LC.getLabel("Feeds","PollTooFewChoicesError",b.config.minNumChoices);LC.getLabel("Feeds","PollTooManyChoicesError",b.config.maxNumChoices);var c=LC.getLabel("Feeds","PollQuestionRequiredError");a.questionPresent?a.hasMinNumChoices?a.hasLessThanMaxNumChoices||b.publisherCore.showErrors(c):b.publisherCore.showErrors(d):b.publisherCore.showErrors(c);
b.publisherCore.enablePublisher()},onSuccess:function(a,b){chatter.getPublisher().getHandler("PollPost");m()},onFailure:function(a,b){var d=chatter.getPublisher().getHandler("PollPost");b.errors&&d.publisherCore.showErrors(b.errors.message);d.publisherCore.enablePublisher()},addPollChoiceInputElement:function(a){var b=chatter.getPublisher().getHandler("PollPost"),d=Sfdc.get(".publisherpollchoice").cloneNode(!0),c=Sfdc.get(".publisherpollchoicelabel",d),e=Sfdc.get(".publisherpollchoiceinput",d);b.state.numChoicesShown++;
var f=p(e.getAttribute("id")),g=p(e.getAttribute("title"));Sfdc.Dom.set(e,{value:"",title:g,id:f});Sfdc.Dom.set(c,{attributes:{"for":f}});Sfdc.Dom.setText(c,g);b.state.numChoicesShown==b.config.maxNumChoices&&Sfdc.Dom.hideByDisplay(Sfdc.Dom.getParent(a,".publisherpolladdchoice"));a=Sfdc.get(".errorMsg",d);Sfdc.Dom.addClass(a,"hidden");Sfdc.Event.add(e,"keyup",n);Sfdc.get(".publisherpollchoices").appendChild(d);e.focus()}},l=function(){for(var a=Sfdc.select(".publisherpollchoiceinput"),b=0;b<a.length;b++)a[b].onfocus=
null;Sfdc.un(window,"unload",l)},n=function(){chatter.getPublisher().getHandler("PollPost").wiredFields[this.id]=this.value;h()},h=function(){chatter.getPublisher().getHandler("PollPost");chatter.getToolbox();var a=chatter.getPublisher();a.getRawBody();var b;if(b=!a.isTextBoxEmpty()&&!a.getHasTextareaErrors()){b=chatter.getToolbox();var d=chatter.getPublisher().getHandler("PollPost"),c=d.wiredFields,e=0,f;for(f in c)b.stringTrim(c[f])&&e++;b=e>=d.config.minNumChoices}b?a.setIsExtensionValidForSubmit(!0):
a.setIsExtensionValidForSubmit(!1)},m=function(){var a=chatter.getPublisher().getTextArea();Sfdc.Event.remove(a,"keyup",h)},p=function(a){var b=chatter.getPublisher().getHandler("PollPost");return a.replace(/\d/,b.state.numChoicesShown)};return k}());
PublisherVisibilityMessages=function(){};PublisherVisibilityMessages.getVisibilityMessages=function(a,d,f,b,g){d=PublisherVisibilityMessages.getLabels(a,d,f,UserContext.isDefaultNetwork,b,g);a={text:d.directedTo,title:LC.getLabel("ChatterVisibility","DirectedToTitle")};d={text:d.accessibleFrom,title:LC.getLabel("ChatterVisibility","AccessibleFromTitle")};return[a,d]};
PublisherVisibilityMessages.getLabels=function(a,d,f,b,g,k){var c=a.subjectId.substr(0,3),l="005"===c,h=a.subjectId===UserContext.userId,m="0F9"===c,e;b?(c=LC.getLabel("ChatterVisibility","TheAllCompanyFeed"),e=","):e=c="";l?k?(a=LC.getLabel("ChatterVisibility","DirectedToTopic"),b=LC.getLabel("ChatterVisibility","AccessibleFromTopic",c)):h||d?h?(a=LC.getLabel("ChatterVisibility","DirectedToYourProfile"),b=LC.getLabel("ChatterVisibility","AccessibleFromYourProfile",c,e)):(a=LC.getLabel("ChatterVisibility",
"DirectedToOtherUserProfile"),b=LC.getLabel("ChatterVisibility","AccessibleFromOtherUserProfile",c,e)):g?(a=LC.getLabel("ChatterVisibility","DirectedToOtherUserProfileWhenUserSharingEnabled"),b=b?LC.getLabel("ChatterVisibility","AccessibleFromOtherUserProfileWhenUserSharingEnabledCommunityZero",c):LC.getLabel("ChatterVisibility","AccessibleFromOtherUserProfileWhenUserSharingEnabledOtherCommunity")):(a=LC.getLabel("ChatterVisibility","DirectedToOtherUserProfile"),b=LC.getLabel("ChatterVisibility",
"AccessibleFromOtherUserProfile",c,e)):m?a.isExternalGroup?(a=LC.getLabel("ChatterVisibility","DirectedToExternalGroup"),b=LC.getLabel("ChatterVisibility","AccessibleFromPrivateGroup",c)):a.isPrivateGroup?(a=LC.getLabel("ChatterVisibility","DirectedToPrivateGroup"),b=LC.getLabel("ChatterVisibility","AccessibleFromPrivateGroup",c)):(a=LC.getLabel("ChatterVisibility","DirectedToPublicGroup"),b=LC.getLabel("ChatterVisibility","AccessibleFromPublicGroup",c)):"INTERNAL_USERS"==f?(a=LC.getLabel("ChatterVisibility",
"DirectedToRecordDetailEmployees"),b=LC.getLabel("ChatterVisibility","AccessibleFromRecordDetailEmployees",c)):(a=LC.getLabel("ChatterVisibility","DirectedToRecordDetailEveryone"),b=LC.getLabel("ChatterVisibility","AccessibleFromRecordDetailEveryone",c));return{directedTo:a,accessibleFrom:b}};
Sfdc.PublisherHandlers.createQuestionPostHandler=function(e){var a={isEdit:e};chatter.getToolbox().sitePrefix();a.config={allowRichText:!0,promptText:LC.getLabel("QuestionFeedItemPublisher","QuestionBodyGhostText")};a.setupPanel=function(b){var d=this,c="";this.config.questionTitleEl=Sfdc.get(e?".overlayDialog .publisherQuestionTitle":"publisherQuestionTitle");e?(this.config.questionTitleEl.id+="Edit",c=LC.getLabel("QuestionFeedItemPublisher","Save")):c=LC.getLabel("QuestionFeedItemPublisher","Ask");
this.config.questionTitleGhostText=LC.getLabel("QuestionFeedItemPublisher","QuestionTitleGhostText");this.config.submitValueAndTitle={value:c,title:c};var f={subjectId:chatter.getFeed().getConfig().subjectId};if(!e&&this.isDeflectionEnabled())chatter.onDeferLoad(function(){d.config.deflectionAutoCompleteComp=new DeflectionAutoComplete(d.config.questionTitleEl.id,chatter.getToolbox().sitePrefix()+"/_ui/deflection/QuestionDeflectionAutoCompleteServlet",f,chatter)});Sfdc.on(this.config.questionTitleEl,
"focus",function(){a.onFocus(d.config.questionTitleEl)});Sfdc.on(this.config.questionTitleEl,"blur",function(){a.onUnfocus(d.config.questionTitleEl)});Sfdc.on(this.config.questionTitleEl,"keyup",function(){a.publisherCore.setIsExtensionValidForSubmit(!a.isTitleEmptyOrPrompt())});e&&b&&(this.config.questionTitleEl.value=b.title||"",Sfdc.Dom.set(".overlayDialog .publishertextarea","title",this.config.promptText),this.publisherCore.setRawBody(b.bodyText,b.atMentions))};a.onFocus=function(b){this.isTitlePromptText()&&
(b.value="",Sfdc.userAgent.isSafari&&b.focus());Sfdc.Dom.addClass(b,"publisherQuestionTitlefocus")};a.onUnfocus=function(b){var a=this.isTitleEmptyOrPrompt();a&&(b.value=this.config.questionTitleGhostText,Sfdc.Dom.removeClass(b,"publisherQuestionTitlefocus"));this.publisherCore.setIsExtensionValidForSubmit(!a)};a.onShowPanel=function(){this.publisherCore.setIsExtensionValidForSubmit(!1)};a.onFailure=function(b,a){this.publisherCore.enablePublisher();var c=this.config.deflectionAutoCompleteComp;c&&
c.hideNoResultsMessage();a.errors&&Dialogs.showSimpleError("",a.errors.message,null)};a.focusFirstElement=function(){this.config.questionTitleEl.focus()};a.clearPanelState=function(){this.config.questionTitleEl.value="";this.onUnfocus(this.config.questionTitleEl);var b=this.config.deflectionAutoCompleteComp;b&&(b.clearSuggestions(),b.hideNoResultsMessage(),b.clearSQBox())};a.onSuccess=function(){var b=this.config.deflectionAutoCompleteComp;b&&(b.clearCache(),b.clearSuggestions(),b.hideNoResultsMessage(),
b.clearSQBox())};a.getPayload=function(b){var a=this.publisherCore.getRawBody();this.publisherCore.isPromptText(a)||(b.text=a);this.isTitleEmptyOrPrompt()||(b.title=this.config.questionTitleEl.value);return b};a.isDeflectionEnabled=function(){return"y"==Sfdc.Dom.getAttribute(this.config.questionTitleEl,"data-deflection","n")};a.isTitlePromptText=function(){return this.config.questionTitleEl.value==this.config.questionTitleGhostText};a.isTitleEmptyOrPrompt=function(){return 0==chatter.getToolbox().stringTrim(this.config.questionTitleEl.value).length||
this.isTitlePromptText()};a.modifyPublisherForDeflectionResults=function(){this.publisherCore.setIsExtensionValidForSubmit(!1)};a.modifyPublisherWithoutDeflectionResults=function(){this.publisherCore.setIsExtensionValidForSubmit(!this.isTitleEmptyOrPrompt())};a.validatePayload=function(){var b=!0,a={};this.isTitleEmptyOrPrompt()&&(b=!1,a={emptyQuestionTitle:!0});return{isValid:b,errorPayload:a}};a.onValidationFailure=function(a){var d=LC.getLabel("QuestionFeedItemPublisher","postTitleRequired");a.emptyQuestionTitle&&
this.publisherCore.showErrors(d);this.publisherCore.enablePublisher()};return a};chatter.getPublisher().registerFeedItemTypeHandler("QuestionPost",Sfdc.PublisherHandlers.createQuestionPostHandler());
chatter.getPublisher().registerFeedItemTypeHandler("RypplePost",function(){var m=null,b=null,f=null,h=null,r=null,l=null,n=null,p=null,B=function(a,b){for(;null!==a.firstChild;)a.removeChild(a.firstChild);a.appendChild(document.createTextNode(b))},s=function(){void 0===thanksRecipientContainer&&(thanksRecipientContainer=Sfdc.get("thanksRecipientContainer"))},C=function(){var a=Sfdc.get("thanksRecipientInputBox");a.value=LC.getLabel("Rypple_Publisher","recipientghosttextJS");Sfdc.Dom.addClass(a,UserAndGroupAutoCompleteInputElement.INPUTBOX_GHOSTTEXT_CSS_CLASS)},
u=function(){Sfdc.get("thanksRecipientInputBox").value=""},D=function(){s();return Sfdc.Dom.getElementXY(thanksRecipientContainer).y+Sfdc.Dom.getHeight(thanksRecipientContainer)},t=function(a){b.state.thanksRecipientid="";var c=Sfdc.get("thanksRecipientInputBox"),d=Sfdc.Dom.getParent(c),e=Sfdc.get("thanksRecipient");a=Sfdc.get(".item_"+a+"",e);Sfdc.Dom.removeChild(a);Sfdc.Dom.show(d);b.state.usernoaccesstogrp="";v();k();w();null!=a&&(b.state.ryppleThanksSuccess||(Sfdc.userAgent.isIE?window.setTimeout("Sfdc.get('thanksRecipientInputBox').focus()",
200):c.focus()))},y=function(a,c){if(b.state.thanksRecipientid!=UserContext.userId){b.state.thanksRecipientid=a;var d=Sfdc.get("thanksRecipientInputBox"),e=Sfdc.Dom.getParent(d),g='\x3cdiv userid\x3d"'+a+'" class\x3d"item_'+a+' item " tabindex\x3d"0"\x3e\x3cspan class\x3d"recipientName"\x3e'+c+'\x3c/span\x3e\x3cdiv class\x3d"rypple-thanksRecipientRemove"\x3e\x3ca href\x3d"javascript:void(0)" class\x3d"remove"\x3e\x3cimg src\x3d"/s.gif"/\x3e\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e',f=Sfdc.get("thanksRecipient"),
g=Sfdc.Dom.insertHTML(f,g);remove=Sfdc.get(".remove",g[0]);Sfdc.on(remove,"click",function(){t(a)});Sfdc.on(f,"keydown",function(b){if(b.keyCode==Sfdc.Event.keyCode.BACKSPACE||b.keyCode==Sfdc.Event.keyCode.DELETE)t(a),Sfdc.Event.stopPropagation(),d.focus()});Sfdc.Dom.hideByDisplay(e);k();x()}UserAndGroupAutoCompleteInputElement.needDefer()?u.defer(100):u();L();M(a,c)},k=function(){result=!1;if(!b.config.ryppleReturnedError){var a=f,c=Sfdc.get("thanksRecipient"),c=Sfdc.get(".recipientName",c),d=LC.getLabel("Rypple_Publisher",
"descriptionghosttextJS");""!=b.state.usernoaccesstogrp&&E(b.state.usernoaccesstogrp);result=null!=c&&null!=a.value&&a.value!=d&&0<a.value.length&&null==a.value.match(/^\s*$/)?!0:!1}b.publisherCore.setIsExtensionValidForSubmit(result)},L=function(){var a=Sfdc.get("thanksRecipientInputBox");Sfdc.Dom.set(a,"size",a.value.length+25);b.config.thankedWidget.acBox&&b.config.thankedWidget.acBox.setStyle("top",D()+"px")},N=function(){b.state.isRyppleAuthorized&&!b.state.badgesRetrieved&&(chatter.getToolbox().perfRemoveStats(),
chatter.getToolbox().perfMark("chatter_getBadges",b.state.perfLogLevel),chatter.getToolbox().get({url:"/workbadges",params:{},success:function(a,c){b.state.badgeHTML=c.html;b.state.badgesRetrieved=!0;chatter.getToolbox().perfEndMark("chatter_getBadges",b.state.perfLogLevel);chatter.getToolbox().submitAndResetPerfData()}}))},F=function(a,b){var d=Sfdc.select(".badgeSmallImage",a);if(d)for(var e={count:0,errors:0,elapsed:0},g=function(a,g){var h=function(a){var g=Date.now();a||e.errors++;e.count++;
e.count===d.length&&(e.elapsed=g-f,b(e))};g.onload=function(){h(!0)};g.onerror=function(){h(!1)};g.src=a},f=Date.now(),h=0;h<d.length;h++){var k=d[h],l=k.getAttribute("data-url");g(l,k)}else b()},z=function(){var a=Sfdc.get("badgeInfo");null!==a&&(b.state.badgeUrl=a.getAttribute("data-url"),b.state.badgeName=a.getAttribute("data-name"),b.state.badgeId=a.getAttribute("data-externalid"),b.state.badgeDescription=a.getAttribute("data-description"),!0!==b.state.defaultBadgeImageSet&&(Sfdc.Dom.set(Sfdc.get(".publisherBadge"),
"src",b.state.badgeUrl),b.state.defaultBadgeImageSet=!0))},w=function(){chatter.getTextareaMessageUtil().hideMessage({el:f.id,msg_id:"ryppleThanksFailed"});b.config.ryppleReturnedError=!1},v=function(){chatter.getTextareaMessageUtil().hideMessage({el:f.id,msg_id:"thanksRecipientWithoutAccess"})},E=function(a){var b=LC.getLabel("PublisherAutoComplete","allCannotReadNoEntitySingular"),b=b.replace("{0}",a),b=b.replace("{1}",m.getSubject().entityType);chatter.getTextareaMessageUtil().showMessage({el:f.id,
type:2,append:!0,msg_html:b,msg_id:"thanksRecipientWithoutAccess"})},M=function(a,c){var d=chatter.getFeed().config.feedType,d=["/feed/",b.state.subjectId,"/",d,"/checkaccess/",a].join("");chatter.getToolbox().get({url:d,success:function(d,g){!1===g[a]&&(b.state.usernoaccesstogrp=c,E(c))}})},G=function(){k()},H=function(){k()},I=function(){k()},x=function(){Sfdc.userAgent.isIE?window.setTimeout(function(){f.focus()},200):f.focus()},J=function(){b.state.isRyppleAuthorized&&(t(b.state.subjectId),b.state.defaultUserRetrieved?
""!=b.state.defaultUserName&&y(b.state.subjectId,b.state.defaultUserName):(b.state.subjectId=m.getSubjectId(),/^005/.test(b.state.subjectId)&&b.state.subjectId!=UserContext.userId&&chatter.getToolbox().get({url:"/userlookup",params:{subjectId:b.state.subjectId},success:function(a,c){if(0<c.name.length){var d=chatter.getToolbox().htmlEncode(c.name);y(b.state.subjectId,d);b.state.defaultUserRetrieved=!0;b.state.defaultUserName=d}}})))},A=function(a){Sfdc.Dom.addClass(l,"hidden");Sfdc.Dom.addClass(n,
"hidden");Sfdc.Dom.set(p,"innerHTML",a);Sfdc.Dom.removeClass(p,"hidden")},O=function(){if(null!==h){var a=h.value.trim();if(0===a.length||a===r)Sfdc.Dom.removeClass(l,"hidden"),Sfdc.Dom.addClass(n,"hidden"),Sfdc.Dom.addClass(p,"hidden");else if(1===a.length)A(LC.getLabel("Rypple_Badge","searchTermsLongerThanOneCharacter"));else{0===q.current()&&chatter.getToolbox().perfRemoveStats();var c=q.next(),d="chatter_searchBadgeDefinitions_"+c,e=function(e){chatter.getToolbox().perfEndMark(d,b.state.perfLogLevel);
q.add(c,{termsLength:a.length,imgStats:e});K("submitPerf",function(){var a=q.getStats();q.clearStats();chatter.getToolbox().submitAndResetPerfData(a)},1500)};chatter.getToolbox().perfMark(d,b.state.perfLogLevel);chatter.getToolbox().get({url:"/workbadges",params:{terms:a},success:function(a,b){var c=b.html.trim();0<c.length?(Sfdc.Dom.addClass(l,"hidden"),Sfdc.Dom.set(n,"innerHTML",c),Sfdc.Dom.removeClass(n,"hidden"),Sfdc.Dom.addClass(p,"hidden"),F(n,e)):(A(LC.getLabel("Rypple_Badge","searchNoBadgesFound")),
e({}))},failure:function(a,b){A(LC.getLabel("Rypple_Badge","searchNoBadgesFound"));e({})}})}}},K=function(){var a={};return function(b,d,e){var g=a[b];g&&clearTimeout(g);g=setTimeout(d,e);a[b]=g}}(),q=function(){var a=0,b={};return{current:function(){return a},next:function(){return++a},add:function(a,e){b["searchStats_"+a]=e},getStats:function(){return b},clearStats:function(){b={}}}}();return{config:{omnitureEvent:"postThanks",maxthanksRecipients:1,defaultTextAreaLines:7,maxBodyLength:978},state:{thanksRecipientid:"",
ryppleDialog:null,badgesRetrieved:!1,defaultUserRetrieved:!1,defaultUserName:"",isRyppleAuthorized:!1,ryppleReturnedError:!1,ryppleThanksSuccess:!1,perfLogLevel:"PRODUCTION",pickerInitialLoad:!1},setupPanel:function(){var a=Sfdc.get("thanksRecipientInputBox");if(null!==a){this.state.isRyppleAuthorized=null!=Sfdc.get("showingrypplethanks");s();var c=Sfdc.get("thanksRecipient");m=chatter.getPublisher();b=m.getHandler("RypplePost");b.config.maxBodyLength=m.DEFAULT_MAX_BODY_LENGTH-22;b.config.promptText=
LC.getLabel("Rypple_Publisher","descriptionghosttextJS");f=m.getTextArea();Sfdc.on(c,"click",function(){a.focus()});this.config.thankedWidget=new UserAndGroupAutoCompleteInputElement({elementId:"thanksRecipientInputBox",inDialog:!0,disableGhostText:!1,entityType:UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_USER,fixedACYPosition:0,ghostText:LC.getLabel("Rypple_Publisher","recipientghosttextJS"),handleSelect:function(a){y(a.itemId,a.itemName);this.complete()},getMinimumWidth:function(){s();return Sfdc.Dom.getWidth(thanksRecipientContainer)-
2},getACXPosition:function(){s();return Sfdc.Dom.getElementXY(thanksRecipientContainer).x},getACYPosition:function(){return D()}});this.config.thankedWidget.isValidSuggestion=function(a,b){return b.ItemId===UserContext.userId?!1:UserAndGroupAutoCompleteInputElement.prototype.isValidSuggestion.call(this,a,b)};Sfdc.on(a,"blur",function(){var c=Sfdc.get(".recipientName",a);b.config.thankedWidget.allowHideAC&&null==c&&(u(),C())});c=document.createElement("script");c.setAttribute("src","/soap/ajax/32.0/connection.js");
document.head.appendChild(c);c=Sfdc.get("thanks_publisher_render_error");null!==c&&chatter.getTextareaMessageUtil().showMessage({el:f.id,type:1,append:!0,msg_html:c.value,msg_id:"thanksPublisherRenderErrorMessage"})}},onShowPanel:function(){this.state.isRyppleAuthorized&&(z(),J(),C());N();f.disabled&&(f.disabled=!1);Sfdc.Event.add(f,"keyup",G);Sfdc.Event.add(f,"paste",H);Sfdc.Event.add(f,"blur",I);var a=Sfdc.get("publisherTextArea");Sfdc.Event.add(a,"click",x);k()},focusFirstElement:function(){Sfdc.get("thanksRecipientInputBox").focus()},
clearPanelState:function(){w();v();b.state.isRyppleAuthorized&&(t(b.state.thanksRecipientid),b.state.thanksRecipientid="",b.state.usernoaccesstogrp="",J(),z(),publisherBadgeImageElement=Sfdc.get(".publisherBadge"),Sfdc.Dom.set(publisherBadgeImageElement,"src",b.state.badgeUrl),Sfdc.Dom.set(publisherBadgeImageElement,"alt",b.state.badgeName),Sfdc.Dom.set(publisherBadgeImageElement,"title",b.state.badgeDescription));b.config.ryppleReturnedError=!1;b.state.ryppleThanksSuccess=!1},getPayload:function(a){chatter.getToolbox().perfMark("chatter_shareThanks",
b.state.perfLogLevel);a.thanked=b.state.thanksRecipientid;a.thankyounote=this.publisherCore.getRawBody();a.smallurl=b.state.badgeUrl;a.fullurl=b.state.badgeUrl;a.name=b.state.badgeName;a.externalid=b.state.badgeId;a.description=b.state.badgeDescription;return a},validatePayload:function(a){var c=chatter.getToolbox();null==a.thanked&&(a.thanked="");var c=!c.stringIsEmpty(a.thankyounote),d=a.thankyounote.length<=b.config.maxBodyLength,e=a.thankyounote!=b.config.promptText,g=0<a.thanked.length;a=void 0!==
a.externalid&&null!==a.externalid;return{isValid:g&&d&&e&&c&&a,errorPayload:{thankyounote:c,thankyounotetoobig:d,thankyounoteghosttext:e,thanked:g,badgeidempty:a}}},onValidationFailure:function(a){var c=LC.getLabel("Rypple_Publisher","ryppleThankedRequired"),d=LC.getLabel("Feeds","CommentMaxLengthErrorMsg",b.config.maxBodyLength+18),e=LC.getLabel("Rypple_Publisher","ryppleBadgeRequired");a.thanked?a.thankyounotetoobig?a.badgeidempty||this.publisherCore.showErrors(e):this.publisherCore.showErrors(d):
this.publisherCore.showErrors(c);b.publisherCore.enablePublisher()},onSuccess:function(a,c){b.state.ryppleThanksSuccess=!0;z();chatter.getToolbox().perfEndMark("chatter_shareThanks",b.state.perfLogLevel);chatter.getToolbox().submitAndResetPerfData()},onFailure:function(a,c){if(c.errors){b.config.ryppleReturnedError=!0;k();var d=c.errors.message;chatter.getTextareaMessageUtil().showMessage({el:f.id,type:1,append:!0,msg_html:d?d:LC.getLabel("Rypple_Publisher","ryppleThanksFailed"),msg_id:"ryppleThanksFailed"})}b.publisherCore.enablePublisher()},
removeEventsForPostType:function(){Sfdc.Event.remove(f,"keyup",G);Sfdc.Event.remove(f,"paste",H);Sfdc.Event.remove(f,"blur",I);var a=Sfdc.get("publisherTextArea");Sfdc.Event.remove(a,"click",x)},showRyppleDialog:function(){var a;chatter.getToolbox().perfMark("chatter_showRyppleDialog",b.state.perfLogLevel);if(null!==b.state.ryppleDialog)a=b.state.ryppleDialog;else{a=new SimpleDialog("rypple",!0);b.state.ryppleDialog=a;a.displayX=!0;a.register();var c=Sfdc.get(".badgeSelectorDialogContents");a.importContentNode(c);
Sfdc.Dom.removeClass(c,"hidden")}a.setTitle(LC.getLabel("Rypple_Badge","selectBadgeTitle"));a.setWidth("520px");a.setMinHeight("500px");c=Sfdc.get("ryppleContent");Sfdc.Dom.addClass(c,"ryppleBadgeContent");a.show();l=Sfdc.get(".allBadgesList");b.state.badgesRetrieved?Sfdc.Dom.set(l,"innerHTML",b.state.badgeHTML):Sfdc.Dom.set(l,"innerHTML",LC.getLabel("Global","loading"));h=Sfdc.get(".badgeListSearchInputElement");r=LC.getLabel("Rypple_Badge","searchGhostText");n=Sfdc.get(".searchResultsBadgesList");
p=Sfdc.get(".badgeSearchResultsMessage");Sfdc.on(h,"focus",function(){null!==h&&h.value===r&&(h.value="",Sfdc.Dom.removeClass(h,"ghostText"))});Sfdc.on(h,"blur",function(){null!==h&&""===h.value&&(h.value=r,Sfdc.Dom.addClass(h,"ghostText"))});Sfdc.on(h,"keyup",function(){K("search",O,200)});F(l,function(a){b.state.pickerInitialLoad||(chatter.getToolbox().perfEndMark("chatter_showRyppleDialog",b.state.perfLogLevel),chatter.getToolbox().submitAndResetPerfData({imgStats:a}),b.state.pickerInitialLoad||
(b.state.pickerInitialLoad=!0,chatter.getToolbox().get({url:"/workbadges",params:{pickerUsage:"1stLoad"}})),b.state.pickerInitialLoad=!0)})},displayBadgeList:function(){b.state.ryppleDialog.setTitle(LC.getLabel("Rypple_Badge","selectBadgeTitle"));var a=Sfdc.get(".ryppleBadgeList"),c=Sfdc.get(".ryppleBadgeDetail");Sfdc.Dom.addClass(c,"hidden");Sfdc.Dom.removeClass(a,"hidden")},displayBadgeDetail:function(a,c,d,e,g){b.state.ryppleDialog.setTitle(LC.getLabel("Rypple_Badge","infoBadgeTitle"));var f=Sfdc.get(".badgeTitle");
B(f,decodeURIComponent(c));Sfdc.Dom.set(f,"data-id",a);a=Sfdc.get(".badgeSelectionDescription");B(a,decodeURIComponent(d));d=Sfdc.get(".badgeLargeImage");Sfdc.Dom.set(d,"src",e);e=Sfdc.get(".ryppleBadgeList");Sfdc.Dom.addClass(e,"hidden");e=Sfdc.get(".ryppleBadgeDetail");Sfdc.Dom.removeClass(e,"hidden");Sfdc.get("ryppleContent").style.height="auto";e=Sfdc.get(".limitRemaining");d=Sfdc.get(".badgeLimitsSection");null===g?(Sfdc.Dom.set(e,"innerHTML",""),Sfdc.Dom.addClass(d,"hidden")):(Sfdc.Dom.set(e,
"innerHTML",g),Sfdc.Dom.removeClass(d,"hidden"))},updateSelectedBadge:function(){var a=Sfdc.get(".badgeTitle"),c=Sfdc.get(".badgeSelectionDescription"),d=Sfdc.get(".badgeLargeImage");Sfdc.get(".badgeTitle");var e=Sfdc.get(".badgeInfo");b.state.badgeUrl=Sfdc.Dom.get(d,"src");b.state.badgeName=Sfdc.Dom.get(a,"innerHTML");b.state.badgeId=Sfdc.Dom.get(a,"data-id");b.state.badgeDescription=Sfdc.Dom.get(c,"innerHTML");a=Sfdc.get(".publisherBadge");b.state.ryppleDialog.hide();Sfdc.Dom.set(a,"src",b.state.badgeUrl);
Sfdc.Dom.set(a,"alt",b.state.badgeName);Sfdc.Dom.set(a,"title",b.state.badgeDescription);Sfdc.Dom.set(e,"data-badgename",b.state.badgeName);w();v();k()},getVisibilityMessages:function(a){var b=[];a.isPrivateGroup&&b.push({title:LC.getLabel("WorkThanksInChatterVisibilityMessages","RecognitionVisibilityTitle"),text:LC.getLabel("WorkThanksInChatterVisibilityMessages","RecognitionAppearsOnWorkDotComProfile")});return b}}}());
Sfdc.PublisherHandlers.createTextPostHandler=function(c){return{isEdit:c,config:{omnitureEvent:"post",lastPastedLink:null,allowRichText:!0},setupPanel:function(a){if(null!=Sfdc.get("publisherAttachLinkPost"))Sfdc.on(Ext.get("publishereditablearea").dom,"paste",function(a){var c=this;window.setTimeout(function(){chatter.getToolbox().linkDetectionAndPublisherSwitch(c.value)},100)});c&&a&&(this.publisherCore.focusOnTextArea(),this.publisherCore.setRawBody(a.bodyText,a.atMentions))},onShowPanel:function(){this.publisherCore.setIsExtensionValidForSubmit(!0)},
onFailure:function(a,b){this.publisherCore.enablePublisher();b.errors&&Dialogs.showSimpleError("",b.errors.message,null)},focusFirstElement:function(){this.publisherCore.focusOnTextArea()},onSuccess:function(a,b){this.publisherCore.restoreDefaultUIState()},getPayload:function(a){var b=this.publisherCore.getRawBody();a.text=b;return a},validatePayload:function(a){var b=a.text;a.isRichText&&(b=chatter.getToolbox().getPlainTextData(b));return{isValid:!(chatter.getToolbox().stringIsEmpty(b)||this.publisherCore.isPromptText(a.text))}},
onValidationFailure:function(){this.publisherCore.resetPublisher();this.publisherCore.enablePublisher()}}};chatter.getPublisher().registerFeedItemTypeHandler("TextPost",Sfdc.PublisherHandlers.createTextPostHandler());
Sfdc.ns("Sfdc.CreateVFPublisherHandler");
Sfdc.CreateVFPublisherHandler=function(){function c(a){var b=chatter.getFeed();"undefined"!=typeof entityFeedPage?entityFeedPage.getApi().refresh(b.getConfig().subjectId,a):a.feed&&b.refresh({params:{subjectId:b.getConfig().subjectId},feedType:b.getConfig().feedType})}function e(a){Sfdc.resolve("Sfdc.EntityFeed.PublisherApi")&&Sfdc.EntityFeed.PublisherApi.selectAction(chatter.getFeed().getConfig().subjectId,a)}function f(a){Sfdc.resolve("Sfdc.EntityFeed.PublisherApi")&&Sfdc.EntityFeed.PublisherApi.setActionInputValues(chatter.getFeed().getConfig().subjectId,
a)}function g(a){Sfdc.resolve("Sfdc.EntityFeed.PublisherApi")&&Sfdc.EntityFeed.PublisherApi.invokeAction(chatter.getFeed().getConfig().subjectId,a)}function h(a){var b=d[a.actionName];b&&Sfdc.canvas.parent.publish({name:"publisher.customActionMessage",payload:a,target:{iframe:b.frameId}})}function k(a){if(Sfdc.resolve("Sfdc.EntityFeed.PublisherApi"))Sfdc.EntityFeed.PublisherApi.close(chatter.getFeed().getConfig().subjectId,a);else if(a.feed){var b=chatter.getFeed();b.close({params:{subjectId:b.getConfig().subjectId},
feedType:b.getConfig().feedType},a)}}var d={};this.registerFeedItemTypeHandler=function(a,b,c){d[c]={frameId:b};chatter.getPublisher().registerFeedItemTypeHandler("VisualforcePage",function(){Sfdc.onload(function(){if("undefined"!=typeof entityFeedPage)entityFeedPage.getApi().onRefresh(b,function(a){Sfdc.canvas.parent.publish({name:"publisher.refresh",payload:a,target:{iframe:b}})})});return{config:{},onFailure:function(){},onSuccess:function(){},getPayload:function(){},validatePayload:function(){},
onValidationFailure:function(){},setupPanel:function(){Sfdc.canvas.parent.publish({name:"publisher.setupPanel",payload:{},target:{iframe:b}})},clearPanelState:function(){Sfdc.canvas.parent.publish({name:"publisher.clearPanelState",payload:{},target:{iframe:b}})},onShowPanel:function(){Sfdc.canvas.parent.publish({name:"publisher.showPanel",payload:{},target:{iframe:b}})}}}(),{handlerId:a})};Sfdc.onload(function(){Sfdc.canvas.parent.subscribe({name:"publisher.refresh",onData:c});Sfdc.canvas.parent.subscribe({name:"publisher.selectAction",
onData:e});Sfdc.canvas.parent.subscribe({name:"publisher.setActionInputValues",onData:f});Sfdc.canvas.parent.subscribe({name:"publisher.invokeAction",onData:g});Sfdc.canvas.parent.subscribe({name:"publisher.customActionMessage",onData:h});Sfdc.canvas.parent.subscribe({name:"publisher.close",onData:k})})};var createVFPublisherHandler=new Sfdc.CreateVFPublisherHandler;
function VisibilityWidget(c){function h(){Sfdc.Dom.hideByDisplay(g());Sfdc.Event.fireEvent(g(),"visibilitybox:oncollapse",g());k=!1;Sfdc.un(document.body,"click",n)}function n(a){(a=Sfdc.Event.getEventTarget(a))&&(Sfdc.Dom.getParent(a,".visibilityWidgetParent")||h())}function g(){if(!e){var a=Sfdc.Dom.getParent(c.icon,".visibilityWidgetParent"),a=Sfdc.Dom.create(a);Sfdc.Dom.addClass(a,[r,"zen-sideNorth","zen-arrowCenter","zen-callout"]);var b=Sfdc.Dom.create(a,{},"b");Sfdc.Dom.addClass(b,["zen-arrow",
"vis-arrow"]);b=Sfdc.Dom.create(a);Sfdc.Dom.addClass(b,"zen-inner");var d=Sfdc.Dom.create(b);Sfdc.Dom.addClass(d,[q,"zen-body"]);b=Sfdc.Dom.create(b);Sfdc.Dom.addClass(b,"visibilityFooter");b=Sfdc.Dom.create(b,{href:s},"a");Sfdc.Dom.addClass(b,"visibilitylearnmorelink");Sfdc.Dom.setText(b,LC.getLabel("ChatterVisibility","LearnMore"));Sfdc.on(b,"keydown",t);e=a;Sfdc.on(c.icon,"keydown",u);Sfdc.on(document.body,"click",n);Sfdc.isFunction(c.onexpand)&&Sfdc.Event.add(e,"visibilitybox:onexpand",c.onexpand);
Sfdc.isFunction(c.oncollapse)&&Sfdc.Event.add(e,"visibilitybox:oncollapse",c.oncollapse)}return e}function u(a){a=window.event||a;a.shiftKey&&9===a.keyCode&&h()}function t(a){a=window.event||a;a.shiftKey&&9==a.keyCode||9===a.keyCode&&h()}var l=this;l.disabled=!1;var r="visibilityHelpContainer",q="visibilityHelpBody",k=!1,e,p,m=[],s=c.helpUrl;this.hideVisibilityBox=function(){k&&h()};this.registerHandler=function(a){m[m.length]=a};this.toggleDisplay=function(){if(!k&&!l.disabled){var a=Sfdc.Dom.create(null,
{},"ul"),b;b=[];for(var d,c=0;c<m.length;c++)d=m[c],d=d(),Sfdc.isArray(d)&&(b=b.concat(d));for(c=0;c<b.length;c++){d=b[c];var f=Sfdc.Dom.create(a,{},"li");Sfdc.Dom.addClass(f,"visibilityMessage");if(d.HTML)Sfdc.Dom.addClass(f,"visibilityCustomHTMLMsg"),Sfdc.Dom.updateHTML(f,d.HTML);else{var e=Sfdc.Dom.create(f,{},"h3");Sfdc.Dom.insertHTML(e,d.title);Sfdc.Dom.addClass(e,"visibilityMessageTitle");f=Sfdc.Dom.create(f);Sfdc.Dom.addClass(f,"visibilityMsgAnchor");Sfdc.Dom.insertHTML(f,d.text)}}p||(p=Sfdc.get("."+
q,g()));b=p;Sfdc.Dom.updateHTML(b,"");b.appendChild(a);Sfdc.Event.fireEvent(g(),"visibilitybox:onexpand",g());Sfdc.Dom.show(g());k=!0;Sfdc.on(document.body,"click",n)}else h()};this.disableWidget=function(){l.disabled=!0;Sfdc.Dom.addClass(c.icon,"disable")};this.enableWidget=function(){l.disabled=!1;Sfdc.Dom.removeClass(c.icon,"disable")}};
function VideoPreview(g,h,m,d){var k=m.replace("{0}",window.location.protocol);this.getVideoLinkTitle=function(){return d};this.getVideoUrl=function(){return k};this.getContainerId=function(){return g};this.getVideoId=function(){return h};this.getInlinePlayerUrl=function(){return window.location.protocol+"//www.youtube.com/embed/"+h+"?version\x3d3\x26autoplay\x3d1\x26rel\x3d0\x26fs\x3d1\x26autohide\x3d1\x26wmode\x3dtransparent\x26enablejsapi\x3d0"}}
function YoutubeVideo(){function g(a){var b=a.getVideoUrl();Sfdc.Ajax.crossDomainRequest(b,function(c){if(c=Sfdc.JSON.parseSafe(c)){var b=a.getContainerId(),l=c.error;if(b=Ext.get(b)){if(!l&&(b&&c.data)&&c.data.thumbnail){var f,d;if(c.data.title&&(f=a.getVideoLinkTitle(),d=b.child(".linkPostLinkTitleText").dom.innerHTML,"www.youtube.com"===f||"youtu.be"===f))d=f=c.data.title;k[b.parent().id]=a.getInlinePlayerUrl();var l=m(c.data.duration),g=b.child(".linkPostLink").dom.href;b.dom.innerHTML=h(c.data.thumbnail.sqDefault.replace("http",
"https"),l,"www.youtube.com","chatter.getYoutubeVideo().expandInlinePlayer(this);",f,d,g)}b.setDisplayed("block")}}},{})}function h(a,b,c,e,d,f,g){return q.replace("{2}",b).replace("{3}",c).replace("{6}",f).replace("{7}",d).replace("{9}",g).replace("{5}",e).replace("{4}",e).replace("{8}",d).replace("{0}",a)}function m(a){if(a){var b=parseInt(a/60);a=parseInt(a%60);var c;1>b&&(b="00");10>a&&(a="0"+a);return 60<b?(c=parseInt(b/60),b=parseInt(b%60),LC.getLabel("Feeds","lengthLong",c,b,a)):LC.getLabel("Feeds",
"lengthShort",b,a)}return""}var d=[],k=[],n=!1,p=!0,q='\x3cdiv class\x3d"videoImages"\x3e\x3cimg src\x3d"{0}" alt\x3d"{8}" class\x3d"thumbnail" onclick\x3d"{4}" title\x3d""\x3e\x3cspan class\x3d"play" onclick\x3d"{5}"\x3e\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d"videoLinkMetaClass"\x3e\x3cdiv class\x3d"videoLinkPostTitle"\x3e\x3ca href\x3d"{9}" title\x3d"{7}" target\x3d"_blank"\x3e{6}\x3c/a\x3e\x3c/div\x3e\x3cdiv class\x3d"videoLinkDescription"\x3e{3}\x3c/div\x3e\x3cdiv class\x3d"videoLinkLengthClass"\x3e{2}\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"clear"\x3e\x3c/div\x3e';
chatter.getEventBus().addEventListener("UIComponent:OverlayDialog","onBeforeOverlayShow",function(){Ext.select(".videoLinkPostOuterContainer \x3e iframe").remove();Ext.select(".videoLinkPostContainer").setDisplayed("block")});this.testInlinePlayer=function(a){a=Ext.get(a).parent().parent();var b=a.parent().id;a.setVisibilityMode(Ext.Element.DISPLAY);a.hide();Ext.DomHelper.append(b,{tag:"iframe",width:"420px",height:"300px",src:"",name:"youtubePlayer",frameborder:"0"})};this.setTestMode=function(a){n=
a};this.isRenderTypeVideoLinkPost=function(a){p=a};this.onPageLoaded=function(){Ext.EventManager.onDocumentReady(function(){chatter.getYoutubeVideo().fetchVideoPreviews()},null,null)};this.fetchVideoPreviews=function(){for(var a=d.length,b=0;b<a;b++){var c=d.shift();if(n){var e=c,c=Ext.get(e.getContainerId());if(p){k[c.parent().id]="";var l=m("10000"),e=e.getVideoLinkTitle(),f=c.child(".linkPostLinkTitleText").dom.innerHTML;if("www.youtube.com"===e||"youtu.be"===e)f=e="user did not enter url name";
c.dom.innerHTML=h(null,l,"www.youtube.com","chatter.getYoutubeVideo().testInlinePlayer(this);",e,f,"www.youtube.com")}}else g(c)}};this.appendToQueue=function(a){d.push(a)};this.expandInlinePlayer=function(a){a=Ext.get(a).parent().parent();var b=a.parent().id,c=k[b];a.setVisibilityMode(Ext.Element.DISPLAY);a.hide();Ext.DomHelper.append(b,{tag:"iframe",width:"420px",height:"300px",src:c,name:"youtubePlayer",frameborder:"0"})}}chatter.extend("YoutubeVideo",YoutubeVideo,null);
Sfdc.ns("Sfdc.SocialPostHandler");
Sfdc.SocialPostHandler=function(){this.registerFeedItemTypeHandler=function(b,k,m,n){chatter.getPublisher().registerFeedItemTypeHandler("SocialPostEvent",function(){function g(a){var c=Sfdc.get("editPage__"+b),e=c.parentNode;Sfdc.Dom.removeChild(c);Sfdc.Dom.insertHTML(e,a.htmlForm);(c=Sfdc.get("editPage__"+b))&&Sfdc.Resource.execScripts(Sfdc.Resource.getScriptsFromHtml(c));window.picklist&&(picklist.initialized=!1,picklist.initAll());SfdcCmp.init(Sfdc.get(".socialPubSenderContainer"))}var d={config:{omnitureEvent:"recordCreate",
urlMaxLen:1E3,urlNameMaxLen:255,disallowedLinkChars:/[\s\\]+/},state:{}};d.config.actionIdParam=b;d.config.formId=k;d.setupPanel=function(){Sfdc.onload(function(){window.picklist&&picklist.initAll()});var a=LC.getLabel("Publisher","Create");d.config.submitValueAndTitle={value:a,title:a}};d.clearPanelState=function(){};d.focusFirstElement=function(){var a=Sfdc.get("Content__"+b);if(a&&Sfdc.Dom.isVisible(a,!0))a.focus(),"number"==typeof a.selectionStart?a.selectionStart=a.selectionEnd=a.value.length:
"undefined"!=typeof a.createTextRange&&(a.focus(),a=a.createTextRange(),a.collapse(!1),a.select());else return!0};d.onShowPanel=function(){this.publisherCore.setIsExtensionValidForSubmit(!0);SfdcApp.social.publisher.onShowPanel(b)};d.onSuccess=function(a,c){var e=chatter.getEventBus();c.feedItemId&&"undefined"===typeof entityFeedPage&&e.fireEvent("chatter:publisher","onAfterUpdateStatus",{json:c});e.fireEvent("chatter:publisher","onAfterQuickActionSuccess",{json:c});e=chatter.getPublisher().getHandler(b);
g(c);e.publisherCore.enablePublisher()};d.onFailure=function(a,c){var e=chatter.getPublisher().getHandler(b);c.errors?e.publisherCore.showErrors(c.errors.message):c.htmlForm?g(c):a.isTimeout?e.publisherCore.showErrors(LC.getLabel("SocialPublisherSendingErrors","Timeout")):e.publisherCore.showErrors(LC.getLabel("SocialPublisherSendingErrors","UnknownException"));e.publisherCore.enablePublisher()};d.getPayload=function(a){a.actionIdParam=this.config.actionIdParam;for(var c=["input","select","textarea"],
e=document.getElementById(k),d=0;d<c.length;d++)for(var b=e.getElementsByTagName(c[d]),f=0;f<b.length;f++)if("checkbox"!=b[f].getAttribute("type")||b[f].checked)if("SELECT"==b[f].tagName){for(var g=[],l=b[f].options,h=0;h<l.length;h++)l[h].selected&&g.push(l[h].value);a[b[f].name]=g}else a[b[f].name]=b[f].value;a.save_new="Saving...";return a};d.postWithCustomFunction=function(a){a={url:"/quickcreate/social",params:a,failure:this.onFailure,success:this.onSuccess};"undefined"!==typeof entityFeedPage?
entityFeedPage.postObjectUpdate(chatter.getFeed().getConfig().subjectId,a):chatter.getToolbox().post(a)};return d}(),{handlerId:b});Sfdc.resolve("Sfdc.EntityFeed.QuickAction")&&Sfdc.EntityFeed.QuickAction.register({actionName:m,actionId:b,handlerId:b,formId:k,contextId:n})}};var socialPostHandler=new Sfdc.SocialPostHandler;
Sfdc.ns("Sfdc.AccessibleFileSharedWithListDialog");
Sfdc.AccessibleFileSharedWithListDialog=function(a){Sfdc.BaseAccessibleFileListDialog.call(this,a);this.id=a.id;this.title=a.title;this.dataLoadUrl=a.dataLoadUrl;this.docId=a.docId;this.height=a.height;this.sharedWithEntityType=a[EntitySharingConstants.SHAREDWITH_PARAM];this.areSharingTypesUpdatable=!1;this.fileOwnerID="";this.ghostMsg=LC.getLabel("ChatterFileSharing","optionalMsgGhostText");this.fileTitle=a.fileTitle;this.atMentionsOptionalMessage=null};
Ext.extend(Sfdc.AccessibleFileSharedWithListDialog,Sfdc.BaseAccessibleFileListDialog);Sfdc.AccessibleFileSharedWithListDialog.ID="chatterFileSharedWithListDialog";Sfdc.AccessibleFileSharedWithListDialog.INPUTBOX_ID="sharedWithInputBox";Sfdc.AccessibleFileSharedWithListDialog.MaxSharedLimit=100;Sfdc.AccessibleFileSharedWithListDialog.MaxVisibleRowNumber=3;Sfdc.AccessibleFileSharedWithListDialog.MAX_SHAREDWITH_PEOPLE_COUNT=9;Sfdc.AccessibleFileSharedWithListDialog.MAX_SHAREDWITH_PEOPLE_MSG_ID="maxSharedWithPeopleCntMsg";
Sfdc.AccessibleFileSharedWithListDialog.SHARING_TYPE_COLLABORATOR="C";Sfdc.AccessibleFileSharedWithListDialog.SHARING_TYPE_VIEWER="V";Sfdc.AccessibleFileSharedWithListDialog.SHARING_TYPE_INFERRED="I";Sfdc.AccessibleFileSharedWithListDialog.SHARING_TYPE_NOACCESS="N";Sfdc.AccessibleFileSharedWithListDialog.GROUP_ENTITY_PREFIX="0F9";Sfdc.AccessibleFileSharedWithListDialog.GROUP_ENTITY_PREFIX_MATCH="^0F9";Sfdc.AccessibleFileSharedWithListDialog.USER_ENTITY_PREFIX="005";
Sfdc.AccessibleFileSharedWithListDialog.USER_ENTITY_PREFIX_MATCH="^005";Sfdc.AccessibleFileSharedWithListDialog.WS_ENTITY_PREFIX="058";Sfdc.AccessibleFileSharedWithListDialog.WS_ENTITY_PREFIX_MATCH="^058";Sfdc.AccessibleFileSharedWithListDialog.sharingRowCounter=0;Sfdc.AccessibleFileSharedWithListDialog.MYENTITY_PREFIX_MATCH="0U0";Sfdc.AccessibleFileSharedWithListDialog.areSharingTypesUpdatable=!1;Sfdc.AccessibleFileSharedWithListDialog.chatterMessagesPerm=!1;
Sfdc.AccessibleFileSharedWithListDialog.isPrivateFile=!1;Sfdc.AccessibleFileSharedWithListDialog.MAX_COMPANY_NAME_LENGTH=10;Sfdc.AccessibleFileSharedWithListDialog.ENTITY_TYPE_ORGANIZATION="c";Sfdc.AccessibleFileSharedWithListDialog.shareWithButtonLocked=!1;Sfdc.AccessibleFileSharedWithListDialog.NOTIFICATION_EMAIL_PANEL_ID="notificationEmailPanelTextArea";Sfdc.AccessibleFileSharedWithListDialog.GROUP_STATUS_PUBLIC="public";Sfdc.AccessibleFileSharedWithListDialog.GROUP_STATUS_PRIVATE="private";
Sfdc.AccessibleFileSharedWithListDialog.isFileDetailPage=function(){return 0<Sfdc.select("body.FileDetailPage").length};Sfdc.AccessibleFileSharedWithListDialog.isChatterPageWithFeed=function(){return 0<Sfdc.select("body.homepage").length||0<Sfdc.select("body.ChatterPage").length&&0===Sfdc.select("div.chatterFileListView").length||0<Sfdc.select("body.UserProfilePage").length||0<Sfdc.select("body.GroupProfilePage").length};
Sfdc.AccessibleFileSharedWithListDialog.showDialog=function(a){Perf.mark(OverlayDialog.LOAD_MARK);var b=Sfdc.AccessibleFileSharedWithListDialog.ID,c=Sfdc.BaseAccessibleFileDialog.getDialogById(b);c?(c.dataLoadUrl=a.dataLoadUrl,c.docId=a.docId,c.setTitle(a.title),c.fileTitle=a.fileTitle,c.sharedWithEntityType=a[EntitySharingConstants.SHAREDWITH_PARAM]):(c={id:b,title:a.title,dataLoadUrl:a.dataLoadUrl,fileTitle:a.fileTitle,docId:a.docId,height:600},c[EntitySharingConstants.SHAREDWITH_PARAM]=a[EntitySharingConstants.SHAREDWITH_PARAM],
c=new Sfdc.AccessibleFileSharedWithListDialog(c),c.width=650,c.register());c.callback=a.callback;c.syncUpMainPage=!1;c.refreshMainPage=!1;b={};a[EntitySharingConstants.SHAREDWITH_PARAM]&&(b[EntitySharingConstants.SHAREDWITH_PARAM]=a[EntitySharingConstants.SHAREDWITH_PARAM]);a[EntitySharingConstants.SHARE_OPTION_PARAM_NAME]&&(b[EntitySharingConstants.SHARE_OPTION_PARAM_NAME]=a[EntitySharingConstants.SHARE_OPTION_PARAM_NAME]);c.open(b)};
Sfdc.AccessibleFileSharedWithListDialog.prototype.cancel=function(){Sfdc.AccessibleFileSharedWithListDialog.closeACList();Sfdc.AccessibleFileSharedWithListDialog.superclass.cancel.call(this)};
Sfdc.AccessibleFileSharedWithListDialog.showSharedWithList=function(a,b,c){HelpBubble.hideBubble("sharedWithGroupsAtMentionsHelpBubble",!0);a=Sfdc.AccessibleFileSharedWithListDialog.getFileTitle(a);var d=null!==a?LC.getLabel("ChatterFileSharing","sharingSettingWithFileTitle",a):LC.getLabel("ChatterFileSharing","sharingSetting");Sfdc.AccessibleFileSharedWithListDialog.closeACList();Sfdc.AccessibleFileSharedWithListDialog.showDialog({title:chatter.getToolbox().htmlEncode(d),docId:b,fileTitle:a,dataLoadUrl:c?
c:"/file/sharedwithlist/"})};Sfdc.AccessibleFileSharedWithListDialog.showSharedWithPeople=function(a,b,c,d,e,f){this.fileOwnerID=c;b=Sfdc.AccessibleFileSharedWithListDialog.getFileTitle(b);c=null!==b?LC.getLabel("ChatterFileSharing","shareWithPeopleWithFileTitle",b):LC.getLabel("ChatterFileSharing","shareWithPeople");f&&(c=LC.getLabel("ChatterFileSharing","shareInScope",c,f));Sfdc.AccessibleFileSharedWithListDialog.showSharedWithWizard(c,a,b,EntitySharingConstants.SHAREDWITH_PEOPLE,d,e)};
Sfdc.AccessibleFileSharedWithListDialog.showSharedWithGroups=function(a,b,c,d,e,f){this.fileOwnerID=c;b=Sfdc.AccessibleFileSharedWithListDialog.getFileTitle(b);c=null!==b?LC.getLabel("ChatterFileSharing","shareWithGroupsWithFileTitle",b):LC.getLabel("ChatterFileSharing","shareWithGroups");f&&(c=LC.getLabel("ChatterFileSharing","shareInScope",c,f));Sfdc.AccessibleFileSharedWithListDialog.showSharedWithWizard(c,a,b,EntitySharingConstants.SHAREDWITH_GROUPS,d,e)};
Sfdc.AccessibleFileSharedWithListDialog.showSharedWithLibrary=function(a,b,c,d,e,f,g,h,k){b=Sfdc.AccessibleFileSharedWithListDialog.buildShareWithLibraryUrl(g);Sfdc.ShareWithLibraryConfirmDialog.showDialogIfRequired({docId:a,shareWithLibraryUrl:b,shareWithLibraryConfirm:h,shareWithLibraryConfirmModal:k})};
Sfdc.AccessibleFileSharedWithListDialog.buildShareWithLibraryUrl=function(a){var b=window.location.pathname,c=window.location.search,d=window.location.hash;if(""===c||null===c){var e=b.split("/");if(e[1]&&"069"===e[1].substring(0,3)||e[2]&&"069"===e[2].substring(0,3))c="?so\x3dlst"}""!==d&&(b+=d);b=encodeURIComponent(b+c);return a+"?c\x3dp\x26retURL\x3d"+b};
Sfdc.AccessibleFileSharedWithListDialog.showSharedWithCompany=function(a,b,c,d,e){this.fileOwnerID=c;b=Sfdc.AccessibleFileSharedWithListDialog.getFileTitle(b);c=null!==b?LC.getLabel("ChatterFileSharing","shareWithCompanyWithFileTitle",b):LC.getLabel("ChatterFileSharing","shareWithCompany");Sfdc.AccessibleFileSharedWithListDialog.showSharedWithWizard(c,a,b,EntitySharingConstants.SHAREDWITH_COMPANY,d,e)};Sfdc.AccessibleFileSharedWithListDialog.getFileTitle=function(a){return null};
Sfdc.AccessibleFileSharedWithListDialog.showSharedWithWizard=function(a,b,c,d,e,f){this.areSharingTypesUpdatable=Sfdc.AccessibleFileSharedWithListDialog.areSharingTypesUpdatable;a={title:chatter.getToolbox().htmlEncode(a),docId:b,fileTitle:c,dataLoadUrl:e?e:"/file/sharedwithwizard/",callback:Sfdc.AccessibleFileSharedWithListDialog.callBack};a[EntitySharingConstants.SHAREDWITH_PARAM]=d;f&&(a[EntitySharingConstants.SHARE_OPTION_PARAM_NAME]=f);Sfdc.AccessibleFileSharedWithListDialog.showDialog(a)};
Sfdc.AccessibleFileSharedWithListDialog.clearInputText=function(){var a=Sfdc.get(Sfdc.AccessibleFileSharedWithListDialog.INPUTBOX_ID);a.blur();Sfdc.Dom.set(a,"value","");a.focus()};Sfdc.AccessibleFileSharedWithListDialog.getOptionalMessageLength=function(a){return 5E3};
Sfdc.AccessibleFileSharedWithListDialog.wireACBox=function(a,b){var c=a&&a===EntitySharingConstants.SHAREDWITH_GROUPS?UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_GROUP:UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_USER;new UserAndGroupAutoCompleteInputElement({servletURI:b,elementId:Sfdc.AccessibleFileSharedWithListDialog.INPUTBOX_ID,inDialog:!0,entityType:c,fixedACYPosition:0,zIndex:80200,handleSelect:function(a){var b=Sfdc.AccessibleFileSharedWithListDialog.hasEntityRow()?!1:!0;!Sfdc.AccessibleFileSharedWithListDialog.isNumberOfRowOverLimit()&&
!Sfdc.AccessibleFileSharedWithListDialog.isRowExist(a.itemId)&&Sfdc.AccessibleFileSharedWithListDialog.addEntityRow({itemID:a.itemId,itemName:a.itemName,itemTitle:a.itemTitle,itemPhoto:a.imageLink,entityType:c,badgeHtml:a.badgeHtml,imageHtml:a.imageHtml,itemPrivacy:a.itemPrivacy});this.select(a.rowIndex);this.complete();a=Sfdc.select(".overlayScrollList");0<a.length&&(a[0].scrollTop+=50);a=Sfdc.get(Sfdc.AccessibleFileSharedWithListDialog.INPUTBOX_ID);c===UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_GROUP?
(this.allowHideAC=!0,a.blur(),this.displayGhostText(),Sfdc.get(Sfdc.AccessibleFileSharedWithListDialog.NOTIFICATION_EMAIL_PANEL_ID).focus()):(this.allowHideAC=!0,b?(a.blur(),this.displayGhostText(),(b=Sfdc.select(".sharingOptionRadio"))&&0<b.length&&b[b.length-1].focus()):UserAndGroupAutoCompleteInputElement.needDefer()?Sfdc.AccessibleFileSharedWithListDialog.clearInputText.defer(100):Sfdc.AccessibleFileSharedWithListDialog.clearInputText())},handleBlur:function(){this.clearSuggestions();this.displayGhostText()},
handleFocusExtra:function(){if(Sfdc.AccessibleFileSharedWithListDialog.getSharedWithListDomElem().rows.length>=Sfdc.AccessibleFileSharedWithListDialog.MaxVisibleRowNumber){var a=Sfdc.select(".overlayScrollList");0<a.length&&(a[0].scrollTop=a[0].scrollHeight)}},getACYPosition:function(a){if(Sfdc.AccessibleFileSharedWithListDialog.getSharedWithListDomElem().rows.length<=Sfdc.AccessibleFileSharedWithListDialog.MaxVisibleRowNumber-1)this.fixedACYPosition=AutoCompleteInputElement.prototype.getACYPosition(a);
else{var b=Sfdc.select(".overlayScrollList"),c=0;0<b.length&&(c=b[0].scrollHeight-b[0].offsetHeight+3);this.fixedACYPosition=AutoCompleteInputElement.prototype.getACYPosition(a)-c}return this.fixedACYPosition}});Sfdc.get("shareHelpLinkElement").focus();addEvent(document.body,"keydown",function(a){getEvent(a).keyCode==KEY_ESC&&Sfdc.AccessibleFileSharedWithListDialog.closeACList()})};
Sfdc.AccessibleFileSharedWithListDialog.callBack=function(a,b){Sfdc.AccessibleFileSharedWithListDialog.areSharingTypesUpdatable="true"===b.areSharingTypesUpdatable?!0:!1;Sfdc.AccessibleFileSharedWithListDialog.chatterMessagesPerm="true"===b.chatterMessagesPerm?!0:!1;Sfdc.AccessibleFileSharedWithListDialog.isPrivateFile="true"===b.isPrivateFile?!0:!1;Sfdc.AccessibleFileSharedWithListDialog.CurrentEntities={};var c=b.sharedWithType===EntitySharingConstants.SHAREDWITH_COMPANY;if(c){var d=b.orgId;if(!d){alert(LC.getLabel("Feeds",
"GenericFailureNoGack"));return}Sfdc.Dom.addClass(Sfdc.get(Sfdc.AccessibleFileSharedWithListDialog.INPUTBOX_ID),"hidden");Sfdc.AccessibleFileSharedWithListDialog.areSharingTypesUpdatable?LC.getLabel("ChatterFileSharing","collaborator"):LC.getLabel("ChatterFileSharing","viewer");Sfdc.AccessibleFileSharedWithListDialog.addEntityRow({itemID:d,itemName:LC.getLabel("ChatterFileSharing","shareWithCompanyLabel"),itemTitle:"",itemPhoto:"/img/chatterfiles/sharewithcompany32x32.png",entityType:Sfdc.AccessibleFileSharedWithListDialog.ENTITY_TYPE_ORGANIZATION,
badgeHtml:""});var d=Sfdc.get("selectedPeopleToShareList"),e=Sfdc.get(".overlayListLink",d);Sfdc.Dom.hideByDisplay(e);Sfdc.AccessibleFileSharedWithListDialog.areSharingTypesUpdatable?(d.child(".shortSharedWithName").dom.setAttribute("title",""),d.child(".shortSharedWithName").removeClass("shortSharedWithName"),d.child(".displayNameWidthWithViewCollaborator").removeClass("displayNameWidthWithViewCollaborator")):(d.child(".longSharedWithName").dom.setAttribute("title",""),d.child(".longSharedWithName").removeClass("longSharedWithName"));
Sfdc.Dom.setText(Sfdc.get("sendEmailOptionLabel"),LC.getLabel("ChatterFileSharing","shareWithCompanyMessageLabel"));d.addClass("noBottomBorder")}else d="/myentity/"==a.substr(0,10)?"/chatter/handlers/myentity/shareAutoComplete":"/chatter/handlers/file/shareAutoComplete",Sfdc.AccessibleFileSharedWithListDialog.wireACBox(this.sharedWithEntityType,d);var f=Ext.fly(this.id).child(".optionalMsg"),g=this;if(f){var h=chatter.getToolbox(),k=Sfdc.AccessibleFileSharedWithListDialog.getOptionalMessageLength(this.sharedWithEntityType),
l=h.getElementErrorContainer(f);h.updateHTML(l,"");var q=LC.getLabel("Publisher","postValueMaxLen",k);f.on("focus",function(){f.dom.value==g.ghostMsg&&(f.dom.value="",f.removeClass("optionalMsgGhostText"))});f.on("blur",function(){""===f.dom.value&&(f.addClass("optionalMsgGhostText"),f.dom.value=g.ghostMsg)});f.on("keyup",function(){var a=h.stringTrim(f.getValue()).length,b=h.validateElement(l,function(){return a<=k},q)&&Sfdc.AccessibleFileSharedWithListDialog.hasEntityRow();Sfdc.AccessibleFileSharedWithListDialog.toggleShareWithButton(b)});
this.sharedWithEntityType===EntitySharingConstants.SHAREDWITH_GROUPS?(g.atMentionsOptionalMessage=new FileSharedWithAutoComplete(f.id),UserContext.userPreferences.getBoolean("HideAtMentionsHelpBubble")||HelpBubble.showAtMentionsInGroupFileSharingHelpBubble()):HelpBubble.hideBubble("sharedWithGroupsAtMentionsHelpBubble",!0)}if(c){f.setVisibilityMode(Ext.Element.DISPLAY).hide();var m=Sfdc.get(".sendEmailOption",Sfdc.get(this.id));Sfdc.Dom.removeClass(m,"hidden");if(m)Sfdc.on(m,"click",function(){f&&
(m.checked?f.setVisibilityMode(Ext.Element.DISPLAY).show():f.setVisibilityMode(Ext.Element.DISPLAY).hide())})}};Sfdc.AccessibleFileSharedWithListDialog.toggleShareWithButton=function(a,b){if("undefined"==typeof b){if(!0===Sfdc.AccessibleFileSharedWithListDialog.shareWithButtonLocked)return}else Sfdc.AccessibleFileSharedWithListDialog.shareWithButtonLocked=b;var c=Sfdc.get("fileSharedWithBtn"),d=chatter.getToolbox();a?d.enableButton(c):d.disableButton(c)};
Sfdc.AccessibleFileSharedWithListDialog.closeDialog=function(){var a=Sfdc.BaseAccessibleFileDialog.getDialogById(Sfdc.AccessibleFileSharedWithListDialog.ID);a&&a.closeDialog()};Sfdc.AccessibleFileSharedWithListDialog.nextPage=function(a,b,c){(a=sfdcPage.getDialogById(Sfdc.AccessibleFileSharedWithListDialog.ID))&&a.loadList({p:c+1})};Sfdc.AccessibleFileSharedWithListDialog.prevPage=function(a,b,c){(a=sfdcPage.getDialogById(Sfdc.AccessibleFileSharedWithListDialog.ID))&&a.loadList({p:c-1})};
Sfdc.AccessibleFileSharedWithListDialog.getEntityTypeForId=function(a){return a.substr(0,Sfdc.AccessibleFileSharedWithListDialog.MYENTITY_PREFIX_MATCH.length)==Sfdc.AccessibleFileSharedWithListDialog.MYENTITY_PREFIX_MATCH?"myentity":"file"};
Sfdc.AccessibleFileSharedWithListDialog.shareWithEntity=function(a,b,c){var d=LC.getLabel("ChatterFileSharing","sharingSetting",a);a=chatter.getToolbox();Sfdc.AccessibleFileSharedWithListDialog.toggleShareWithButton(!1,!0);var e="/"+Sfdc.AccessibleFileSharedWithListDialog.getEntityTypeForId(b)+"/sharedwithwizard/"+b+";create",f=Sfdc.BaseAccessibleFileDialog.getDialogById(Sfdc.AccessibleFileSharedWithListDialog.ID),g=Sfdc.get(".optionalMsg",Sfdc.get(f.id));g&&a.stringTrim(g.value)==f.ghostMsg&&(g.value=
"");g={};c&&(g[EntitySharingConstants.SHAREDWITH_PARAM]=c,c===EntitySharingConstants.SHAREDWITH_GROUPS&&Sfdc.isDefAndNotNull(f.atMentionsOptionalMessage)&&(g.optionalMsg=f.atMentionsOptionalMessage.getInputWithEncodedAtMentions()));a.post({url:e,params:g,form:"shareWithEntityForm",failure:function(a,b){Sfdc.AccessibleFileSharedWithListDialog.toggleShareWithButton(!1,!1);b&&!b.errormessage&&alert(LC.getLabel("Feeds","GenericFailureNoGack"))},success:function(a,e){Sfdc.AccessibleFileSharedWithListDialog.toggleShareWithButton(!1,
!1);try{f&&(f.setTitle(d),f.updateContent(e)),f.syncUpMainPage=!0,Sfdc.AccessibleFileSharedWithListDialog.updateTitle(b,e.isPrivate),c===EntitySharingConstants.SHAREDWITH_GROUPS&&HelpBubble.hideBubble("sharedWithGroupsAtMentionsHelpBubble",!0)}catch(g){}}})};Sfdc.AccessibleFileSharedWithListDialog.getSharedWithListDomElem=function(){return Sfdc.select(".overlayListTable")[0]};
Sfdc.AccessibleFileSharedWithListDialog.isNumberOfRowOverLimit=function(){return Sfdc.get(Sfdc.AccessibleFileSharedWithListDialog.getSharedWithListDomElem()).rows.length>=Sfdc.AccessibleFileSharedWithListDialog.MaxSharedLimit?!0:!1};Sfdc.AccessibleFileSharedWithListDialog.isRowExist=function(a){return Sfdc.AccessibleFileSharedWithListDialog.CurrentEntities[a]?!0:!1};
Sfdc.AccessibleFileSharedWithListDialog.deleteEntityRow=function(a,b,c){HelpBubble.hideBubble("sharedWithGroupsAtMentionsHelpBubble",!0);var d=Sfdc.AccessibleFileSharedWithListDialog.getSharedWithListDomElem().rows.length;Sfdc.Dom.removeChild(Sfdc.Dom.getParent(a,"tr"));delete Sfdc.AccessibleFileSharedWithListDialog.CurrentEntities[b];Sfdc.AccessibleFileSharedWithListDialog.toggleShareWithButton(Sfdc.AccessibleFileSharedWithListDialog.hasEntityRow());d===Sfdc.AccessibleFileSharedWithListDialog.MaxVisibleRowNumber&&
Sfdc.Dom.removeClass(Sfdc.get(Sfdc.select(".overlayList")[0]),"overlayScrollList");Sfdc.AccessibleFileSharedWithListDialog.showHideExternalUserLabel();c===UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_GROUP&&Sfdc.AccessibleFileSharedWithListDialog.showHidePublicGroupWarningLabel();c===UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_USER&&d==Sfdc.AccessibleFileSharedWithListDialog.MAX_SHAREDWITH_PEOPLE_COUNT&&Sfdc.AccessibleFileSharedWithListDialog.toggleMaxPeopleCountWarningMsg(!1)};
Sfdc.AccessibleFileSharedWithListDialog.hasEntityRow=function(){return 0<Sfdc.get(Sfdc.AccessibleFileSharedWithListDialog.getSharedWithListDomElem()).rows.length};
Sfdc.AccessibleFileSharedWithListDialog.addEntityRow=function(a){var b=Sfdc.get(Sfdc.AccessibleFileSharedWithListDialog.getSharedWithListDomElem());HelpBubble.hideBubble("sharedWithGroupsAtMentionsHelpBubble",!0);var c=b.rows.length,d=b.insertRow(c),e="";0<c&&(e=" notFirstRow");var f=a.itemTitle,g=a.itemName,h=a.entityType,k=document.createElement("td");k.className="overlayListPhoto"+e;k.setAttribute("valign","top");k.innerHTML=a.imageHtml?a.imageHtml:'\x3cimg width\x3d"32" height\x3d"32" title\x3d"'+
g+" - "+f+'" class\x3d"followerIcon" alt\x3d"'+g+" - "+f+'" src\x3d"'+a.itemPhoto+'"\x3e';var l=[];l.push('\x3cspan title\x3d"'+g+'" class\x3d"'+(!0===this.areSharingTypesUpdatable?"shortSharedWithName":"longSharedWithName")+'"\x3e');l.push(g);this.areSharingTypesUpdatable||l.push('\x3cinput type\x3d"hidden" name\x3d"'+EntitySharingConstants.ENTITY_ID+'" value\x3d"'+a.itemID+'"/\x3e');l.push("\x3c/span\x3e");l.push(a.badgeHtml);l.push("\x3cbr\x3e");l.push('\x3cspan title\x3d"'+f+'" class\x3d"titleSpan"\x3e'+
f+"\x3c/span\x3e");g=l.join("");f=document.createElement("td");f.className="overlayListName"+e;!0===this.areSharingTypesUpdatable&&(f.className+=" displayNameWidthWithViewCollaborator");h===Sfdc.AccessibleFileSharedWithListDialog.ENTITY_TYPE_ORGANIZATION&&(f.className+=" displayNameWidthWithCompanyShare");f.setAttribute("valign","top");f.innerHTML=g;g=document.createElement("td");g.className="overlayListLink"+e;l=h===UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_GROUP?LC.getLabel("ChatterFileSharing",
"removeGroup"):LC.getLabel("ChatterFileSharing","removePerson");g.innerHTML='\x3ca href\x3d"javascript:void(0);" onclick\x3d"Sfdc.AccessibleFileSharedWithListDialog.deleteEntityRow(this,\x26quot;'+a.itemID+"\x26quot;,\x26quot;"+h+'\x26quot);" title\x3d"'+l+'"\x3e\x3cimg alt\x3d"'+l+'" title\x3d"'+l+'" class\x3d"deleteIconClass" src\x3d"/s.gif"\x3e\x3c/a\x3e';d.appendChild(k);d.appendChild(f);d.appendChild(g);!0===this.areSharingTypesUpdatable&&(!0===(a.itemID===this.fileOwnerID?!0:!1)?(k=document.createElement("td"),
k.className="overlayListOwner"+e,e=document.createElement("span"),e.className="overlayOwnerSpan",f=document.createTextNode(LC.getLabel("ChatterFileSharing","alreadyOwner")),e.appendChild(f),f=document.createElement("input"),f.type="hidden",f.name=EntitySharingConstants.SHARING_TYPE+Sfdc.AccessibleFileSharedWithListDialog.sharingRowCounter,f.value=a.itemID+":"+Sfdc.AccessibleFileSharedWithListDialog.SHARING_TYPE_INFERRED,k.appendChild(e),k.appendChild(f),d.appendChild(k),k.setAttribute("colSpan","2")):
(k=EntitySharingConstants.SHARING_TYPE+Sfdc.AccessibleFileSharedWithListDialog.sharingRowCounter,f=document.createElement("td"),f.className="overlayListViewer"+e,g=document.createElement("td"),g.className="overlayListCollaborator"+e,Sfdc.userAgent.isIE8||Sfdc.userAgent.isIE7?(e=document.createElement('\x3cinput type\x3d"radio" name\x3d"'+k+'"\x3e'),l=document.createElement('\x3cinput type\x3d"radio" name\x3d"'+k+'"\x3e')):(e=document.createElement("input"),e.type="radio",e.name=k,l=document.createElement("input"),
l.type="radio",l.name=k),e.className="sharingOptionRadio",e.value=a.itemID+":"+Sfdc.AccessibleFileSharedWithListDialog.SHARING_TYPE_VIEWER,f.appendChild(e),l.className="sharingOptionRadio",l.value=a.itemID+":"+Sfdc.AccessibleFileSharedWithListDialog.SHARING_TYPE_COLLABORATOR,g.appendChild(l),d.appendChild(f),d.appendChild(g),h===UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_GROUP?a.itemPrivacy&&a.itemPrivacy===Sfdc.AccessibleFileSharedWithListDialog.GROUP_STATUS_PRIVATE?l.checked=!0:e.checked=
!0:h===Sfdc.AccessibleFileSharedWithListDialog.ENTITY_TYPE_ORGANIZATION?e.checked=!0:l.checked=!0));Sfdc.AccessibleFileSharedWithListDialog.CurrentEntities[a.itemID]=a;Sfdc.get("selectedPeopleToShareList").scrollTop+=50;Sfdc.AccessibleFileSharedWithListDialog.toggleShareWithButton(!0);c===Sfdc.AccessibleFileSharedWithListDialog.MaxVisibleRowNumber-1&&Sfdc.Dom.addClass(Sfdc.get(Sfdc.select(".overlayList")[0]),"overlayScrollList");Sfdc.AccessibleFileSharedWithListDialog.sharingRowCounter++;Sfdc.AccessibleFileSharedWithListDialog.showHideExternalUserLabel();
h===UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_GROUP&&!0===Sfdc.AccessibleFileSharedWithListDialog.isPrivateFile&&Sfdc.AccessibleFileSharedWithListDialog.showHidePublicGroupWarningLabel();h===UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_USER&&(c=b.rows.length,c==Sfdc.AccessibleFileSharedWithListDialog.MAX_SHAREDWITH_PEOPLE_COUNT&&Sfdc.AccessibleFileSharedWithListDialog.toggleMaxPeopleCountWarningMsg(!0))};
Sfdc.AccessibleFileSharedWithListDialog.toggleMaxPeopleCountWarningMsg=function(a){var b=Sfdc.get(Sfdc.AccessibleFileSharedWithListDialog.MAX_SHAREDWITH_PEOPLE_MSG_ID);b||(b=document.createElement("div"),b.id=Sfdc.AccessibleFileSharedWithListDialog.MAX_SHAREDWITH_PEOPLE_MSG_ID,b.className="maxSharedWithPeopleCntMsg",b.innerHTML=LC.getLabel("ChatterFileSharing","maxSharedWithPeopleCntMsg"),Sfdc.get("selectedPeopleToShareList").parentNode.appendChild(b),b=Sfdc.get(Sfdc.AccessibleFileSharedWithListDialog.MAX_SHAREDWITH_PEOPLE_MSG_ID));
a?(Sfdc.Dom.addClass(Sfdc.get(Sfdc.AccessibleFileSharedWithListDialog.INPUTBOX_ID),"hidden"),Sfdc.Dom.removeClass(b,"hidden")):(Sfdc.Dom.removeClass(Sfdc.get(Sfdc.AccessibleFileSharedWithListDialog.INPUTBOX_ID),"hidden"),Sfdc.Dom.addClass(b,"hidden"))};
Sfdc.AccessibleFileSharedWithListDialog.showHideExternalUserLabel=function(){for(var a=!1,b=Sfdc.select("span[class\x3dchatterUserGuestBadge]",Sfdc.get("selectedPeopleToShareList")),c=0;c<b.length;c++)if(b[c].innerHTML){var d=b[c].innerHTML;if(0<=d.indexOf(LC.getLabel("ChatterExternal","withGuests"))||0<=d.indexOf(LC.getLabel("ChatterExternal","privateWithGuests"))){a=!0;break}}a?Sfdc.Dom.removeClass(Sfdc.get("shareWithPeopleListHeader"),"hidden"):Sfdc.Dom.addClass(Sfdc.get("shareWithPeopleListHeader"),
"hidden")};Sfdc.AccessibleFileSharedWithListDialog.showHidePublicGroupWarningLabel=function(){var a=!1,b=Sfdc.get("selectedPeopleToShareList"),c=Sfdc.select("img.chatter-photo",b),b=Sfdc.select(".chatter-privateIcon",b);c.length>b.length&&(a=!0);a?(Sfdc.Dom.addClass(Sfdc.get("defaultWallPostLabel"),"hidden"),Sfdc.Dom.removeClass(Sfdc.get("publicWallPostLabel"),"hidden")):(Sfdc.Dom.removeClass(Sfdc.get("defaultWallPostLabel"),"hidden"),Sfdc.Dom.addClass(Sfdc.get("publicWallPostLabel"),"hidden"))};
Sfdc.AccessibleFileSharedWithListDialog.prototype.show=function(){Sfdc.BaseAccessibleFileDialog.prototype.show.call(this);this.dialog.style.top=getScrollTop()+this.dialog.offsetTop+"px";Sfdc.userAgent.isChrome&&window.scrollBy(0,1)};
Sfdc.AccessibleFileSharedWithListDialog.closeNoGroupMembershipOverlay=function(a,b,c){var d=location.href;0<d.indexOf("\x26so\x3dgrp")||0<d.indexOf("?so\x3dgrp")?Sfdc.BaseAccessibleFileListDialog.closeDialog("chatterFileSharedWithListDialog"):(Sfdc.BaseAccessibleFileListDialog.closeDialog("chatterFileSharedWithListDialog"),Sfdc.AccessibleFileSharedWithListDialog.showSharedWithList(a,b,c))};
Sfdc.AccessibleFileSharedWithListDialog.prototype.hook_cancel=function(){var a=Sfdc.BaseAccessibleFileDialog.getDialogById(this.id);HelpBubble.hideBubble("sharedWithGroupsAtMentionsHelpBubble",!0);if(a&&(!0===a.refreshMainPage||!0===a.syncUpMainPage)){var b=Sfdc.AccessibleFileSharedWithListDialog.isFileDetailPage(),c=Sfdc.AccessibleFileSharedWithListDialog.isChatterPageWithFeed();if(!0===a.refreshMainPage||!0===b||!0===c){var a=location.href,d;if(0<(b=a.indexOf("?fa\x3d"))||0<(b=a.indexOf("?so\x3d")))a=
0<(d=a.indexOf("\x26",b+4))?0<a.indexOf("?fa\x3d")?a.substr(0,b+1)+a.substr(d+1):a.substr(0,b)+a.substr(d):a.substr(0,b);navigateToUrl(a)}else Sfdc.ChatterFileFeedActions.resetDocUpload(a.docId)}};Sfdc.AccessibleFileSharedWithListDialog.PERM_DROPDOWN_ID="permissionDropdown";Sfdc.FileSharedWithPermissionDropdown=function(a,b){Sfdc.DropdownPanel.call(this,a,b)};Ext.extend(Sfdc.FileSharedWithPermissionDropdown,Sfdc.DropdownPanel);
Sfdc.FileSharedWithPermissionDropdown.prototype.initCustomEvents=function(){var a=this;addEvent(document.getElementById("sharedWithListScrollPanel"),"scroll",function(){a.close()})};Sfdc.FileSharedWithPermissionDropdown.prototype.getXY=function(a){var b=document.getElementById("sharedWithListScrollPanel"),c=0,d=0;Sfdc.userAgent.isIE8?(c=9,d=-1):Sfdc.userAgent.isIE7&&(c=10,d=0);return{x:a.x-14+d,y:a.y-b.scrollTop+c}};
Sfdc.FileSharedWithPermissionDropdown.prototype.getContent=function(a){var b=a.docId,c=a.sharedWithId,d=a.sharedFileOwnerId,e=a.isAdmin,f=a.shareId,g=a.isChatterFile,h=a.fileTitle,k=a.sharedWithName,l=a.isSharedWithPublicGroup,q=a.isGroupSharingAvailable;a=a.useStopLinkShareLabel;var m=[];m.push('\x3cdiv class\x3d"permissionLabelPanel"\x3e\x3ca onclick\x3d"Sfdc.AccessibleFileSharedWithListDialog.closePermissionDropdown(); return false;" href\x3d"javascript:void(0);"\x3e'+this.anchorElem.innerHTML+
"\x3c/a\x3e\x3c/div\x3e");var n=Sfdc.get("sharingOptionJSONStr"+c),p,t=[];if(n)for(var r=Sfdc.JSON.parse(n.innerHTML),n=r[EntitySharingConstants.SHARING_CURRENT_TYPE],s=0;s<r.sharingOption.length;s++){var k=r.sharingOption[s],u=k.sharingType,v=k.label;u[0]===Sfdc.AccessibleFileSharedWithListDialog.SHARING_TYPE_NOACCESS?(k=LC.getLabel("ChatterFileSharing","inYourCompanyLabel"),p='\x3cdiv class\x3d"permissionActionLinkPanel"\x3e\x3ca onclick\x3d"Sfdc.MakeFilePrivateConfirmDialog.showDialog({isChatterFile:\x26quot;'+
g+"\x26quot;, docId:\x26quot;"+b+"\x26quot;, fileTitle:\x26quot;"+escape(h)+"\x26quot;, sharedWithId:\x26quot;"+c+"\x26quot;, sharedWithName:\x26quot;"+k+"\x26quot;, shareId:\x26quot;"+f+"\x26quot;, isSharedWithPublicGroup:"+l+", isGroupSharingAvailable:"+q+", useStopLinkShareLabel:"+a+'}); return false;" class\x3d"permissionActionLink"\x3e\x3cspan class\x3d"permissionLabel"\x3e'+v+"\x3c/span\x3e\x3c/a\x3e\x3c/div\x3e"):t.push('\x3cdiv class\x3d"permissionActionLinkPanel"\x3e\x3ca onclick\x3d"Sfdc.AccessibleFileSharedWithListDialog.changeSharingType(\x26quot;'+
b+"\x26quot;, \x26quot;"+c+"\x26quot;, \x26quot;"+d+"\x26quot;, \x26quot;"+n+"\x26quot;, \x26quot;"+u+"\x26quot;, \x26quot;"+k.label+"\x26quot;, "+e+", \x26quot;"+f+'\x26quot;); return false;" class\x3d"permissionActionLink"\x3e\x3cspan class\x3d"permissionLabel"\x3e'+v+"\x3c/span\x3e\x3c/a\x3e\x3c/div\x3e")}p&&m.push(p);m=m.concat(t);if(Sfdc.userAgent.isIE7||Sfdc.userAgent.isIE8)m.push('\x3cdiv class\x3d"usid-roundedCornerDropdown usid-trDropdown"\x3e\x3c/div\x3e'),2==r.sharingOption.length?m.push('\x3cdiv class\x3d"usid-topSpacer usid-topSpacerThreeRows"\x3e'):
m.push('\x3cdiv class\x3d"usid-topSpacer"\x3e'),m.push('\x3cimg src\x3d"/s.gif" height\x3d"8"/\x3e\x3c/div\x3e'),m.push('\x3cdiv class\x3d"usid-roundedCornerDropdown usid-tlDropdown"\x3e\x3c/div\x3e'),m.push('\x3cdiv class\x3d"usid-roundedCornerDropdown usid-brDropdown"\x3e\x3c/div\x3e'),2==r.sharingOption.length?m.push('\x3cdiv class\x3d"usid-bottomSpacer usid-bottomSpacerThreeRows"\x3e'):m.push('\x3cdiv class\x3d"usid-bottomSpacer"\x3e'),m.push('\x3cimg src\x3d"/s.gif" height\x3d"8"/\x3e\x3c/div\x3e'),
m.push('\x3cdiv class\x3d"usid-roundedCornerDropdown usid-blDropdown"\x3e\x3c/div\x3e');return m.join("")};Sfdc.AccessibleFileSharedWithListDialog.getPermissionDropdown=function(){var a=Sfdc.DropdownPanel.getPanel(Sfdc.AccessibleFileSharedWithListDialog.PERM_DROPDOWN_ID);a||(a=new Sfdc.FileSharedWithPermissionDropdown(Sfdc.AccessibleFileSharedWithListDialog.PERM_DROPDOWN_ID,"sharedWithPermissionDropdown"));return a};
Sfdc.AccessibleFileSharedWithListDialog.showPermissionDropdown=function(a,b,c,d,e,f,g,h,k,l,q,m,n){var p=Sfdc.AccessibleFileSharedWithListDialog.getPermissionDropdown();p&&(b={docId:b,sharedWithId:c,sharingOptionJSONStr:d,sharedFileOwnerId:e,isAdmin:f,shareId:g,x:getObjX(a),y:getObjY(a),isChatterFile:h,fileTitle:k,sharedWithName:l,isSharedWithPublicGroup:q,isGroupSharingAvailable:m,useStopLinkShareLabel:n},p.show(a,b))};
Sfdc.AccessibleFileSharedWithListDialog.closePermissionDropdown=function(){var a=Sfdc.AccessibleFileSharedWithListDialog.getPermissionDropdown();a&&a.close()};Sfdc.AccessibleFileSharedWithListDialog.closeACList=function(){var a=Sfdc.get(Sfdc.AccessibleFileSharedWithListDialog.INPUTBOX_ID+TagAutoComplete.BOX_ID);a&&Sfdc.Dom.hideByDisplay(a)};
Sfdc.AccessibleFileSharedWithListDialog.changeSharingType=function(a,b,c,d,e,f,g,h){Sfdc.AccessibleFileSharedWithListDialog.closePermissionDropdown();a={docId:a,sharedWithId:b,currentType:d,type:e,label:f,syncUpMainPage:!1,shareId:h};f=UserContext.userId;f===c||g||d===Sfdc.AccessibleFileSharedWithListDialog.SHARING_TYPE_VIEWER&&e===Sfdc.AccessibleFileSharedWithListDialog.SHARING_TYPE_COLLABORATOR?Sfdc.AccessibleFileSharedWithListDialog.postSharingTypeChange(a):(f===b||b.match(Sfdc.AccessibleFileSharedWithListDialog.GROUP_ENTITY_PREFIX_MATCH)==
Sfdc.AccessibleFileSharedWithListDialog.GROUP_ENTITY_PREFIX)&&d===Sfdc.AccessibleFileSharedWithListDialog.SHARING_TYPE_COLLABORATOR&&e===Sfdc.AccessibleFileSharedWithListDialog.SHARING_TYPE_VIEWER||b.match(Sfdc.AccessibleFileSharedWithListDialog.USER_ENTITY_PREFIX_MATCH)!==Sfdc.AccessibleFileSharedWithListDialog.USER_ENTITY_PREFIX&&b.match(Sfdc.AccessibleFileSharedWithListDialog.WS_ENTITY_PREFIX_MATCH)!==Sfdc.AccessibleFileSharedWithListDialog.WS_ENTITY_PREFIX&&d===Sfdc.AccessibleFileSharedWithListDialog.SHARING_TYPE_INFERRED&&
e===Sfdc.AccessibleFileSharedWithListDialog.SHARING_TYPE_VIEWER?(a.syncUpMainPage=!0,Sfdc.ChangeSharingTypeConfirmDialog.showDialog(a)):Sfdc.AccessibleFileSharedWithListDialog.postSharingTypeChange(a)};
Sfdc.AccessibleFileSharedWithListDialog.postSharingTypeChange=function(a,b){var c=a.docId,d=a.sharedWithId,e=a.currentType,f=a.type,g=chatter.getToolbox(),c="/"+Sfdc.AccessibleFileSharedWithListDialog.getEntityTypeForId(c)+"/sharedwithwizard/"+c+";edit",h=Sfdc.BaseAccessibleFileDialog.getDialogById(Sfdc.AccessibleFileSharedWithListDialog.ID);e===Sfdc.AccessibleFileSharedWithListDialog.SHARING_TYPE_NOACCESS&&h&&(h.syncUpMainPage=!0);g.post({url:c,params:{st:f,reload:!0,eid:d,shareId:a.shareId},failure:function(a,
c){c&&!c.errormessage&&alert(LC.getLabel("Feeds","GenericFailureNoGack"));b&&b()},success:function(a,c){var d=!1;h&&h.updateContent(c);var d=!0,e=null;Sfdc.ChangeSharingTypeConfirmDialog.dialogExists()&&(e=OverlayDialogElement.getDialog(Sfdc.ChangeSharingTypeConfirmDialog.ID));d&&e&&(!0===e.syncUpMainPage&&h)&&(h.syncUpMainPage=!0);b&&b()}})};
Sfdc.AccessibleFileSharedWithListDialog.postSharingOptionChange=function(a,b){var c="A";!0===b&&(c="R");var d=chatter.getToolbox(),e="/"+Sfdc.AccessibleFileSharedWithListDialog.getEntityTypeForId(a)+"/sharedwithwizard/"+a+";edit",f=Sfdc.BaseAccessibleFileDialog.getDialogById(Sfdc.AccessibleFileSharedWithListDialog.ID);d.post({url:e,params:{reload:!0,fs:c},failure:function(a,b){b&&!b.errormessage&&alert(LC.getLabel("Feeds","GenericFailureNoGack"))},success:function(a,b){f&&f.updateContent(b)}})};
Sfdc.AccessibleFileSharedWithListDialog.updateTitle=function(a,b){a=ApiUtils.to18CharId(a);var c=Sfdc.get(a+"_title");if(c){var c=Sfdc.get(".fileTypeIcon",Sfdc.Dom.getParent(c,"div")),d=Sfdc.get(".filePrivateIcon",c);b?d||(d=Sfdc.Dom.create(document,!1,"img"),d.className="filePrivateIcon",d.src="/s.gif",c.appendChild(d)):d&&Sfdc.Dom.removeChild(d)}};Sfdc.ns("Sfdc.FileCollaborationConfirmDialog");
Sfdc.FileCollaborationConfirmDialog=function(a){this.id=a.id;this.docId=a.docId;this.windowName=a.id;this.setupDefaultButtons();this.addEvents();this.buttonContents=this.contents="";this.hasButtonsBar=!0};Ext.extend(Sfdc.FileCollaborationConfirmDialog,OverlayDialogElement);Sfdc.FileCollaborationConfirmDialog.prototype.makeContent=function(a){};
Sfdc.FileCollaborationConfirmDialog.prototype.showDialog=function(a){this.makeContent(a);this.isModal=!1;this.createContent();this.setWidth(540);this.show();a=Sfdc.get(Sfdc.AccessibleFileSharedWithListDialog.ID);Sfdc.Dom.hideByDisplay(a)};Sfdc.FileCollaborationConfirmDialog.prototype.cancel=function(){this.hide();var a=Sfdc.get(Sfdc.AccessibleFileSharedWithListDialog.ID);Sfdc.Dom.show(a)};Sfdc.ns("Sfdc.MakeFilePrivateConfirmDialog");
Sfdc.MakeFilePrivateConfirmDialog=function(a){Sfdc.FileCollaborationConfirmDialog.call(this,a);this.isChatterFile=a.isChatterFile};Ext.extend(Sfdc.MakeFilePrivateConfirmDialog,Sfdc.FileCollaborationConfirmDialog);Sfdc.MakeFilePrivateConfirmDialog.ID="makePrivateConfirmDialog";
Sfdc.MakeFilePrivateConfirmDialog.showDialog=function(a){Sfdc.AccessibleFileSharedWithListDialog.closePermissionDropdown();var b=null;document.getElementById(Sfdc.MakeFilePrivateConfirmDialog.ID)?b=OverlayDialogElement.getDialog(Sfdc.MakeFilePrivateConfirmDialog.ID):(a.id=Sfdc.MakeFilePrivateConfirmDialog.ID,b=new Sfdc.MakeFilePrivateConfirmDialog(a),b.register());b.showDialog(a)};
Sfdc.MakeFilePrivateConfirmDialog.prototype.makeContent=function(a){var b,c;a.sharedWithId?(b=LC.getLabel("ChatterFileSharing","stopSharing"),a.useStopLinkShareLabel?c=LC.getLabel("ChatterFileSharing","stopSharingViaLinkMsg","\x3cb\x3e"+escapeHTML(a.fileTitle)+"\x3c/b\x3e"):"00D"===a.sharedWithId.substr(0,3)?(c='\x3cdiv class\x3d"stopSharingWithCompany"\x3e'+LC.getLabel("ChatterFileSharing","stopSharingMsg",escapeHTML(unescape(a.fileTitle)),LC.getLabel("ChatterFileSharing","yourCompanyLabel"))+"\x3c/div\x3e",
a.isGroupSharingAvailable&&(c+='\x3cdiv class\x3d"stopSharingWithCompanyDescription"\x3e'+LC.getLabel("ChatterFileSharing","stopSharingWithCompany")+"\x3c/div\x3e")):"0DB"===a.sharedWithId.substr(0,3)?(c='\x3cdiv class\x3d"stopSharingWithCompany"\x3e'+LC.getLabel("ChatterFileSharing","stopSharingMsg",escapeHTML(unescape(a.fileTitle)),LC.getLabel("ChatterFileSharing","yourCommunityLabel"))+"\x3c/div\x3e",a.isGroupSharingAvailable&&(c+='\x3cdiv class\x3d"stopSharingWithCompanyDescription"\x3e'+LC.getLabel("ChatterFileSharing",
"stopSharingWithCommunity")+"\x3c/div\x3e")):c=LC.getLabel("ChatterFileSharing","stopSharingMsg","\x3cb\x3e"+escapeHTML(unescape(a.fileTitle))+"\x3c/b\x3e","\x3cb\x3e"+escapeHTML(a.sharedWithName)+"\x3c/b\x3e")):a.isChatterFile?(b=LC.getLabel("ChatterFileSharing","makePrivate"),c=LC.getLabel("ChatterFileSharing","makePrivateMsgForChatterFile")):(b=LC.getLabel("ChatterFileSharing","restrictAccess"),c=escapeHTML(LC.getLabel("ChatterFileSharing","makePrivateMsgForContentFile")));this.setTitle(b);this.isModal=
!1;var d=[];d.push('\x3cdiv class\x3d"makePrivateMsgPanel"\x3e');a.sharedWithId?d.push('\x3cdiv class\x3d"stopSharingMsg"\x3e'+c+"\x3c/div\x3e"):a.isChatterFile?(d.push('\x3cdiv class\x3d"makePrivateMsgIcon"\x3e\x3c/div\x3e'),d.push('\x3cdiv class\x3d"makePrivateMsgForChatterFile"\x3e'+c+"\x3c/div\x3e")):d.push('\x3cdiv class\x3d"makePrivateMsgForContentFile"\x3e'+c+"\x3c/div\x3e");d.push("\x3c/div\x3e");this.contents=d.join("");d=[];d.push('\x3cinput type\x3d"button" value\x3d"');a.sharedWithId?
d.push(LC.getLabel("ChatterFileSharing","stopSharing")):d.push(b);d.push('" class\x3d"'+ZenCss.btn+'"');d.push(' onclick\x3d"Sfdc.MakeFilePrivateConfirmDialog.execute(');d.push("{isChatterFile: ");d.push(a.isChatterFile?"true":"false");d.push(", docId: \x26quot;");d.push(a.docId);a.sharedWithId&&(d.push("\x26quot;, sharedWithId: \x26quot;"),d.push(a.sharedWithId));a.shareId&&(d.push("\x26quot;, shareId: \x26quot;"),d.push(a.shareId));d.push("\x26quot;}");d.push(');"/\x3e');d.push('\x3cinput type\x3d"button" value\x3d"');
d.push(LC.getLabel("Buttons","cancel"));d.push('" class\x3d"'+ZenCss.btn+'" onclick\x3d"Sfdc.MakeFilePrivateConfirmDialog.closeDialog();"/\x3e');this.buttonContents=d.join("")};Sfdc.MakeFilePrivateConfirmDialog.closeDialog=function(){OverlayDialogElement.getDialog(Sfdc.MakeFilePrivateConfirmDialog.ID).cancel()};
Sfdc.MakeFilePrivateConfirmDialog.execute=function(a){var b=chatter.getToolbox(),c="/"+Sfdc.AccessibleFileSharedWithListDialog.getEntityTypeForId(a.docId)+"/sharedwithwizard/"+a.docId+";delete",d=!1;a.sharedWithId&&(c+="?eid\x3d"+a.sharedWithId,d=!0);a.shareId&&(c=c+(d?"\x26":"?")+"shareId\x3d"+a.shareId);b.post({url:c,failure:function(a,b){b&&!b.errormessage&&alert(LC.getLabel("Feeds","GenericFailureNoGack"));Sfdc.MakeFilePrivateConfirmDialog.closeDialog()},success:function(b,c){try{var d=Sfdc.AccessibleFileSharedWithListDialog.isFileDetailPage();
if(c.url)if(d)navigateToUrl(c.url,null,Desktop.CLOSETAB_ACTION);else{var h=Sfdc.BaseAccessibleFileDialog.getDialogById(Sfdc.AccessibleFileSharedWithListDialog.ID);h.refreshMainPage=!0;Sfdc.MakeFilePrivateConfirmDialog.closeDialog();Sfdc.BaseAccessibleFileListDialog.closeDialog("chatterFileSharedWithListDialog")}else(h=Sfdc.BaseAccessibleFileDialog.getDialogById(Sfdc.AccessibleFileSharedWithListDialog.ID))&&h.updateContent(c),h.syncUpMainPage=!0,Sfdc.MakeFilePrivateConfirmDialog.closeDialog();var k=
Sfdc.AccessibleFileSharedWithListDialog.getSharedWithListDomElem().rows.length;Sfdc.AccessibleFileSharedWithListDialog.updateTitle(a.docId,2>k)}catch(l){}}})};Sfdc.ns("Sfdc.ChangeSharingTypeConfirmDialog");Sfdc.ChangeSharingTypeConfirmDialog=function(a){Sfdc.FileCollaborationConfirmDialog.call(this,a);this.isChatterFile=a.isChatterFile};Ext.extend(Sfdc.ChangeSharingTypeConfirmDialog,Sfdc.FileCollaborationConfirmDialog);Sfdc.ChangeSharingTypeConfirmDialog.ID="changeSharingTypeConfirmDialog";
Sfdc.ChangeSharingTypeConfirmDialog.dialogExists=function(){return document.getElementById(Sfdc.ChangeSharingTypeConfirmDialog.ID)?!0:!1};Sfdc.ChangeSharingTypeConfirmDialog.showDialog=function(a){var b=null;Sfdc.ChangeSharingTypeConfirmDialog.dialogExists()?b=OverlayDialogElement.getDialog(Sfdc.ChangeSharingTypeConfirmDialog.ID):(a.id=Sfdc.ChangeSharingTypeConfirmDialog.ID,b=new Sfdc.ChangeSharingTypeConfirmDialog(a),b.register());b.syncUpMainPage=a.syncUpMainPage;b.showDialog(a)};
Sfdc.ChangeSharingTypeConfirmDialog.prototype.makeContent=function(a){var b=LC.getLabel("ChatterFileSharing","changePermission"),c;c=a.sharedWithId.match(Sfdc.AccessibleFileSharedWithListDialog.GROUP_ENTITY_PREFIX_MATCH)==Sfdc.AccessibleFileSharedWithListDialog.GROUP_ENTITY_PREFIX?LC.getLabel("ChatterFileSharing","changeGroupPermissionAlert"):a.sharedWithId.match(Sfdc.AccessibleFileSharedWithListDialog.USER_ENTITY_PREFIX_MATCH)==Sfdc.AccessibleFileSharedWithListDialog.USER_ENTITY_PREFIX?LC.getLabel("ChatterFileSharing",
"changePeoplePermissionAlert"):LC.getLabel("ChatterFileSharing","changeRecordPermissionAlert");this.setTitle(b);this.isModal=!1;var d=[];d.push('\x3cdiv class\x3d"changePermissionMsgPanel"\x3e');d.push('\x3cdiv class\x3d"changePermissionMsg"\x3e'+c+"\x3c/div\x3e");d.push("\x3c/div\x3e");this.contents=d.join("");d=[];d.push('\x3cinput type\x3d"button" value\x3d"');d.push(b);d.push('" class\x3d"'+ZenCss.btn+'"');d.push(' onclick\x3d"Sfdc.ChangeSharingTypeConfirmDialog.execute(');d.push("{docId: \x26quot;");
d.push(a.docId);d.push("\x26quot;, sharedWithId: \x26quot;");d.push(a.sharedWithId);d.push("\x26quot;, type: \x26quot;");d.push(a.type);d.push("\x26quot;, label: \x26quot;");d.push(a.label);d.push("\x26quot;}");d.push(');"/\x3e');d.push('\x3cinput type\x3d"button" value\x3d"');d.push(LC.getLabel("Buttons","cancel"));d.push('" class\x3d"'+ZenCss.btn+'" onclick\x3d"Sfdc.ChangeSharingTypeConfirmDialog.closeDialog();"/\x3e');this.buttonContents=d.join("")};
Sfdc.ChangeSharingTypeConfirmDialog.closeDialog=function(){OverlayDialogElement.getDialog(Sfdc.ChangeSharingTypeConfirmDialog.ID).cancel()};Sfdc.ChangeSharingTypeConfirmDialog.execute=function(a){Sfdc.AccessibleFileSharedWithListDialog.postSharingTypeChange(a,Sfdc.ChangeSharingTypeConfirmDialog.closeDialog)};Sfdc.ns("Sfdc.ShareWithLibraryConfirmDialog");Sfdc.ShareWithLibraryConfirmDialog=function(a){Sfdc.FileCollaborationConfirmDialog.call(this,a)};Ext.extend(Sfdc.ShareWithLibraryConfirmDialog,Sfdc.FileCollaborationConfirmDialog);
Sfdc.ShareWithLibraryConfirmDialog.ID="shareWithLibraryConfirmDialog";
Sfdc.ShareWithLibraryConfirmDialog.showDialogIfRequired=function(a){Sfdc.AccessibleFileSharedWithListDialog.closePermissionDropdown();if(!a.shareWithLibraryConfirm)return Sfdc.BaseAccessibleFileDialog.getDialogById(Sfdc.AccessibleFileSharedWithListDialog.ID)&&Sfdc.BaseAccessibleFileListDialog.closeDialog(Sfdc.AccessibleFileSharedWithListDialog.ID),navigateToUrl(a.shareWithLibraryUrl),!1;var b=null;document.getElementById(Sfdc.ShareWithLibraryConfirmDialog.ID)?b=OverlayDialogElement.getDialog(Sfdc.ShareWithLibraryConfirmDialog.ID):
(a.id=Sfdc.ShareWithLibraryConfirmDialog.ID,b=new Sfdc.ShareWithLibraryConfirmDialog(a),b.displayX=!1,b.register());b.showDialog(a)};Sfdc.ShareWithLibraryConfirmDialog.prototype.showDialog=function(a){this.makeContent(a);this.isModal=a.shareWithLibraryConfirmModal;this.createContent();this.setWidth(540);this.show();this.isModal||(a=Sfdc.get(Sfdc.AccessibleFileSharedWithListDialog.ID),Sfdc.Dom.hideByDisplay(a))};
Sfdc.ShareWithLibraryConfirmDialog.prototype.makeContent=function(a){this.setTitle(escapeHTML(LC.getLabel("ChatterFileSharing","shareFileWithLibraryConfirmationHeader")));var b=escapeHTML(LC.getLabel("ChatterFileSharing","shareWithLibraryFileSyncedWarning")),c=LC.getLabel("Publisher","Share"),d=LC.getLabel("Buttons","cancel"),e=[];e.push('\x3cdiv class\x3d"confirmationMsgPanel"\x3e');e.push('\x3cdiv class\x3d"shareWithLibraryMsgIcon"\x3e\x3c/div\x3e');e.push('\x3cdiv class\x3d"shareWithLibraryWarningMsg"\x3e'+
b+"\x3c/div\x3e");e.push("\x3c/div\x3e");this.contents=e.join("");e=[];e.push("\x3cdiv\x3e");e.push('\x3cimg src\x3d"/s.gif" class\x3d"shareWithLibraryMsgIconSpacer"/\x3e');e.push('\x3cinput type\x3d"button" value\x3d"');e.push(c);e.push('" class\x3d"'+ZenCss.btn+'"');e.push(" onclick\x3d'Sfdc.ShareWithLibraryConfirmDialog.execute(");e.push("{docId: \x26quot;");e.push(a.docId);e.push("\x26quot;,");e.push("shareWithLibraryUrl: \x26quot;");e.push(a.shareWithLibraryUrl);e.push("\x26quot;});'/\x3e");
e.push('\x3cdiv style\x3d"width:5px;height:auto;display:inline-block;"\x3e\x3c/div\x3e');e.push('\x3cinput type\x3d"button" value\x3d"');e.push(d);e.push('" class\x3d"'+ZenCss.btn+'" onclick\x3d"Sfdc.ShareWithLibraryConfirmDialog.closeDialog(');e.push(a.shareWithLibraryConfirmModal);e.push(');"/\x3e');e.push("\x3c/div\x3e");this.buttonContents=e.join("")};
Sfdc.ShareWithLibraryConfirmDialog.closeDialog=function(a){OverlayDialogElement.getDialog(Sfdc.ShareWithLibraryConfirmDialog.ID).hide();a||(a=Sfdc.get(Sfdc.AccessibleFileSharedWithListDialog.ID),Sfdc.Dom.show(a))};Sfdc.ShareWithLibraryConfirmDialog.execute=function(a){Sfdc.ShareWithLibraryConfirmDialog.closeDialog(!0);Sfdc.BaseAccessibleFileDialog.getDialogById(Sfdc.AccessibleFileSharedWithListDialog.ID)&&Sfdc.BaseAccessibleFileListDialog.closeDialog(Sfdc.AccessibleFileSharedWithListDialog.ID);navigateToUrl(a.shareWithLibraryUrl)};
Sfdc.ns("Sfdc.MultiFileUploaderBase");
Sfdc.MultiFileUploaderBase=function(b){this.config={uploadActionUrl:"",statsActionUrl:"",params:{},uploadBtnAnchor:null,maxFileSize:0,maxFileSizeLabel:"",progressBarWidth:150,overallProgressBarWidth:250,onStartCallback:function(a,b){},onProgressCallback:function(a,b,d,e){},onCompleteCallback:function(a,b,d){},onCancelCallback:function(a,b){},onErrorCallback:function(a,b,d){},errMsg:{leavePage:LC.getLabel("ChatterFileMultiUpload","leavingUploadWarningMsg")}};Sfdc.MultiFileUploaderUtil.extend(this.config,b);
this.totalNumberOfFilesSelected=this.completedSize=this.selectedSize=this.filesInProgress=this.filesCompleted=this.filesSelected=0;this.uploadHandler=this.createUploadHandler();this.config.uploadBtnAnchor&&(this.uploadButton=this.hookupUploadButton(this.config.uploadBtnAnchor));this.uploadToFolderId=this.config.fldr;this.preventLeaveInProgress()};
Sfdc.MultiFileUploaderBase.prototype={uploadFiles:function(b){if(b){for(var a=0;a<b.length;a++)this.scheduleFileUpload(b[a]);this.afterAllFileUploadsScheduled()}},onStartHandler:function(b,a){this.filesInProgress++;this.filesSelected++;a&&(this.selectedSize+=a.size)},onProgressHandler:function(b,a,c,d){},onCompleteHandler:function(b,a,c){this.filesInProgress--;this.filesCompleted++;a&&(this.completedSize+=a.size)},onCancelHandler:function(b,a){this.filesInProgress--;this.filesSelected--;a&&(this.selectedSize-=
a.size)},onErrorHandler:function(b,a,c){},afterAllFileUploadsScheduled:function(){},scheduleFileUpload:function(b){this.totalNumberOfFilesSelected++;var a=this.uploadHandler.addToUploadList(b);!1!==this.config.onStartCallback(a,b)&&this.onStartHandler(a,b)&&(Sfdc.MultiFileUploaderUtil.checkFileSyncOption(),this.uploadHandler.scheduleUpload(a,{fileSync:Sfdc.ChatterFileUploader.isFileSync,filterParentId:this.filterParentId,fldr:this.uploadToFolderId,params:this.config.params}))},hookupUploadButton:function(b){var a=
this;return new Sfdc.UploadButton({uploadBtnAnchor:b,onChange:function(b){a.uploadFiles(b.files)}})},createUploadHandler:function(){var b=this;return new Sfdc.ChatterFileUploadHandler({uploadActionUrl:this.config.uploadActionUrl,uploader:this,onProgressCallback:function(a,c,d,e){b.onProgressHandler(a,c,d,e);b.config.onProgressCallback(a,c,d,e)},onCompleteCallback:function(a,c,d){b.onCompleteHandler(a,c,d);b.config.onCompleteCallback(a,c,d)},onCancelCallback:function(a,c){b.onCancelHandler(a,c);b.config.onCancelCallback(a,
c)},onErrorCallback:function(a,c,d){b.onErrorHandler(a,c,d);b.config.onErrorCallback(a,c,d)},customHandlers:this.config.customHandlers})},preventLeaveInProgress:function(){var b=this,a=this.config.errMsg.leavePage;Sfdc.on(window,"beforeunload",function(c){if(b.filesSelected!==b.filesCompleted)return c=c||window.event,c.returnValue=a})}};
Sfdc.ns("Sfdc.SWFUploadButton");Sfdc.SWFUploadButton=function(a){this.swfUrlPrefix=a.swfUrlPrefix;this.uploadDlgConfig=a.uploadDlgConfig;Sfdc.UploadButton.apply(this,arguments)};Sfdc.MultiFileUploaderUtil.extend(Sfdc.SWFUploadButton.prototype,Sfdc.UploadButton.prototype);Sfdc.SWFUploadButton.SWF_BUTTON_ID="multiFileUploaderSwfBtn";Sfdc.SWFUploadButton.SUPPORTED_FLASH_VERSION=11;
Sfdc.MultiFileUploaderUtil.extend(Sfdc.SWFUploadButton.prototype,{createInputBtn:function(){Sfdc.get("uploadFileButtonLink").innerHTML=LC.getLabel("ChatterFilesTabPage","uploadMultiFilesLinkText");var a=this.swfUrlPrefix+"/flex/MultiFileUploader.swf",b=Sfdc.MultiFileUploaderUtil.createElementFromHTML('\x3cdiv class\x3d"swfbtn-panel"\x3e\x3cdiv id\x3d"'+Sfdc.SWFUploadButton.SWF_BUTTON_ID+'"\x3e\x26nbsp;\x3c/div\x3e\x3c/div\x3e');this.uploadBtnAnchor.appendChild(b);swfobject.embedSWF(a,Sfdc.SWFUploadButton.SWF_BUTTON_ID,
"100%","100%",Sfdc.SWFUploadButton.SUPPORTED_FLASH_VERSION.toString(),"",{},{codebase:"http://fpdownload.macromedia.com/get/flashplayer/current/swflash.cab",src:a,quality:"high",play:"true",loop:"false",pluginspage:"http://www.adobe.com/go/getflashplayer",name:Sfdc.SWFUploadButton.SWF_BUTTON_ID,allowScriptAccess:"sameDomain",movie:a,type:"application/x-shockwave-flash",wmode:"transparent"});return b}});
Sfdc.ns("Sfdc.SingleUploadButton");Sfdc.SingleUploadButton=function(a){Sfdc.UploadButton.apply(this,arguments)};Sfdc.MultiFileUploaderUtil.extend(Sfdc.SingleUploadButton.prototype,Sfdc.UploadButton.prototype);
Sfdc.MultiFileUploaderUtil.extend(Sfdc.SingleUploadButton.prototype,{createInputBtn:function(){var a=this.createHiddenInputBtn();addEvent(a,"mouseover",function(){var b=a.parentNode.firstChild;b&&Sfdc.Dom.addClass(b,"ahover")});addEvent(a,"mouseout",function(){var b=a.parentNode.firstChild;b&&Sfdc.Dom.removeClass(b,"ahover")});return a}});
Sfdc.ns("Sfdc.MultiFileUploaderUiComponents.FileUploadBadgeList");
Sfdc.MultiFileUploaderUiComponents.FileUploadBadgeList=function(a){this.fileUploadListContainerId=a.fileUploadListContainerId;this.fileUploadListContainerElem=document.getElementById(this.fileUploadListContainerId);this.fileUploadListContainerElem.innerHTML=Sfdc.MultiFileUploaderUiComponents.FileUploadBadgeList.HTML_TEMPLATE;this.fileUploadListElem=a.fileUploadListElem||Sfdc.get("multifile-upload-list",this.fileUploadListContainerElem);this.cancelFileUploadCallback=a.cancelFileUploadCallback;this.idToFileUploadBadge=
{};this.setupCancelAction()};Sfdc.MultiFileUploaderUiComponents.FileUploadBadgeList.HTML_TEMPLATE='\x3cul id\x3d"multifile-upload-list" class\x3d"multifile-upload-list"\x3e\x3c/ul\x3e';Sfdc.MultiFileUploaderUiComponents.FileUploadBadgeList.prototype.setupCancelAction=function(){var a=this;addEvent(this.fileUploadListElem,"click",function(b){b=b||window.event;var c=b.target||b.srcElement;Sfdc.Dom.hasClass(c,"deleteIconClass")&&(a.preventDefault(b),a.cancelFileUploadCallback(c.parentNode.parentNode))})};
Sfdc.MultiFileUploaderUiComponents.FileUploadBadgeList.prototype.preventDefault=function(a){a.preventDefault?a.preventDefault():a.returnValue=!1};
Sfdc.MultiFileUploaderUiComponents.FileUploadBadgeList.prototype.add=function(a){this.idToFileUploadBadge[a.dom.mfuFileId]=a;this.fileUploadListElem.appendChild(a.dom);a=Ext.fly(this.fileUploadListContainerId);var b=a.parent(".overlayDialog ").dom,c=b.id,b=b.offsetTop+b.offsetHeight,d=Sfdc.Window.getWindowHeight();b>d&&(b-=d,d=a.getHeight(),d>b&&a.setHeight(d-b),a.setStyle("overflow-y","auto"),c&&(a=sfdcPage.getDialogById(c))&&a.position())};
Sfdc.MultiFileUploaderUiComponents.FileUploadBadgeList.prototype.get=function(a){return this.idToFileUploadBadge[a]};
Sfdc.ns("Sfdc.CreateCanvasPublisherHandler");
Sfdc.CreateCanvasPublisherHandler=function(){this.registerFeedItemTypeHandler=function(e){chatter.getPublisher().registerFeedItemTypeHandler("CanvasPost",function(){return{config:{},setupPanel:function(){Sfdc.canvas.parent.publish({name:"publisher.setupPanel",payload:{},target:{canvas:e}})},clearPanelState:function(){Sfdc.canvas.parent.publish({name:"publisher.clearPanelState",payload:{},target:{canvas:e}})},onShowPanel:function(){var a=this.publisherCore;Sfdc.canvas.parent.publish({name:"publisher.showPanel",
payload:{},target:{canvas:e}});Sfdc.canvas.parent.subscribe({name:"publisher.setValidForSubmit",onData:function(c){a.setIsExtensionValidForSubmit(c)}});a.setIsExtensionValidForSubmit(!1)},onSuccess:function(){Sfdc.canvas.parent.publish({name:"publisher.success",payload:{},target:{canvas:e}})},onFailure:function(a,c){var d=this.publisherCore;"undefined"!==typeof d&&"undefined"!==typeof d.setIsExtensionValidForSubmit&&d.setIsExtensionValidForSubmit(!1);Sfdc.canvas.parent.publish({name:"publisher.failure",
payload:c,target:{canvas:e}})},getPayload:function(a,c){var d=this.publisherCore,f=d.getRawBody();a.text=d.isPromptText(f)?"":f;Sfdc.canvas.parent.publish({name:"publisher.getPayload",payload:a,target:{canvas:e}});Sfdc.canvas.parent.subscribe({name:"publisher.setPayload",onData:function(b){a.feedItemType=b.feedItemType;"CanvasPost"===b.feedItemType?(a.auxText=b.auxText,a.namespacePrefix=b.namespace,a.developerName=b.developerName,a.title=b.title,a.height=b.height,a.parameters=chatter.getToolbox().htmlEncode(b.parameters),
a.description=b.description,a.thumbnailUrl=b.thumbnailUrl):(Sfdc.isEmpty(b.auxText)||(a.text=a.text+"\n\n"+b.auxText),"LinkPost"===b.feedItemType&&(a.url=b.url,a.urlName=b.urlName));c(a)}});return{isValid:!0,isAsync:!0,errorPayload:{}}},validatePayload:function(a){var c=!0,d={validFeedItemType:!0};"TextPost"!==a.feedItemType&&("LinkPost"!==a.feedItemType&&"CanvasPost"!==a.feedItemType)&&(d.validFeedItemType=!1,d.feedItemType=a.feedItemType,c=!1);return{isValid:c,errorPayload:d}},onValidationFailure:function(a){var c=
this.publisherCore;a.validFeedItemType||(a={errors:{message:LC.getLabel("CanvasPublisher","invalidFeedItemType",a.feedItemType)}},Sfdc.canvas.parent.publish({name:"publisher.failure",payload:a,target:{canvas:e}}));c.enablePublisher()}}}(),{handlerId:e})}};var createCanvasPublisherHandler=new Sfdc.CreateCanvasPublisherHandler;
Sfdc.ns("Sfdc.AccessibleFilePublicLinksDialog");Sfdc.AccessibleFilePublicLinksDialog=function(a){Sfdc.BaseAccessibleFileListDialog.call(this,a);this.id=a.id;this.title=a.title;this.docId=a.docId;this.fileTitle=a.fileTitle;this.versionId=a.versionId;this.height=a.height;this.width=525};Sfdc.AccessibleFilePublicLinksDialog.prototype=new Sfdc.BaseAccessibleFileListDialog({});Sfdc.AccessibleFilePublicLinksDialog.ID="chatterFilePublicLinkDialog";Sfdc.AccessibleFilePublicLinksDialog.DATA_LOAD_URL="/file/publiclinks/";
Sfdc.AccessibleFilePublicLinksDialog.showDialog=function(a,b,c,d){c=Sfdc.AccessibleFileSharedWithListDialog.getFileTitle(c);var e=Sfdc.isDefAndNotNull(c)?LC.getLabel("ChatterFilePublicLink","createPublicLinkWithFileTitle",c):LC.getLabel("ChatterFilePublicLink","createPublicLink");d&&(e=LC.getLabel("ChatterFileSharing","shareInScope",e,d));Perf.mark(OverlayDialog.LOAD_MARK);chatter.getEventBus().addEventListener("chatter:files","onAfterPublicLinkDialogOpen",Sfdc.AccessibleFilePublicLinksDialog.highLightLink);
sfdcPage.getDialogById(Sfdc.AccessibleFileSharedWithListDialog.ID)&&Sfdc.Dom.hideByDisplay(Sfdc.get(Sfdc.AccessibleFileSharedWithListDialog.ID));var f=Sfdc.AccessibleFilePublicLinksDialog.ID;d=sfdcPage.getDialogById(f);a={id:f,title:chatter.getToolbox().htmlEncode(e),docId:a,versionId:b,fileTitle:c};d||(d=new Sfdc.AccessibleFilePublicLinksDialog(a),d.register());d.open(a)};
Sfdc.AccessibleFilePublicLinksDialog.highLightLink=function(){setTimeout(function(){var a=Sfdc.get("overrideInput");a&&(a.focus(),a.select())},100)};
Sfdc.AccessibleFilePublicLinksDialog.hideShowLinkDetail=function(){var a=Sfdc.get("linkSettingDetailDiv"),b=Sfdc.get("linkSettingHeader_icon");Sfdc.Dom.isVisible(a)?(Sfdc.Dom.addClass(a,"hidden"),Sfdc.Dom.removeClass(b,"publicLinkSetupImageExpand"),Sfdc.Dom.addClass(b,"publicLinkSetupImageCollapse")):(Sfdc.Dom.removeClass(a,"hidden"),Sfdc.Dom.removeClass(b,"publicLinkSetupImageCollapse"),Sfdc.Dom.addClass(b,"publicLinkSetupImageExpand"))};Sfdc.AccessibleFilePublicLinksDialog.needRefresh=!1;
Sfdc.AccessibleFilePublicLinksDialog.copyLinkForIE=function(){var a=Sfdc.get("overrideInput").value;window.clipboardData.setData("text",a)};
Sfdc.AccessibleFilePublicLinksDialog.prototype.clickShareBtn=function(a){this.hide();Sfdc.AccessibleFileSharedWithListDialog.showSharedWithList(this.fileTitle,this.docId);Sfdc.AccessibleFileSharedWithListDialog.updateTitle(this.docId,!1);var b=Sfdc.BaseAccessibleFileDialog.getDialogById(Sfdc.AccessibleFileSharedWithListDialog.ID);a||(Sfdc.AccessibleFilePublicLinksDialog.needRefresh=!0);b&&Sfdc.AccessibleFilePublicLinksDialog.needRefresh&&(b.syncUpMainPage=!0)};
Sfdc.AccessibleFilePublicLinksDialog.prototype.open=function(a){var b=Sfdc.AccessibleFilePublicLinksDialog.DATA_LOAD_URL+a.docId,c=this;Sfdc.apply(this,a,!0);chatter.getToolbox().post({url:b,params:{versionId:c.versionId},success:function(a,e){c.updateContent(e);c.hasExistingLink="true"===e.hasExistingLink?!0:!1;c.callback&&c.callback(b)}})};Sfdc.AccessibleFilePublicLinksDialog.prototype.cancel=function(){this.clickShareBtn(this.hasExistingLink)};
Sfdc.AccessibleFilePublicLinksDialog.prototype.show=function(){Sfdc.BaseAccessibleFileDialog.prototype.show.call(this);chatter.getEventBus().fireEvent("chatter:files","onAfterPublicLinkDialogOpen")};
window.Perf&&Perf.enabled&&Perf.mark("MultiFileUploader:Start");Sfdc.ns("Sfdc.ChatterFileUploader");
Sfdc.ChatterFileUploader=function(a){Sfdc.MultiFileUploaderBase.apply(this,arguments);Sfdc.MultiFileUploaderUtil.extend(this.config,{progressBarWidth:200,overallProgressBarWidth:330,fileUploadListContainerId:null,fileUploadListElem:null});Sfdc.MultiFileUploaderUtil.extend(this.config,a);this.ui=Sfdc.MultiFileUploaderUi;this.overallProgressBar=new Sfdc.MultiFileUploaderUiComponents.ProgressBar(Sfdc.get("overallProgress"),this.config.overallProgressBarWidth);var b=this,c=this.uploadHandler;this.fileUploadBadgeList=
new Sfdc.MultiFileUploaderUiComponents.FileUploadBadgeList({fileUploadListContainerId:this.config.fileUploadListContainerId,fileUploadListElem:this.config.fileUploadListElem,cancelFileUploadCallback:function(a){if(Sfdc.MultiFileUploaderUtil.isIE9AndBelow()){Sfdc.ChatterFileSWFUploader.cancelCurrentUpload(a.mfuFileId);var d=Sfdc.ChatterFileSWFUploader.getFileObj(a.mfuFileId);b.onCancelHandler(a.mfuFileId,d);b.config.onCancelCallback(a.mfuFileId,d)}else c.cancelCurrentUpload(a.mfuFileId),c.uploadNextIfNoneInProgress()}});
this.filterParentId=this.config.filterParentId;this.uploadedDocId=null;var e=this.config.fileInput?1:2,d=Sfdc.ChatterFileUploader.getOriginOfMultiUpload(this.filterParentId,this.config.isRelatedList);this.usageStats=new Sfdc.MultiFileUploaderUsageStats({filterParentId:this.config.filterParentId,origin:d,uploadMethod:e,statsActionUrl:this.config.statsActionUrl})};Sfdc.MultiFileUploaderUtil.extend(Sfdc.ChatterFileUploader.prototype,Sfdc.MultiFileUploaderBase.prototype);
Sfdc.MultiFileUploaderUtil.extend(Sfdc.ChatterFileUploader.prototype,{setUploadedDocId:function(a){a&&(this.uploadedDocId=a)},afterUploadFinished:function(){var a=this.filesCompleted,b=this.filesSelected;a<b?this.ui.updateUploadingStatusInfoWithInProgressMessage(a,b):this.afterAllUploadsFinished()},afterAllUploadsFinished:function(){var a=this.filesSelected;0<this.filesCompleted?this.ui.updateUploadingStatusInfoWithSuccessMessage(a):this.ui.updateUploadingStatusInfoWithAllCanceledMessage(this.totalNumberOfFilesSelected);
this.ui.hideOverallProgressBar();this.ui.hideCancelRemainingUploadsButton();this.ui.showCloseButton();this.shouldShowSharingSettingsButton()?this.ui.showSharingSettingsBtn(Sfdc.AccessibleUploadFileDialog.getBaseUrl(),this.uploadedDocId):this.ui.hideSharingSettingBtn();this.usageStats.sendUsageStats(this.filesSelected)},shouldShowSharingSettingsButton:function(){if(this.isSingleFileMode&&this.uploadedDocId){var a=Sfdc.ChatterFileUploader.getOriginOfMultiUpload(this.config.filterParentId,this.config.isRelatedList);
if(a!=Sfdc.ChatterFileUploader.GROUP_PAGE&&a!=Sfdc.ChatterFileUploader.PROFILE_PAGE)return!0}return!1},constructFileUploadBadge:function(a,b){var c=new Sfdc.MultiFileUploaderUiComponents.FileUploadBadge(a,b,this.config.maxFileSize,this.config.maxFileSizeLabel,this.config.progressBarWidth,this.isSingleFileMode);this.fileUploadBadgeList.add(c);return c},onStartHandler:function(a,b){var c=new Sfdc.MultiFileUploaderFile(b);this.usageStats.start(c);c=this.constructFileUploadBadge(a,c);if(c.fileDoesNotMeetLimits)return!1;
Sfdc.MultiFileUploaderBase.prototype.onStartHandler.apply(this,arguments);c.dom.isAbort=!1;return!0},onProgressHandler:function(a,b,c,e){Sfdc.MultiFileUploaderBase.prototype.onProgressHandler.apply(this,arguments);var d=this.fileUploadBadgeList.get(a),h=d.dom;if(!h||!(h.isAbort&&!0===h.isAbort)){d.updateProgressBar(c/e);if(c!=e){var k=Math.round(100*(c/e));100>k?d.updateFileProgressPercentage(k):(Sfdc.get(".multifile-upload-status",h).innerHTML=LC.getLabel("ChatterFileMultiUpload","processing"),Sfdc.Dom.addClass(Sfdc.get(".multifile-upload-cancel",
h),"hidden"))}this.filesCompleted<this.filesSelected&&this.ui.updateUploadingStatusInfoWithInProgressMessage(this.filesCompleted,this.filesSelected);this.overallProgressBar.update((c+this.completedSize)/this.selectedSize)}},onCancelHandler:function(a,b){Sfdc.MultiFileUploaderBase.prototype.onCancelHandler.apply(this,arguments);this.fileUploadBadgeList.get(a).displayAsCanceled();this.afterUploadFinished()},onErrorHandler:function(a,b,c){a=Sfdc.MultiUploadErrorHandlingDialog.open(c);Sfdc.ChatterFileUploader.dragAndDropZone.errorDialog=
a;Sfdc.ChatterFileUploader.dragAndDropZone.isEntered=!1;Sfdc.AccessibleMultiUploadFilesDialog.isOpened()&&Sfdc.AccessibleMultiUploadFilesDialog.displayDragAndDropTargetIcon(!1)},onCompleteHandler:function(a,b,c){var e=new Sfdc.MultiFileUploaderFile(b);this.usageStats.finish(e);Sfdc.MultiFileUploaderBase.prototype.onCompleteHandler.apply(this,arguments);this.fileUploadBadgeList.get(a).displayAsCompleted(c);this.setUploadedDocId(c.docid);this.afterUploadFinished()},cancelRemainingUploads:function(){Sfdc.MultiFileUploaderUtil.isIE9AndBelow()?
Sfdc.ChatterFileSWFUploader.cancelRemainingUploads():this.uploadHandler.cancelRemainingUploads()},afterAllFileUploadsScheduled:function(){(this.isSingleFileMode=1===this.totalNumberOfFilesSelected)?(this.ui.hideOverallProgressBar(),this.ui.hideListTableHeader(),this.ui.showSingleFileModeUploadList()):(this.ui.showOverallProgressBar(),this.ui.showListTableHeader(),this.ui.hideSharingSettingBtn());0<this.filesInProgress?(this.ui.hideCloseButton(),this.ui.showCancelRemainingUploadsButton()):this.afterAllUploadsFinished()}});
Sfdc.ChatterFileUploader.GROUP_ENTITY_PREFIX="0F9";Sfdc.ChatterFileUploader.PROFILE_ENTITY_PREFIX="005";Sfdc.ChatterFileUploader.CAMPAIGN_ENTITY_PREFIX="701";Sfdc.ChatterFileUploader.ORG_ENTITY_PREFIX="00D";Sfdc.ChatterFileUploader.GROUP_PAGE="GROUP_PAGE";Sfdc.ChatterFileUploader.PROFILE_PAGE="PROFILE_PAGE";Sfdc.ChatterFileUploader.CHATTER_FILE_PAGE="CHATTER_PAGE";Sfdc.ChatterFileUploader.CAMPAIGN_PAGE="CAMPAIGN_PAGE";Sfdc.ChatterFileUploader.RELATED_LIST="RELATED_LIST";
Sfdc.ChatterFileUploader.FILE_TAB_PAGE="FILE_TAB_PAGE";Sfdc.ChatterFileUploader.PUBLISHER="PUBLISHER";Sfdc.ChatterFileUploader.maxFileSize=0;Sfdc.ChatterFileUploader.maxFileSizeLabel="";Sfdc.ChatterFileUploader.ACTION_URL="/chatterfile/";
Sfdc.ChatterFileUploader.createInstance=function(a,b){var c=a.fileInput,e={fileUploadListContainerId:"multiUploadListPanel",fileInput:c,maxFileSize:Sfdc.ChatterFileUploader.maxFileSize,filterParentId:b,uploadActionUrl:Sfdc.MultiFileUploaderUtil.getActionUrl()+Sfdc.ChatterFileUploader.ACTION_URL,statsActionUrl:Sfdc.ChatterFileUploader.ACTION_URL};Sfdc.MultiFileUploaderUtil.extend(e,a);e=new Sfdc.ChatterFileUploader(e);c&&e.uploadFiles(c.files);return e};Sfdc.ChatterFileUploader.dragAndDropZone=null;
Sfdc.ChatterFileUploader.setupPageDragDropZone=function(a){Sfdc.ChatterFileUploader.setupDropZoneSavedConfig=a;if(!Sfdc.ChatterFileUploader.dragAndDropZone){var b=new Sfdc.UploadFileDragDropZone({onEnterCallback:function(){b.isEntered=!0;b.createDragAndDropOverlay();if(Sfdc.AccessibleMultiUploadFilesDialog.isOpened())Sfdc.AccessibleMultiUploadFilesDialog.displayDragAndDropTargetIcon(!0);else{var a=Sfdc.ChatterFileUploader.setupDropZoneSavedConfig;a.fileInput=null;a.displayDDTargetIcon=!0;Sfdc.AccessibleMultiUploadFilesDialog.open(a)}},
onDropCallback:function(a){b.isEntered=!1;b.destroyDragAndDropOverlay();a=Sfdc.MultiFileUploaderUtil.processDirectoriesInFileList(a.dataTransfer);var e=Sfdc.AccessibleMultiUploadFilesDialog.uploader;0<a.length&&e?(Sfdc.AccessibleMultiUploadFilesDialog.displayDragAndDropTargetIcon(!1),e.uploadFiles(a)):Sfdc.AccessibleMultiUploadFilesDialog.closeIt(!0)},onLeaveCallback:function(){b.isEntered=!1;b.destroyDragAndDropOverlay();var a=Sfdc.AccessibleMultiUploadFilesDialog.uploader;a&&0===a.filesCompleted+
a.filesInProgress?Sfdc.AccessibleMultiUploadFilesDialog.closeIt():Sfdc.AccessibleMultiUploadFilesDialog.displayDragAndDropTargetIcon(!1)}});Sfdc.ChatterFileUploader.dragAndDropZone=b}};
Sfdc.ChatterFileUploader.getOriginOfMultiUpload=function(a,b){return a&&a.substr(0,3)===Sfdc.ChatterFileUploader.GROUP_ENTITY_PREFIX&&0<window.location.href.indexOf("GroupFileListPage")?Sfdc.ChatterFileUploader.GROUP_PAGE:a&&a.substr(0,3)===Sfdc.ChatterFileUploader.PROFILE_ENTITY_PREFIX&&0<window.location.href.indexOf("UserFileListPage")?Sfdc.ChatterFileUploader.PROFILE_PAGE:0<window.location.href.indexOf("ChatterPage")?Sfdc.ChatterFileUploader.CHATTER_FILE_PAGE:b?Sfdc.ChatterFileUploader.RELATED_LIST:
a&&a.substr(0,3)===Sfdc.ChatterFileUploader.CAMPAIGN_ENTITY_PREFIX?Sfdc.ChatterFileUploader.CAMPAIGN_PAGE:Sfdc.ChatterFileUploader.FILE_TAB_PAGE};Sfdc.ChatterFileUploader.isMultiFileUpload=!1;Sfdc.ChatterFileUploader.isIEMultiFileUpload=!1;Sfdc.ChatterFileUploader.isFileSync=!1;Sfdc.ChatterFileUploader.createAndAttachUploadButton=function(a,b){new Sfdc.UploadButton({uploadBtnAnchor:a,onChange:function(a){b.fileInput=a;b.displayDDTargetIcon=!1;Sfdc.AccessibleMultiUploadFilesDialog.open(b)}})};
Sfdc.ChatterFileUploader.hideUploadFileButtonLink=function(){Sfdc.Dom.hideByDisplay("uploadFileButtonLink")};Sfdc.ChatterFileUploader.addDragDropZoneButtonStyle=function(a){Sfdc.Dom.addClass(a,"dragDropZoneButton")};Sfdc.ChatterFileUploader.addDragDropZoneDashedBorder=function(a){Sfdc.Dom.addClass(a,"dragDropZoneDiv")};
Sfdc.ChatterFileUploader.addIndicatorTextStringNonIE=function(a){var b=document.createElement("div");b.setAttribute("class","multifile-upload-draganddrop-indicactor");var c=document.createElement("span");c.appendChild(document.createTextNode(LC.getLabel("ChatterFileMultiUpload","dragAndDropIndicatorNoIE")));b.appendChild(c);a.appendChild(b)};Sfdc.ChatterFileUploader.adjustParentStyling=function(a){(a=Sfdc.Dom.getParent(a))&&Sfdc.Dom.addClass(a,"multiUploadControl")};
Sfdc.ChatterFileUploader.hookupInputForMultiFileUpload=function(a){var b=a.btnDivId,c=a.enableMultiFileUploading,e=a.filterParentId,d=a.parentEntityName,h=a.maxFileSize,k=a.maxFileSizeLabel,m=a.fldr,n=a.isRelatedList,g=Sfdc.ChatterFileUploader.getOriginOfMultiUpload(e,n),d={fileInput:null,displayDDTargetIcon:!1,filterParentId:e,parentEntityName:d,uploaderOrigin:g,isRelatedList:n,maxFileSizeLabel:k};m&&(d.fldr=m);var f=document.getElementById(b);Sfdc.ChatterFileUploader.maxFileSize=h;Sfdc.ChatterFileUploader.maxFileSizeLabel=
k;b=document.getElementById("fileUploaderDiv");if(f)if(k=Ext.isWindows&&Sfdc.userAgent.isSafari,c&&Sfdc.MultiFileUploaderUtil.isMultiFileUploadSupported()&&!k&&!Sfdc.MultiFileUploaderUtil.isIE9AndBelow())Sfdc.ChatterFileUploader.isMultiFileUpload=!0,Sfdc.ChatterFileUploader.hideUploadFileButtonLink(),Sfdc.ChatterFileUploader.createAndAttachUploadButton(f,d),Sfdc.ChatterFileUploader.setupPageDragDropZone(d),Sfdc.ChatterFileUploader.addDragDropZoneButtonStyle(f),Sfdc.ChatterFileUploader.addDragDropZoneDashedBorder(b),
Sfdc.ChatterFileUploader.addIndicatorTextStringNonIE(b),Sfdc.ChatterFileUploader.adjustParentStyling(b);else{if(Sfdc.userAgent.isChrome&&(c=Sfdc.get("fileUploadBtnDiv")))c=Sfdc.get(".uploadArrow",c),Sfdc.Dom.addClass(c,"uploadArrowWithMorePadding");var l={title:LC.getLabel("ChatterFilesTabPage","uploadFileDialogTitle")};m&&(l.fldr=m);a.token&&null===chatter.getToolbox().token()&&chatter.getToolbox().setToken(a.token);a.hiddenInputId&&(l.successHandler=function(b,c,d,m){Sfdc.get(a.hiddenInputId).value=
c.docid;Sfdc.Dom.show(Sfdc.get(a.btnClearId));Sfdc.Dom.focus(Sfdc.get(a.btnClearId));Sfdc.Dom.hideByDisplay(f);b=m.replace(/^.*\\/,"");d=Sfdc.get(a.imgDisplayId);d.src="/sfc/servlet.shepherd/version/download/"+c.versionId;d.alt=b;d.title=b;Sfdc.get(a.imgNameDiv).innerText=b},l.cancelHandler=function(){Sfdc.Dom.focus(f)});if(a.btnClearId){var p=Sfdc.get(a.btnClearId);addEvent(p,"click",function(){Sfdc.Dom.hideByDisplay(p);Sfdc.Dom.show(f);Sfdc.Dom.focus(f);Sfdc.ChatterFiles.deleteFileQuietly(Sfdc.get(a.hiddenInputId).value);
Sfdc.get(a.hiddenInputId).value="";var b=Sfdc.get(a.imgDisplayId);b.src=a.defaultImageUrl;b.title=LC.getLabel("CampaignImage","defaultImageAltText");b.alt=LC.getLabel("CampaignImage","defaultImageAltText");Sfdc.get(a.imgNameDiv).innerText=LC.getLabel("CampaignImage","showingDefault")})}g==Sfdc.ChatterFileUploader.CAMPAIGN_PAGE&&(l.maxFileSize=h,l.origin=g,l.sharingOption_upload=a.sharingOption_upload);if(e&&(g==Sfdc.ChatterFileUploader.RELATED_LIST||g==Sfdc.ChatterFileUploader.CAMPAIGN_PAGE))l.filterParentId=
e;addEvent(f,"click",function(){Sfdc.AccessibleUploadFileDialog.open(l)})}Sfdc.ChatterFileUploader.config=d;b&&Sfdc.Dom.show(b)};
Sfdc.ChatterFileUploader.hookupInputForSingleFileUpload=function(a,b,c){Sfdc.ChatterFileUploader.maxFileSize=b;Sfdc.ChatterFileUploader.maxFileSizeLabel=c;if((a=document.getElementById(a))&&Sfdc.MultiFileUploaderUtil.isFileAPISupported()&&(Sfdc.userAgent.isSafari||Sfdc.userAgent.isChromium))Sfdc.ChatterFileUploader.isMultiFileUpload=!1,new Sfdc.SingleUploadButton({uploadBtnAnchor:a,onChange:function(a){chatter.getPublisher().getHandler("ContentPost").fileNewInfoUpdate(a)}})};
Sfdc.ChatterFileUploader.setVisible=function(a){var b=document.getElementById("fileUploaderDiv");b&&(!1===a?Sfdc.Dom.hideByDisplay(b):Sfdc.Dom.show(b))};Sfdc.ns("Sfdc.ChatterFileSWFUploader");
Sfdc.ChatterFileSWFUploader=function(){var a=null,b=null,c={},e=0,d=null,h=null,k=function(){b.each(function(a){a=b.get(a);var c=a.index;c>=e&&(Sfdc.ChatterFileSWFUploader.cancelCurrentUpload(parseInt(c,10),!0),d.onCancelHandler(parseInt(c,10),a),d.config.onCancelCallback(parseInt(c,10),a))});d.afterAllUploadsFinished()};return{setSwfUploadButton:function(b){a=b},startSelectFileCallback:function(){a.config.openUploadDialog();b=new Map;d=Sfdc.AccessibleMultiUploadFilesDialog.uploader;d.totalNumberOfFilesSelected=
0;d.filesCompleted=0;d.filesSelected=0;var c=Sfdc.SWFUploadButton.SWF_BUTTON_ID;h=Sfdc.userAgent.isIE?document.getElementById(c):document[c]},selectFileCallback:function(a,e,g,f){g={index:a,name:e,size:g,type:f};b.put(e,g);c[a]=g;d.totalNumberOfFilesSelected++;d.onStartHandler(a,g);Sfdc.userAgent.isIE7&&Sfdc.Dom.hideByDisplay(Sfdc.get("multiUploadCancelRemainingBtn"));d.afterAllFileUploadsScheduled()},uploadProgressCallback:function(a,c,e){a=b.get(a);d.onProgressHandler(a.index,a,c,e);d.config.onProgressCallback(a.index,
a,c,e)},uploadCompleteCallback:function(a){},uploadCompleteDataCallback:function(a,c){var g=b.get(a);e=g.index;var f=Sfdc.MultiFileUploaderUtil.parseResponseResult(c);if("Failure"===f.message)return f.html=f.html&&chatter.getFileUploader().getBase64Decoder().decode(f.html),Sfdc.MultiUploadErrorHandlingDialog.open(f.html),"true"===f.ignoreIt?(Sfdc.ChatterFileSWFUploader.cancelCurrentUpload(parseInt(e,10)),d.onCancelHandler(parseInt(e,10),g),d.config.onCancelCallback(parseInt(e,10),g)):k(),f.ignoreIt;
d.onCompleteHandler(g.index,g,f);d.config.onCompleteCallback(g.index,g,f);d.setUploadedDocId(f.docid);0===d.filesSelected?d.overallProgressBar.update(0):d.afterUploadFinished();e++;return"true"},ioErrorCallback:function(a){},getRequestToken:function(){return chatter.getToolbox().token()},getActionRequestUrl:function(){return Sfdc.MultiFileUploaderUtil.getActionUrl()+Sfdc.ChatterFileUploader.ACTION_URL},getFilterParentId:function(){return d.filterParentId},getFolderId:function(){return d.config.fldr},
getIsFileSync:function(){Sfdc.MultiFileUploaderUtil.checkFileSyncOption();return Sfdc.ChatterFileUploader.isFileSync?"true":"false"},cancelCurrentUpload:function(a,b){!0!==b&&(b=!1);h.cancelUpload(a,b)},cancelRemainingUploads:function(){k()},getFileObj:function(a){return c[a]}}}();window.Perf&&Perf.enabled&&Perf.endMark("MultiFileUploader:Start");

//# sourceMappingURL=/javascript/1684699876605/sfdc/source/Chatter.js.map
